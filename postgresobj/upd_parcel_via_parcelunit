begin
 CREATE OR REPLACE FUNCTION upd_parcel_via_parcelunit() RETURNS TRIGGER AS $$
    BEGIN
        SET parcelunit.parcel_parcelkey = temp_parcelunit_parcelkey;
        CREATE TEMP TABLE IF NOT EXISTS temp_table AS
        SELECT * FROM parcel WHERE  parcel.parcel_parcelkey  = temp_parcelunit_parcelkey;     
        IF (TG_OP = 'DELETE') THEN
        
            OLD.last_updated = now();
            OLD.last_user = user;
            INSERT INTO parcel VALUES(OLD.*);
            RETURN OLD;
        ELSIF (TG_OP = 'UPDATE') THEN
          
            NEW.lastupdatedby_userid = now();
            NEW.occperiod.lastupdatedby_userid = user;
            INSERT INTO parcel VALUES(NEW.*);
            RETURN NEW;
        ELSIF (TG_OP = 'INSERT') then
            NEW.lastupdatedby_userid = now();
            NEW.occperiod.lastupdatedby_userid = user;
            INSERT INTO parcel VALUES(NEW.*);
            RETURN NEW;
        END IF;
    END;   
    $$ LANGUAGE plpgsql;
END;
