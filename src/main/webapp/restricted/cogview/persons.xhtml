<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:f="http://xmlns.jcp.org/jsf/core"
      xmlns:p="http://primefaces.org/ui">
    <h:head>
        <link rel="stylesheet" type="text/css" href="css/style.css"></link>
        <title>Persons</title>
    </h:head>
    <h:body>
        <ui:composition template="../navContainer_restricted.xhtml">
            <ui:define name="content">

                <f:view id="persons-view">
                    <div class="two-column-page-flex-container">
                        <div class="list-column-persons">
                            <h:form id="messages-left-form">
                                <h:messages id="persons-messages-global"
                                            globalOnly="true" showDetail="true" showSummary="true"
                                            warnClass="msgWarn" infoClass="msgInfo" fatalClass="msgFatal" errorClass="msgError">
                                </h:messages>
                            </h:form>

                            <h1 class="property-maroon">Persons</h1>

                            <h:outputText value="List query name: #{personsBB.searchParams.searchName}"/>


                            <h:form id="change-person-form">

                                <h:messages id="person-search-messages" globalOnly="true" showDetail="true" showSummary="true"
                                            warnClass="msgWarn" infoClass="msgInfo" fatalClass="msgFatal" errorClass="msgError">
                                </h:messages>


                                <h:panelGrid columns="2" cellpadding="10" footerClass="gridFooter"
                                             columnClasses="gridTd-solid-back, gridTd-solid-back">

                                    <h:panelGroup>
                                        <p:outputLabel for="muniSelectMenu-person">
                                            <h:outputText value="Municipality:"/>
                                        </p:outputLabel>
                                        <p:spacer height="5px"/>

                                        <p:selectOneMenu id="muniSelectMenu-person" 
                                                         tabindex="1" 
                                                         value="#{personsBB.searchParams.muni}">
                                            <f:converter converterId="muniConverter"/>
                                            <f:selectItem itemLabel="select muni..." noSelectionOption="true"  itemDisabled="true"/>
                                            <f:selectItems id="muniNameList" value="#{sessionBean.facesUser.authMunis}" var="m" itemValue="#{m}" itemLabel="#{m.muniName}" />
                                        </p:selectOneMenu>
                                    </h:panelGroup>

                                    <h:panelGroup class="spacer"></h:panelGroup>    


                                    <h:panelGroup>
                                        <p:outputLabel id="filter-by-fname-ol" for="filter-by-fname-cb" value="Filter by first name?"/>
                                        <p:spacer height="5px"/>
                                        <p:selectBooleanCheckbox id="filter-by-fname-cb" value="#{personsBB.searchParams.filterByFirstName}" />
                                    </h:panelGroup>

                                    <h:panelGroup>
                                        <p:outputLabel for="formFirstName-person">
                                            <h:outputText value="First Name"/>
                                        </p:outputLabel>
                                        <p:inputText id="formFirstName-person" value="#{personsBB.searchParams.firstNameSS}" 
                                                     style="width: 200px;" tabindex="1" required="false" styleClass="inputText">
                                            <f:validateLength minimum="2" maximum="100"/>
                                        </p:inputText>
                                        <h:message for="formFirstName-person" showDetail="false" showSummary="true" 
                                                   warnClass="msgWarn" infoClass="msgInfo" fatalClass="msgFatal" errorClass="msgError" />
                                    </h:panelGroup>

                                    <h:panelGroup>
                                        <p:outputLabel id="filter-by-lname-ol" for="filter-by-lname-cb" value="Filter by last name?"/>
                                        <p:spacer height="5px"/>
                                        <p:selectBooleanCheckbox id="filter-by-lname-cb" value="#{personsBB.searchParams.filterByLastName}" />
                                    </h:panelGroup>

                                    <h:panelGroup id="lname-person-person">
                                        <p:outputLabel for="formLastName-person">
                                            <h:outputText value="Last Name"/>
                                        </p:outputLabel>
                                        <p:inputText id="formLastName-person" value="#{personsBB.searchParams.lastNameSS}" 
                                                     style="width: 200px;" tabindex="4" required="false" styleClass="inputText">
                                            <f:validateLength minimum="2" maximum="100"/>
                                        </p:inputText>
                                        <h:message for="formLastName-person" showDetail="false" showSummary="true" 
                                                   warnClass="msgWarn" infoClass="msgInfo" fatalClass="msgFatal" errorClass="msgError" />
                                    </h:panelGroup>


                                    <h:panelGroup>
                                        <p:outputLabel id="filter-by-personid-ol" for="filter-by-personid-cb" value="Filter by person ID?"/>
                                        <p:spacer height="5px"/>
                                        <p:selectBooleanCheckbox id="filter-by-personid-cb" value="#{personsBB.searchParams.filterByObjectID}" />
                                    </h:panelGroup>



                                    <h:panelGroup id="personID">
                                        <p:outputLabel for="formPersonID">
                                            <h:outputText value="Person ID number"/>
                                        </p:outputLabel>
                                        <p:inputText id="formPersonID" value="#{personsBB.searchParams.objectID}" 
                                                     style="width: 25%;" tabindex="3" required="true" styleClass="inputText"/>
                                        <h:message for="formPersonID" showDetail="false" showSummary="true" 
                                                   warnClass="msgWarn" infoClass="msgInfo" fatalClass="msgFatal" errorClass="msgError" />

                                    </h:panelGroup>
                                </h:panelGrid>

                                <p:commandButton
                                    value="Search for Persons" tabindex="4" ajax="true" icon="fa fa-search"
                                    actionListener="#{personsBB.searchForPersons}" 
                                    update=    "change-person-form:filter-by-personid-cb
                                    change-person-form:formPersonID
                                    change-person-form:filter-by-fname-cb
                                    change-person-form:formFirstName-person
                                    change-person-form:filter-by-lname-cb
                                    change-person-form:formLastName-person
                                    change-person-form:muniSelectMenu-person
                                    change-person-form:personTable
                                    change-person-form:person-search-messages
                                    messages-left-form:persons-messages-global
                                    "/>



                                <h2>Search Results</h2>

                                <p:dataTable
                                    id="personTable"
                                    var="p"
                                    value="#{personsBB.personList}"
                                    rowKey="#{p.personID}"
                                    tableStyleClass="primeDataTable"
                                    rowExpandMode="single"
                                    expandedRow="false"
                                    filteredValue="#{personsBB.filteredPersonList}"
                                    widgetVar="personSelectListTable">
                                    <!--<p:ajax event="rowSelect" update="selectedRowLabel"/>-->

                                    <p:column width="4%">
                                        <f:facet name="header">
                                            <h:outputText value="ID" />
                                        </f:facet>
                                        <h:outputText value="#{p.personID}"/>
                                    </p:column>

                                    <p:column width="10%" sortBy="#{p.personType.label}">
                                        <f:facet name="header">
                                            <h:outputText value="Person Type" />
                                        </f:facet>
                                        <h:outputText value="#{p.personType.label}"/>
                                    </p:column>


                                    <p:column width="10%" sortBy="#{p.firstName}"
                                              filterBy="#{p.firstName}">
                                        <f:facet name="header">
                                            <h:outputText value="First" />
                                        </f:facet>
                                        <h:outputText value="#{p.firstName}"/>
                                    </p:column>

                                    <p:column width="10%" filterBy="#{p.lastName}"
                                              sortBy="#{p.lastName}">
                                        <f:facet name="header">
                                            <h:outputText value="Last" />
                                        </f:facet>
                                        <h:outputText value="#{p.lastName}"/>
                                    </p:column>

                                    <p:column   width="20%"
                                                sortBy="#{p.addressStreet}"
                                                filterBy="#{p.addressStreet}">
                                        <f:facet name="header">
                                            <h:outputText value="Address" />
                                        </f:facet>
                                        <h:outputText escape="false" value="#{p.addressStreet}"/>
                                        <p:spacer height="5px"/>
                                        <h:outputText value="#{p.addressCity}, #{p.addressState} #{p.addressZip}"/>
                                    </p:column>

                                    <p:column width="10%" >
                                        <f:facet name="header">
                                            <h:outputText value="Select" />
                                        </f:facet>
                                        <p:commandButton actionListener="#{personsBB.selectPerson(p)}"
                                                         ajax="true"
                                                         value="select"
                                                         update="
                                                         selected-person-info-form:selected-person-info-ds"/>
                                    </p:column>

                                    <p:rowExpansion>
                                    </p:rowExpansion>
                                </p:dataTable>
                            </h:form>
                        </div>

                        <div class="object-column">

                            <p:spacer height="6px;"/>

                            <h:form id="selected-person-info-form">

                                <p:dataScroller
                                    id="selected-person-info-ds"
                                    value="#{personsBB.selectedPerson}"
                                    var="p">


                                    <div class="outlinedBox">

                                        <h2><h:outputText value="#{p.firstName} #{p.lastName} (#{p.muni.muniName})"/>, Person ID:<h:outputText value="#{p.personID}"/> </h2>
                                        <h:panelGrid columns="4" cellpadding="10" footerClass="gridFooter"
                                                     columnClasses="gridTd, gridTd, gridTd, gridTd">

                                            <h:panelGroup>
                                                <h:outputLabel styleClass="bold" value="First Name"/>
                                                <p:spacer height="15px"/>
                                                <div class="rowExpansion">
                                                    <h:outputText value="#{p.firstName}"/>
                                                </div>
                                            </h:panelGroup>


                                            <h:panelGroup>
                                                <h:outputLabel styleClass="bold" value="Last Name"/>
                                                <p:spacer height="15px"/>
                                                <div class="rowExpansion">
                                                    <h:outputText value="#{p.lastName}"/>
                                                </div>
                                            </h:panelGroup>

                                            <h:panelGroup>
                                                <h:outputLabel styleClass="bold" value="Muni"/>
                                                <p:spacer height="15px"/>
                                                <div class="rowExpansion">
                                                    <h:outputText value="#{p.muni.muniName}"/>
                                                </div>
                                            </h:panelGroup>

                                            <h:panelGroup>
                                                <h:outputLabel styleClass="bold" value="Type"/>
                                                <p:spacer height="15px"/>
                                                <div class="rowExpansion">
                                                    <h:outputText value="#{p.personType.label}"/>
                                                </div>
                                            </h:panelGroup>

                                            <h:panelGroup>
                                                <h:outputLabel styleClass="bold" value="Job Title"/>
                                                <p:spacer height="15px"/>
                                                <div class="rowExpansion">
                                                    <h:outputText value="#{p.jobTitle}"/>
                                                </div>
                                            </h:panelGroup>

                                            <h:panelGroup>
                                                <h:outputLabel styleClass="bold" value="Email"/>
                                                <p:spacer height="15px"/>
                                                <div class="rowExpansion">
                                                    <h:outputText value="#{p.email}"/>
                                                </div>
                                            </h:panelGroup>

                                            <h:panelGroup>
                                                <h:outputLabel styleClass="bold" value="Address"/>
                                                <p:spacer height="15px"/>
                                                <div class="rowExpansion">
                                                    <h:outputText escape="false" value="#{p.addressStreet}"/>
                                                    <p:spacer height="5px"/>
                                                    <h:outputText value="#{p.addressCity}, #{p.addressState} #{p.addressZip}"/>
                                                </div>
                                            </h:panelGroup>

                                            <h:panelGroup>
                                                <h:outputLabel styleClass="bold" value="Under 19"/>
                                                <p:spacer height="15px"/>
                                                <div class="rowExpansion">
                                                    <h:outputText value="#{p.under18}"/>
                                                </div>
                                            </h:panelGroup>

                                            <h:panelGroup>
                                                <h:outputLabel styleClass="bold" value="Active?"/>
                                                <p:spacer height="15px"/>
                                                <div class="rowExpansion">
                                                    <h:outputText value="#{p.active}"/>
                                                </div>
                                            </h:panelGroup>

                                            <h:panelGroup>
                                                <h:outputLabel styleClass="bold" value="Last Updated"/>
                                                <p:spacer height="15px"/>
                                                <div class="rowExpansion">
                                                    <h:outputText value="#{p.lastUpdated}"/>
                                                </div>
                                            </h:panelGroup>

                                            <h:panelGroup>
                                                <h:outputLabel styleClass="bold" value="Expires"/>
                                                <p:spacer height="15px"/>
                                                <div class="rowExpansion">
                                                    <h:outputText value="#{p.expiryDate.toString}"/>
                                                </div>
                                            </h:panelGroup>

                                            <h:panelGroup>
                                                <h:outputLabel styleClass="bold" value="Phone home"/>
                                                <p:spacer height="15px"/>
                                                <div class="rowExpansion">
                                                    <h:outputText value="#{p.phoneHome}"/>
                                                </div>
                                            </h:panelGroup>

                                            <h:panelGroup>
                                                <h:outputLabel styleClass="bold" value="Phone work"/>
                                                <p:spacer height="15px"/>
                                                <div class="rowExpansion">
                                                    <h:outputText value="#{p.phoneWork}"/>
                                                </div>
                                            </h:panelGroup>

                                            <h:panelGroup>
                                                <h:outputLabel styleClass="bold" value="Phone cell"/>
                                                <p:spacer height="15px"/>
                                                <div class="rowExpansion">
                                                    <h:outputText value="#{p.phoneCell}"/>
                                                </div>
                                            </h:panelGroup>

                                            <f:facet name="footer">
                                                <h:outputLabel styleClass="bold" value="Person notes"/> 
                                                 <p:commandButton onclick="PF('person-notes-dialog').show()" 
                                                             icon="fa fa-pencil-square-o"
                                                             value="new note" 
                                                             styleClass="noFill button-size-small" 
                                                             rendered="#{sessionBean.facesUser.keyCard.hasMuniStaffPermissions}" />
                                                <p:spacer height="15px"/>
                                                <div class="rowExpansion">
                                                    <h:outputText escape="false" value="#{p.notes}"/>
                                                </div>
                                            </f:facet>
                                        </h:panelGrid>
                                    </div>
                                    <p:commandButton onclick="PF('update-person-dialog').show()" value="update person" ajax="true"
                                                     icon="fa fa-edit"
                                                     update="
                                                     person-update-form:pers-form-header-id
                                                     person-update-form:pers-form-header-fname
                                                     person-update-form:pers-form-header-lname
                                                     person-update-form:pers-form-lastupdated
                                                     person-update-form:personTypeSelectMenu
                                                     person-update-form:muniSM
                                                     person-update-form:formFirstNameIT
                                                     person-update-form:formLastNameIT
                                                     person-update-form:formJobTitleIT
                                                     person-update-form:formCellIT
                                                     person-update-form:formHomeIT
                                                     person-update-form:formWorkIT
                                                     person-update-form:formEmailIT
                                                     person-update-form:isUnder18FormIS
                                                     person-update-form:formStreetIT
                                                     person-update-form:formCityIT
                                                     person-update-form:formStateIT
                                                     person-update-form:formZipIT
                                                     person-update-form:isActiveFormIS

                                                     "/>

                                </p:dataScroller>


                            </h:form>
                            
                             <p:commandButton   onclick="PF('update-person-dialog').show()" 
                                                value="Update person" ajax="true"
                                                icon="fa fa-link" />
                            
                            
                            <h3>Associated properties</h3>
                            
                            
                                <p:dataTable
                                    id="propSearchTable"
                                    var="prop"
                                    value="#{propertyProfileBB.propList}"
                                    rowKey="#{prop.propertyID}"
                                    filteredValue="#{propertyProfileBB.filteredPropList}"
                                    tableStyleClass="primeDataTable"
                                    draggableRows="false" tabindex="6"
                                    >
                                    <p:column width="8%">
                                        <f:facet name="header">
                                            <h:outputText value="ID"/>
                                        </f:facet>
                                        <h:outputText value="#{prop.propertyID}" />
                                    </p:column>
                                    <p:column width="15%">
                                        <f:facet name="header">
                                            <h:outputText value="Address"/>
                                        </f:facet>
                                        <h:outputText value="#{prop.address}" />
                                    </p:column>

                                    <p:column width="10%">
                                        <f:facet name="header">
                                            <h:outputText value="Muni" />
                                        </f:facet>
                                        <h:outputText value="#{prop.muni.muniName}"/>
                                    </p:column>

                                    <p:column width="12%">
                                        <f:facet name="header">
                                            <h:outputText value="Use Type"/>
                                        </f:facet>
                                        <h:outputText value="#{prop.propertyUseType}" />
                                    </p:column>

                                    <p:column width="5%">
                                        <f:facet name="header">
                                            <h:outputText value=""/>
                                        </f:facet>
                                        <p:commandButton icon="fa fa-hand-o-right"
                                                         action="#{propertyProfileBB.manageProperty(prop)}" 
                                                         ajax="true"/>
                                    </p:column>
                                </p:dataTable>
                            

                        </div>
                    </div>

                    <p:dialog      height="650" width="700"
                                   widgetVar="update-person-dialog"
                                   closable="true" 
                                   rendered="#{sessionBean.facesUser.keyCard.hasMuniStaffPermissions}">

                        <h:form id="person-update-form">
                            <h2>Person ID: <h:outputText id="pers-form-header-id" value="#{personsBB.selectedPerson.personID} -"/> 
                                <h:outputText id="pers-form-header-fname" value="#{personsBB.selectedPerson.firstName} "/>
                                <h:outputText id="pers-form-header-lname" value="#{personsBB.selectedPerson.lastName}"/>, 
                            </h2>
                            <p>This record was last updated on: <h:outputText id="pers-form-lastupdated" value="#{personsBB.selectedPerson.lastUpdatedPretty}"/></p>
                            <h:panelGrid columns="2" border="0" 
                                         cellpadding="5" columnClasses="gridTd, gridTd"
                                         footerClass="gridFooter">


                                <h:panelGroup>

                                    <h:outputLabel value="Person Type:" for="personTypeSelectMenu"/>
                                    <p:spacer height="3px"/>
                                    <p:selectOneMenu id="personTypeSelectMenu" required="true" value="#{personsBB.selectedPerson.personType}">
                                        <f:selectItems value="#{personCoordinator.personTypes}"
                                                       var="pt" itemValue="#{pt}" itemLabel="#{pt.label}"/>
                                    </p:selectOneMenu>
                                    <h:message for="personTypeSelectMenu" showDetail="false" showSummary="true" 
                                               warnClass="msgWarn" infoClass="msgInfo" fatalClass="msgFatal" errorClass="msgError" />
                                </h:panelGroup>

                                <h:panelGroup>

                                    <h:outputLabel value="Municipality" for="personMuniSelectMenu"/>
                                    <p:spacer height="3px"/>
                                    <p:selectOneMenu
                                        id="muniSM" tabindex="1"
                                        value="#{personsBB.selectedPerson.muni}">

                                        <f:converter converterId="muniConverter"/>
                                        <f:selectItems id="muniNameList" value="#{sessionBean.facesUser.authMunis}" var="m" itemValue="#{m}" itemLabel="#{m.muniName}" />

                                    </p:selectOneMenu>
                                </h:panelGroup>

                                <h:panelGroup>
                                    <h:outputLabel value="First Name:" for="formFirstNameIT"/>
                                    <p:spacer height="3px"/>
                                    <p:inputText id="formFirstNameIT" value="#{personsBB.selectedPerson.firstName}" 
                                                 style="width: 250px;" tabindex="1" required="true" styleClass="inputText"/>
                                    <h:message for="formFirstNameIT" showDetail="false" showSummary="true" 
                                               warnClass="msgWarn" infoClass="msgInfo" fatalClass="msgFatal" errorClass="msgError" />
                                </h:panelGroup>

                                <h:panelGroup>
                                    <h:outputLabel value="Last Name:" for="formLastNameIT"/>
                                    <p:spacer height="3px"/>
                                    <p:inputText id="formLastNameIT" value="#{personsBB.selectedPerson.lastName}" 
                                                 style="width: 250px;" tabindex="2" required="true" styleClass="inputText"/>
                                    <h:message for="formLastNameIT" showDetail="false" showSummary="true" 
                                               warnClass="msgWarn" infoClass="msgInfo" fatalClass="msgFatal" errorClass="msgError" />
                                </h:panelGroup>


                                <h:panelGroup>
                                    <h:outputLabel value="Job Title:" for="formJobTitleIT"/>
                                    <p:inputText id="formJobTitleIT" value="#{personsBB.selectedPerson.jobTitle}"
                                                 style="width: 250px;" tabindex="3" required="false" styleClass="inputText"/>
                                    <p:spacer height="3px"/>
                                    <h:message for="formJobTitleIT" showDetail="false" showSummary="true" 
                                               warnClass="msgWarn" infoClass="msgInfo" fatalClass="msgFatal" errorClass="msgError" />
                                </h:panelGroup>

                                <h:panelGroup>
                                    <h:outputLabel value="Phone(cell):" for="formCellIT"/>
                                    <p:spacer height="3px"/>
                                    <p:inputText id="formCellIT" value="#{personsBB.selectedPerson.phoneCell}" 
                                                 style="width: 250px;" tabindex="4" required="false" styleClass="inputText" maxlength="12"/>
                                    <h:message for="formCellIT" showDetail="false" showSummary="true" 
                                               warnClass="msgWarn" infoClass="msgInfo" fatalClass="msgFatal" errorClass="msgError" />
                                </h:panelGroup>

                                <h:panelGroup>
                                    <h:outputLabel value="Phone(home):" for="formHomeIT"/>
                                    <p:spacer height="3px"/>
                                    <p:inputText id="formHomeIT" value="#{personsBB.selectedPerson.phoneHome}" 
                                                 style="width: 250px;" tabindex="5" required="false" styleClass="inputText" maxlength="12"/>
                                    <h:message for="formHomeIT" showDetail="false" showSummary="true" 
                                               warnClass="msgWarn" infoClass="msgInfo" fatalClass="msgFatal" errorClass="msgError" />
                                </h:panelGroup>

                                <h:panelGroup>
                                    <h:outputLabel value="Phone(work)" for="formWorkIT"/>
                                    <p:spacer height="3px"/>
                                    <p:inputText id="formWorkIT" value="#{personsBB.selectedPerson.phoneWork}" 
                                                 style="width: 250px;" tabindex="6" required="false" styleClass="inputText" maxlength="12"/>
                                    <h:message for="formWorkIT" showDetail="false" showSummary="true" 
                                               warnClass="msgWarn" infoClass="msgInfo" fatalClass="msgFatal" errorClass="msgError" />
                                </h:panelGroup>

                                <h:panelGroup>
                                    <h:outputLabel value="Email:" for="formEmailIT"/>
                                    <p:spacer height="3px"/>
                                    <p:inputText id="formEmailIT" value="#{personsBB.selectedPerson.email}" 
                                                 style="width: 250px;" tabindex="7" required="false" styleClass="inputText"/>
                                    <h:message for="formEmailIT" showDetail="false" showSummary="true" 
                                               warnClass="msgWarn" infoClass="msgInfo" fatalClass="msgFatal" errorClass="msgError" />
                                </h:panelGroup>

                                <h:panelGroup>
                                    <h:outputLabel value="Is under 18?" for="isUnder18FormIS"/>
                                    <p:spacer height="3px"/>
                                    <p:inputSwitch tabindex="8" id="isUnder18FormIS" value="#{personsBB.selectedPerson.under18}" onLabel="Yes" offLabel="No" />
                                </h:panelGroup>

                                <h:panelGroup>
                                    <h:outputLabel value="Street:" for="formStreetIT"/>
                                    <p:spacer height="3px"/>
                                    <p:inputText id="formStreetIT" value="#{personsBB.selectedPerson.addressStreet}" 
                                                 style="width: 250px;" tabindex="9" required="true" styleClass="inputText"/>
                                    <h:message for="formStreetIT" showDetail="false" showSummary="true" 
                                               warnClass="msgWarn" infoClass="msgInfo" fatalClass="msgFatal" errorClass="msgError" />
                                </h:panelGroup>

                                <h:panelGroup>
                                    <h:outputLabel value="City:" for="formCityIT"/>
                                    <p:spacer height="3px"/>
                                    <p:inputText id="formCityIT" value="#{personsBB.selectedPerson.addressCity}" 
                                                 style="width: 250px;" tabindex="10" required="true" styleClass="inputText"/>
                                    <h:message for="formCityIT" showDetail="false" showSummary="true" 
                                               warnClass="msgWarn" infoClass="msgInfo" fatalClass="msgFatal" errorClass="msgError" />
                                </h:panelGroup>

                                <h:panelGroup>
                                    <h:outputLabel value="State:" for="formStateIT"/>
                                    <p:spacer height="3px"/>
                                    <p:inputText id="formStateIT" value="#{personsBB.selectedPerson.addressState}" 
                                                 style="width: 250px;" tabindex="11" required="true" styleClass="inputText" maxlength="2"/>
                                    <h:message for="formStateIT" showDetail="false" showSummary="true" 
                                               warnClass="msgWarn" infoClass="msgInfo" fatalClass="msgFatal" errorClass="msgError" />
                                </h:panelGroup>

                                <h:panelGroup>
                                    <h:outputLabel value="ZipCode:" for="formZipIT"/>
                                    <p:spacer height="3px"/>
                                    <p:inputText id="formZipIT" value="#{personsBB.selectedPerson.addressZip}" 
                                                 style="width: 250px;" tabindex="12" required="false" styleClass="inputText"/>
                                    <h:message for="formZipIT" showDetail="false" showSummary="true" 
                                               warnClass="msgWarn" infoClass="msgInfo" fatalClass="msgFatal" errorClass="msgError" />
                                </h:panelGroup>

                                <h:panelGroup>
                                    <h:outputLabel value="Active Person?" for="isActiveFormIS"/>
                                    <p:inputSwitch id="isActiveFormIS" value="#{personsBB.selectedPerson.active}" onLabel="Yes" offLabel="No" tabindex="14"/>
                                </h:panelGroup>



                            </h:panelGrid>
                            
                            <h:outputLabel for="update-desc-ita" value="Brief description of update: "/>
                            <p:inputTextarea id="update-desc-ita" style="width: 300px; height: 200px;" value="#{personsBB.updateDescription}" tabindex="1"/>
                            
                            <p:spacer height="10px"/>
                            <p:commandButton ajax="true" value="Cancel" icon="fa fa-stop" 
                                             onclick="PF('update-person-dialog').hide()"/>

                            <p:commandButton ajax="true" value="Update Person" actionListener="#{personsBB.updatePerson}"
                                             rendered="#{sessionBean.facesUser.keyCard.hasMuniStaffPermissions}"
                                             update="selected-person-info-form:selected-person-info-ds
                                             messages-left-form:persons-messages-global"
                                             oncomplete="PF('update-person-dialog').hide()"/>
                        </h:form>
                    </p:dialog>
                    
                    
                    
                        <p:confirmDialog message="Attach note to Person" 
                                         severity="alert" widgetVar="person-note-dialog"
                                         closable="true" responsive="true"
                                         rendered="#{sessionBean.facesUser.keyCard.hasMuniStaffPermissions}">

                            <h:form id="person-note-form">
                                <h:outputLabel for="note-ita" value="Message text"/>
                                <p:spacer height="15px"/>
                                <p:inputTextarea id="note-ita" style="width: 300px; height: 200px;" value="#{personsBB.notesToAppend}" tabindex="1"/>
                                <p:spacer height="15px"/>
                                <h:outputText escape="false" value="The above text, your name, and a timestamp will be attached to "/> 
                                <h:outputText value="#{p.firstName} #{p.lastName} (#{p.muni.muniName})"/>, Person ID:<h:outputText value="#{p.personID}"/>

                                <p:spacer height="15px"/>
                                <p:commandButton ajax="true" tabindex="2"
                                                 value="Cancel" icon="fa fa-stop" 
                                                 onclick="PF('person-note-dialog').hide()"/>
                                <p:commandButton    ajax="true" actionListener="#{personsBB.attachNoteToPerson}" tabindex="3"
                                                    value="Submit" icon="fa fa-link" oncomplete="PF('person-note-dialog').hide()"
                                                    rendered="#{sessionBean.facesUser.keyCard.hasMuniStaffPermissions}"
                                                    update="    selected-person-info-form:selected-person-info-ds
                                                                messages-left-form:persons-messages-global"/>
                            </h:form>
                        </p:confirmDialog>
                </f:view>
            </ui:define>
        </ui:composition>
    </h:body>
</html>

