<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:f="http://xmlns.jcp.org/jsf/core"
      xmlns:p="http://primefaces.org/ui"
      xmlns:c="http://xmlns.jcp.org/jsp/jstl/core">
    <h:head>
        <link rel="stylesheet" type="text/css" href="css/style.css"></link>
        <title>CE Events</title>
    </h:head>
    <h:body>
        <ui:composition template="../navContainer_restricted.xhtml">
            <ui:define name="content">
                <div class="mainContainer">
                    <f:view>

                        <h:form id="ceev-form-globalmessages">
                            <h:messages id="ceev-globalmessages" globalOnly="true" showDetail="false" showSummary="true"
                                        warnClass="msgWarn" infoClass="msgInfo" fatalClass="msgFatal" errorClass="msgError">
                            </h:messages>
                        </h:form>

                        <h1>Code enforcement event explorer</h1>

                        <p>All future timeline events in <h:outputText value="#{sessionBean.sessionMuni.muniName} and events requiring your personal view confirmation."/></p>

                        <h:form id="ceev-form-search">

                            <p:fieldset legend="search options"
                                        toggleable="true" collapsed="true" style="background-color: white;">
                                <h:panelGrid columns="2" cellpadding="10" columnClasses="gridTd-solid-back, gridTd-solid-back"
                                             footerClass="gridFooter" >
                                    <h:panelGroup>
                                        <h:panelGrid columns="2" cellpadding="10" footerClass="gridFooter"
                                                     columnClasses="topbottom-lines-left, topbottom-lines-right">
                                            <h:panelGroup>
                                                <p:outputLabel id="ceev-filter-muni-ol" for="seev-filter-type" value="filter by municipality? "/>
                                                <p:selectBooleanCheckbox id="seev-filter-muni-chkbx" value="#{cEEventsBB.searchParams.filterByMuni}" >
                                                    <p:ajax update="ceev-search-muni-som"/>
                                                </p:selectBooleanCheckbox>
                                            </h:panelGroup>
                                            <h:panelGroup>
                                                <p:selectOneMenu id="ceev-search-muni-som" tabindex="1" value="#{cEEventsBB.searchParams.muni}"
                                                                 disabled="#{!cEEventsBB.searchParams.filterByMuni}">
                                                    <f:converter converterId="muniConverter"/>
                                                    <f:selectItem itemLabel="select municipality..." noSelectionOption="true" itemDisabled="true"/>
                                                    <f:selectItems id="muniNameList" value="#{sessionBean.userAuthMuniList}" var="m" itemValue="#{m}" itemLabel="#{m.muniName}" />
                                                </p:selectOneMenu>
                                                <h:message for="ceev-search-muni-som" showDetail="true" showSummary="true" 
                                                           warnClass="msgWarn" infoClass="msgInfo" fatalClass="msgFatal" errorClass="msgError" />
                                            </h:panelGroup>


                                            <h:panelGroup>
                                                <p:outputLabel id="ceev-search-startend-chkbx-ol" 
                                                               for="ceev-search-startend-chkbx" 
                                                               styleClass="bold"
                                                               value="filter by date range? "/>
                                                <p:selectBooleanCheckbox id="ceev-search-startend-chkbx" value="#{cEEventsBB.searchParams.filterByStartEndDate}" >
                                                    <p:ajax update="ceev-search-usedor-chkbx
                                                            ceev-search-vconf-chkbx 
                                                            ceev-search-timestamp-chkbx
                                                            eventDateCalStart
                                                            eventDateCalEnd
                                                            ceev-search-relative-dates-cb" />
                                                </p:selectBooleanCheckbox>

                                                <h4 style="margin-bottom: 2px;">date search options:</h4>

                                                <p:outputLabel id="ceev-search-usedor-ol" for="ceev-search-usedor-chkbx" value="use date of record field? "/>
                                                <p:selectBooleanCheckbox id="ceev-search-usedor-chkbx" 
                                                                         value="#{cEEventsBB.searchParams.useDateOfRecord}" 
                                                                         disabled="#{!cEEventsBB.searchParams.filterByStartEndDate}"/>

                                                <p:spacer height="1px"/>

                                                <p:outputLabel id="ceev-search-vconf-ol" for="ceev-search-vconf-chkbx" value="use view confirmed date field? "/>
                                                <p:selectBooleanCheckbox id="ceev-search-vconf-chkbx" 
                                                                         value="#{cEEventsBB.searchParams.useRespondedAtDateRange}" 
                                                                         disabled="#{!cEEventsBB.searchParams.filterByStartEndDate}"/>

                                                <p:spacer height="1px"/>

                                                <p:outputLabel id="ceev-search-timestamp-ol" for="ceev-search-timestamp-chkbx" value="use entry timestamp field? "/>
                                                <p:selectBooleanCheckbox id="ceev-search-timestamp-chkbx" 
                                                                         value="#{cEEventsBB.searchParams.useEntryTimestamp}" 
                                                                         disabled="#{!cEEventsBB.searchParams.filterByStartEndDate}"/>

                                            </h:panelGroup>

                                            <h:panelGroup id="datepickers-pg">
                                                <p:spacer height="5px" />
                                                <p:outputLabel id="eventDateCalStartOL" for="eventDateCalStart" value="query start date: "/>
                                                <p:spacer height="1px"/>
                                                <p:calendar id="eventDateCalStart" value="#{cEEventsBB.searchParams.startDateUtilDate}" 
                                                            mode="popup" disabled="#{(!cEEventsBB.searchParams.filterByStartEndDate) or cEEventsBB.searchParams.useRelativeDates}"
                                                            showOn="button" pattern="EEE, dd MMM, yyyy HH:mm:ss"
                                                            navigator="true" tabindex="16" timeInput="true" showHour="true" showMinute="false" showSecond="false" showMillisec="false"
                                                            showButtonPanel="true" showTodayButton="true"
                                                            required="false"/>
                                                <h:message for="eventDateCalStart" showDetail="false" showSummary="true" 
                                                           warnClass="msgWarn" infoClass="msgInfo" fatalClass="msgFatal" errorClass="msgError" />

                                                <p:spacer height="5px"/>

                                                <p:outputLabel id="eventDateCalEndOL" for="eventDateCalEnd" value="query end date: "/>
                                                <p:spacer height="1px"/>
                                                <p:calendar id="eventDateCalEnd" value="#{cEEventsBB.searchParams.endDateUtilDate}" 
                                                            mode="popup" disabled="#{(!cEEventsBB.searchParams.filterByStartEndDate) or cEEventsBB.searchParams.useRelativeDates}"
                                                            showOn="button" pattern="EEE, dd MMM, yyyy HH:mm:ss"
                                                            navigator="true" tabindex="16" timeInput="true" showHour="true" showMinute="true" showSecond="false" showMillisec="false"
                                                            showButtonPanel="true" showTodayButton="true"
                                                            required="false" />
                                                <h:message for="eventDateCalEnd" showDetail="false" showSummary="true" 
                                                           warnClass="msgWarn" infoClass="msgInfo" fatalClass="msgFatal" errorClass="msgError" />
                                            </h:panelGroup>

                                            <h:panelGroup>

                                                <p:outputLabel id="ceev-search-relative-dates-ol" for="ceev-search-relative-dates-cb" value="use relative dates? "/>
                                                <p:selectBooleanCheckbox id="ceev-search-relative-dates-cb" 
                                                                         value="#{cEEventsBB.searchParams.useRelativeDates}" 
                                                                         disabled="#{!cEEventsBB.searchParams.filterByStartEndDate}">
                                                    <p:ajax update="eventDateCalStart
                                                            eventDateCalEnd
                                                            ceev-search-relative-dates-start-it
                                                            ceev-search-relative-dates-end-it" />
                                                </p:selectBooleanCheckbox>


                                            </h:panelGroup>
                                            <h:panelGroup>
                                                <p:outputLabel id="ceev-search-relative-dates-start-ol" for="ceev-search-relative-dates-start-it" value="start date in days (relative to today)"/>
                                                <p:spacer height="1px"/>
                                                <p:inputText id="ceev-search-relative-dates-start-it" 
                                                             value="#{cEEventsBB.searchParams.startDateRelativeDays}" 
                                                             disabled="#{!(cEEventsBB.searchParams.filterByStartEndDate and cEEventsBB.searchParams.useRelativeDates)}" />
                                                <h:message for="ceev-search-relative-dates-start-it" showDetail="false" showSummary="true" 
                                                           warnClass="msgWarn" infoClass="msgInfo" fatalClass="msgFatal" errorClass="msgError" />

                                                <p:spacer height="5px"/>
                                                <p:outputLabel id="ceev-search-relative-dates-end-ol" for="ceev-search-relative-dates-end-it" value="end date in days (relative to today)"/>
                                                <p:spacer height="1px"/>
                                                <p:inputText id="ceev-search-relative-dates-end-it" 
                                                             value="#{cEEventsBB.searchParams.endDateRelativeDays}" 
                                                             disabled="#{!(cEEventsBB.searchParams.filterByStartEndDate and cEEventsBB.searchParams.useRelativeDates)}" />
                                                <h:message for="ceev-search-relative-dates-end-it" showDetail="false" showSummary="true" 
                                                           warnClass="msgWarn" infoClass="msgInfo" fatalClass="msgFatal" errorClass="msgError" />

                                            </h:panelGroup>
                                            <h:panelGroup>
                                                <p:outputLabel id="seev-filter-type-ol" for="seev-filter-type" value="filter by event type? "/>
                                                <p:selectBooleanCheckbox id="seev-filter-type" 
                                                                         value="#{cEEventsBB.searchParams.filterByEventType}">
                                                    <p:ajax update="ceev-critera-type" />
                                                </p:selectBooleanCheckbox>
                                            </h:panelGroup>


                                            <h:panelGroup>
                                                <h:outputLabel for="ceev-criteria-type">
                                                    <h:outputText value="event types:"/>
                                                </h:outputLabel>
                                                <p:spacer height="1px" />
                                                <p:selectOneMenu id="ceev-critera-type" required="false" 
                                                                 value="#{cEEventsBB.searchParams.evtType}" tabindex="10"
                                                                 disabled="#{!cEEventsBB.searchParams.filterByEventType}">
                                                    <p:ajax update="ceev-criteria-cat" immediate="true"/> 
                                                    <f:selectItems value="#{cEEventsBB.eventTypesList}"/>
                                                </p:selectOneMenu>
                                                <h:message for="ceev-critera-type" showDetail="false" showSummary="true" 
                                                           warnClass="msgWarn" infoClass="msgInfo" fatalClass="msgFatal" errorClass="msgError" />
                                            </h:panelGroup>

                                            <h:panelGroup>
                                                <p:outputLabel id="ceev-filter-cat-ol" for="ceev-filter-cat" value="filter by event category? "/>
                                                <p:selectBooleanCheckbox id="ceev-filter-cat" value="#{cEEventsBB.searchParams.filterByEventCategory}">
                                                    <p:ajax update="ceev-criteria-cat" />
                                                </p:selectBooleanCheckbox>
                                            </h:panelGroup>

                                            <h:panelGroup>
                                                <h:outputLabel for="ceev-criteria-cat" id="ceev-criteria-cat-ol">
                                                    <h:outputText value="event Categories in selected event type:"/>
                                                </h:outputLabel>
                                                <p:spacer height="1px" />
                                                <p:selectOneMenu id="ceev-criteria-cat" style="width: 300px;" 
                                                                 value="#{cEEventsBB.searchParams.eventCategory}" tabindex="10"
                                                                 disabled="#{!cEEventsBB.searchParams.filterByEventCategory}">
                                                    <f:converter converterId="eventCategoryConverter"/>
                                                    <f:selectItems  id="catItemsList" value="#{cEEventsBB.eventCatList}" var="ec" itemValue="#{ec}" itemLabel="#{ec.eventCategoryTitle}"/>
                                                </p:selectOneMenu>
                                                <h:message for="ceev-criteria-cat" showDetail="false" showSummary="true"  
                                                           warnClass="msgWarn" infoClass="msgInfo" fatalClass="msgFatal" errorClass="msgError" />
                                            </h:panelGroup>
                                            <h:panelGroup>
                                                <p:outputLabel id="ceev-filter-id-ol" for="ceev-filter-id" value="filter by ce case ID? "/>
                                                <p:selectBooleanCheckbox id="ceev-filter-id" value="#{cEEventsBB.searchParams.filterByCaseID}" 
                                                                         disabled="false" >
                                                    <p:ajax update="ceev-criteria-caseid" />
                                                </p:selectBooleanCheckbox>
                                            </h:panelGroup>

                                            <h:panelGroup>
                                                <p:outputLabel id="ceev-criteria-caseid-ol" for="ceev-criteria-caseid" value="ce case ID:"/>
                                                <p:spacer height="5px"/>
                                                <p:inputText id="ceev-criteria-caseid" 
                                                             value="#{cEEventsBB.searchParams.caseId}" 
                                                             disabled="#{!cEEventsBB.searchParams.filterByCaseID}"/>
                                                <h:message for="ceev-criteria-caseid" showDetail="false" showSummary="true" 
                                                           warnClass="msgWarn" infoClass="msgInfo" fatalClass="msgFatal" errorClass="msgError" />
                                            </h:panelGroup>

                                            <h:panelGroup>
                                                <p:outputLabel id="ceev-filter-creator-ol" for="ceev-filter-creator" value="filter by event owner? "/>
                                                <p:selectBooleanCheckbox id="ceev-filter-creator" value="#{cEEventsBB.searchParams.filterByEventOwner}" >
                                                    <p:ajax update="ceev-criteria-user" />
                                                </p:selectBooleanCheckbox>
                                            </h:panelGroup>

                                            <h:panelGroup>
                                                <h:outputLabel for="ceev-criteria-user" id="ceev-criteria-user-ol">
                                                    <h:outputText value="system user list"/>
                                                </h:outputLabel>
                                                <p:spacer height="5px"/>

                                                <p:selectOneMenu id="ceev-criteria-user" required="false" 
                                                                 value="#{cEEventsBB.searchParams.user}"
                                                                 disabled="#{!cEEventsBB.searchParams.filterByEventOwner}">
                                                    <f:selectItem itemLabel="select a user..." noSelectionOption="true" />
                                                    <f:selectItems value="#{cEEventsBB.userList}"  var="u" itemValue="#{u}" 
                                                                    itemLabel="#{u.person.firstName} #{u.person.lastName} (id:#{u.username})"/>
                                                    <f:converter converterId="userConverter"/>
                                                </p:selectOneMenu>
                                            </h:panelGroup>

                                            <h:panelGroup>
                                                <p:outputLabel id="ceev-filter-person-ol" for="ceev-filter-person" value="filter by person? "/>
                                                <p:selectBooleanCheckbox id="ceev-filter-person" value="#{cEEventsBB.searchParams.filterByPerson}" >
                                                    <p:ajax update="ceev-criteria-person" />
                                                </p:selectBooleanCheckbox>
                                            </h:panelGroup>

                                            <h:panelGroup>
                                                <p:outputLabel id="ceev-criteria-person-ol" for="ceev-criteria-person" value="your current session's person list:"/>
                                                <p:spacer height="5px"/>
                                                <p:selectOneMenu id="ceev-criteria-person" required="false" 
                                                                 value="#{cEEventsBB.searchParams.person}"
                                                                 disabled="#{!cEEventsBB.searchParams.filterByPerson}">
                                                    <f:selectItem itemLabel="select a person..." noSelectionOption="true" />
                                                    <f:selectItems value="#{sessionBean.sessionPersonList}"  var="p" itemValue="#{p}" 
                                                                   itemLabel="#{p.firstName} #{p.lastName}"/>
                                                    <f:converter converterId="personConverter"/>
                                                </p:selectOneMenu>
                                                <h:message for="ceev-criteria-person" showDetail="false" showSummary="true" 
                                                           warnClass="msgWarn" infoClass="msgInfo" fatalClass="msgFatal" errorClass="msgError" />
                                            </h:panelGroup>

                                        </h:panelGrid>
                                    </h:panelGroup>
                                    <h:panelGroup>

                                        <h:panelGrid columns="2" cellpadding="10" footerClass="gridFooter"
                                                     columnClasses="topbottom-lines-left, topbottom-lines-right">


                                            <h:panelGroup>
                                                <p:outputLabel id="ceev-filter-active-ol" for="ceev-filter-active" value="filter by active? "/>
                                                <p:selectBooleanCheckbox id="ceev-filter-active" value="#{cEEventsBB.searchParams.filterByActive}" >
                                                    <p:ajax update="ceev-criteria-active" />
                                                </p:selectBooleanCheckbox>
                                            </h:panelGroup>

                                            <h:panelGroup>
                                                <p:selectBooleanCheckbox id="ceev-criteria-active" 
                                                                         value="#{cEEventsBB.searchParams.isActive}" 
                                                                         disabled="#{!cEEventsBB.searchParams.filterByActive}" />
                                                <p:outputLabel id="ceev-criteria-active-ol" for="ceev-criteria-active" 
                                                               value="(checked = only active events:)" styleClass="italic"/>
                                            </h:panelGroup>

                                            <h:panelGroup>
                                                <p:outputLabel id="ceev-filter-hidden-ol" for="ceev-filter-hidden" value="filter by hidden? "/>
                                                <p:selectBooleanCheckbox id="ceev-filter-hidden" value="#{cEEventsBB.searchParams.filterByHidden}" >
                                                    <p:ajax update="ceev-criteria-hidden" />
                                                </p:selectBooleanCheckbox>
                                            </h:panelGroup>

                                            <h:panelGroup>
                                                <p:selectBooleanCheckbox id="ceev-criteria-hidden" 
                                                                         value="#{cEEventsBB.searchParams.isHidden}" 
                                                                         disabled="#{!cEEventsBB.searchParams.filterByHidden}" />
                                                <p:outputLabel id="ceev-criteria-hidden-ol" for="ceev-criteria-hidden" 
                                                               value="(checked = only hidden events)" styleClass="italic"/>
                                            </h:panelGroup>

                                            <h:panelGroup>
                                                <p:outputLabel id="ceev-filter-eventid-ol" for="ceev-filter-eventid" value="filter by event ID? "/>
                                                <p:selectBooleanCheckbox id="ceev-filter-eventid" 
                                                                         value="#{cEEventsBB.searchParams.filterByObjectID}" 
                                                                         styleClass="checkbox">
                                                    <p:ajax update="ceev-criteria-eventid" />
                                                </p:selectBooleanCheckbox>
                                            </h:panelGroup>
                                            <h:panelGroup>
                                                <p:outputLabel id="ceev-criteria-eventid-ol" for="ceev-criteria-eventid" value="event id:"/>
                                                <p:spacer height="5px"/>
                                                <p:inputText id="ceev-criteria-eventid" 
                                                             value="#{cEEventsBB.searchParams.objectID}" 
                                                             disabled="#{!cEEventsBB.searchParams.filterByObjectID}"/>
                                                <h:message for="ceev-criteria-eventid" showDetail="false" showSummary="true" 
                                                           warnClass="msgWarn" infoClass="msgInfo" fatalClass="msgFatal" errorClass="msgError" />
                                            </h:panelGroup>
                                            <h:panelGroup>
                                                <p:outputLabel id="ceev-query-limit-ol" for="ceev-query-limit" value="limit results to 100? "/>
                                                <p:selectBooleanCheckbox id="ceev-query-limit" value="#{cEEventsBB.searchParams.limitResultCountTo100}" />
                                            </h:panelGroup>
                                            
                                            <h:panelGroup></h:panelGroup>
                                            
                                            <h:panelGroup>
                                                <h3>Case action request events:</h3>
                                            </h:panelGroup>
                                            <h:panelGroup></h:panelGroup>

                                            <h:panelGroup styleClass="action-requests-search">
                                                <p:outputLabel id="ceev-filter-requests-action-ol" 
                                                               for="ceev-filter-requestsaction-cb" 
                                                               value="filter by requests action? "
                                                               styleClass="bold"
                                                               />
                                                <p:selectBooleanCheckbox id="ceev-filter-requestsaction-cb" value="#{cEEventsBB.searchParams.filterByrequestsAction}" >
                                                    <p:ajax update="ceev-criteria-requests-action-cb
                                                                    ceev-filter-requested-action-status-cb
                                                                    ceev-criteria-requested-action-status-cb
                                                                    ceev-filter-requests-typecat-reqaction-cb
                                                                    ceev-filter-requests-rejected-cb
                                                                    ceev-criteria-requests-rejected-cb
                                                                    ceev-filter-requests-user-requestor-cb
                                                                    ceev-filter-requests-user-responder-intended-cb
                                                                    ceev-filter-requests-user-responder-actual-cb
                                                                    " />
                                                </p:selectBooleanCheckbox>
                                            </h:panelGroup>

                                            <h:panelGroup styleClass="action-requests-search">
                                                <p:selectBooleanCheckbox id="ceev-criteria-requests-action-cb" 
                                                                         value="#{cEEventsBB.searchParams.requestsAction}" 
                                                                         disabled="#{!cEEventsBB.searchParams.filterByrequestsAction}" />
                                                <p:outputLabel id="ceev-criteria-requireview-info-ol" for="ceev-criteria-requests-action-cb" 
                                                               value="(checked = requests action)" styleClass="italic"/>
                                            </h:panelGroup>

                                            <h:panelGroup styleClass="action-requests-search">
                                                <p:outputLabel id="ceev-filter-requested-action-ol" 
                                                               for="ceev-filter-requested-action-status-cb" 
                                                               value="filter by requested action status? "/>
                                                <p:selectBooleanCheckbox id="ceev-filter-requested-action-status-cb" 
                                                                         value="#{cEEventsBB.searchParams.filterByHasResponseEvent}" 
                                                                         disabled="#{!cEEventsBB.searchParams.filterByrequestsAction}">
                                                    <p:ajax update="ceev-criteria-requested-action-status-cb" />
                                                </p:selectBooleanCheckbox>
                                            </h:panelGroup>

                                            <h:panelGroup styleClass="action-requests-search">
                                                <p:selectBooleanCheckbox id="ceev-criteria-requested-action-status-cb" 
                                                                         value="#{cEEventsBB.searchParams.hasResponseEvent}" 
                                                                         disabled="#{!cEEventsBB.searchParams.filterByHasResponseEvent or !cEEventsBB.searchParams.filterByrequestsAction}" 
                                                                         styleClass="checkbox"/>
                                                <p:outputLabel id="ceev-filter-requested-action-status-info-ol" 
                                                               for="ceev-criteria-requested-action-status-cb" 
                                                               value="(checked = has a response)" styleClass="italic"/>
                                            </h:panelGroup>
                                            
                                            <h:panelGroup styleClass="action-requests-search">
                                                <p:outputLabel id="ceev-filter-requests-typecat-reqaction-ol" 
                                                               for="ceev-filter-requests-typecat-reqaction-cb" 
                                                               value="filter by requested action category"/>
                                                <p:selectBooleanCheckbox id="ceev-filter-requests-typecat-reqaction-cb" 
                                                                         value="#{cEEventsBB.searchParams.filterByRequestedResponseEventCat}" 
                                                                         disabled="#{!cEEventsBB.searchParams.filterByrequestsAction}">
                                                    <p:ajax update="ceev-criteria-requests-action-cb" />
                                                </p:selectBooleanCheckbox>
                                            </h:panelGroup>
                                            
                                            <h:panelGroup styleClass="action-requests-search">
                                                <p class="italic">when enabled, this switch assigns <br />
                                                    the chosen event category (not type alone) <br />
                                                    selection box at left to requested case events</p>
                                            </h:panelGroup>
                                            
                                            <h:panelGroup styleClass="action-requests-search">
                                                 <p:outputLabel id="ceev-filter-requests-user-requestor-ol" 
                                                               for="ceev-filter-requests-user-requestor-cb" 
                                                               value="filter by requestor"/>
                                                <p:selectBooleanCheckbox id="ceev-filter-requests-user-requestor-cb" 
                                                                         value="#{cEEventsBB.searchParams.filterByRequestor}" 
                                                                         disabled="#{!cEEventsBB.searchParams.filterByrequestsAction}">
                                                </p:selectBooleanCheckbox>
                                                <p:spacer height="5px" />
                                                <p:outputLabel id="ceev-filter-requests-user-responder-intended-ol" 
                                                               for="ceev-filter-requests-user-responder-intended-cb" 
                                                               value="filter by intended responder"/>
                                                <p:selectBooleanCheckbox id="ceev-filter-requests-user-responder-intended-cb" 
                                                                         value="#{cEEventsBB.searchParams.filterByResponderIntended}" 
                                                                         disabled="#{!cEEventsBB.searchParams.filterByrequestsAction}">
                                                </p:selectBooleanCheckbox>
                                                <p:spacer height="5px" />
                                                <p:outputLabel id="ceev-filter-requests-user-responder-actual-ol" 
                                                               for="ceev-filter-requests-user-responder-actual-cb" 
                                                               value="filter by actual responder"/>
                                                <p:selectBooleanCheckbox id="ceev-filter-requests-user-responder-actual-cb" 
                                                                         value="#{cEEventsBB.searchParams.filterByResponderActual}" 
                                                                         disabled="#{!cEEventsBB.searchParams.filterByrequestsAction}">
                                                </p:selectBooleanCheckbox>
                                                
                                            </h:panelGroup>
                                            <h:panelGroup>
                                                 <p class="italic">these filters, when enabled, assign <br />
                                                    the chosen user selected in the filter above called <br />
                                                    "filter by event owner" to requested case events <br />
                                                    instead of the primary event</p>
                                                
                                            </h:panelGroup>
                                            

                                            <h:panelGroup styleClass="action-requests-search">
                                                <p:outputLabel id="ceev-filter-requests-rejected-ol" 
                                                               for="ceev-filter-requests-rejected-cb" 
                                                               value="filter by rejected request?"/>
                                                <p:selectBooleanCheckbox id="ceev-filter-requests-rejected-cb" 
                                                                         value="#{cEEventsBB.searchParams.filterByRejectedRequest}" 
                                                                         disabled="#{!cEEventsBB.searchParams.filterByrequestsAction}">
                                                    <p:ajax update="ceev-criteria-requests-rejected-cb" />
                                                </p:selectBooleanCheckbox>
                                            </h:panelGroup>

                                            <h:panelGroup styleClass="action-requests-search">
                                                <p:selectBooleanCheckbox id="ceev-criteria-requests-rejected-cb" 
                                                                         value="#{cEEventsBB.searchParams.rejectedRequest}" 
                                                                         disabled="#{!cEEventsBB.searchParams.filterByRejectedRequest or !cEEventsBB.searchParams.filterByrequestsAction }" />
                                                <p:outputLabel id="ceev-criteria-requests-rejected-ol" for="ceev-criteria-requests-rejected-cb" 
                                                               value="(checked = rejected)" styleClass="italic"/>
                                            </h:panelGroup>
                                        </h:panelGrid>                                        
                                    </h:panelGroup>
                                </h:panelGrid>                               
                                <p:commandButton    id="queryButton"
                                                    ajax="true" value="Run query" actionListener="#{cEEventsBB.executeQuery}"
                                                    process="@form"
                                                    update="events-datascroller-form:events-datascroller
                                                    events-datatable-form:events-datatable
                                                    ceev-form-globalmessages:ceev-globalmessages
                                                    "
                                                    />
                            </p:fieldset>
                        </h:form>


                        <h2>Load preset event lists</h2>
                     
                        <h:form id="presets-form">
                            

                            <p:commandButton    id="event-preset-eventsreqviewconf" 
                                                ajax="true"
                                                 value="Required actions" 
                                                 styleClass="noFill"
                                                 actionListener="#{cEEventsBB.loadEventsRequiringAction(ev)}"
                                                 disabled="false"
                                                 icon="fa fa-tasks"
                                                 rendered="#{systemServicesBB.bbSessionUser.keyCard.hasMuniReaderPermissions}"
                                                 update="
                                                    ceev-form-search
                                                    events-datascroller-form:events-datascroller
                                                    events-datatable-form:events-datatable
                                                    ceev-form-globalmessages:ceev-globalmessages
                                                    "/>

                            <p:commandButton    id="event-preset-allactivitybyoffandmuni" 
                                                ajax="true"
                                                 value="all officer activity by muni (past week)" 
                                                 styleClass="noFill"
                                                 actionListener="#{cEEventsBB.loadOfficerActivityPastWeek}"
                                                 disabled="false"
                                                 icon="fa fa-wheelchair-alt"
                                                 rendered="#{sessionBeasessionUserer.keyCard.hasMuniReaderPermissions}"
                                                 update="
                                                    ceev-form-search
                                                    events-datascroller-form:events-datascroller
                                                    events-datatable-form:events-datatable
                                                    ceev-form-globalmessages:ceev-globalmessages
                                                    "/>

                            <p:commandButton    id="event-preset-complianceevents" 
                                                ajax="true"
                                                 value="violation compliance events (past month)" 
                                                 actionListener="#{cEEventsBB.loadComplianceEventsPastMonth}"
                                                 styleClass="noFill"
                                                 disabled="false"
                                                 icon="fa fa-check-square"
                                                 rendered="#{sessionBsessionUserUser.keyCard.hasMuniReaderPermissions}"
                                                 update="
                                                    ceev-form-search
                                                    events-datascroller-form:events-datascroller
                                                    events-datatable-form:events-datatable
                                                    ceev-form-globalmessages:ceev-globalmessages
                                                    "/>

                        </h:form>

                        
               
                        
                        
                                <h:form id="events-datascroller-form">
                                  
                                    

                                    <p:dataScroller
                                        id="events-datascroller"
                                        var="e"
                                        value="#{cEEventsBB.eventList}"
                                        widgetVar="ceevent-ds-var">

                                        <div class="outlinedBox event-ds-box">

                                        <div class="status-display-container">
                                            <div class="action-request-icon">
                                                <i class="material-icons"><h:outputText id="action-request-display-icon-ot" value="#{e.event.category.icon.materialIcon}"/></i>
                                            </div>
                                            <div class="status-display-status-list-container">
                                                <div class="action-request-header">
                                                    <h:outputText value="#{e.event.category.eventType.label}: #{e.event.category.eventCategoryTitle} "/>
                                                </div>
                                                <div class="action-request-subheader">
                                                    <h:outputText value="#{e.eventCaseBare.property.address} " />
                                                    <h:outputText value=" (#{e.eventCaseBare.property.muni.muniName}) | " />
                                                    <h:outputText value="Code enforcement case id: #{e.eventCaseBare.caseID} " />
                                                    <h:outputText value="Current case stage: #{e.eventCaseBare.caseStage.label} " />
                                                    <br />
                                                    <h:outputText value="Date: #{e.event.dateOfRecordPretty}"/>
                                                </div>
                                            </div>
                                        </div>
                                            
                                        <h:panelGrid columns="3" 
                                                     cellpadding="5" 
                                                     footerClass="gridFooter" 
                                                     headerClass="gridHeader"
                                                     columnClasses="gridTd, gridTd, gridTd">

                                                <f:facet name="header">
                                                    <h:outputText value="Owner: " styleClass="bold" />
                                                    
                                                    <h:outputText value="#{e.event.owner.person.firstName} #{e.event.owner.person.lastName}"/>
                                                    
                                                    <div class="rowExpansion">
                                                        <h:outputText styleClass="bold" value="Description: " />
                                                        <h:outputText styleClass="weight-normal" value="#{e.event.description}"/>
                                                    </div>
                                                    <div class="rowExpansion">
                                                        <h:outputText styleClass="bold" value="Notes: " />
                                                        <h:outputText styleClass="weight-normal" value="#{e.event.responderNotes}"/>
                                                    </div>
                                                    
                                                </f:facet>

                                                <h:panelGroup>
                                                    
                                                    <p:spacer height="5px"/>
                                                    <h:outputText styleClass="bold" value="Date of record: "/>
                                                    <h:outputText value="#{e.event.dateOfRecordPretty}"/>
                                                    <p:spacer height="5px"/>
                                                    <h:outputText styleClass="bold" value="Creation time stamp: "/>
                                                    <h:outputText value="#{e.event.timestampPretty}"/>
                                                </h:panelGroup>
                                                
                                                 <h:panelGroup>
                                                    <h:outputText styleClass="bold" value="Disclose to Municipality Staff: " />
                                                    <h:outputText value="#{e.event.discloseToMunicipality}"/>
                                                    
                                                    <p:spacer height="5px"/>
                                                    
                                                    <h:outputText styleClass="bold" value="Disclose to Public: " />
                                                    <h:outputText value="#{e.event.discloseToPublic}"/>
                                                    <p:spacer height="5px"/>
                                                    
                                                    <h:outputText styleClass="bold" value="Active: "/>
                                                    <h:outputText value="#{e.event.active}"/>
                                                    
                                                    <p:spacer height="5px"/>
                                                    
                                                    <h:outputText styleClass="bold" value="Hidden: "/>
                                                    <h:outputText value="#{e.event.hidden}"/>
                                                    
                                                </h:panelGroup>

                                                 <h:panelGroup rendered="#{e.event.requestsAction}">
                                                    <h:outputText styleClass="bold" value="Requests action: "/>
                                                    <h:outputText value="#{e.event.requestsAction}"/>
                                                    
                                                    <p:spacer height="5px"/>
                                                    
                                                    <h:outputText styleClass="bold" value="Requested event: "/>
                                                    <h:outputText value="#{e.event.requestedEventCat.eventType.label}: #{e.event.requestedEventCat.eventCategoryTitle}"/>

                                                    <p:spacer height="5px"/>
                                                    
                                                    <h:outputText styleClass="bold" value="Action requested by: "/>
                                                    <h:outputText value="#{e.event.actionRequestedBy.person.firstName} #{e.event.actionRequestedBy.person.lastName}"/>

                                                    <p:spacer height="5px"/>
                                                    
                                                    <h:outputText styleClass="bold" value="Intended user/action taker: "/>
                                                    <h:outputText value="#{(empty e.event.responderIntended) ? 'default code officer' : e.event.responderIntended.person.lastName}"/>                                   

                                                    <p:spacer height="5px"/>
                                                    <h:outputText styleClass="bold" value="Action taken by: "/>
                                                    <h:outputText value="#{e.event.responderActual.person.firstName} #{e.event.responderActual.person.lastName}"/>
                                                    
                                                    <h:outputText styleClass="bold" value="Action timestamp: "/>
                                                    <h:outputText value="#{e.event.responseTimePrettyDate}"/>

                                                    <h:outputText styleClass="bold" value="Request rejected? "/>
                                                    <h:outputText value="#{e.event.requestRejected}"/>

                                                    <h:outputText styleClass="bold" value="Action response notes:"/>
                                                    <h:outputText value="#{e.event.responderNotes}"/>
                                                </h:panelGroup>

                                                

                                            </h:panelGrid>
                                                   

                                               
                                        </div>

                                    </p:dataScroller>

                                </h:form>

                     
                                <h:form id="events-datatable-form">
                                    <p:dataTable
                                        id="events-datatable"
                                        var="e"
                                        rowKey="#{e.event.eventID}"
                                        value="#{cEEventsBB.eventList}"
                                        tableStyleClass="primeDataTable"
                                        resizableColumns="true"
                                        rowExpandMode="multiple"
                                        expandedRow="false"
                                        filteredValue="#{cEEventsBB.filteredEventList}"
                                        widgetVar="ceevent-dt-var"
                                        >
                                        <!--<p:ajax event="rowSelect" update="selectedRowLabel"/>-->

                                        <p:column width="3%" exportable="false">
                                            <f:facet name="header">
                                                <h:outputText value="Expand"/>
                                            </f:facet>
                                            <p:rowToggler/>
                                        </p:column>

                                        <p:column width="11%" sortBy="#{e.event.dateOfRecord}">
                                            <f:facet name="header">
                                                <h:outputText value="Date" />
                                            </f:facet>
                                            <h:outputText value="#{e.event.dateOfRecordPretty}"/>
                                        </p:column>

                                        <p:column width="15%" sortBy="#{e.eventCaseBare.property.address}">
                                            <f:facet name="header">
                                                <h:outputText value="Property" />
                                            </f:facet>
                                            <h:outputText value="#{e.eventCaseBare.property.address} (#{e.eventCaseBare.property.muni.muniName}"/>
                                        </p:column>

                                        <p:column width="15%">
                                            <f:facet name="header">
                                                <h:outputText value="Case name" />
                                            </f:facet>
                                            <h:outputText value="#{e.eventCaseBare.caseName})" />
                                        </p:column>

                                        <p:column width="8%" sortBy="#{e.event.category.eventType.label}"
                                                  filterBy="#{e.event.category.eventType.label}">
                                            <f:facet name="header">
                                                <h:outputText value="Type" />
                                            </f:facet>
                                            <h:outputText value="#{e.event.category.eventType.label}"/>
                                        </p:column>

                                        <p:column width="10%" sortBy="#{e.event.category.eventCategoryTitle}"
                                                  filterBy="#{e.event.category.eventCategoryTitle}">
                                            <f:facet name="header">
                                                <h:outputText value="Category" />
                                            </f:facet>
                                            <h:outputText value="#{e.event.category.eventCategoryTitle}"/>
                                        </p:column>
                                        <p:column width="5%" filterBy="#{e.event.owner.person.lastName}"
                                                  sortBy="#{e.event.owner.person.lastName}">
                                            <f:facet name="header">
                                                <h:outputText value="Creator" />
                                            </f:facet>
                                            <h:outputText value="#{e.event.owner.person.lastName}"/>
                                        </p:column>
                                        <p:column width="20%" style="word-wrap: normal;">
                                            <f:facet name="header">
                                                <h:outputText value="Description" />
                                            </f:facet>
                                            <div class="rowExpansion">
                                                <h:outputText value="#{e.event.description}"/>
                                            </div>
                                        </p:column>
                                        <p:column width="5%" exportable="false">
                                            <f:facet name="header">
                                                <h:outputText value="edit" />
                                            </f:facet>
                                            <p:commandButton icon="fa fa-edit"
                                                             action="#{caseProfileBB.jumpToCasesToEditCEEvent(e)}" 
                                                             ajax="false"/>

                                        </p:column>

                                        <p:rowExpansion>

                                            <div class="outlinedBox">
                                                <h2>Event ID: <h:outputText value="#{e.event.eventID}"/> </h2>
                                                <h:panelGrid columns="4" cellpadding="10" footerClass="gridFooter"
                                                             columnClasses="gridTd, gridTd, gridTd, gridTd">

                                                    <h:panelGroup>
                                                        <h:outputText styleClass="bold" value="Description" />
                                                        <div class="rowExpansion">
                                                            <h:outputText value="#{e.event.description}"/>
                                                        </div>
                                                    </h:panelGroup>

                                                    <h:panelGroup>
                                                        <h:outputText styleClass="bold" value="Disclose to Municipality Staff?" />
                                                        <div class="rowExpansion">
                                                            <h:outputText value="#{e.event.discloseToMunicipality}"/>
                                                        </div>
                                                    </h:panelGroup>

                                                    <h:panelGroup>
                                                        <h:outputText styleClass="bold" value="Disclose to Public?" />
                                                        <div class="rowExpansion">
                                                            <h:outputText value="#{e.event.discloseToPublic}"/>
                                                        </div>
                                                    </h:panelGroup>
                                                    <h:panelGroup>
                                                        <h:outputText styleClass="bold" value="Creation time stamp"/>
                                                        <div class="rowExpansion">
                                                            <h:outputText value="#{e.event.timestamp}"/>
                                                        </div>
                                                    </h:panelGroup>
                                                    <h:panelGroup>
                                                        <h:outputText styleClass="bold" value="Active Event?"/>
                                                        <div class="rowExpansion">
                                                            <h:outputText value="#{e.event.active}"/>
                                                        </div>
                                                    </h:panelGroup>

                                                    
                                                    <h:panelGroup>
                                                        <h:outputText styleClass="bold" value="View confirmed by"/>
                                                        <div class="rowExpansion">
                                                            <h:outputText value="#{e.event.responderActual.person.lastName}"/>
                                                        </div>
                                                    </h:panelGroup>

                                                    <h:panelGroup>
                                                        <h:outputText styleClass="bold" value="View confirmed at"/>
                                                        <div class="rowExpansion">
                                                            <h:outputText value="#{e.event.responseTimestamp}"/>
                                                        </div>
                                                    </h:panelGroup>



                                                    <f:facet name="footer" class="leftalign">
                                                        <h:outputLabel styleClass="bold" style="text-align: left" value="Notes"/>
                                                        <p:spacer height="15px"/>
                                                        <div class="rowExpansion" style="text-align: left">
                                                            <h:outputText escape="false" value="#{e.event.notes}"/>
                                                        </div>
                                                    </f:facet>

                                                </h:panelGrid>
                                            </div>
                                        </p:rowExpansion>
                                    </p:dataTable>
                                </h:form>
                        
                        <p:dialog header="Code Enforcement Profile" widgetVar="helpdlg" responsive="true">
                            <h2>Code enforcement case profile</h2>
                            <p>This page is the launchpad for all other case-related actions and displays the entire case event history.</p>
                        </p:dialog>

                        <p:commandButton  value="help on this page" onclick="PF('helpdlg').show()" styleClass="noFill" icon="fa fa-question-circle"/>
                        <p:spacer height="10px"/>

                    </f:view>
                </div>
            </ui:define>
        </ui:composition>
    </h:body>
</html>

