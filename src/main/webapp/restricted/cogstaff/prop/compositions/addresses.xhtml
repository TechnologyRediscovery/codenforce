<ui:composition xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
                xmlns:h="http://xmlns.jcp.org/jsf/html"
                xmlns:f="http://xmlns.jcp.org/jsf/core"
                xmlns:p="http://primefaces.org/ui"
                xmlns="http://www.w3.org/1999/xhtml">

    <h:form id="addresses-growl-form">

        <p:growl id="addresses-growl"
                 globalOnly="false" 
                 />
    </h:form>

    <p:dialog   id="address-dialog"
                height="700" width="1300"
                widgetVar="address-dialog-var"
                responsive="true"
                resizable="true"
                closable="true"
                closeOnEscape="true"
                modal="true"
                header="#{addressBB.currentAddress.addressID eq 0 ? 'Add new address' : 'Edit address'}"
                rendered="true"
                >

        <div class="p-grid">
            <div class="p-col">
                <p:panel id="address-info-panel"
                         toggleable="true"
                         collapsed="false"
                         header="Address Info">

                    <h:form id="address-info-form">

                        <p:commandButton id="address-edit-button"
                                         value="#{addressBB.addressEditMode? 'Save changes' : 'Edit'}"
                                         rendered="#{systemServicesBB.bbSessionUser.keyCard.hasMuniStaffPermissions}"
                                         icon="fa #{addressBB.addressEditMode ? 'fa-check' : 'fa-pencil'}"
                                         actionListener="#{addressBB.toggleMailingAddressEditMode}"
                                         oncomplete="PF('address-dialog-var').show()"
                                         update="address-info-form"/>

                        <p:commandButton id="zip-search-button"
                                         value="Search for Zip, City, and State"
                                         rendered="true"
                                         icon="fa fa-address-book"
                                         oncomplete="PF('address-search-dialog-var').show()"
                                         />
                        <div class="restrict-main-contents-io-button gray_button">

                            <p:commandButton    id="address-edit-abort-button"
                                                ajax="true"
                                                rendered="#{addressBB.addressEditMode}"
                                                value="Abort edit"
                                                actionListener="#{addressBB.onMailingAddressAbortOperationButtonChange}"
                                                oncomplete="PF('address-dialog-var').show()"
                                                update="address-info-form"
                                                icon="fa fa-stop" />
                        </div>

                        <p:spacer height="5px"/>    

                        <div class="p-grid">
                            <div class="p-col-6">Address ID</div>

                            <div class="p-col-6">
                                <h:outputText rendered="#{!addressBB.addressEditMode}" 
                                              value="#{addressBB.currentAddress.addressID eq 0 ? 'new record' : addressBB.currentAddress.addressID}"/>
                            </div>

                            <div class="p-col-6">Building Number</div>
                            <div class="p-col-6">
                                <h:outputText rendered="#{!addressBB.addressEditMode}" 
                                              value="#{addressBB.currentAddress.buildingNo}"/>

                                <p:inputText rendered="#{addressBB.addressEditMode}"
                                             value="#{addressBB.currentAddress.buildingNo}" />
                            </div>
                            <div class="p-col-6">
                                PO Box
                            </div>
                            
                            <div class="p-col-6">
                                <h:outputText rendered="#{!addressBB.addressEditMode}" 
                                              value="#{addressBB.currentAddress.poBox}"/>
                                
                                <p:selectBooleanCheckbox    id="address-pobox-sbcb"
                                                            rendered="#{addressBB.addressEditMode}"
                                                            value="#{addressBB.formPOBox}" >
                                    <p:ajax process="address-pobox-sbcb"
                                            update="address-pobox-it" />
                                
                                </p:selectBooleanCheckbox>
                                
                                <p:inputText    id="address-pobox-it"
                                                rendered="#{addressBB.addressEditMode}"
                                                disabled="#{!addressBB.formPOBox}"
                                                value="#{addressBB.currentAddress.poBox}" />
                            </div>
                            
                            <div class="p-col-6">
                                Street
                            </div>
                            
                            <div class="p-col-6">
                                <h:outputText rendered="true" 
                                              value="#{!empty addressBB.currentAddress.street ? addressBB.currentAddress.street.name : ''}"/>
                                <h:outputText rendered="true" 
                                              value=" (ID:#{!empty addressBB.currentAddress.street ? addressBB.currentAddress.street.streetID : ''})"/>
                            </div>

                            <div class="p-col-6">
                                City, State, ZIP Code
                            </div>
                            
                            <div class="p-col-6">
                                <h:outputText rendered="#{!empty addressBB.currentAddress.street}" 
                                              value="#{!empty addressBB.currentAddress.street ? addressBB.currentAddress.street.cityStateZip.city : ''}"/>
                                
                                <h:outputText   rendered="#{!empty addressBB.currentAddress.street}" 
                                                value=", " />
                                
                                <h:outputText rendered="#{!empty addressBB.currentAddress.street}" 
                                              value="#{!empty addressBB.currentAddress.street ? addressBB.currentAddress.street.cityStateZip.state : ''}"/>
                                
                                <h:outputText   rendered="#{!empty addressBB.currentAddress.street}" 
                                                value=" " />
                                
                                <h:outputText rendered="#{!empty addressBB.currentAddress.street}" 
                                              value="#{!empty addressBB.currentAddress.street ? addressBB.currentAddress.street.cityStateZip.zipCode : ''}"/>
                            </div>


                            <div class="p-col-6">Source</div>
                            <div class="p-col-6">
                                <h:outputText rendered="#{!addressBB.addressEditMode}" 
                                              value="#{addressBB.currentAddress.source.title}"/>

                                <p:selectOneMenu id="address-source-som"
                                                 required="true"
                                                 rendered="#{addressBB.addressEditMode}" 
                                                 value="#{addressBB.currentAddress.source}">
                                    <f:converter converterId="bobSourceConverter"/>
                                    <f:selectItems value="#{addressBB.addressSourceList}"
                                                   var="bs" 
                                                   itemValue="#{bs}" 
                                                   itemLabel="#{bs.title} (ID:#{bs.sourceid})"/>
                                </p:selectOneMenu>

                            </div>


                            <div class="p-col-6">Verified?</div>
                            <div class="p-col-6">
                                <h:outputText   rendered="#{!addressBB.addressEditMode}"
                                                value="#{empty addressBB.currentAddress.verifiedTS ? 'No' : 'Yes'}" />

                                <p:spacer height="2px" />

                                <h:outputText   rendered="#{!addressBB.addressEditMode}"
                                                value="#{!empty addressBB.currentAddress.verifiedTS ? 'on ' : ''}" />

                                <p:spacer height="2px" />

                                <h:outputText   rendered="#{!addressBB.addressEditMode}"
                                                value="#{!empty addressBB.currentAddress.verifiedBy ? 'by ' : ''}" />

                                <h:outputText   rendered="#{!addressBB.addressEditMode}"
                                                value="#{!empty addressBB.currentAddress.verifiedBy ? addressBB.currentAddress.verifiedBy.username : ''}" />


                                <p:selectBooleanCheckbox    id="address-verified-sbcb"
                                                            rendered="#{addressBB.addressEditMode}"
                                                            value="#{addressBB.formAddressVerified}" >
                                
                                    <p:ajax process="address-verified-sbcb" 
                                            update="address-ver-source-som"/>
                                </p:selectBooleanCheckbox>
                            </div>

                            <div class="p-col-6">Verification Source</div>
                            <div class="p-col-6">
                                <h:outputText rendered="#{!addressBB.addressEditMode}" 
                                              value="#{addressBB.currentAddress.verifiedSource.title}"/>

                                <p:selectOneMenu id="address-ver-source-som"
                                                 required="false"
                                                 disabled="#{!addressBB.formAddressVerified}"
                                                 rendered="#{addressBB.addressEditMode}" 
                                                 value="#{addressBB.currentAddress.verifiedSource}">
                                    <f:converter converterId="bobSourceConverter"/>
                                    <f:selectItems value="#{addressBB.addressSourceList}"
                                                   var="bs" 
                                                   itemValue="#{bs}" 
                                                   itemLabel="#{bs.title} (ID:#{bs.sourceid})"/>
                                </p:selectOneMenu>

                            </div>

                            <div class="p-col-6">Creation</div>
                            <div class="p-col-6">
                                <h:outputText value="#{addressBB.getPrettyDate(addressBB.currentAddress.createdTS)}" />
                                <p:spacer height="2px" />
                                <h:outputText   rendered="#{!empty addressBB.currentAddress.createdBy}"
                                                value="by #{addressBB.currentAddress.createdBy.username}" />
                            </div>

                            <div class="p-col-6">Last update</div>
                            <div class="p-col-6">
                                <h:outputText value="#{addressBB.getPrettyDate(addressBB.currentAddress.lastUpdatedTS)}" />
                                <p:spacer height="2px" />
                                <h:outputText   rendered="#{!empty addressBB.currentAddress.lastUpdatedBy}"
                                                value="by #{addressBB.currentAddress.lastUpdatedBy.username}" />
                            </div>

                            <div class="p-col-6">Record status</div>
                            <div class="p-col-6">
                                <h:outputText value="#{empty addressBB.currentAddress.deactivatedTS ? 'active' : 'deactivated on'}" />
                                <p:spacer height="2px" />
                                <h:outputText value="#{empty addressBB.currentAddress.deactivatedTS ? '' : addressBB.getPrettyDate(addressBB.currentAddress.deactivatedTS) }" />
                                <p:spacer height="2px" />
                                <h:outputText   rendered="#{!empty addressBB.currentAddress.deactivatedBy}"
                                                value="by #{addressBB.currentAddress.deactivatedBy.username}" />
                            </div>
                            <div class="p-col-6">
                                Notes
                                <p:spacer height="3px" />
                            
                                <p:commandLink  id="address-notes-init-clink"
                                                ajax="true"
                                                style="color:blue;"
                                                oncomplete="PF('address-note-dialog-var').show()"
                                                rendered="#{!addressBB.editModeCurrentAddress}"
                                                update="address-note-dialog
                                                address-note-form"
                                                value="Attach note"
                                                actionListener="#{addressBB.onMailingAddressNoteInitButtonChange}">

                                </p:commandLink>
                            
                            </div>
                            <div class="p-col-6">
                                <h:outputText value="#{addressBB.currentAddress.notes}"
                                              escape="false" />
                            </div>
                        </div>
                    </h:form>
                </p:panel>

            </div>

            <div class="p-col">


                <p:panel id="address-links-panel"
                         toggleable="true"
                         collapsed="false"
                         header="Address Connections">

                    <h:form id="address-links-form">

                        <h:outputText value="connections to #{addressBB.currentAddress.addressString}"
                                      escape="false" />


                    </h:form>
                </p:panel>

            </div>

        </div>
    </p:dialog>

    <p:dialog   id="address-search-dialog"
                height="600" width="1200"
                widgetVar="address-search-dialog-var"
                responsive="true"
                resizable="true"
                closable="true"
                closeOnEscape="true"
                modal="true"
                header="Address Manager"
                rendered="true"
                >

        <div class="p-grid">
            <div class="p-col">
                <p:panel id="csz-search-panel"
                         toggleable="true"
                         collapsed="false"
                         header="City, State, ZIP Code Search">

                    <h:form id="csz-search-form">


                        <p:selectOneMenu id="csz-search-query-som"
                                         tabindex="1"
                                         value="#{addressBB.selectedCSZQuery}"
                                         style="width: 100%"
                                         >
                            <f:converter converterId="bOBQueryConverter"/>

                            <f:selectItem itemLabel="select a query..."
                                          noSelectionOption="true"
                                          itemDisabled="true"
                                          />
                            <f:selectItems id="csz-search-query-si"
                                           value="#{addressBB.qcszEnumList}"
                                           var="ql"
                                           itemValue="#{ql}"
                                           itemLabel="#{ql.queryTitle}" 
                                           />
                            <p:ajax update="param-itfield-city 
                                    param-itfield-zip
                                    param-itfield-state
                                    addresses-growl-form"
                                    listener="#{addressBB.onQueryChange}"
                                    />
                        </p:selectOneMenu>


                        <p:commandButton id="csz-search-button"
                                         value="Search"
                                         rendered="true"
                                         icon="fa fa-search"
                                         actionListener="#{addressBB.onQueryCSZExecuteButtonChange}"
                                         oncomplete="PF('address-search-dialog-var').show()"
                                         update="   csz-search-form
                                         addresses-growl-form"/>


                        <div class="restrict-main-contents-io-button gray_button">

                            <p:commandButton    id="csz-search-clear-button"
                                                ajax="true"
                                                rendered="true"
                                                value="Reset search"
                                                actionListener="#{addressBB.onQueryResetButtonChange}"
                                                update="addresses-growl-form
                                                @form"
                                                icon="fa fa-eraser" />
                        </div>

                        <p:spacer height="5px"/>    

                        <div class="p-grid">
                            <div class="p-col-6">ZIP Code</div>

                            <div class="p-col-6">
                                <p:inputText    id="param-itfield-zip"
                                                value="#{addressBB.selectedCSZQuery.primaryParams.zip_val}" 
                                                disabled="#{!addressBB.selectedCSZQuery.primaryParams.zip_ctl}" />
                            </div>
                            <div class="p-col-6">City</div>

                            <div class="p-col-6">
                                <p:inputText    id="param-itfield-city"
                                                value="#{addressBB.selectedCSZQuery.primaryParams.city_val}" 
                                                disabled="#{!addressBB.selectedCSZQuery.primaryParams.city_ctl}" />
                            </div>
                            <div class="p-col-6">State</div>

                            <div class="p-col-6">
                                <p:inputText    id="param-itfield-state"
                                                value="#{addressBB.selectedCSZQuery.primaryParams.state_val}" 
                                                disabled="#{!addressBB.selectedCSZQuery.primaryParams.state_ctl}" />
                            </div>
                        </div>

                        <p:spacer height="5px"/>    

                        <p:dataTable    id="csz-results-table"
                                        value="#{addressBB.selectedCSZQuery.results}"
                                        var="csz"
                                        lazy="false"
                                        rowKey="#{csz.cityStateZipID}"
                                        tableStyleClass="primeDataTable"
                                        draggableRows="true" 
                                        stripedRows="true"
                                        rowExpandMode="multiple"
                                        tabindex="6">

                            <p:column width="10%" 
                                      headerText="Exp.">
                                <p:rowToggler/>
                            </p:column>

                            <p:column width="20%">
                                <f:facet name="header">
                                    <h:outputText value="ZIP Code"/>
                                </f:facet>
                                <h:outputText value="#{csz.zipCode}" />
                            </p:column>

                            <p:column width="40%"
                                      sortBy="#{csz.city}"
                                      filterable="true">
                                <f:facet name="header">
                                    <h:outputText value="City"/>
                                </f:facet>
                                <h:outputText value="#{csz.city}" />
                            </p:column>

                            <p:column width="10%">
                                <f:facet name="header">
                                    <h:outputText value="State"/>
                                </f:facet>
                                <h:outputText value="#{csz.state}" />
                            </p:column>

                            <p:column width="20%">
                                <f:facet name="header">
                                    <h:outputText value="Actions"/>
                                </f:facet>

                                <p:commandLink  id="csz-select"
                                                value="load streets"
                                                style="color:blue;"
                                                rendered="true"
                                                actionListener="#{addressBB.selectCityStateZip(csz)}"
                                                ajax="true"
                                                update="address-dialog
                                                address-info-form
                                                street-search-form
                                                addresses-growl-form"
                                                />
                            </p:column>
                            <p:rowExpansion>
                                <div class="p-grid">

                                    <div class="p-col-4">
                                        City/State/Zip ID
                                    </div>
                                    <div class="p-col-8">
                                        <h:outputText value="#{csz.cityStateZipID}" />
                                    </div>
                                    <div class="p-col-4">
                                        Record Type
                                    </div>
                                    <div class="p-col-8">
                                        <h:outputText value="#{csz.recordTypeString}" />
                                    </div>
                                    <div class="p-col-4">
                                        Default role
                                    </div>
                                    <div class="p-col-8">
                                        <h:outputText value="#{csz.defaultTypeString}" />
                                    </div>
                                    <div class="p-col-4">
                                        Default City
                                    </div>
                                    <div class="p-col-8">
                                        <h:outputText value="#{csz.defaultCity}" />
                                    </div>
                                </div>
                            </p:rowExpansion>
                        </p:dataTable>
                    </h:form>
                </p:panel>  
            </div>

            <div class="p-col">

                <p:panel id="street-panel"
                         toggleable="true"
                         collapsed="false"
                         header="Street">

                    <h:form id="street-search-form">

                        <h3>
                            <h:outputText value="Viewing all streets in ZIP Code: #{addressBB.currentCityStateZip.zipCode} (#{addressBB.currentCityStateZip.defaultCity}, #{addressBB.currentCityStateZip.state})" />
                        </h3>

                        <p:commandButton id="street-create-init-button"
                                         value="New street"
                                         icon="fa fa-plus"
                                         disabled="#{empty addressBB.currentCityStateZip}"
                                         oncomplete="PF('street-infoedit-dialog-var').show()"
                                         actionListener="#{addressBB.onMailingStreetCreateInitButtonChange}"
                                         update="street-infoedit-dialog
                                         street-infoedit-form"/>

                        <p:spacer height="5px"/>

                        <p:dataTable    id="street-results-table"
                                        value="#{addressBB.streetList}"
                                        filteredValue="#{addressBB.streetListFiltered}"
                                        var="street"
                                        lazy="false"
                                        scrollable="true"
                                        scrollHeight="200px"
                                        scrollRows="5"
                                        rowKey="#{street.streetID}"
                                        tableStyleClass="primeDataTable"
                                        draggableRows="false" 
                                        tabindex="6">


                            <p:column width="10%">
                                <f:facet name="header">
                                    <h:outputText value="ID"/>
                                </f:facet>
                                <h:outputText value="#{street.streetID}" />
                            </p:column>

                            <p:column width="40%"
                                      sortBy="#{street.name}"
                                      filterable="true"
                                      filterBy="#{street.name}"
                                      >
                                <f:facet name="header">
                                    <h:outputText value="Street Name"/>
                                </f:facet>
                                <h:outputText value="#{street.name}" />
                            </p:column>

                            <p:column width="15%">
                                <f:facet name="header">
                                    <h:outputText value="ZIP Code"/>
                                </f:facet>
                                <h:outputText value="#{street.cityStateZip.zipCode}" />
                            </p:column>

                            <p:column width="10%">
                                <f:facet name="header">
                                    <h:outputText value="State"/>
                                </f:facet>
                                <h:outputText value="#{street.cityStateZip.state}" />
                            </p:column>


                            <p:column width="25%">
                                <f:facet name="header">
                                    <h:outputText value="Actions"/>
                                </f:facet>


                                <p:commandLink  id="street-viewedit"
                                                value="view/edit"
                                                style="color:blue;"
                                                rendered="true"
                                                actionListener="#{addressBB.onStreetViewEditLinkClick(street)}"
                                                ajax="true"
                                                oncomplete="PF('street-infoedit-dialog-var').show();"
                                                update="street-infoedit-dialog
                                                street-infoedit-form"
                                                />

                                <p:spacer height="2px" />


                                <p:commandLink  id="street-select"
                                                value="load addresses"
                                                style="color:blue;"
                                                rendered="true"
                                                actionListener="#{addressBB.onStreetSelectLinkClick(street)}"
                                                ajax="true"
                                                update="building-panel
                                                building-form
                                                addresses-growl-form"
                                                />
                            </p:column>
                        </p:dataTable>
                    </h:form>
                </p:panel>

                <p:panel id="building-panel"
                         toggleable="true"
                         collapsed="false"
                         header="Addresses">
                    <h:form id="building-form">

                        <p:commandButton id="address-create-init-button"
                                         value="New address on #{addressBB.currentStreet.name}"
                                         disabled="#{empty addressBB.currentStreet}"
                                         icon="fa fa-plus"
                                         oncomplete="PF('address-dialog-var').show()"
                                         actionListener="#{addressBB.onMailingAddressAddInitButtonChange}"
                                         update="address-dialog
                                         address-info-form
                                         addresses-growl-form"/>

                        <p:spacer height="5px" />

                        <p:dataTable    id="address-results-table"
                                        value="#{addressBB.mailingAddressList}"
                                        filteredValue="#{addressBB.mailingAddressListFiltered}"
                                        var="addr"
                                        lazy="false"
                                        rowKey="#{addr.addressID}"
                                        tableStyleClass="primeDataTable"
                                        draggableRows="true" 
                                        stripedRows="true"
                                        tabindex="6">

                            <p:column width="20%"
                                      filterBy="#{addr.buildingNo}"
                                      filterable="true"
                                      sortBy="#{addr.buildingNo}">
                                <f:facet name="header">
                                    <h:outputText value="Bldg No."/>
                                </f:facet>
                                <h:outputText value="#{addr.buildingNo}" />
                            </p:column>

                            <p:column width="25%"
                                      sortBy="#{addr.street.name}">
                                <f:facet name="header">
                                    <h:outputText value="Street"/>
                                </f:facet>
                                <h:outputText value="#{addr.street.name}" />
                            </p:column>

                            <p:column width="25%">
                                <f:facet name="header">
                                    <h:outputText value="City"/>
                                </f:facet>
                                <h:outputText value="#{addr.street.cityStateZip.defaultCity}" />
                            </p:column>

                            <p:column width="20%">
                                <f:facet name="header">
                                    <h:outputText value="Actions"/>
                                </f:facet>

                                <p:commandLink  id="address-view"
                                                value="view/edit"
                                                style="color:blue;"
                                                rendered="true"
                                                actionListener="#{addressBB.onMailingAddressViewEditLinkClick(addr)}"
                                                ajax="true"
                                                oncomplete="PF('address-dialog-var').show();"
                                                update="address-dialog
                                                address-info-form
                                                addresses-growl-form"
                                                />

                                <p:spacer height="3px" />

                                <p:commandLink  id="address-select"
                                                value="select"
                                                style="color:blue;"
                                                rendered="true"
                                                actionListener="#{addressBB.onMailingAddressViewEditLinkClick(addr)}"
                                                ajax="true"
                                                oncomplete="PF('address-search-dialog-var').hide();"
                                                update="topnav-prop-form"
                                                />
                            </p:column>
                        </p:dataTable>
                    </h:form>
                </p:panel>
            </div>
        </div>
    </p:dialog>

    <p:dialog id="street-infoedit-dialog"
              width="1000"
              widgetVar="street-infoedit-dialog-var"
              header="Street: #{addressBB.currentStreet.streetID eq 0 ? '(New street)' : addressBB.currentStreet.name}"
              modal="true"
              closeOnEscape="true"
              closable="true"
              resizable="true">
        <h:form id="street-infoedit-form">

            <p:commandButton id="street-edit-button"
                             value="#{addressBB.editModeCurrentStreet ? 'Save Changes' : 'Edit'}"
                             disabled="#{!addressBB.currentStreet.active}"
                             rendered="#{systemServicesBB.bbSessionUser.keyCard.hasMuniStaffPermissions}"
                             icon="fa #{addressBB.editModeCurrentStreet ? 'fa-check' : 'fa-pencil'}"
                             actionListener="#{addressBB.onToggleStreetEditModeButtonChange}"
                             oncomplete="PF('street-infoedit-dialog-var').show()"
                             update="@form
                             street-infoedit-dialog"/>

            <div class="gray_button">

                <p:commandButton id="street-edit-abort"
                                 value="Cancel"
                                 styleClass="gray-button"
                                 rendered="#{addressBB.editModeCurrentStreet}"
                                 icon="fa fa-stop"
                                 ajax="true"
                                 actionListener="#{addressBB.onMailingStreetEditAbort}"
                                 update="street-infoedit-form"
                                 />
            </div>

            <div class="p-grid">
                <div class="p-col-6">
                    ID
                </div>
                <div class="p-col-6">
                    <h:outputText value="#{addressBB.currentStreet.streetID eq 0 ? '(New street)' : addressBB.currentStreet.streetID}" />
                </div>

                <div class="p-col-6">
                    Street Name
                </div>
                <div class="p-col-6">
                    <h:outputText value="#{addressBB.currentStreet.name}" 
                                  rendered="#{!addressBB.editModeCurrentStreet}"
                                  />
                    <p:inputText value="#{addressBB.currentStreet.name}" 
                                 rendered="#{addressBB.editModeCurrentStreet}"
                                 />
                </div>
                <div class="p-col-6">
                    City, State, Zip
                </div>
                <div class="p-col-6">
                    <h:outputText value="#{addressBB.currentStreet.cityStateZip.city}" 
                                  rendered="true"
                                  />
                    <h:outputText value=", " />
                    <h:outputText value="#{addressBB.currentStreet.cityStateZip.state}" 
                                  rendered="true"
                                  />

                    <h:outputText value=" " />
                    <h:outputText value="#{addressBB.currentStreet.cityStateZip.zipCode}" 
                                  rendered="true"
                                  />

                    <p:spacer height="3px" />
                    <h:outputText value="(CSZip ID:#{addressBB.currentStreet.cityStateZip.cityStateZipID})" 
                                  rendered="true"
                                  />
                </div>

                <div class="p-col-6">
                    Created
                </div>
                <div class="p-col-6">
                    <h:outputText value="#{addressBB.getPrettyDate(addressBB.currentStreet.createdTS)}" />

                </div>
                <div class="p-col-6">
                    Active
                    <p:spacer height="3px" />

                    <p:commandLink  id="street-deactivate-clink"
                                    ajax="true"
                                    style="color:blue;"
                                    oncomplete="PF('remove-street-confirm-dialog-var').show()"
                                    rendered="#{!addressBB.editModeCurrentStreet}"
                                    update="remove-street-confirm-dialog
                                    remove-street-confirm-form"
                                    value="Deactivate street ID #{addressBB.currentStreet.streetID}"
                                    actionListener="#{addressBB.onMailingStreetDeactivateInitLinkClick}">

                    </p:commandLink>
                </div>
                <div class="p-col-6">
                    <h:outputText value="#{addressBB.currentStreet.active ? 'Active' : 'Deactivated'}" />

                </div>
                <div class="p-col-6">
                    Notes
                    <p:spacer height="3px" />
                    <p:commandLink  id="street-notes-init-clink"
                                    ajax="true"
                                    style="color:blue;"
                                    oncomplete="PF('street-note-dialog-var').show()"
                                    rendered="#{!addressBB.editModeCurrentStreet}"
                                    update="street-note-dialog
                                    street-note-form"
                                    value="Attach note"
                                    actionListener="#{addressBB.onMailingStreetNoteInitButtonChange}">

                    </p:commandLink>
                </div>
                <div class="p-col-6">
                    <h:outputText value="#{addressBB.currentStreet.notes}" 
                                  escape="false"/>
                </div>
            </div>
        </h:form>
    </p:dialog>



    <p:confirmDialog id="remove-street-confirm-dialog"
                     widgetVar="remove-street-confirm-dialog-var"
                     header="Confirm deactivation of street?"
                     closeOnEscape="true"
                     closable="true"
                     responsive="true">

        <h:form id="remove-street-confirm-form">
            <h:outputText value="DEACTIVATOR BEWEARE! Deactivating a street will deactivate all addresses on this street and all links to all those addresses!" />
            <p:spacer height="5px" />
            <p:commandButton  id="street-remove-commit-button"
                              ajax="true"
                              rendered="#{systemServicesBB.bbSessionUser.keyCard.hasMuniStaffPermissions}"
                              update="addresses-growl-form"
                              value="Confirm removal of street #{addressBB.currentStreet.name} (ID: #{addressBB.currentStreet.streetID})"
                              actionListener="#{addressBB.onMailingStreetDeactivateCommit}" 
                              oncomplete="PF('remove-street-confirm-dialog-var').hide()">
            </p:commandButton>

            <p:spacer height="5px" />

            <div class="gray_button">

                <p:commandButton id="remove-street-abort-button"
                                 value="Cancel"
                                 styleClass="gray-button"
                                 rendered="true"
                                 icon="fa fa-stop"
                                 process="@none"
                                 immediate="true"
                                 actionListener="#{addressBB.onMailingStreetEditAbort}"
                                 oncomplete="PF('remove-street-confirm-dialog-var').hide()" />
            </div>
        </h:form>
    </p:confirmDialog>


    <p:confirmDialog id="remove-address-confirm-dialog"
                     widgetVar="remove-address-confirm-dialog-var"
                     header="Confirm deactivation of address?"
                     closeOnEscape="true"
                     closable="true"
                     responsive="true">

        <h:form id="remove-address-confirm-form">
            <h:outputText value="DEACTIVATOR BEWEARE! Deactivating an address will deactivate all links to this address!" />
            <p:spacer height="5px" />
            <p:commandButton  id="address-remove-commit-button"
                              ajax="true"
                              rendered="#{systemServicesBB.bbSessionUser.keyCard.hasMuniStaffPermissions}"
                              update="addresses-growl-form"
                              value="Confirm removal of address #{addressBB.currentAddress.buildingNo} (ID: #{addressBB.currentAddress.addressID})"
                              actionListener="#{addressBB.onMailingStreetDeactivateCommit}" 
                              oncomplete="PF('remove-address-confirm-dialog-var').hide()">
            </p:commandButton>

            <p:spacer height="5px" />

            <div class="gray_button">

                <p:commandButton id="remove-address-abort-button"
                                 value="Cancel"
                                 styleClass="gray-button"
                                 rendered="true"
                                 icon="fa fa-stop"
                                 process="@none"
                                 immediate="true"
                                 actionListener="#{addressBB.onMailingAddressAbortOperationButtonChange}"
                                 oncomplete="PF('remove-address-confirm-dialog-var').hide()" />
            </div>
        </h:form>
    </p:confirmDialog>
    
    <p:dialog   id="address-note-dialog"
                height="400" width="400"
                widgetVar="address-note-dialog-var"
                responsive="true"
                resizable="true"
                closable="true"
                closeOnEscape="true"
                modal="true"
                header="Append note Current Address ID:#{addressBB.currentAddress.addressID}"
                rendered="true"
                >

        <h:form id="address-note-form">
            <h:outputText value="Note content:" />

            <p:spacer height="5px" />

            <p:inputTextarea value="#{addressBB.formNotesAddress}"
                             cols="40"
                             rows="5" />

            <p:spacer height="3px" />
            <h:outputText value="(your username and the date/time will be automatically included)" />
            <p:spacer height="5px" />

            <p:commandButton id="address-note-commit-button" 
                             value="Save note"
                             rendered="true"
                             icon="fa fa-sticky-note"
                             ajax="true"
                             actionListener="#{addressBB.onMailingAddressNoteCommitButtonChage}"
                             oncomplete="PF('address-note-dialog-var').hide()"
                             update="address-info-form
                             addresses-growl-form"/>
        </h:form>
    </p:dialog>
    
    <p:dialog   id="street-note-dialog"
                height="400" width="400"
                widgetVar="street-note-dialog-var"
                responsive="true"
                resizable="true"
                closable="true"
                closeOnEscape="true"
                modal="true"
                header="Append note to current street ID:#{addressBB.currentStreet.streetID}"
                rendered="true"
                >

        <h:form id="street-note-form">
            <h:outputText value="Note content:" />

            <p:spacer height="5px" />

            <p:inputTextarea value="#{addressBB.formNotesStreet}"
                             cols="40"
                             rows="5" />

            <p:spacer height="3px" />
            <h:outputText value="(your username and the date/time will be automatically included)" />
            <p:spacer height="5px" />

            <p:commandButton id="street-note-commit-button" 
                             value="Save note"
                             rendered="true"
                             icon="fa fa-sticky-note"
                             ajax="true"
                             actionListener="#{addressBB.onMailingStreetNoteCommitButtonChage}"
                             oncomplete="PF('street-note-dialog-var').hide()"
                             update="addresses-growl-form
                             street-infoedit-form"/>
        </h:form>
    </p:dialog>
    
    
</ui:composition>
