<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:f="http://xmlns.jcp.org/jsf/core"
      xmlns:p="http://primefaces.org/ui">
    <h:head>
        <link rel="stylesheet" type="text/css" href="css/style.css"></link>
        <title>Property Info</title>
    </h:head>
    <h:body>
        <ui:composition template="/restricted/navContainer_restricted.xhtml">
            <ui:define name="content">
                <f:view id="prop-info-view">
                    <p:outputPanel id="body-panel">

                        <!-- GLOBAL MESSAGES -->
                        <h:form id="form-messages-global">
                            <p:growl id="messages-global" showDetail="false"/>
                        </h:form>

                        <div class="mainContainer">

                             <div class="page-links">
                                <div class="restrict-main-contents-io-link link-button">
                                    <a href="#propinfo-panel-info">property info</a>
                                </div>
                                 
                                <h:outputText value=" | " />
                                
                                <div class="restrict-main-contents-io-link link-button">
                                    <a href="#prop-cases-panel">
                                        <h:outputText value="code enf cases (#{propertySearchBB.currentProperty.ceCaseList.size()})" />
                                    </a>
                                </div>
                                
                                <h:outputText value=" | " />
                                
                                <div class="restrict-main-contents-io-link link-button">
                                    <a href="#prop-units-panel">
                                        <h:outputText value="units (#{propertySearchBB.currentProperty.unitWithListsList.size()})" />
                                    </a>
                                </div>
                                
                                <h:outputText value=" | " />
                                
                                <div class="restrict-main-contents-io-link link-button">
                                    <a href="#prop-persons-panel">
                                        <h:outputText value="persons (#{propertySearchBB.currentProperty.personList.size()})" />
                                    </a>
                                </div>
                               
                                <h:outputText value=" | " />
                                
                                <div class="restrict-main-contents-io-link link-button">
                                    <a href="#prop-events-panel">
                                        <h:outputText value="events (#{propertySearchBB.currentProperty.completeEventList.size()})" />
                                    </a>
                                </div>
                                
                                <h:outputText value=" | " />
                                
                                
                                <div class="restrict-main-contents-io-link link-button">
                                    <a href="#propinfo-notes-panel">notes</a>
                                </div>
                                
                                <h:outputText value=" | " />
                                
                                
                                <div class="restrict-main-contents-io-link link-button">
                                    <a href="#prop-blobs-panel">docs and photos</a>
                                </div>
                                <h:outputText value=" | " />
                                
                                
                                <div class="restrict-main-contents-io-link link-button">
                                    <a href="#prop-extinfo-panel">external data</a>
                                </div>
                            </div>
                            
                            <!-- DATA CONTAINER -->
                            <div class="ui-g data-container">

                                <!-- LIST DATA CONTAINER --> 
                                <div class="ui-g-12 ui-md-6 ui-lg-6 list-data-container">

                                    <!-- PANEL CONTAINER -->
                                    <p:panel id="prop-search-query-panel"
                                             toggleable="true"
                                             widgetVar="prop-search-query-panel-var"
                                             collapsed="false"
                                             style="width:100%;"
                                             header="Property Search"
                                             rendered="true">

                                        <!--MESSAGES -->
                                        <h:form id="prop-search-messages-form">
                                            <p:growl id="prop-search-messages" showDetail="false"/>
                                        </h:form>

                                        <h:form id="prop-search-query-form">

                                            <!-- NESTED DATA CONTAINER -->
                                            <div class="ui-g data_container_nested_restrict">

                                                <!--NESTED DATA FIELD GRID:12-->
                                                <div class="ui-g-12 ui-md-12 ui-lg-12 restrict-data-field">

                                                    <!-- NESTED DATA TITLE -->
                                                    <div class="restrict-main-contents-io-title">
                                                        <h:outputLabel value="Select Tpye of Search"
                                                                       for="prop-search-query-som" 
                                                                       />
                                                    </div>
                                                    <!-- NESTED DATA CONTENT -->
                                                    <div class="restrict-main-contents-io-content">
                                                        <p:selectOneMenu id="prop-search-query-som"
                                                                         tabindex="1"
                                                                         value="#{propertySearchBB.querySelected}"
                                                                         style="width: 100%"
                                                                         >
                                                            <f:converter converterId="bOBQueryConverter"/>

                                                            <f:selectItem itemLabel="select one..."
                                                                          noSelectionOption="true"
                                                                          itemDisabled="true"
                                                                          />
                                                            <f:selectItems id="prop-search-query-si"
                                                                           value="#{propertySearchBB.queryList}"
                                                                           var="ql"
                                                                           itemValue="#{ql}"
                                                                           itemLabel="#{ql.queryTitle}" 
                                                                           />
                                                            <p:ajax update="prop-search-filter-addr-val-0
                                                                    @form
                                                                    prop-search-messages-form"
                                                                    listener="#{propertySearchBB.changeQuerySelected}"
                                                                    />
                                                        </p:selectOneMenu>
                                                    </div>
                                                </div>
                                            </div>

                                            <!-- NESTED DATA CONTAINER -->
                                            <div class="ui-g data_container_nested_restrict">

                                                <!-- NESTED DATA FIELD GRID:12-->
                                                <div class="ui-g-12 ui-md-12 ui-lg-12 restrict-data-field">

                                                    <!-- NESTED DATA TITLE -->
                                                    <div class="restrict-main-contents-io-title">
                                                        <h:outputLabel value="Enter Search Criteria"
                                                                       for="cears-query-desc-ot" />
                                                        <div class="restrict-main-contents-io-link">
                                                            <p:commandLink id="prop-search-advanced-button"
                                                                           ajax="true"
                                                                           actionListener="#{propertySearchBB.onAdvancedSearchButtonChange}"
                                                                           oncomplete="PF('prop-search-advanced-var').show()"
                                                                           rendered="#{systemServicesBB.bbSessionUser.keyCard.hasMuniStaffPermissions}"
                                                                           value="Advanced search"
                                                                           />

                                                        </div>
                                                    </div>

                                                    <!-- NESTED DATA CONTENT -->
                                                    <div class="restrict-main-contents-io-content">
                                                        <p:inputText id="prop-search-filter-addr-val-0"
                                                                     value="#{propertySearchBB.searchParamsSelected.address_val}"
                                                                     style="width: 100%;"
                                                                     tabindex="2"
                                                                     disabled="#{!propertySearchBB.searchParamsSelected.address_ctl}"
                                                                     required="false"
                                                                     styleClass="data_field_value"
                                                                     placeholder="#{propertySearchBB.querySelected.queryName.desc}"
                                                                     />

                                                        <p:message for="prop-search-filter-addr-val-0" showDetail="false" showSummary="true"/>
                                                    </div>

                                                    <!-- NESTED DATA FILTER -->
                                                    <div class="restrict-main-contents-io-filter">

                                                        <p:selectBooleanCheckbox class="checkbox"
                                                                                 id="prop-search-filter-addr-ctl-0"
                                                                                 value="#{propertySearchBB.searchParamsSelected.address_ctl}" >
                                                            <p:ajax update="prop-search-filter-addr-val-0"/>
                                                        </p:selectBooleanCheckbox>

                                                        <p:outputLabel for="prop-search-filter-addr-ctl-0" 
                                                                       value="Filter by street/number"
                                                                       />
                                                    </div>

                                                    <!-- NESTED DATA FILTER -->
                                                    <div class="restrict-main-contents-io-filter">

                                                        <p:selectBooleanCheckbox class="checkbox"
                                                                                 id="prop-search-appendresults-chkbox-0"
                                                                                 value="#{propertySearchBB.appendResultsToList}"
                                                                                 disabled="false" />

                                                        <p:outputLabel for="prop-search-appendresults-chkbox-0"
                                                                       value="Add to results below"
                                                                       />

                                                    </div>
                                                </div>

                                            </div>

                                            <!-- NESTED DATA CONTAINER -->
                                            <div class="ui-g data_container_nested_restrict">

                                                <!--NESTED DATA FIELD GRID:12-->
                                                <div class="ui-g-12 ui-md-12 ui-lg-12 restrict-data-field">

                                                    <!-- NESTED DATA BUTTON -->
                                                    <div class="restrict-main-contents-io-button">
                                                        <p:commandButton id="prop-search-exec-cb-0"
                                                                         ajax="true"
                                                                         actionListener="#{propertySearchBB.executeQuery}"
                                                                         icon="fa fa-search"
                                                                         value="Search"
                                                                         style="width: 100%"
                                                                         disabled="#{propertySearchBB.querySelected.queryExecuted}"
                                                                         update=" 
                                                                         @form
                                                                         form-messages-global
                                                                         prop-search-messages-form
                                                                         prop-search-log-form
                                                                         prop-search-results-panel
                                                                         prop-search-clear-cb-0"/>

                                                    </div>

                                                    <!-- NESTED DATA GRAY BUTTON -->
                                                    <div class="restrict-main-contents-io-button gray_button">
                                                        <p:commandButton id="prop-search-clear-cb-0"
                                                                         ajax="true"
                                                                         actionListener="#{propertySearchBB.resetQuery}"
                                                                         icon="fa fa-eraser"
                                                                         value="Clear"
                                                                         style="width: 100%"
                                                                         disabled="#{!propertySearchBB.querySelected.queryExecuted}"
                                                                         update=" prop-search-messages-form
                                                                         prop-search-log-form
                                                                         prop-search-results-panel
                                                                         @form
                                                                         prop-search-query-form"/>

                                                    </div>
                                                </div>
                                            </div>
                                        </h:form>
                                    </p:panel>

                                    <!-- PANEL CONTAINER -->
                                    <p:panel id="prop-search-results-panel"
                                             toggleable="true"
                                             widgetVar="prop-search-query-panel-var"
                                             collapsed="false"
                                             style="width:100%;"
                                             header="Search Results"
                                             rendered="true">


                                        <h:form id="prop-search-results-form">

                                            <!-- NESTED DATA CONTAINER -->
                                            <div class="ui-g data_container_nested_restrict">

                                                <!--NESTED DATA FIELD GRID:12-->
                                                <div class="ui-g-12 ui-md-12 ui-lg-12 restrict-data-field">

                                                    <!-- NESTED DATA BUTTON -->
                                                    <div class="restrict-main-contents-io-button gray_button">
                                                        <p:commandButton id="prop-search-results-clear"
                                                                         ajax="true"
                                                                         actionListener="#{propertySearchBB.clearPropertyList}"
                                                                         icon="fa fa-eraser"
                                                                         style="width: 100%"
                                                                         value="Clear Results "
                                                                         update=" prop-search-messages-form
                                                                         prop-search-results-form"/>

                                                    </div>
                                                </div>
                                            </div>

                                            <p:dataTable id="prop-search-results-table"
                                                         var="prop"
                                                         value="#{propertySearchBB.propListMaster}"
                                                         rowKey="#{prop.propertyID}"
                                                         tableStyleClass="primeDataTable"
                                                         draggableRows="false"
                                                         draggableColumns="true"
                                                         tabindex="6"
                                                         >

                                                <p:column width="10%;" style="text-align: center">
                                                    <f:facet name="header">
                                                        <h:outputText value="ID"/>
                                                    </f:facet>
                                                    <h:outputText value="#{prop.propertyID}" />
                                                </p:column>

                                                <p:column width="35%" style="text-align: center">
                                                    <f:facet name="header">
                                                        <h:outputText value="Address"/>
                                                    </f:facet>
                                                    <h:outputText value="#{prop.address}" />
                                                </p:column>

                                                <p:column width="35%" style="text-align: center">
                                                    <f:facet name="header">
                                                        <h:outputText value="Municipality" />
                                                    </f:facet>
                                                    <h:outputText value="#{prop.muni.muniName}"/>
                                                </p:column>

                                                <p:column width="20%" style="text-align: center">
                                                    <f:facet name="header">
                                                        <h:outputText value="Load"/>
                                                    </f:facet>
                                                    <div class="gray_button">
                                                        <p:commandButton id="prop-search-loadprop-button"
                                                                         icon="fa fa-folder-open-o"
                                                                         value="Load"
                                                                         style="#{prop.parID == propertySearchBB.currentProperty.propertyID ? 'background-color: #dee461; color:black;':''}"
                                                                         action="#{propertySearchBB.exploreProperty(prop)}"
                                                                         ajax="true"
                                                                         update="
                                                                         form-messages-global
                                                                         propinfo-panel-info
                                                                         prop-workflow-panel
                                                                         prop-events-panel
                                                                         prop-persons-panel
                                                                         prop-cases-panel
                                                                         prop-units-panel
                                                                         prop-extinfo-panel
                                                                         
                                                                         "
                                                                         />
                                                    </div>
                                                </p:column>
                                            </p:dataTable>
                                        </h:form>
                                    </p:panel>

                                    <!-- PANEL CONTAINER -->
                                    <p:panel  id="prop-search-log-panel"
                                              toggleable="true"
                                              widgetVar="prop-search-log-panel-var"
                                              collapsed="true"
                                              style="width:100%;"
                                              header="Query log"
                                              rendered="true">

                                        <h:form id="prop-search-log-form">
                                            <div class='search-query-desc'>
                                                <h:outputText id="prop-search-log-ot"
                                                              value="#{propertySearchBB.querySelected.queryLog}"
                                                              escape="false"/>
                                            </div>
                                        </h:form>
                                    </p:panel>

                                </div>

                                <!-- OBJECT DATA CONTAINER --> 
                                <div class="ui-g-12 ui-md-6 ui-lg-6 object-data-container">


                                    <p:outputPanel id = "prop-lists-outpanel" >
                                        <p:panel id="property-tools-panel"
                                                 toggleable="true"
                                                 collapsed="false"
                                                 header="Property tools: #{propertySearchBB.currentProperty.muni.muniName}"
                                                 rendered="true"
                                                 >
                                            
                                            <h:form id="property-tools-form">
                                                
                                                <p:commandButton id="prop-add-init-cb"
                                                                 ajax="true"
                                                                 value="Add new property"
                                                                 icon="fa fa-plus"
                                                                 actionListener="#{propertySearchBB.onPropertyAddInit}"
                                                                 oncomplete="PF('prop-addupdate-dialog-var').show();"
                                                                 update="prop-addupdate-dialog
                                                                 prop-addupdate-form" />
                                                
                                                
                                            </h:form>
                                        </p:panel>

                                        <!-- OBJECT DATA PANEL--> 
                                        <p:panel id="propinfo-panel-info"
                                                 toggleable="true"
                                                 collapsed="false"
                                                 header="#{propertySearchBB.currentProperty.address} (#{propertySearchBB.currentProperty.muni.muniName})"
                                                 rendered="#{propertySearchBB.currentPropertySelected}"
                                                 >
                                            <h:form id="evruleconfig-panel-info-form">
                                                
                                                <div class="object-metadata">
                                                    <h:outputText value="ID: #{propertySearchBB.currentProperty.propertyID} "/>
                                                    <h:outputText value="Created: #{propertySearchBB.getPrettyDate(propertySearchBB.currentProperty.creationTS)} "/>
                                                    <h:outputText value="Last udpated:#{propertySearchBB.getPrettyDate(propertySearchBB.currentProperty.lastUpdatedTS)}" />
                                                
                                                </div>
                                            
   
                                                <p:commandButton id="prop-update-init-cb"
                                                                 ajax="true"
                                                                 value="Update property"
                                                                 icon="fa fa-edit"
                                                                 actionListener="#{propertySearchBB.onPropertyUpdateInit}"
                                                                 oncomplete="PF('prop-addupdate-dialog-var').show();"
                                                                 update="prop-addupdate-dialog
                                                                 prop-addupdate-form" />
                                                
                                                

                                                <!-- NESTED DATA CONTAINER -->
                                                <div class="ui-g data_container_nested_restrict">

                                                    <!--NESTED DATA FIELD -->
                                                    <div class="ui-g-12 ui-md-12 ui-lg-12 restrict-data-field">

                                                        <!--NESTED DATA LABEL INLINE -->
                                                        <div class="restrict-data-field-label-inline" >
                                                            <h:outputLabel value="Address"/>
                                                        </div>
                                                        <!--NESTED DATA VALUE INLINE -->
                                                        <div class="restrict-data-field-value-inline" >

                                                            <h:outputText value="#{propertySearchBB.currentProperty.address}" />
                                                            <br/>
                                                            <h:outputText value="#{propertySearchBB.currentProperty.address_city}" />
                                                            <h:outputText value=", " />
                                                            <h:outputText value="#{propertySearchBB.currentProperty.address_state}" />
                                                            <h:outputText value=" " />
                                                            <h:outputText value="#{propertySearchBB.currentProperty.address_zip}" />
                                                        </div>
                                                    </div>

                                                    <!--NESTED DATA FIELD -->
                                                    <div class="ui-g-12 ui-md-6 ui-lg-4 restrict-data-field" >
                                                        <!--NESTED DATA LABEL INLINE -->
                                                        <div class="restrict-data-field-label-inline" >
                                                            <h:outputLabel value="County"/>
                                                        </div>
                                                        <!--NESTED DATA VALUE INLINE -->
                                                        <div class="restrict-data-field-value-inline" >
                                                            <h:outputText value="#{propertySearchBB.currentProperty.countyCode}" />

                                                        </div>
                                                    </div>

                                                    <!--NESTED DATA FIELD -->
                                                    <div class="ui-g-12 ui-md-6 ui-lg-4 restrict-data-field">
                                                        <!--NESTED DATA LABEL INLINE -->
                                                        <div class="restrict-data-field-label-inline" >
                                                            <h:outputLabel value="User Group"/>
                                                        </div>
                                                        <!--NESTED DATA VALUE INLINE -->
                                                        <div class="restrict-data-field-value-inline" >
                                                            <h:outputText value="#{propertySearchBB.currentProperty.useGroup}" />

                                                        </div>
                                                    </div>

                                                    <!--NESTED DATA FIELD -->
                                                    <div class="ui-g-12 ui-md-6 ui-lg-4 restrict-data-field">
                                                        <!--NESTED DATA LABEL INLINE -->
                                                        <div class="restrict-data-field-label-inline" >
                                                            <h:outputLabel value="Land Bank Prospect"/>
                                                        </div>
                                                        <!--NESTED DATA VALUE INLINE -->
                                                        <div class="restrict-data-field-value-inline" >
                                                            <h:outputText value="#{!(empty propertySearchBB.currentProperty.landBankProspect)
                                                                                   ? propertySearchBB.currentProperty.landBankProspect.title : ' '}" />

                                                        </div>
                                                    </div>

                                                    <!--NESTED DATA FIELD -->
                                                    <div class="ui-g-12 ui-md-6 ui-lg-4 restrict-data-field" >
                                                        <!--NESTED DATA LABEL INLINE -->
                                                        <div class="restrict-data-field-label-inline" >
                                                            <h:outputLabel value="Municipality"/>
                                                        </div>
                                                        <!--NESTED DATA VALUE INLINE -->
                                                        <div class="restrict-data-field-value-inline" >
                                                            <h:outputText value="#{propertySearchBB.currentProperty.muni.muniName}
                                                                          (ID:#{propertySearchBB.currentProperty.muni.muniCode})" />

                                                        </div>
                                                    </div>

                                                    <!--NESTED DATA FIELD -->
                                                    <div class="ui-g-12 ui-md-6 ui-lg-4 restrict-data-field">
                                                        <!--NESTED DATA LABEL INLINE -->
                                                        <div class="restrict-data-field-label-inline" >
                                                            <h:outputLabel value="Construction Type"/>
                                                        </div>
                                                        <!--NESTED DATA VALUE INLINE -->
                                                        <div class="restrict-data-field-value-inline" >
                                                            <h:outputText value="#{propertySearchBB.currentProperty.constructionType}" />

                                                        </div>
                                                    </div>

                                                    <!--NESTED DATA FIELD -->
                                                    <div class="ui-g-12 ui-md-6 ui-lg-4 restrict-data-field">
                                                        <!--NESTED DATA LABEL INLINE -->
                                                        <div class="restrict-data-field-label-inline" >
                                                            <h:outputLabel value="Land Bank Held"/>
                                                        </div>
                                                        <!--NESTED DATA VALUE INLINE -->
                                                        <div class="restrict-data-field-value-inline" >
                                                            <h:outputText value="#{propertySearchBB.currentProperty.landBankHeld}" />

                                                        </div>
                                                    </div>

                                                    <!--NESTED DATA FIELD -->
                                                    <div class="ui-g-12 ui-md-6 ui-lg-4 restrict-data-field">
                                                        <!--NESTED DATA LABEL INLINE -->
                                                        <div class="restrict-data-field-label-inline" >
                                                            <h:outputLabel value="Parcel ID"/>
                                                        </div>
                                                        <!--NESTED DATA VALUE INLINE -->
                                                        <div class="restrict-data-field-value-inline" >
                                                            <h:outputText value="#{propertySearchBB.currentProperty.parID}" />

                                                        </div>
                                                    </div>
                                                    <!--NESTED DATA FIELD -->
                                                    <div class="ui-g-12 ui-md-6 ui-lg-4 restrict-data-field">
                                                        <!--NESTED DATA LABEL INLINE -->
                                                        <div class="restrict-data-field-label-inline" >
                                                            <h:outputLabel value="Condition Class"/>
                                                        </div>
                                                        <!--NESTED DATA VALUE INLINE -->
                                                        <div class="restrict-data-field-value-inline" >
                                                            <h:outputText value="#{!(empty propertySearchBB.currentProperty.condition)
                                                                                   ? propertySearchBB.currentProperty.condition.title
                                                                                   : ''}" />

                                                        </div>
                                                    </div>
                                                    <!--NESTED DATA FIELD -->
                                                    <div class="ui-g-12 ui-md-6 ui-lg-4 restrict-data-field">
                                                        <!--NESTED DATA LABEL INLINE -->
                                                        <div class="restrict-data-field-label-inline" >
                                                            <h:outputLabel value="Nonaddressable"/>
                                                        </div>
                                                        <!--NESTED DATA VALUE INLINE -->
                                                        <div class="restrict-data-field-value-inline" >
                                                            <h:outputText value="#{propertySearchBB.currentProperty.nonAddressable}" />

                                                        </div>
                                                    </div>
                                                    <!--NESTED DATA FIELD -->
                                                    <div class="ui-g-12 ui-md-6 ui-lg-4 restrict-data-field">
                                                        <!--NESTED DATA LABEL INLINE -->
                                                        <div class="restrict-data-field-label-inline" >
                                                            <h:outputLabel value="Lot-Block"/>
                                                        </div>
                                                        <!--NESTED DATA VALUE INLINE -->
                                                        <div class="restrict-data-field-value-inline" >
                                                            <h:outputText value="#{propertySearchBB.currentProperty.lotAndBlock}"  />

                                                        </div>
                                                    </div>
                                                    <!--NESTED DATA FIELD -->
                                                    <div class="ui-g-12 ui-md-6 ui-lg-4 restrict-data-field">
                                                        <!--NESTED DATA LABEL INLINE -->
                                                        <div class="restrict-data-field-label-inline" >
                                                            <h:outputLabel value="Source"/>
                                                        </div>
                                                        <!--NESTED DATA VALUE INLINE -->
                                                        <div class="restrict-data-field-value-inline" >
                                                            <h:outputText value="#{!(empty propertySearchBB.currentProperty.bobSource)
                                                                                   ? propertySearchBB.currentProperty.bobSource.title : ''}"  />

                                                        </div>
                                                    </div>
                                                    <!--NESTED DATA FIELD -->
                                                    <div class="ui-g-12 ui-md-6 ui-lg-4 restrict-data-field">
                                                        <!--NESTED DATA LABEL INLINE -->
                                                        <div class="restrict-data-field-label-inline" >
                                                            <h:outputLabel value="Active"/>
                                                        </div>
                                                        <!--NESTED DATA VALUE INLINE -->
                                                        <div class="restrict-data-field-value-inline" >
                                                            <h:outputText value="#{propertySearchBB.currentProperty.active}" />
                                                        </div>
                                                    </div>
                                                </div>

                                                <!-- NESTED DATA CONTAINER -->
                                                <div class="ui-g data_container_nested_restrict">

                                                    <!--NESTED DATA FIELD VERTICAL-->
                                                    <div class="ui-g-3 ui-md-3 ui-lg-3 restrict-data-field-vertical">
                                                        <!--NESTED DATA LABEL VERTICAL -->
                                                        <div class="restrict-data-field-label-vertical" >
                                                            <h:outputLabel value=" "/>
                                                        </div>
                                                        <!--NESTED DATA VALUE VERTICAL -->
                                                        <div class="restrict-data-field-value-vertical" style="font-weight: 700;">
                                                            Start Date:
                                                        </div>
                                                        <!--NESTED DATA VALUE VERTICAL -->
                                                        <div class="restrict-data-field-value-vertical" style="font-weight: 700;">
                                                            End Date:
                                                        </div>

                                                    </div>

                                                    <!--NESTED DATA FIELD VERTICAL-->
                                                    <div class="ui-g-3 ui-md-3 ui-lg-3 restrict-data-field-vertical">
                                                        <!--NESTED DATA LABEL VERTICAL -->
                                                        <div class="restrict-data-field-label-vertical" >
                                                            <h:outputLabel value="Unfitness of Occupancy"/>
                                                        </div>
                                                        <!--NESTED DATA VALUE VERTICAL -->
                                                        <div class="restrict-data-field-value-vertical" >
                                                            <h:outputText id="propinfo-ot-unfitstart-1"
                                                                          value="#{!(empty propertySearchBB.currentProperty.unfitDateStart) ? propertySearchBB.getPrettyDateNoTime(propertySearchBB.currentProperty.unfitDateStart) : ''}" />
                                                        </div>
                                                        <!--NESTED DATA VALUE VERTICAL -->
                                                        <div class="restrict-data-field-value-vertical" >
                                                            <h:outputText id="propinfo-ot-unfitstop-1"
                                                                          value="#{!(empty propertySearchBB.currentProperty.unfitDateStop) ? propertySearchBB.getPrettyDateNoTime(propertySearchBB.currentProperty.unfitDateStop) : ''}" />
                                                        </div>

                                                    </div>

                                                    <!--NESTED DATA FIELD VERTICAL-->
                                                    <div class="ui-g-3 ui-md-3 ui-lg-3 restrict-data-field-vertical">
                                                        <!--NESTED DATA LABEL VERTICAL -->
                                                        <div class="restrict-data-field-label-vertical" >
                                                            <h:outputLabel value="Vacany"/>
                                                        </div>
                                                        <!--NESTED DATA VALUE VERTICAL -->
                                                        <div class="restrict-data-field-value-vertical" >

                                                            <h:outputText id="propinfo-ot-vacantstart-1"
                                                                          value="#{!(empty propertySearchBB.currentProperty.vacantDateStart) ? propertySearchBB.getPrettyDateNoTime(propertySearchBB.currentProperty.vacantDateStart) : ''}" />

                                                        </div>
                                                        <!--NESTED DATA VALUE VERTICAL -->
                                                        <div class="restrict-data-field-value-vertical" >
                                                            <h:outputText id="propinfo-ot-vacantstop-1"
                                                                          value="#{!(empty propertySearchBB.currentProperty.vacantDateStop) ? propertySearchBB.getPrettyDateNoTime(propertySearchBB.currentProperty.vacantDateStop) : ''}" />
                                                        </div>

                                                    </div>

                                                    <!--NESTED DATA FIELD VERTICAL-->
                                                    <div class="ui-g-3 ui-md-3 ui-lg-3 restrict-data-field-vertical">
                                                        <!--NESTED DATA LABEL VERTICAL -->
                                                        <div class="restrict-data-field-label-vertical" >
                                                            <h:outputLabel value="Abandonment"/>
                                                        </div>
                                                        <!--NESTED DATA VALUE VERTICAL -->
                                                        <div class="restrict-data-field-value-vertical" >
                                                            <h:outputText id="propinfo-ot-abandonedstart-1"
                                                                          value="#{!(empty propertySearchBB.currentProperty.abandonedDateStart) ? propertySearchBB.getPrettyDateNoTime(propertySearchBB.currentProperty.abandonedDateStart) : ''}" />

                                                        </div>
                                                        <!--NESTED DATA VALUE VERTICAL -->
                                                        <div class="restrict-data-field-value-vertical" >
                                                            <h:outputText id="propinfo-ot-abandonedstop-1"
                                                                          value="#{!(empty propertySearchBB.currentProperty.abandonedDateStop) ? propertySearchBB.getPrettyDateNoTime(propertySearchBB.currentProperty.abandonedDateStop) : ''}" />
                                                        </div>
                                                    </div>
                                                </div>
                                            </h:form>

                                        </p:panel>


                                        <p:panel    id="prop-cases-panel"
                                                    toggleable="true"
                                                    widgetVar="prop-cases-panel-var"
                                                    collapsed="false"
                                                    header="Code Enforcement Cases"
                                                    rendered="#{propertySearchBB.currentPropertySelected}">
                                            <h:form id="prop-cases-panel-form">

                                                <p:commandButton   id="prop-cases-newcase-button"
                                                                   ajax="fase"
                                                                   action="#{propertySearchBB.onCreateNewCaseButtonChange}"
                                                                   oncomplete="PF('prop-persons-manage-var').show()"
                                                                   rendered="#{systemServicesBB.bbSessionUser.keyCard.hasMuniStaffPermissions}"
                                                                   value="Create New Code Enforcement Case"
                                                                   icon="fa fa-archive"
                                                                   />

                                                <p:spacer height="5px" />

                                                <p:dataTable id="prop-cases-table"
                                                             var="cse"
                                                             value="#{propertySearchBB.currentProperty.ceCaseList}"
                                                             tableStyleClass="primeDataTable"
                                                             rowKey="#{cse.caseID}"
                                                             >

                                                    <p:column headerText="Date Opened"
                                                              styleClass="centeredColumnContent"
                                                              sortBy="#{cse.originationDate}">

                                                        <h:outputText value="#{!(empty cse.originationDate) ? propertySearchBB.getPrettyDate(cse.originationDate) : ''}"/>

                                                    </p:column>

                                                    <p:column headerText="Status"
                                                              styleClass="centeredColumnContent">

                                                        <h:outputText value="#{cse.statusBundle.phase.caseOpen ? 'Open' : 'Closed'}"/>

                                                    </p:column>

                                                    <p:column headerText="Name"
                                                              styleClass="centeredColumnContent">

                                                        <h:outputText value="#{cse.caseName}"/>

                                                    </p:column>

                                                    <p:column headerText="Manager"
                                                              styleClass="centeredColumnContent">

                                                        <h:outputText value="#{!(empty cse.caseManager) ? cse.caseManager.person.lastName:'No manager '}"/>

                                                    </p:column>
                                                    <p:column headerText="ID"
                                                              styleClass="centeredColumnContent">

                                                        <h:outputText value="#{cse.caseID}"/>

                                                    </p:column>

                                                    <p:column headerText="Options"
                                                              styleClass="centeredColumnContent">

                                                        <p:commandButton    id="prop-person-viewcase-button"
                                                                            ajax="false"
                                                                            styleClass="noFill button-size-small"
                                                                            action="#{propertySearchBB.onViewCaseButtonChange(cse)}"
                                                                            icon="fa fa-folder-open-o"
                                                                            value="View"
                                                                            />

                                                    </p:column>
                                                </p:dataTable>
                                            </h:form>

                                        </p:panel>


                                        <p:panel    id="prop-units-panel"
                                                    toggleable="true"
                                                    widgetVar="prop-events-panel-var"
                                                    collapsed="false"
                                                    header="Units"
                                                    rendered="#{propertySearchBB.currentPropertySelected}">
                                            <h:form id="prop-units-panel-form">


                                                <p:commandButton    id="prop-units-explore-button"
                                                                    ajax="false"
                                                                    value="Configure Units"
                                                                    styleClass="noFill button-size-small"
                                                                    action="#{propertySearchBB.onPropUnitExploreButtonChange}"
                                                                    icon="fa fa-hotel"
                                                                    />

                                                <p:spacer height="5px" />

                                                <p:dataTable id="prop-units-table"
                                                             var="unit"
                                                             value="#{propertySearchBB.currentProperty.unitWithListsList}"
                                                             tableStyleClass="primeDataTable"
                                                             rowKey="#{unit.unitID}"
                                                             >

                                                    <p:column headerText="Number"
                                                              styleClass="centeredColumnContent">

                                                        <h:outputText value="#{unit.unitNumber}"/>

                                                    </p:column>

                                                    <p:column headerText="# Occ Periods"
                                                              styleClass="centeredColumnContent">

                                                        <h:outputText value="#{unit.periodList.size()}"/>

                                                    </p:column>


                                                    <p:column headerText="Rent start"
                                                              styleClass="centeredColumnContent">

                                                        <h:outputText value="#{propertySearchBB.getPrettyDateNoTime(unit.rentalIntentDateStart)}"/>

                                                    </p:column>

                                                    <p:column headerText="Rent stop"
                                                              styleClass="centeredColumnContent">

                                                        <h:outputText value="#{propertySearchBB.getPrettyDateNoTime(unit.rentalIntentDateStart)}"/>

                                                    </p:column>

                                                    <p:column headerText="Last updated"
                                                              styleClass="centeredColumnContent">

                                                        <h:outputText value="#{propertySearchBB.getPrettyDateNoTime(unit.lastUpdatedTS)}"/>

                                                    </p:column>

                                                    <p:column headerText="Sys ID"
                                                              styleClass="centeredColumnContent">
                                                        <h:outputText value="#{unit.unitID}"/>


                                                    </p:column>

                                                    <p:column headerText="Options"
                                                              styleClass="centeredColumnContent">

                                                        <p:commandButton   id="prop-unit-newperiod-button"
                                                                           ajax="true"
                                                                           actionListener="#{propertyOccPeriodsBB.initiateNewOccPeriodCreation(unit)}"
                                                                           oncomplete="PF('prop-addperiod-dialog-var').show()"
                                                                           rendered="#{systemServicesBB.bbSessionUser.keyCard.hasMuniStaffPermissions}"
                                                                           value="New Occ Period"
                                                                           icon="fa fa-id-card-o"
                                                                           />


                                                    </p:column>
                                                </p:dataTable>
                                            </h:form>



                                        </p:panel>


                                    <p:panel id="prop-blobs-panel"
                                             toggleable="true"
                                             collapsed="false"
                                             header="Files and Photos"
                                             rendered="true"
                                             >

                                        <h:form id="prop-blobs-form">

                                            <p:commandButton    id="prop-blob-add-button"
                                                                ajax="true"
                                                                styleClass="noFill button-size-small"
                                                                actionListener="#{propertySearchBB.onBlobAddButtonChange}"
                                                                oncomplete="PF('prop-blobs-dialog-var').show()"
                                                                value="Add Photos or Documents"
                                                                icon="fa fa-upload"
                                                                />

                                            <p:spacer height="5px" />

                                            <p:dataTable
                                                id="prop-blobs-table"
                                                var="blob"
                                                value="#{propertySearchBB.currentProperty.blobList}"
                                                rowKey="#{blob.blobID}"
                                                tableStyleClass="primeDataTable"
                                                resizableColumns="true"
                                                draggableRows="false" tabindex="6">

                                                <p:column width="15%">
                                                    <f:facet name="header">
                                                        <h:outputText value="File Type"/>
                                                    </f:facet>
                                                    <h:outputText value="#{blob.type.title}"/>
                                                    <!-- type icon here -->
                                                </p:column>

                                                <p:column width="15%">
                                                    <f:facet name="header">
                                                        <h:outputText value="IDs"/>
                                                    </f:facet>
                                                    <h:outputText value="linkID: #{blob.photoDocID}"/>
                                                    <br/>
                                                    <h:outputText value="bytesID: #{blob.bytesID}"/>
                                                    
                                                </p:column>

                                                <p:column width="45%">
                                                    <f:facet name="header">
                                                        <h:outputText value="Info"/>
                                                    </f:facet>
                                                    <div class="rowExpansion">
                                                        <h:outputText value="title: #{blob.title}"/>
                                                        <br/>
                                                        <h:outputText value="descr: #{blob.description}"/>
                                                        <br/>
                                                        <h:outputText value="filename: #{blob.filename}"/>
                                                        <br/>
                                                        <h:outputText value="created: #{propertySearchBB.getPrettyDateNoTime(blob.createdTS)}"/>
                                                    </div>
                                                </p:column>


                                                <p:column>
                                                    <f:facet name="header">
                                                        <h:outputText value="Actions"/>
                                                    </f:facet>
                                                    <p:commandButton 
                                                        value="View in tab" 
                                                        ajax="false"
                                                        icon="fa fa-eye" 
                                                        styleClass="ui-button-outlined">
                                                        <p:fileDownload value="#{blobRetrieveBB.retrieveBlob(blob)}"
                                                                        contentDisposition="inline"
                                                                        />
                                                    </p:commandButton>
                                                    <br/>
                                                    <p:commandButton 
                                                        value="Download" 
                                                        ajax="false"
                                                        icon="fa fa-arrow-down" 
                                                        styleClass="ui-button-outlined">
                                                        <p:fileDownload value="#{blobRetrieveBB.retrieveBlob(blob)}"
                                                                        />
                                                    </p:commandButton>
                                                    <br/>
                                                     <div class="restrict-main-contents-io-link link-button">

                                                        <p:commandLink      id="blob-update-button"
                                                                            ajax="true"
                                                                            styleClass="noFill button-size-small"
                                                                            action="#{propertySearchBB.onBlobSelectButtonChange(blob)}"
                                                                            value="edit"
                                                                            oncomplete="PF('blob-edit-dialog-var').show()"
                                                                            update="blob-edit-dialog
                                                                            blob-edit-form"
                                                                            />
                                                    </div>
                                                    
                                                    
                                                     <h:outputText value="&nbsp;&nbsp;|" />
                                                     <div class="restrict-main-contents-io-link link-button">

                                                        <p:commandLink      id="blob-remove-button"
                                                                            ajax="true"
                                                                            styleClass="noFill button-size-small"
                                                                            action="#{propertySearchBB.onBlobRemoveInitButtonChange(blob)}"
                                                                            value="remove"
                                                                            oncomplete="PF('blob-remove-dialog-var').show()"
                                                                            update="blob-remove-dialog
                                                                            blob-remove-form"
                                                                            />
                                                        
                                                        
                                                    </div>
                                                    
                                                </p:column>
                                            </p:dataTable>
                                        </h:form>
                                    </p:panel>


                                        <p:panel id="prop-workflow-panel"
                                                 toggleable="true"
                                                 widgetVar="prop-workflow-panel-var"
                                                 collapsed="false"
                                                 header="Proposals"
                                                 rendered="false">
                                            <h:form id="prop-workflow-form">

                                                <p:selectOneMenu id="prop-workflow-viewoptions-som"
                                                                 value="#{propertySearchBB.selectedPropViewOption}"
                                                                 tabindex="10">

                                                    <f:selectItems  id="prop-workflow-viewoptions-selitems"
                                                                    value="#{workflowBB.proposalsViewOptions}"
                                                                    var="pvo"
                                                                    itemValue="#{pvo}"
                                                                    itemLabel="#{pvo.label}"/>
                                                    <p:ajax update="proposals-proposalscroller"
                                                            immediate="true"/>
                                                </p:selectOneMenu>

                                                <p:dataScroller id="proposals-proposalscroller"
                                                                var="proposal"
                                                                widgetVar="proposals-proposalscroller-var"
                                                                value="#{propertySearchBB.currentProperty.assembleProposalList(propertySearchBB.selectedPropViewOption)}"
                                                                rowIndexVar="#{proposal.proposalID}">

                                                    <div class="outlinedBox">
                                                        <div class="proposal-metadata-container">
                                                            <div class="proposal-propbuttoncontainer">
                                                                <p:commandButton    id="proposal-button-showdescription"
                                                                                    styleClass="noFill button-size-small button-moreinfo"
                                                                                    icon="fa fa-info"/>

                                                                <p:overlayPanel id="proposal-overlaypanel-proposaldescription"
                                                                                for="proposal-button-showdescription"
                                                                                dynamic="true"
                                                                                showCloseIcon="true"
                                                                                style="width:300px"
                                                                                modal="false">

                                                                    <h:outputText       styleClass="proposal-description"
                                                                                        value="#{proposal.directive.description}" />
                                                                </p:overlayPanel>


                                                                <p:commandButton    id="proposal-button-rejectionreason"
                                                                                    styleClass="noFill button-size-small"
                                                                                    oncomplete="PF('occperiod-rejectproposal-dialog-var').show()"
                                                                                    rendered="#{!proposal.directive.requiredEvaluationForBOBClose
                                                                                                or systemServicesBB.bbSessionUser.keyCard.hasSysAdminPermissions }"
                                                                                    icon="fa fa-trash"/>
                                                            </div>
                                                            <div class="proposal-prophead">
                                                                <h:outputText value="#{proposal.directive.title}" />
                                                            </div>

                                                            <p:spacer height="5px" />

                                                            <h:panelGrid   id="prop-workflow-propinfo-pg"
                                                                           columns="1"
                                                                           style="clear:both;"
                                                                           columnClasses="gridTd"
                                                                           rendered="true">
                                                                <h:panelGroup>
                                                                    <h:outputText styleClass="ui-label-inline"
                                                                                  value="Intended for: "  />
                                                                    <h:outputText styleClass="data-text"
                                                                                  value="#{proposal.responderIntended.person.firstName}" />
                                                                    <h:outputText styleClass="data-text"
                                                                                  value=" " />
                                                                    <h:outputText styleClass="data-text"
                                                                                  value="#{proposal.responderIntended.person.lastName}" />
                                                                </h:panelGroup>
                                                            </h:panelGrid>
                                                        </div>

                                                        <p:dataScroller id="proposals-choicescroller"
                                                                        var="choice"
                                                                        widgetVar="proposals-choicescroller-var"
                                                                        value="#{proposal.directive.choiceListVisible}"
                                                                        rowIndexVar="#{choice.choiceID}">

                                                            <p:commandButton    id="proposal-choice-button-choose"
                                                                                ajax="true"
                                                                                styleClass="proposal-choice-button"
                                                                                actionListener="#{workflowBB.proposals_makeChoice(choice, proposal)}"
                                                                                disabled="#{!choice.canChoose or !(empty proposal.responseTS)}"
                                                                                value="#{choice.title}"
                                                                                icon="#{!(empty choice.icon) ? choice.icon.fontAwesome : 'fa fa-fighter-jet'}"
                                                                                title="#{choice.description}"
                                                                                update="occperiod-form-proposals
                                                                                occperiod-panel-proposals-messages-form"/>
                                                            <p:spacer height="5px" />
                                                        </p:dataScroller>
                                                    </div>
                                                </p:dataScroller>
                                            </h:form>
                                        </p:panel>

                                        <p:panel    id="prop-events-panel"
                                                    toggleable="true"
                                                    widgetVar="prop-events-panel-var"
                                                    collapsed="false"
                                                    header="Events"
                                                    rendered="#{propertySearchBB.currentPropertySelected}">

                                            <h:form id="prop-events-panel-form">


                                                <p:selectOneMenu style="width: 300px;" 
                                                                 id="prop-viewoptionsevents-solb" 
                                                                 value="#{propertySearchBB.eventViewOptionSelected}" 
                                                                 tabindex="10">

                                                    <p:ajax update="prop-events-datatable"                                                           
                                                            immediate="true"/>

                                                    <f:selectItems  id="prop-events-selitems" 
                                                                    value="#{propertySearchBB.eventViewOptions}" 
                                                                    var="evo" 
                                                                    itemValue="#{evo}" 
                                                                    itemLabel="#{evo.label}"/>
                                                </p:selectOneMenu>

                                                <p:spacer height="5px" />

                                                <p:dataTable id="prop-events-datatable"
                                                             var="event"
                                                             value="#{propertySearchBB.currentProperty.completeEventList}"
                                                             tableStyleClass="primeDataTable"
                                                             rowKey="#{event.eventID}"
                                                             >

                                                    <p:column headerText="ID"
                                                              styleClass="centeredColumnContent">

                                                        <h:outputText value="#{event.eventID}"/>

                                                    </p:column>

                                                    <p:column headerText="Category"
                                                              styleClass="centeredColumnContent">
                                                        <h:outputText value="#{event.category.eventCategoryTitle}" />


                                                    </p:column>

                                                    <p:column headerText="Description"
                                                              styleClass="centeredColumnContent">

                                                        <h:outputText value="#{event.description}"/>

                                                    </p:column>
                                                    <p:column headerText="Options"
                                                              styleClass="centeredColumnContent">

                                                        <p:commandButton    id="prop-events-open-button"
                                                                            ajax="false"
                                                                            styleClass="noFill button-size-small"
                                                                            action="#{propertySearchBB.onViewEventButtonChange(event)}"
                                                                            value="View Event"
                                                                            icon="fa fa-folder-open-o"
                                                                            />


                                                    </p:column>
                                                </p:dataTable>
                                            </h:form>

                                        </p:panel>



                                        <p:panel    id="prop-persons-panel"
                                                    toggleable="true"
                                                    widgetVar="prop-events-panel-var"
                                                    collapsed="false"
                                                    header="Persons"
                                                    rendered="#{propertySearchBB.currentPropertySelected}">
                                            <h:form id="prop-persons-panel-form">

                                                <p:commandButton   id="prop-persons-manage-button"
                                                                   ajax="true"
                                                                   actionListener="#{propertySearchBB.onPersonConnectInitButtonChange}"
                                                                   oncomplete="PF('prop-persons-manage-var').show()"
                                                                   rendered="#{systemServicesBB.bbSessionUser.keyCard.hasMuniStaffPermissions}"
                                                                   value="Link Person to Property"
                                                                   icon="fa fa-user-plus"
                                                                   />

                                                <p:spacer height="5px" />

                                                <p:dataTable id="prop-persons-table"
                                                             var="person"
                                                             value="#{propertySearchBB.currentProperty.personList}"
                                                             tableStyleClass="primeDataTable"
                                                             rowKey="#{person.personID}"
                                                             >

                                                    <p:column headerText="Name"
                                                              styleClass="centeredColumnContent">

                                                        <h:outputText value="#{person.firstName}"/>
                                                        <h:outputText value=" "/>
                                                        <h:outputText value="#{person.lastName}"/>
                                                        <p:spacer height="1px" />
                                                        <h:outputText value="#{person.addressStreet}"/>
                                                        <p:spacer height="1px" />
                                                        <h:outputText value="#{person.addressCity}"/>
                                                        <h:outputText value=" "/>
                                                        <h:outputText value="#{person.addressState}"/>
                                                        <h:outputText value=", "/>
                                                        <h:outputText value="#{person.addressZip}"/>


                                                    </p:column>

                                                    <p:column headerText="Type"
                                                              styleClass="centeredColumnContent">
                                                        <h:outputText value="#{person.personType.label}" />


                                                    </p:column>

                                                    <p:column headerText="Person Last updated"
                                                              styleClass="centeredColumnContent">
                                                        <h:outputText value="#{propertySearchBB.getPrettyDateNoTime(person.lastUpdated)}" />


                                                    </p:column>

                                                    <p:column headerText="ID"
                                                              styleClass="centeredColumnContent">

                                                        <h:outputText value="#{person.personID}"/>

                                                    </p:column>

                                                    <p:column headerText="Options"
                                                              styleClass="centeredColumnContent">

                                                        <p:commandButton    id="prop-person-removepersonlink-button"
                                                                            ajax="false"
                                                                            styleClass="noFill button-size-small"
                                                                            action="#{propertySearchBB.onPersonConnectRemoveButtonChange(person)}"
                                                                            icon="fa fa-trash"
                                                                            value="Remove Link"
                                                                            disabled="#{!systemServicesBB.bbSessionUser.keyCard.hasMuniStaffPermissions}"
                                                                            />
                                                        <p:spacer height="3px" />

                                                        <p:commandButton    id="prop-person-exploreperson-button"
                                                                            ajax="false"
                                                                            styleClass="noFill button-size-small"
                                                                            action="#{propertySearchBB.onViewPersonProfileButtonChange(person)}"
                                                                            icon="fa fa-folder-open-o"
                                                                            value="View Person"
                                                                            />

                                                    </p:column>


                                                </p:dataTable>
                                            </h:form>


                                        </p:panel>


                                        <p:panel    id="prop-extinfo-panel"
                                                    toggleable="true"
                                                    widgetVar="prop-info-var"
                                                    collapsed="false"
                                                    header="External Data Records"
                                                    rendered="#{propertySearchBB.currentPropertySelected}">

                                            <h:form id="prop-extinfo-panel-form">
                                                <p:dataTable id="prop-extinfo-table"
                                                             var="record"
                                                             value="#{propertySearchBB.currentProperty.extDataList}"
                                                             tableStyleClass="primeDataTable"
                                                             rowKey="#{record.extdataid}"
                                                             >

                                                    <p:column headerText="Date"
                                                              styleClass="centeredColumnContent">

                                                        <h:outputText value="#{propertySearchBB.getPrettyDateNoTime(cord.lastUpdatedTS)}"/>

                                                    </p:column>

                                                    <p:column headerText="Owner name"
                                                              styleClass="centeredColumnContent">

                                                        <h:outputText value="#{record.ownername}"/>

                                                    </p:column>

                                                    <p:column headerText="Tax status"
                                                              styleClass="centeredColumnContent">

                                                        <h:outputText value="#{!(empty record.taxStatus) ? record.taxStatus.paidStatus : ''}"/>

                                                    </p:column>



                                                </p:dataTable>



                                            </h:form>
                                        </p:panel>


                                        <p:panel id="propinfo-notes-panel"
                                                 toggleable="true"
                                                 collapsed="false"
                                                 header="Property Notes"
                                                 rendered="#{propertySearchBB.currentPropertySelected}"
                                                 > 
                                            <h:form id="propinfo-notes-form">
                                                <h:messages id="propinfo-notes-messages"
                                                            globalOnly="true" showDetail="true" showSummary="true"
                                                            warnClass="msgWarn" infoClass="msgInfo" fatalClass="msgFatal" errorClass="msgError">
                                                </h:messages>

                                                <div class="ui-g data-container">
                                                    <p:commandButton   id="propinfo-notes-add-button"
                                                                       rendered="#{systemServicesBB.bbSessionUser.keyCard.hasMuniReaderPermissions}"
                                                                       value="Add new note"  
                                                                       icon="fa fa-sticky-note-o"
                                                                       actionListener="#{propertySearchBB.onNoteInitButtonChange}"
                                                                       oncomplete="PF('propinfo-notes-dialog-var').show()"
                                                                       update="propinfo-note-create-form"/>
                                                    <p:spacer height="5px" />
                                                    <div    id="propinf-ot-notes-div"
                                                            class="data_field"
                                                            style="clear:both;">
                                                        <h:outputLabel  styleClass="data_field_label"
                                                                        for="propinfo-ot-notes"
                                                                        value="Notes"/>

                                                        <h:outputText   id="propinfo-ot-notes"
                                                                        styleClass="data_field_value"
                                                                        value="#{propertySearchBB.currentProperty.notes}"
                                                                        escape="false"/>
                                                    </div>
                                                </div>

                                            </h:form>
                                        </p:panel>

                                    </p:outputPanel>


                                </div>

                            </div>


                        </div>

                    </p:outputPanel>
                    
                    

                    <p:dialog   id="prop-blobs-dialog"
                                height="600" width="800"
                                widgetVar="prop-blobs-dialog-var"
                                responsive="true"
                                modal="true"
                                resizable="true"
                                closable="true"
                                closeOnEscape="true"
                                header="Photos and Documents on #{propertySearchBB.currentProperty.address} (#{propertySearchBB.currentProperty.muni.muniName})"
                                rendered="true"
                                > 

                        <h:form id="case-blobs-start-form" enctype="multipart/form-data">
                            <h2>Photos/Docs related to this property (10 max)</h2>
                            <p>Allowed file types: pdf, jpeg, png, gif</p>

                            <p:fileUpload 
                                mode="advanced" 
                                update="prop-blobs-form:prop-blobs-table"
                                listener="#{propertySearchBB.onBlobUploadCommitButtonChange}"
                                multiple="true"
                                fileLimit="100"
                                sizeLimit="99999999999" 
                                allowTypes="/(\.|\/)(jpe?g|JPG|JPE?G|png|PNG|pdf|PDF)$/"
                                rendered="true"
                                oncomplete="PF('prop-blobs-dialog-var').hide()"/>    
                        </h:form>


                    </p:dialog>


                    <p:dialog   id="blob-edit-dialog"
                                height="600" width="800"
                                widgetVar="blob-edit-dialog-var"
                                responsive="true"
                                modal="true"
                                resizable="true"
                                closable="true"
                                closeOnEscape="true"
                                header="Edit photo/document (LinkID: #{propertySearchBB.currentBlob.photoDocID})"
                                rendered="true"
                                > 

                        <h:form id="blob-edit-form" >
                            
                            
                                <div class="ui-g data_container_nested_restrict">
                                    

                                    <div class="ui-g-12 ui-md-12 ui-lg-12 restrict-data-field">
                                        <div class="restrict-main-contents-io-title" >
                                            <h:outputLabel for="blob-edit-title-it">
                                                <h:outputText value="Title"/>
                                            </h:outputLabel>
                                        </div>

                                        <div class="restrict-main-contents-io-content" >
                                            <p:inputText  id="blob-edit-title-it" 
                                                          value="#{propertySearchBB.currentBlob.title}" 
                                                          tabindex="1" 
                                                          required="false" />
                                        </div>
                                    </div>
                                    <div class="ui-g-12 ui-md-12 ui-lg-12 restrict-data-field">
                                        <div class="restrict-main-contents-io-title" >
                                            <h:outputLabel for="blob-edit-descr-it">
                                                <h:outputText value="Description"/>
                                            </h:outputLabel>
                                        </div>

                                        <div class="restrict-main-contents-io-content" >
                                            <p:inputText  id="blob-edit-descr-it" 
                                                          value="#{propertySearchBB.currentBlob.description}" 
                                                          tabindex="2" 
                                                          required="false" />
                                        </div>
                                    </div>

                                    <div class="ui-g-12 ui-md-12 ui-lg-12 restrict-data-field">
                                        
                                        <p:commandButton    id="blob-edit-commit-cb"
                                                            ajax="true" 
                                                            actionListener="#{propertySearchBB.onBlobUpdateMetadata}"
                                                            oncomplete="PF('blob-edit-dialog-var').hide()"
                                                            value="Save changes"  
                                                            tabindex="3"
                                                            styleClass="inline-button"
                                                            icon="fa fa-floppy-o"
                                                            update="prop-blobs-form:prop-blobs-table
                                                            form-messages-global"/>
                                        
                                    </div>

                                </div>
                            
                            
                        </h:form>
                           

                    </p:dialog>
                    
                    

                    <p:dialog   id="blob-remove-dialog"
                                height="400" width="600"
                                widgetVar="blob-remove-dialog-var"
                                responsive="true"
                                modal="true"
                                resizable="true"
                                closable="true"
                                closeOnEscape="true"
                                header="Remove photo or document"
                                > 

                        <h:form id="blob-remove-form">

                            <div class="ui-g data_container_nested_restrict">
                                <div class="ui-g-12 ui-md-6 ui-lg-4 restrict-data-field" >
                                    <div class="restrict-data-field-label-inline" >

                                        <h:outputLabel  for="blob-remove-button">
                                            <h:outputText value="This operation removes the link between this blob and this property; the file remains in the DB" />
                                        </h:outputLabel>
                                    </div>
                                </div>
                                <div class="ui-g-12 ui-md-6 ui-lg-4 restrict-data-field" >

                                    <div class="restrict-main-contents-io-button red_button">
                                        <p:commandButton 
                                            id="blob-remove-button"
                                            icon="fa fa-trash"
                                            ajax="true"
                                            actionListener="#{propertySearchBB.onBlobRemoveCommitButtonChange}"
                                            value="Remove Photo/Doc ID:#{propertySearchBB.currentBlob.photoDocID}"
                                            update="prop-blobs-form:prop-blobs-table
                                                            form-messages-global"
                                            oncomplete="PF('blob-remove-dialog-var).hide();"
                                            />
                                    </div>
                                    <div class="restrict-main-contents-io-button gray_button">
                                        <p:commandButton    id="blob-remove-cancel-button"
                                                            ajax="true"  
                                                            tabindex="27"
                                                            value="Cancel"
                                                            icon="fa fa-stop"
                                                            immediate="true"
                                                            process="@none"
                                                            onclick="PF('blob-remove-dialog-var').hide()"
                                                            />
                                    </div>
                                </div>
                            </div>
                        </h:form>
                    </p:dialog>

                    
                    <p:dialog id="prop-addupdate-dialog"
                              header="#{propertySearchBB.currentProperty.propertyID == 0 ? 'New property record':propertySearchBB.currentProperty.address}"
                              modal="true"
                              height="800" 
                              width="550"
                              widgetVar="prop-addupdate-dialog-var"
                              closable="true"
                              rendered="#{systemServicesBB.bbSessionUser.keyCard.hasMuniStaffPermissions}"
                              >

                        <h:form id="prop-addupdate-form">


                            <div class="object-metadata">
                                <h:outputText value="ID: #{propertySearchBB.currentProperty.propertyID} "/>
                                <h:outputText value="Created: #{propertySearchBB.getPrettyDate(propertySearchBB.currentProperty.creationTS)} "/>
                                <h:outputText value="Last udpated:#{propertySearchBB.getPrettyDate(propertySearchBB.currentProperty.lastUpdatedTS)}" />

                            </div>
                                            


                            <p:commandButton    id="prop-add-addnew-commit-button-1"
                                                icon="fa fa-plus"
                                                ajax="false"
                                                action="#{propertySearchBB.onPropertyAddCommit}"
                                                value="Create record"
                                                rendered="#{propertySearchBB.currentProperty.propertyID == 0}"
                                                />

                            <p:commandButton    id="prop-add-update-commit-button-1"
                                                icon="fa fa-edit"
                                                ajax="false"
                                                action="#{propertySearchBB.onPropertyUpdateCommit}"
                                                value="Save updates"
                                                rendered="#{propertySearchBB.currentProperty.propertyID != 0}"
                                                />
                            <div class="restrict-main-contents-io-button gray_button">
                                
                                <p:commandButton    id="prop-add-discard-button-1"
                                                    icon="fa fa-trash-o"
                                                    ajax="false"
                                                    action="#{propertySearchBB.onDiscardNewPropertyDataButtonChange}"
                                                    value="Discard new record"
                                                    rendered="#{propertySearchBB.currentProperty.propertyID == 0}"
                                                    />
                            </div>

                            <div    id="prop-add-container-div"
                                    class="ui-g data-container">

                                <div    id="prop-add-muni-div"
                                        class="ui-g-12 ui-md-12 ui-lg-12 data_field">

                                    <p:outputLabel  value="Municipality"
                                                    for="prop-add-muni-som"/>

                                    <h:selectOneMenu id="prop-add-muni-som"
                                                     value="#{propertySearchBB.currentProperty.muni}" style="width:175px;height:25px">
                                        <f:converter converterId="muniConverter"/>
                                        <f:selectItems id="propinfoedit-muninamelist"
                                                       value="#{sessionBean.sessUser.authMuniList}"
                                                       var="m" itemValue="#{m}" itemLabel="#{m.muniName}"/>

                                    </h:selectOneMenu>
                                </div>
                                <div    id="prop-add-address-div"
                                        class="ui-g-12 ui-md-12 ui-lg-12 data_field">
                                    <p:outputLabel value="Street Address"/>
                                    <p:spacer width="3px"/>
                                    <p:inputText    id="prop-add-address-it"
                                                    value="#{propertySearchBB.currentProperty.address}"
                                                    />
                                </div>

                                <div    id="prop-add-cit-div"
                                        class="ui-g-12 ui-md-12 ui-lg-12 data_field">
                                    <p:outputLabel      id="prop-add-cit-ol"
                                                        value="City"
                                                        for="prop-add-cit-it"
                                                        styleClass="data_field_label"/>

                                    <p:inputText    id="prop-add-cit-it"
                                                    value="#{propertySearchBB.currentProperty.address_city}"
                                                    />

                                </div>

                                <div    id="prop-add-state-div"
                                        class="ui-g-12 ui-md-12 ui-lg-12 data_field">

                                    <p:outputLabel value="State"
                                                   for="prop-add-state-it"
                                                   />

                                    <p:inputText    id="prop-add-state-it"
                                                    value="#{propertySearchBB.currentProperty.address_state}"
                                                    />

                                </div>

                                <div    id="prop-add-zip-div"
                                        class="ui-g-12 ui-md-12 ui-lg-12 data_field">

                                    <p:outputLabel value="Zip Code"
                                                   for="prop-add-zip-it"
                                                   />

                                    <p:inputText    id="prop-add-zip-it"
                                                    value="#{propertySearchBB.currentProperty.address_zip}"
                                                    />
                                </div>


                                <div    id="prop-add-lab-div"
                                        class="ui-g-12 ui-md-12 ui-lg-12 data_field">

                                    <p:outputLabel  value="Lot and Block"
                                                    for="prop-add-lab-it"/>

                                    <p:inputText    id="prop-add-lab-it"
                                                    value="#{propertySearchBB.currentProperty.lotAndBlock}"
                                                    />

                                </div>

                                <div    id="prop-add-parid-div"
                                        class="ui-g-12 ui-md-12 ui-lg-12 data_field">

                                    <p:outputLabel value="ParcelID"
                                                   for="prop-add-parid-it"/>

                                    <p:inputText    id="prop-add-parid-it"
                                                    value="#{propertySearchBB.currentProperty.parID}"/>
                                </div>

                                <div    id="prop-add-usegroup-div"
                                        class="ui-g-12 ui-md-12 ui-lg-12 data_field">

                                    <p:outputLabel value="Use Group"
                                                   for="prop-add-usegroup-it"/>

                                    <p:inputText    id="prop-add-usegroup-it"
                                                    value="#{propertySearchBB.currentProperty.useGroup}"/>
                                </div>


                                <div    id="prop-add-const-div"
                                        class="ui-g-12 ui-md-12 ui-lg-12 data_field">

                                    <p:outputLabel value="Construction type"
                                                   for="prop-add-const-it"/>

                                    <p:inputText    id="prop-add-const-it"
                                                    value="#{propertySearchBB.currentProperty.constructionType}"/>
                                </div>


                                <ui:remove>


                                    <div    id="prop-add-cond-div"
                                            class="ui-g-12 ui-md-12 ui-lg-12 data_field">

                                        <p:outputLabel  value="Condition"
                                                        for="prop-add-condition-som"/>

                                        <h:selectOneMenu id="prop-add-condition-som"
                                                         value="#{propertySearchBB.currentProperty.condition}" style="width:175px;height:25px">
                                            <f:converter converterId="intensityClassConverter"/>
                                            <f:selectItem itemLabel="select a muni..." noSelectionOption="true" />
                                            <f:selectItems id="propinfoedit-condition-selitems"
                                                           value="#{propertySearchBB.conditionIntensityList}"
                                                           var="ic" itemValue="#{ic}" itemLabel="#{ic.numericRating}: #{ic.title}"/>

                                        </h:selectOneMenu>
                                    </div>

                                    <div    id="prop-add-landprospect-div"
                                            class="ui-g-12 ui-md-12 ui-lg-12 data_field">

                                        <p:outputLabel  value="Land Bank Prospect"
                                                        for="prop-add-landprospect-som"/>

                                        <h:selectOneMenu id="prop-add-landprospect-som"
                                                         value="#{propertySearchBB.currentProperty.landBankProspect}" style="width:175px;height:25px">
                                            <f:converter converterId="intensityClassConverter"/>
                                            <f:selectItem itemLabel="select a muni..." noSelectionOption="true" />
                                            <f:selectItems id="propinfoedit-landprospect-selitems"
                                                           value="#{propertySearchBB.landBankProspectIntensityList}"
                                                           var="ic" itemValue="#{ic}" itemLabel="#{ic.numericRating}: #{ic.title}"/>

                                        </h:selectOneMenu>
                                    </div>

                                    <div    id="prop-add-source-div"
                                            class="ui-g-12 ui-md-12 ui-lg-12 data_field">

                                        <p:outputLabel  value="Object Source"
                                                        for="prop-add-source-som"/>

                                        <h:selectOneMenu id="prop-add-source-som"
                                                         value="#{propertySearchBB.currentProperty.bobSource}" style="width:175px;height:25px">
                                            <f:converter converterId="bobSourceConverter"/>
                                            <f:selectItem itemLabel="select a source..." noSelectionOption="true" />
                                            <f:selectItems id="propinfoedit-sourcess-elitems"
                                                           value="#{propertySearchBB.sourceList}"
                                                           var="bs" itemValue="#{bs}" itemLabel="#{bs.title}"/>

                                        </h:selectOneMenu>
                                    </div>

                                </ui:remove>

                                <div    id="prop-add-unfit-div"
                                        class="ui-g-12 ui-md-12 ui-lg-12 data_field">

                                    <p:outputLabel value="Unfit Start Date"
                                                   for="prop-add-unfit-start-cal"/>

                                    <p:calendar id="prop-add-unfit-start-cal"
                                                value="#{propertySearchBB.currentProperty.unfitDateUtilStart}"
                                                mode="popup"
                                                pattern="EEE, dd MMM, yyyy HH:mm:ss"
                                                navigator="true"
                                                tabindex="16"
                                                timeInput="true"
                                                showHour="true" showMinute="false" showSecond="false" showMillisec="false"
                                                showButtonPanel="true"
                                                showTodayButton="true"
                                                maxdate="#{propertySearchBB.currentProperty.unfitDateUtilStop}">
                                    </p:calendar>
                                </div>

                                <div    id="prop-add-unfit-div"
                                        class="ui-g-12 ui-md-12 ui-lg-12 data_field">

                                    <p:outputLabel value="Unfit End Date"
                                                   for="prop-add-unfit-end-cal"/>
                                    <p:spacer height="3px"/>
                                    <p:calendar id="prop-add-unfit-end-cal"
                                                value="#{propertySearchBB.currentProperty.unfitDateUtilStop}"
                                                mode="popup"
                                                pattern="EEE, dd MMM, yyyy HH:mm:ss"
                                                navigator="true"
                                                tabindex="16"
                                                timeInput="true"
                                                showHour="true" showMinute="false" showSecond="false" showMillisec="false"
                                                showButtonPanel="true"
                                                showTodayButton="true"
                                                mindate="#{propertySearchBB.currentProperty.unfitDateUtilStart}">
                                    </p:calendar>

                                </div>

                                <div    id="prop-add-vacant-div"
                                        class="ui-g-12 ui-md-12 ui-lg-12 data_field">

                                    <p:outputLabel  value="Vacant Start Date"
                                                    for="prop-add-vacant-start-cal"/>

                                    <p:calendar id="prop-add-vacant-start-cal"
                                                value="#{propertySearchBB.currentProperty.vacantDateUtilStart}"
                                                mode="popup"
                                                pattern="EEE, dd MMM, yyyy HH:mm:ss"
                                                navigator="true"
                                                tabindex="16"
                                                timeInput="true"
                                                showHour="true" showMinute="false" showSecond="false" showMillisec="false"
                                                showButtonPanel="true"
                                                showTodayButton="true"
                                                maxdate="#{propertySearchBB.currentProperty.vacantDateUtilStop}">
                                    </p:calendar>
                                </div>

                                <div    id="prop-add-vacant-stop-div"
                                        class="ui-g-12 ui-md-12 ui-lg-12 data_field">

                                    <p:outputLabel value="Vacant Stop Date"
                                                   for="prop-add-vacant-stop-cal"/>

                                    <p:calendar id="prop-add-vacant-stop-cal"
                                                value="#{propertySearchBB.currentProperty.vacantDateUtilStop}"
                                                mode="popup"
                                                pattern="EEE, dd MMM, yyyy HH:mm:ss"
                                                navigator="true"
                                                tabindex="16"
                                                timeInput="true"
                                                showHour="true" showMinute="false" showSecond="false" showMillisec="false"
                                                showButtonPanel="true"
                                                showTodayButton="true"
                                                mindate="#{propertySearchBB.currentProperty.vacantDateUtilStart}">
                                    </p:calendar>
                                </div>

                                <div    id="prop-add-abandoned-div"
                                        class="ui-g-12 ui-md-12 ui-lg-12 data_field">

                                    <p:outputLabel value="Abandoned Start Date"
                                                   for="prop-add-abandoned-start-cal"/>

                                    <p:calendar id="prop-add-abandoned-start-cal"
                                                value="#{propertySearchBB.currentProperty.abandonedDateUtilStart}"
                                                mode="popup"
                                                pattern="EEE, dd MMM, yyyy HH:mm:ss"
                                                navigator="true"
                                                tabindex="16"
                                                timeInput="true"
                                                showHour="true" showMinute="false" showSecond="false" showMillisec="false"
                                                showButtonPanel="true"
                                                showTodayButton="true"
                                                maxdate="#{propertySearchBB.currentProperty.abandonedDateUtilStop}">
                                    </p:calendar>
                                </div>

                                <div    id="prop-add-abandoned-stop-div"
                                        class="ui-g-12 ui-md-12 ui-lg-12 data_field">

                                    <p:outputLabel value="Abandoned Stop Date"
                                                   for="prop-add-abandoned-stop-cal"/>

                                    <p:calendar id="prop-add-abandoned-stop-cal"
                                                value="#{propertySearchBB.currentProperty.abandonedDateUtilStop}"
                                                mode="popup"
                                                pattern="EEE, dd MMM, yyyy HH:mm:ss"
                                                navigator="true"
                                                tabindex="16"
                                                timeInput="true"
                                                showHour="true" showMinute="false" showSecond="false" showMillisec="false"
                                                showButtonPanel="true"
                                                showTodayButton="true"
                                                mindate="#{propertySearchBB.currentProperty.abandonedDateUtilStart}">
                                    </p:calendar>
                                </div>




                                <p:commandButton    id="prop-add-addnew-commit-button-2"
                                                    icon="fa fa-plus"
                                                    ajax="false"
                                                    action="#{propertySearchBB.onPropertyAddCommit}"
                                                    value="Save record"
                                                    rendered="#{propertySearchBB.currentProperty.propertyID == 0}"
                                                    />

                                <p:commandButton    id="prop-add-update-commit-button-2"
                                                    icon="fa fa-edit"
                                                    ajax="false"
                                                    action="#{propertySearchBB.onPropertyUpdateCommit}"
                                                    value="Save updates"
                                                    rendered="#{propertySearchBB.currentProperty.propertyID != 0}"
                                                    />
                                <div class="restrict-main-contents-io-button gray_button">
                                    
                                    <p:commandButton    id="prop-add-discard-button-2"
                                                        icon="fa fa-trash-o"
                                                        ajax="true"
                                                        action="#{propertySearchBB.onDiscardNewPropertyDataButtonChange}"
                                                        value="Discard new record"
                                                        rendered="#{propertySearchBB.currentProperty.propertyID == 0}"
                                                        />
                                </div>
                            </div>
                        </h:form>
                    </p:dialog>




                    <p:dialog id="prop-remove-dialog"
                              modal="true"
                              height="300" 
                              width="550"
                              widgetVar="prop-remove-dialog-var"
                              closable="true"
                              header="Remove property #{propertySearchBB.currentProperty.address}"
                              rendered="#{systemServicesBB.bbSessionUser.keyCard.hasEnfOfficialPermissions}"
                              >

                        <h:form id="propinfo-remove-form">

                            <p>Caution: This action is like 'delete'; we have to dig the record back out by
                                hand if you goof.</p>
                            <p:commandButton icon="fa fa-trash"
                                             ajax="false"
                                             action="#{propertySearchBB.onRemoveButtonChange()}"
                                             value="Permanently remove property ID:#{propertySearchBB.currentProperty.propertyID}"
                                             />

                        </h:form>
                    </p:dialog>


                    <p:dialog id="prop-persons-manage-dialog"
                              modal="true"
                              height="300" 
                              width="550"
                              widgetVar="prop-persons-manage-var"
                              closable="true"
                              header="Connect New Person"
                              rendered="#{systemServicesBB.bbSessionUser.keyCard.hasMuniReaderPermissions}"
                              >

                        <h:form id="prop-persons-messages-form">
                            <h:messages id="prop-persons-manage-form-messages"
                                        globalOnly="true" showDetail="true" showSummary="true"
                                        warnClass="msgWarn" infoClass="msgInfo" fatalClass="msgFatal" errorClass="msgError">
                            </h:messages>
                        </h:form>

                        <h:form id="prop-persons-manage-form">

                            <div    id="usercfg-add-container-div"
                                    class="ui-g data-container">

                                <div    id="prop-pers-personlink-chooselinkmethod-div"
                                        class="ui-g-12 ui-md-12 ui-lg-12 data_field">

                                    <p:outputLabel for="prop-pers-personlink-chooselinkmethod-sbb"
                                                   styleClass="data_field_label">
                                        <h:outputText value="Select a user-person selection method:"/>
                                    </p:outputLabel>
                                    <p:selectBooleanButton id="prop-pers-personlink-chooselinkmethod-sbb"
                                                           onLabel="Link from Person List" 
                                                           offLabel="Link by Manual Person ID Entry"
                                                           styleClass="selectButton" 
                                                           value="#{propertySearchBB.personLinkUseID}"
                                                           >
                                        <p:ajax update="prop-person-som-userpersons
                                                prop-person-addpersonbyid-it" />
                                    </p:selectBooleanButton>


                                </div>

                                <div    id="prop-pers-personlink-som-div"
                                        class="ui-g-12 ui-md-12 ui-lg-12 data_field">


                                    <p:outputLabel  for="prop-person-som-userpersons" 
                                                    value="Available User-type persons:"
                                                    styleClass="data_field_label"/>

                                    <p:selectOneMenu id="prop-person-som-userpersons" 
                                                     required="false" 
                                                     disabled="#{propertySearchBB.personLinkUseID}"
                                                     value="#{propertySearchBB.personSelected}"
                                                     styleClass="data_field_value">

                                        <f:selectItem itemLabel="select a person..." noSelectionOption="true" />

                                        <f:selectItems value="#{systemServicesBB.bbSessionPersonList}"  var="p" itemValue="#{p}" 
                                                       itemLabel="#{p.firstName} #{p.lastName} (id:#{p.personID})"/>

                                        <f:converter converterId="personConverter"/>
                                    </p:selectOneMenu>

                                    <h:message for="prop-person-som-userpersons" showDetail="false" showSummary="true" 
                                               warnClass="msgWarn" infoClass="msgInfo" fatalClass="msgFatal" errorClass="msgError" />
                                </div>


                                <div    id="prop-pers-personlink-byid-div"
                                        class="ui-g-12 ui-md-12 ui-lg-12 data_field">



                                    <p:outputLabel  for="prop-person-addpersonbyid-it" 
                                                    value="Add user by ID"
                                                    styleClass="data_field_label"/>

                                    <p:inputText id="prop-person-addpersonbyid-it" 
                                                 disabled="#{!propertySearchBB.personLinkUseID}"
                                                 value="#{propertySearchBB.personIDToLink}" 
                                                 style="width: 50px;" 
                                                 tabindex="3" 
                                                 type="number"
                                                 required="false" 
                                                 styleClass="inputText"/>

                                    <h:message for="prop-person-addpersonbyid-it" showDetail="false" showSummary="true" 
                                               warnClass="msgWarn" infoClass="msgInfo" fatalClass="msgFatal" errorClass="msgError" />

                                </div>
                            </div>

                            <p:spacer height="5px" />

                            <p:commandButton    id="prop-person-connect-abort"
                                                ajax="true" 
                                                tabindex="2"
                                                oncomplete="PF('prop-persons-manage-var').hide()"
                                                value="Cancel" 
                                                icon="fa fa-stop" 
                                                />

                            <p:commandButton ajax="false"
                                             id="prop-person-commitconnect" 
                                             value="Connect" 
                                             icon="fa fa-user-circle-o"
                                             rendered="#{systemServicesBB.bbSessionUser.keyCard.hasDeveloperPermissions}"
                                             disabled="false"
                                             action="#{propertySearchBB.onPersonConnectCommitButtonChange}"
                                             />



                        </h:form>
                    </p:dialog>

                    <p:dialog id="prop-search-advanced-dialog"
                              height="500" 
                              width="800"
                              modal="true"
                              widgetVar="prop-search-advanced-var"
                              closable="true"
                              header="Advanced Search Parameters">

                        <h:form id="prop-search-params-form-1">


                            <!-- NESTED DATA CONTAINER -->
                            <div class="ui-g data_container_nested_restrict">

                                <!--NESTED DATA FIELD -->
                                <div class="ui-g-12 ui-md-12 ui-lg-12 restrict-data-field">

                                    <!-- NESTED DATA TITLE -->
                                    <div class="restrict-main-contents-io-title" >

                                        <!-- NESTED DATA FILTER -->
                                        <div class="restrict-main-contents-io-filter">

                                            <p:selectBooleanCheckbox class="checkbox"
                                                                     id="prop-search-filter-addr-ctl"
                                                                     value="#{propertySearchBB.searchParamsSelected.address_ctl}" >
                                                <p:ajax update="prop-search-filter-addr-val"/>
                                            </p:selectBooleanCheckbox>

                                            <p:outputLabel for="prop-search-filter-addr-ctl" 
                                                           value="Filter by House Number / Street Name"
                                                           />

                                        </div>
                                    </div>

                                    <!-- NESTED DATA CONTENT -->
                                    <div class="restrict-main-contents-io-content" >

                                        <p:inputText id="prop-search-filter-addr-val"
                                                     value="#{propertySearchBB.searchParamsSelected.address_val}"
                                                     style="width:100%"
                                                     tabindex="2"
                                                     disabled="#{!propertySearchBB.searchParamsSelected.address_ctl}"
                                                     required="false"
                                                     styleClass="inputText search-inputtext"
                                                     />


                                    </div>


                                </div>


                                <!--NESTED DATA FIELD -->
                                <div class="ui-g-12 ui-md-12 ui-lg-12 restrict-data-field">

                                    <!-- NESTED DATA TITLE -->
                                    <div class="restrict-main-contents-io-title" >

                                        <!-- NESTED DATA FILTER -->
                                        <div class="restrict-main-contents-io-filter">

                                            <p:selectBooleanCheckbox class="checkbox"
                                                                     id="prop-search-muni-ctl"
                                                                     value="#{propertySearchBB.searchParamsSelected.muni_ctl}" >
                                                <p:ajax update="prop-search-muni-som"/>
                                            </p:selectBooleanCheckbox>

                                            <p:outputLabel for="prop-search-muni-ctl"
                                                           value="Filter by Municipality"
                                                           />

                                        </div>
                                    </div>

                                    <!-- NESTED DATA CONTENT -->
                                    <div class="restrict-main-contents-io-content" >

                                        <p:selectOneMenu id="prop-search-muni-som"
                                                         tabindex="1"
                                                         value="#{propertySearchBB.searchParamsSelected.muni_val}"
                                                         disabled="#{!propertySearchBB.searchParamsSelected.muni_ctl}"
                                                         style="width: 100%"
                                                         >
                                            <f:converter converterId="muniConverter"/>

                                            <f:selectItem itemLabel="select municipality..."
                                                          noSelectionOption="true"
                                                          itemDisabled="true"/>

                                            <f:selectItems id="muniNameList"
                                                           value="#{systemServicesBB.bbSessionUser.authMuniList}"
                                                           var="m" 
                                                           itemValue="#{m}" 
                                                           itemLabel="#{m.muniName}" />

                                        </p:selectOneMenu>

                                    </div>

                                </div>


                                <!--NESTED DATA FIELD -->
                                <div class="ui-g-12 ui-md-12 ui-lg-12 restrict-data-field">

                                    <!-- NESTED DATA TITLE -->
                                    <div class="restrict-main-contents-io-title" >

                                        <!-- NESTED DATA FILTER -->
                                        <div class="restrict-main-contents-io-filter">

                                            <p:selectBooleanCheckbox class="checkbox"
                                                                     id="prop-search-filter-id-ctl"
                                                                     value="#{propertySearchBB.searchParamsSelected.bobID_ctl}"
                                                                     disabled="false">
                                                <p:ajax update="prop-search-filter-id-val" />
                                            </p:selectBooleanCheckbox>
                                            <p:outputLabel for="prop-search-filter-id-ctl"
                                                           value="Filter by Property ID"/>

                                        </div>
                                    </div>

                                    <!-- NESTED DATA CONTENT -->
                                    <div class="restrict-main-contents-io-content" >
                                        <p:inputText id="prop-search-filter-id-val"
                                                     type="number"
                                                     value="#{propertySearchBB.searchParamsSelected.bobID_val}"
                                                     disabled="#{!propertySearchBB.searchParamsSelected.bobID_ctl}"
                                                     />

                                    </div>

                                </div>


                                <!--NESTED DATA FIELD -->
                                <div class="ui-g-12 ui-md-12 ui-lg-12 restrict-data-field">

                                    <!-- NESTED DATA TITLE -->
                                    <div class="restrict-main-contents-io-title" >

                                        <!-- NESTED DATA FILTER -->
                                        <div class="restrict-main-contents-io-filter">
                                            <p:selectBooleanCheckbox class="checkbox"
                                                                     id="prop-search-filter-parcelid-ctl"
                                                                     value="#{propertySearchBB.searchParamsSelected.parcelid_ctl}"
                                                                     disabled="false">
                                                <p:ajax update="prop-search-filter-parcelid-val" />
                                            </p:selectBooleanCheckbox>

                                            <p:outputLabel for="prop-search-filter-id-ctl"
                                                           value="Filter by Parcel ID"/>
                                        </div>
                                    </div>

                                    <!-- NESTED DATA CONTENT -->
                                    <div class="restrict-main-contents-io-content" >
                                        <p:inputText id="prop-search-filter-parcelid-val"
                                                     type="number"
                                                     value="#{propertySearchBB.searchParamsSelected.parcelid_val}"
                                                     disabled="#{!propertySearchBB.searchParamsSelected.parcelid_ctl}"
                                                     />

                                    </div>

                                </div>


                                <!--NESTED DATA FIELD -->
                                <div class="ui-g-12 ui-md-12 ui-lg-12 restrict-data-field">

                                    <!-- NESTED DATA TITLE -->
                                    <div class="restrict-main-contents-io-title" >

                                        <!-- NESTED DATA FILTER -->
                                        <div class="restrict-main-contents-io-filter">

                                            <p:selectBooleanCheckbox class="checkbox"
                                                                     id="prop-search-filter-usetype-ctl"
                                                                     value="#{propertySearchBB.searchParamsSelected.useType_ctl}"
                                                                     disabled="false">
                                                <p:ajax update="prop-search-filter-usetype-val" />
                                            </p:selectBooleanCheckbox>

                                            <p:outputLabel for="prop-search-filter-usetype-ctl"
                                                           value="Filter by Use Type"/>

                                        </div>
                                    </div>

                                    <!-- NESTED DATA CONTENT -->
                                    <div class="restrict-main-contents-io-content" >
                                        <p:selectOneMenu    id="prop-search-filter-usetype-val"
                                                            tabindex="1"
                                                            style="width: 100%"
                                                            value="#{propertySearchBB.searchParamsSelected.useType_val}"
                                                            disabled="#{!propertySearchBB.searchParamsSelected.useType_ctl}">
                                            <f:converter    converterId="propertyUseTypeConverter"/>
                                            <f:selectItem   itemLabel="select a use type..." noSelectionOption="true" itemDisabled="true"/>
                                            <f:selectItems  id="prop-search-filter-usetype-items"
                                                            value="#{propertySearchBB.putList}"
                                                            var="put" itemValue="#{put}" itemLabel="#{put.name}" />
                                        </p:selectOneMenu>

                                    </div>

                                </div>


                                <!--NESTED DATA FIELD -->
                                <div class="ui-g-12 ui-md-12 ui-lg-12 restrict-data-field">

                                    <!-- NESTED DATA TITLE -->
                                    <div class="restrict-main-contents-io-title" >

                                        <!-- NESTED DATA FILTER -->
                                        <div class="restrict-main-contents-io-filter">

                                            <p:selectBooleanCheckbox class="checkbox"
                                                                     id="prop-search-filter-user-ctl"
                                                                     value="#{propertySearchBB.searchParamsSelected.user_ctl}"
                                                                     disabled="#{!(propertySearchBB.searchParamsSelected.user_rtMin.rank lt systemServicesBB.bbSessionUser.keyCard.governingAuthPeriod.role.rank)}">
                                                <p:ajax update="prop-search-filter-user-som" />
                                            </p:selectBooleanCheckbox>

                                            <p:outputLabel for="prop-search-filter-user-ctl"
                                                           value="Filter by User"/>

                                        </div>
                                    </div>

                                    <!-- NESTED DATA CONTENT -->
                                    <div class="restrict-main-contents-io-content" >
                                        <p:selectOneMenu id="prop-search-filter-user-som"
                                                         style="width: 100%"
                                                         required="false"
                                                         value="#{propertySearchBB.searchParamsSelected.user_val}"
                                                         disabled="#{!(propertySearchBB.searchParamsSelected.user_rtMin.rank lt systemServicesBB.bbSessionUser.keyCard.governingAuthPeriod.role.rank)}">
                                            <f:selectItem itemLabel="select a user..." noSelectionOption="true" />
                                            <f:selectItems value="#{systemServicesBB.userListForSearch}"  var="u" itemValue="#{u}"
                                                           itemLabel="#{u.human.firstName} #{u.human.lastName} (id:#{u.username})"/>
                                            <f:converter converterId="userConverter"/>
                                        </p:selectOneMenu>
                                    </div>

                                </div>


                                <!--NESTED DATA FIELD -->
                                <div class="ui-g-12 ui-md-4 ui-lg-4 restrict-data-field">

                                    <!-- NESTED DATA TITLE -->
                                    <div class="restrict-main-contents-io-title" >

                                        <!-- NESTED DATA FILTER -->
                                        <div class="restrict-main-contents-io-filter">

                                            <p:selectBooleanCheckbox class="checkbox"
                                                                     id="prop-search-date-ctl"
                                                                     value="#{propertySearchBB.searchParamsSelected.date_startEnd_ctl}" >
                                                <p:ajax update="prop-search-date-field-val
                                                        prop-search-date-start-val
                                                        prop-search-date-end-val
                                                        prop-search-date-relative-ctl" />
                                            </p:selectBooleanCheckbox>

                                            <p:outputLabel for="prop-search-date-ctl"
                                                           value="Filter by Date Range"
                                                           />

                                        </div>
                                    </div>

                                    <!-- NESTED DATA CONTENT -->
                                    <div class="restrict-main-contents-io-content" >
                                        <p:selectOneMenu  id="prop-search-date-field-val"
                                                          tabindex="1"
                                                          style="width: 100%"
                                                          value="#{propertySearchBB.searchParamsSelected.date_field}"
                                                          disabled="#{!propertySearchBB.searchParamsSelected.date_startEnd_ctl}">
                                            <f:selectItem itemLabel="select a date field..."
                                                          noSelectionOption="true"
                                                          itemDisabled="true"/>
                                            <f:selectItems id="prop-search-date-field-val-items"
                                                           value="#{propertySearchBB.searchParamsSelected.dateFieldList}"
                                                           var="f" itemValue="#{f}" itemLabel="#{f.title}" />
                                        </p:selectOneMenu>
                                    </div>

                                </div>

                                <!--NESTED DATA FIELD -->
                                <div class="ui-g-12 ui-md-4 ui-lg-4 restrict-data-field">

                                    <!-- NESTED DATA TITLE -->
                                    <div class="restrict-main-contents-io-title" >

                                        <!-- NESTED DATA FILTER -->
                                        <div class="restrict-main-contents-io-filter">
                                            <p:outputLabel for="prop-search-date-start-val"
                                                           value="Start Date"/>

                                        </div>
                                    </div>

                                    <!-- NESTED DATA CONTENT -->
                                    <div class="restrict-main-contents-io-content" >
                                        <p:calendar id="prop-search-date-start-val"
                                                    value="#{propertySearchBB.searchParamsSelected.startDate_val_utilDate}"
                                                    disabled="#{(!propertySearchBB.searchParamsSelected.date_startEnd_ctl) or propertySearchBB.searchParamsSelected.date_relativeDates_ctl}"
                                                    mode="popup"
                                                    showOn="button"
                                                    pattern="EEE, dd MMM, yyyy HH:mm:ss"
                                                    navigator="true"
                                                    tabindex="16"
                                                    timeInput="true"
                                                    showHour="true" showMinute="false" showSecond="false" showMillisec="false"
                                                    showButtonPanel="true"
                                                    showTodayButton="true"
                                                    required="false"
                                                    style="width: 100%"/>

                                    </div>

                                </div>


                                <!--NESTED DATA FIELD -->
                                <div class="ui-g-12 ui-md-4 ui-lg-4 restrict-data-field">

                                    <!-- NESTED DATA TITLE -->
                                    <div class="restrict-main-contents-io-title" >

                                        <!-- NESTED DATA FILTER -->
                                        <div class="restrict-main-contents-io-filter">
                                            <p:outputLabel for="prop-search-date-end-val"
                                                           value="End Date"/>

                                        </div>
                                    </div>

                                    <!-- NESTED DATA CONTENT -->
                                    <div class="restrict-main-contents-io-content" >
                                        <p:calendar id="prop-search-date-end-val"
                                                    value="#{propertySearchBB.searchParamsSelected.endDate_val_utilDate}"
                                                    disabled="#{(!propertySearchBB.searchParamsSelected.date_startEnd_ctl) or propertySearchBB.searchParamsSelected.date_relativeDates_ctl}"
                                                    mode="popup"
                                                    showOn="button"
                                                    pattern="EEE, dd MMM, yyyy HH:mm:ss"
                                                    navigator="true"
                                                    tabindex="16"
                                                    timeInput="true"
                                                    showHour="true" showMinute="false" showSecond="false" showMillisec="false"
                                                    showButtonPanel="true"
                                                    showTodayButton="true"
                                                    required="false"
                                                    style="width: 100%"/>
                                    </div>

                                </div>


                                <!--NESTED DATA FIELD -->
                                <div class="ui-g-12 ui-md-4 ui-lg-4 restrict-data-field">

                                    <!-- NESTED DATA TITLE -->
                                    <div class="restrict-main-contents-io-title" >

                                        <!-- NESTED DATA FILTER -->
                                        <div class="restrict-main-contents-io-filter">

                                            <p:selectBooleanCheckbox class="checkbox"
                                                                     id="prop-search-date-relative-ctl"
                                                                     value="#{propertySearchBB.searchParamsSelected.date_relativeDates_ctl}"
                                                                     disabled="#{!propertySearchBB.searchParamsSelected.date_startEnd_ctl}">
                                                <p:ajax update="prop-search-date-end-val
                                                        prop-search-date-start-val
                                                        prop-search-date-end-val
                                                        prop-search-date-relative-start-val
                                                        prop-search-date-relative-end-val" />
                                            </p:selectBooleanCheckbox>

                                            <p:outputLabel for="prop-search-date-relative-ctl"
                                                           value="Filter by Relative Date"
                                                           />

                                        </div>
                                    </div>

                                    <!-- NESTED DATA CONTENT -->
                                    <div class="restrict-main-contents-io-content" >
                                        -
                                    </div>

                                </div>


                                <!--NESTED DATA FIELD -->
                                <div class="ui-g-12 ui-md-4 ui-lg-4 restrict-data-field">

                                    <!-- NESTED DATA TITLE -->
                                    <div class="restrict-main-contents-io-title" >

                                        <!-- NESTED DATA FILTER -->
                                        <div class="restrict-main-contents-io-filter">
                                            <p:outputLabel for="prop-search-date-relative-start-val"
                                                           value="Start Date"
                                                           />
                                        </div>
                                    </div>

                                    <!-- NESTED DATA CONTENT -->
                                    <div class="restrict-main-contents-io-content" >

                                        <p:inputText id="prop-search-date-relative-start-val"
                                                     value="#{propertySearchBB.searchParamsSelected.date_relativeDates_start_val}"
                                                     disabled="#{!(propertySearchBB.searchParamsSelected.date_startEnd_ctl and propertySearchBB.searchParamsSelected.date_relativeDates_ctl)}" />
                                    </div>

                                </div>


                                <!--NESTED DATA FIELD -->
                                <div class="ui-g-12 ui-md-4 ui-lg-4 restrict-data-field">

                                    <!-- NESTED DATA TITLE -->
                                    <div class="restrict-main-contents-io-title" >

                                        <!-- NESTED DATA FILTER -->
                                        <div class="restrict-main-contents-io-filter">
                                            <p:outputLabel for="prop-search-date-relative-end-val"
                                                           value="End Date"
                                                           />
                                        </div>
                                    </div>

                                    <!-- NESTED DATA CONTENT -->
                                    <div class="restrict-main-contents-io-content" >

                                        <p:inputText id="prop-search-date-relative-end-val"
                                                     value="#{propertySearchBB.searchParamsSelected.date_realtiveDates_end_val}"
                                                     disabled="#{!(propertySearchBB.searchParamsSelected.date_startEnd_ctl and propertySearchBB.searchParamsSelected.date_relativeDates_ctl)}" />
                                    </div>

                                </div>


                                <!--NESTED DATA FIELD -->
                                <div class="ui-g-12 ui-md-12 ui-lg-12 restrict-data-field">

                                    <!-- NESTED DATA TITLE -->
                                    <div class="restrict-main-contents-io-title" >

                                        <!-- NESTED DATA FILTER -->
                                        <div class="restrict-main-contents-io-filter">

                                            <p:selectBooleanCheckbox class="checkbox"
                                                                     id="prop-search-appendresults-chkbox"
                                                                     value="#{propertySearchBB.appendResultsToList}"
                                                                     disabled="false" />

                                            <p:outputLabel for="prop-search-filter-user-ctl"
                                                           value="Append results to list? "/>

                                        </div>
                                    </div>

                                </div>

                                <!--NESTED DATA FIELD -->
                                <div class="ui-g-12 ui-md-6 ui-lg-6 restrict-data-field">

                                    <div class="restrict-main-contents-io-button" style="float: left">
                                        <p:commandButton id="prop-search-exec-cb"
                                                         ajax="true"
                                                         actionListener="#{propertySearchBB.executeQuery}"
                                                         icon="fa fa-search"
                                                         style="width: 100%"
                                                         value="Search"
                                                         disabled="#{propertySearchBB.querySelected.queryExecuted}"
                                                         update=" prop-search-messages-form
                                                         prop-search-results-form
                                                         prop-search-log-form
                                                         prop-search-exec-cb
                                                         prop-search-clear-cb"/>

                                    </div>
                                    <div class="restrict-main-contents-io-button gray_button" style="float: left">
                                        <p:commandButton id="prop-search-clear-cb"
                                                         ajax="true"
                                                         actionListener="#{propertySearchBB.resetQuery}"
                                                         icon="fa fa-eraser"
                                                         style="width: 100%"
                                                         value="Clear search"
                                                         disabled="#{!propertySearchBB.querySelected.queryExecuted}"
                                                         update=" prop-search-messages-form
                                                         prop-search-log-form
                                                         @form
                                                         prop-search-query-form"/>

                                    </div>

                                </div>

                                <!--NESTED DATA FIELD -->
                                <div class="ui-g-12 ui-md-6 ui-lg-6 restrict-data-field">

                                    <div class="restrict-main-contents-io-button">
                                        <p:commandButton id="prop-search-exec-cb-2"
                                                         ajax="true"
                                                         actionListener="#{propertySearchBB.executeQuery}"
                                                         icon="fa fa-search"
                                                         style="width: 100%"
                                                         value="Search"
                                                         oncomplete="PF('prop-search-advanced-var').hide()"
                                                         disabled="#{propertySearchBB.querySelected.queryExecuted}"
                                                         update=" prop-search-messages-form
                                                         prop-search-results-form
                                                         prop-search-log-form
                                                         prop-search-exec-cb
                                                         prop-search-clear-cb"/>



                                    </div>
                                    <div class="restrict-main-contents-io-button gray_button">
                                        <p:commandButton ajax="true"
                                                         value="Cancel" 
                                                         icon="fa fa-stop"
                                                         style="width: 100%"
                                                         onclick="PF('prop-search-advanced-var').hide()"
                                                         tabindex="4"/>

                                    </div>

                                </div>
                            </div>
                        </h:form>
                    </p:dialog>

                    <p:dialog    id="prop-addperiod-dialog"
                                 height="400" width="600"
                                 widgetVar="prop-addperiod-dialog-var"
                                 closable="true"
                                 header="Add New Occupancy Period">


                        <h:form id="dialog-addoccperiod-form">
                            <h:messages id="prop-occperiods-addop-messages"
                                        globalOnly="true" showDetail="true" showSummary="true"
                                        warnClass="msgWarn" infoClass="msgInfo" fatalClass="msgFatal" errorClass="msgError">
                            </h:messages>


                            <h:outputLabel styleClass="ui-label" for="som-occperiodtype" value="Occupancy type" />

                            <p:selectOneMenu
                                id="som-occperiodtype" tabindex="1" required="true"
                                value="#{propertyOccPeriodsBB.selectedOccPeriodType}">
                                <f:converter converterId="occPeriodTypeConverter"/>
                                <f:selectItem itemLabel="Select a period type..." itemDisabled="true" noSelectionOption="true"/>
                                <f:selectItems id="si-typelist"
                                               value="#{propertyOccPeriodsBB.occPeriodTypeList}"
                                               var ="opt"
                                               itemValue="#{opt}"
                                               itemLabel="#{opt.title}" />
                            </p:selectOneMenu>

                            <p:spacer height="5px" />

                            <p:commandButton ajax="true"
                                             value="Cancel" icon="fa fa-stop"
                                             onclick="PF('dialog-addoccperiod-var').hide()"
                                             tabindex="4"/>


                            <p:commandButton ajax="false"
                                             action="#{propertyOccPeriodsBB.addNewOccPeriod}"
                                             icon="fa fa-plus-square"
                                             styleClass="inline-button"
                                             value="Create new period"
                                             tabindex="3"/>

                        </h:form>
                    </p:dialog>

                    <p:dialog   id="propinfo-notes-dialog"
                                height="300" width="750"
                                widgetVar="propinfo-notes-dialog-var"
                                closable="true"
                                header="Note Builder"
                                rendered="#{systemServicesBB.bbSessionUser.keyCard.hasMuniReaderPermissions}"
                                >

                        <h:form id="propinfo-note-create-form">

                            <h:messages id="propinfo-dialog-note-messages"
                                        globalOnly="true" showDetail="true" showSummary="true"
                                        warnClass="msgWarn" infoClass="msgInfo" fatalClass="msgFatal" errorClass="msgError">
                            </h:messages>

                            <h:panelGrid columns="1"
                                         columnClasses="gridTd, gridTd">

                                <h:panelGroup>
                                    <h:outputText styleClass="ui-label" value="Note text: "/>
                                    <p:textEditor   id="propinfo-notes-editor"
                                                value="#{propertySearchBB.formNoteText}"
                                                secure="false"
                                                required="false"
                                                height="200"/>


                                    <p:spacer height="5px" />
                                    <p:commandButton    id="propinfo-updatemetadata-button-cancel"
                                                        ajax="true"  tabindex="27"
                                                        value="Cancel"
                                                        icon="fa fa-stop"
                                                        immediate="true"
                                                        onclick="PF('propinfo-notes-dialog-var').hide()"
                                                        />

                                    <p:commandButton   id="propinfo-dialog-notes-button-addnote"
                                                       ajax="true" 
                                                       actionListener="#{propertySearchBB.onNoteCommitButtonChange}"
                                                       oncomplete="PF('propinfo-notes-dialog-var').hide()"
                                                       rendered="#{systemServicesBB.bbSessionUser.keyCard.hasMuniStaffPermissions}"                                                                               
                                                       value="Attach Note"  
                                                       styleClass="inline-button"
                                                       icon="fa fa-sticky-note-o"
                                                       update="propinfo-notes-form"/>
                                </h:panelGroup>
                            </h:panelGrid>
                        </h:form>
                    </p:dialog>

                </f:view>

                <script type="text/javascript">
                    $(function () {
                        $.extend(PF("datatable"), {
                            onKeyDown: function (e) {
                                var key = e.which,
                                        keyCode = $.ui.keyCode;
                                if ((key === keyCode.ENTER || key === keyCode.NUMPAD_ENTER)) {
                                    e.preventDefault();
                                }
                            },
                            onKeyUp: function (e, rowIndex) {
                                var key = e.which,
                                        keyCode = $.ui.keyCode;
                                //.ui-row-editor-check .ui-icon-check .ui-c
                                if ((key === keyCode.ENTER || key === keyCode.NUMPAD_ENTER)) {
                                    this.tbody
                                            .find('.ui-row-editor .ui-icon-check')
                                            .eq(rowIndex)
                                            .click();
                                }
                                if (key === keyCode.ESCAPE) {
                                    this.tbody
                                            .find('.ui-row-editor .ui-icon-close')
                                            .eq(rowIndex)
                                            .click();
                                }
                            }
                        });
                    });
                </script>
            </ui:define>
        </ui:composition>
    </h:body>
</html>

