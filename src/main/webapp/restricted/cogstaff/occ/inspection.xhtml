<?xml version="1.0" encoding="UTF-8"?>
<!--
Copyright (C) 2018 Adam Gutonski

This program is free software: you can redistribute it and/or modify
it under the terms of the GNU General Public License as published by
the Free Software Foundation, either version 3 of the License, or
(at your option) any later version.

This program is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
GNU General Public License for more details.

You should have received a copy of the GNU General Public License
along with this program.  If not, see <http://www.gnu.org/licenses/>.
-->
<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:f="http://xmlns.jcp.org/jsf/core"
      xmlns:p="http://primefaces.org/ui">
    <h:head>
        <link rel="stylesheet" type="text/css" href="css/style.css"></link>
        <title>Occupancy period</title>
    </h:head>
    <h:body>
        <ui:composition template="../../navContainer_restricted.xhtml">
            <ui:define name="content">
                <f:view id="view-inspections">
                    <div class="mainContainer">
                        <div class="two-column-page-flex-container">

                            <div class="list-column">

                                <h:form id="form-messages-global">

                                    <h:messages id="messages-global" globalOnly="true" showDetail="true" showSummary="true"
                                                warnClass="msgWarn" infoClass="msgInfo" fatalClass="msgFatal" errorClass="msgError" />

                                </h:form>


                                <h:form id="occperiod-form-address">

                                    <div class="occperiod-address-container">

                                        <h:outputText styleClass="occperiod-address"
                                                      value="#{occInspectionBB.currentPropertyUnit.property.address}
                                                      (#{occInspectionBB.currentPropertyUnit.property.muni.muniName})" />

                                        <p:spacer height="3px" />

                                        <h:outputText styleClass="ui-label-inline" value="Occupancy period for unit no. "  />

                                        <h:outputText value="(single dwelling unit)"
                                                      rendered="#{occInspectionBB.currentPropertyUnit.unitNumber == '-1'}"
                                                      styleClass="data-text italic" />

                                        <h:outputText value="#{occInspectionBB.currentPropertyUnit.unitNumber}"
                                                      rendered="#{occInspectionBB.currentPropertyUnit.unitNumber != '-1'}"
                                                      styleClass="data-text"/>

                                        <p:commandButton   id="occperiod-address-button-changepropunit"
                                                           ajax="true"
                                                           styleClass="noFill button-size-small"
                                                           actionListener="#{occInspectionBB.initiatePropUnitUpdate}"
                                                           oncomplete="PF('occperiod-dialog-periodpropunit-var').show()"
                                                           icon="fa fa-gears"
                                                           update="occperiod-dialog-periodpropunit-form"/>
                                    </div>

                                </h:form>

                                <p:separator />

                                <p:panel id="occperiod-panel-periodmetadata"
                                         toggleable="true"
                                         widgetVar="occperiod-panel-periodmetadata-var"
                                         collapsed="false"
                                         header="Occupancy period settings">

                                    <h:form id="occperiod-form-periodmetadata">
                                        <h:panelGrid        id="occperiod-panelgrid-periodmetadata"
                                                            columns="2"
                                                            columnClasses="gridTd, gridTdg"
                                                            rendered="true">
                                            <h:panelGroup>
                                                <h:outputText value="Period type:"
                                                              styleClass="ui-label font-smaller"/>
                                                <div class="field-lock-status-icon-container">
                                                    <i class="material-icons">
                                                        <h:outputText id="occperiod-periodmetadata-icon-type"
                                                                      value="#{empty occInspectionBB.currentOccPeriod.periodTypeCertifiedTS ? 'block' : 'verified_user'}"/>
                                                    </i>
                                                </div>
                                                <h:outputText value="#{occInspectionBB.currentOccPeriod.type.title}"
                                                              styleClass="data-text"/>
                                            </h:panelGroup>

                                            <h:panelGroup>
                                                <f:subview id="occperiod-periodmetadata-subview-typelockinfo">
                                                    <f:subview id="occperiod-periodmetadata-subview-typelock-unlocked"
                                                               rendered="#{empty occInspectionBB.currentOccPeriod.periodTypeCertifiedTS}">
                                                        <p:commandButton    id="occperiod-periodmetadata-button-pertype-certify"
                                                                            ajax="true"
                                                                            styleClass="noFill"
                                                                            actionListener="#{occInspectionBB.certifyOccPeriodField}"
                                                                            rendered="#{systemServicesBB.bbSessionUser.keyCard.hasEnfOfficialPermissions}"
                                                                            disabled="false"
                                                                            value="certify period type"
                                                                            icon="fa fa-shield"
                                                                            update="occperiod-form-periodmetadata
                                                                            form-messages-global"
                                                                            title="secure this occupancy period's type">
                                                            <f:param name="fieldtocertify" value="occperiodtype" />
                                                            <f:param name="certifymode" value="certify" />
                                                        </p:commandButton>


                                                    </f:subview>
                                                    <f:subview id="occperiod-periodmetadata-subview-typelock-locked"
                                                               rendered="#{!empty occInspectionBB.currentOccPeriod.periodTypeCertifiedTS}">
                                                        <h:outputText styleClass="ui-label-inline font-smaller" value="Period type locked: " />
                                                        <h:outputText styleClass="data-text" value="#{occInspectionBB.getPrettyDateNoTime(occInspectionBB.currentOccPeriod.periodTypeCertifiedTS)}" />
                                                        <p:spacer height="0px" />
                                                        <h:outputText styleClass="ui-label-inline" value="By: " />
                                                        <h:outputText styleClass="data-text" value="#{occInspectionBB.currentOccPeriod.periodTypeCertifiedBy.person.firstName}" />
                                                        <h:outputText styleClass="data-text" value=" " />
                                                        <h:outputText styleClass="data-text" value="#{occInspectionBB.currentOccPeriod.periodTypeCertifiedBy.person.lastName}" />

                                                        <p:spacer height="5px" />

                                                        <p:commandButton    id="occperiod-periodmetadata-button-pertype-withdraw"
                                                                            ajax="true"
                                                                            styleClass="noFill"
                                                                            actionListener="#{occInspectionBB.certifyOccPeriodField}"
                                                                            rendered="true"
                                                                            disabled="false"
                                                                            value="remove type lock"
                                                                            update="occperiod-form-periodmetadata
                                                                            form-messages-global"
                                                                            icon="fa fa-unlock"
                                                                            title="clear a previously existing type authorization">
                                                            <f:param name="fieldtocertify" value="occperiodtype" />
                                                            <f:param name="certifymode" value="withdraw" />
                                                        </p:commandButton>
                                                    </f:subview>
                                                </f:subview>
                                            </h:panelGroup>

                                            <h:panelGroup>
                                                <h:outputText value="Authorization status: "
                                                              styleClass="ui-label font-smaller"/>
                                                <div class="field-lock-status-icon-container">
                                                    <i class="material-icons">
                                                        <h:outputText id="occperiod-periodmetadata-icon-authstatus"
                                                                      value="#{empty occInspectionBB.currentOccPeriod.authorizedTS? 'block' : 'verified_user'}"/>
                                                    </i>
                                                </div>

                                                <h:outputText id="occperiod-form-periodmetadata-auth-ot"
                                                              value="#{empty occInspectionBB.currentOccPeriod.authorizedTS ? 'not authorized' : 'authorized!'}"/>

                                            </h:panelGroup>
                                            <h:panelGroup>
                                                <f:subview id="occperiod-periodmetadata-subview-auth-container">

                                                    <f:subview id="occperiod-periodmetadata-subview-auth-notauthorized"
                                                               rendered="#{empty occInspectionBB.currentOccPeriod.authorizedTS}">
                                                        <p:commandButton    id="occperiod-periodmetadata-subview-auth-button-certify"
                                                                            ajax="true"
                                                                            styleClass="noFill"
                                                                            actionListener="#{occInspectionBB.certifyOccPeriodField}"
                                                                            rendered="true"
                                                                            disabled="false"
                                                                            value="authorize period"
                                                                            icon="fa fa-shield"
                                                                            update="occperiod-form-periodmetadata
                                                                            form-messages-global"
                                                                            title="finalize all occupancy period settings which then allows permitting">
                                                            <f:param name="fieldtocertify" value="authorization" />
                                                            <f:param name="certifymode" value="certify" />
                                                        </p:commandButton>
                                                    </f:subview>
                                                    <f:subview id="occperiod-periodmetadata-subview-auth-authorized"
                                                               rendered="#{!(empty occInspectionBB.currentOccPeriod.authorizedTS)}">

                                                        <h:outputText styleClass="ui-label-inline" value="Authorized at " />
                                                        <h:outputText styleClass="data-text" value="#{occInspectionBB.getPrettyDateNoTime(occInspectionBB.currentOccPeriod.authorizedTS)}" />
                                                        <p:spacer height="0px" />
                                                        <h:outputText styleClass="ui-label-inline" value=" By user  " />
                                                        <h:outputText styleClass="data-text" value="#{occInspectionBB.currentOccPeriod.authorizedBy.person.firstName}" />
                                                        <h:outputText styleClass="data-text" value=" " />
                                                        <h:outputText styleClass="data-text" value="#{occInspectionBB.currentOccPeriod.authorizedBy.person.lastName}" />

                                                        <p:spacer height="5px" />

                                                        <p:commandButton    id="occperiod-periodmetadata-subview-auth-button-withdraw"
                                                                            ajax="true"
                                                                            styleClass="noFill"
                                                                            actionListener="#{occInspectionBB.certifyOccPeriodField}"
                                                                            rendered="true"
                                                                            disabled="false"
                                                                            value="withdraw authorization"
                                                                            icon="fa fa-warning"
                                                                            update="occperiod-form-periodmetadata
                                                                            form-messages-global"
                                                                            title="finalize all occupancy period settings which then allows permitting">
                                                            <f:param name="fieldtocertify" value="authorization" />
                                                            <f:param name="certifymode" value="withdraw" />
                                                        </p:commandButton>
                                                    </f:subview>
                                                </f:subview>

                                            </h:panelGroup>

                                            <h:panelGroup>
                                                <h:outputText value="Start date:"
                                                              styleClass="ui-label font-smaller"/>
                                                <div class="field-lock-status-icon-container">
                                                    <i class="material-icons">
                                                        <h:outputText id="occperiod-periodmetadata-icon-startdate"
                                                                      value="#{empty occInspectionBB.currentOccPeriod.startDateCertifiedTS ? 'block' : 'verified_user'}"/>
                                                    </i>
                                                </div>
                                                <h:outputText value="#{empty occInspectionBB.currentOccPeriod.endDate ? 'no start date' : occInspectionBB.getPrettyDateNoTime(occInspectionBB.currentOccPeriod.startDate)}" />
                                            </h:panelGroup>

                                            <h:panelGroup>
                                                <f:subview id="occperiod-periodmetadata-subview-startdate-container">

                                                    <f:subview id="occperiod-periodmetadata-subview-startdate-unlocked"
                                                               rendered="#{empty occInspectionBB.currentOccPeriod.startDateCertifiedTS}">

                                                        <h:outputText value="Edit start date: "
                                                                      styleClass="ui-label font-smaller"/>
                                                        <p:calendar     id="occperiod-periodmetadata-cal-startdate"
                                                                        value="#{occInspectionBB.currentOccPeriod.startDateUtilDate}"
                                                                        mode="popup"
                                                                        showOn="button" pattern="EEE, dd MMM, yyyy"
                                                                        navigator="true" tabindex="16" timeInput="false" showHour="false" showMinute="false" showSecond="false" showMillisec="false"
                                                                        showButtonPanel="true" showTodayButton="true"
                                                                        required="false">
                                                            <p:ajax />
                                                        </p:calendar>
                                                        <p:spacer height="5px" />

                                                        <p:commandButton    id="occperiod-periodmetadata-subview-startdate-button-certify"
                                                                            ajax="true"
                                                                            styleClass="noFill"
                                                                            actionListener="#{occInspectionBB.certifyOccPeriodField}"
                                                                            rendered="true"
                                                                            disabled="false"
                                                                            value="lock start date"
                                                                            icon="fa fa-shield"
                                                                            update="occperiod-form-periodmetadata
                                                                            form-messages-global"
                                                                            title="finalize start date">
                                                            <f:param name="fieldtocertify" value="startdate" />
                                                            <f:param name="certifymode" value="certify" />
                                                        </p:commandButton>
                                                    </f:subview>
                                                    <f:subview id="occperiod-periodmetadata-subview-startdate-locked"
                                                               rendered="#{!empty occInspectionBB.currentOccPeriod.startDateCertifiedTS}">

                                                        <h:outputText styleClass="ui-label-inline" value="Start date locked at " />
                                                        <h:outputText styleClass="data-text" value="#{occInspectionBB.getPrettyDateNoTime(occInspectionBB.currentOccPeriod.startDateCertifiedTS)}" />
                                                        <p:spacer height="0px" />
                                                        <h:outputText styleClass="ui-label-inline" value=" by " />
                                                        <h:outputText styleClass="data-text" value="#{occInspectionBB.currentOccPeriod.startDateCertifiedBy.person.firstName}" />
                                                        <h:outputText styleClass="data-text" value=" " />
                                                        <h:outputText styleClass="data-text" value="#{occInspectionBB.currentOccPeriod.startDateCertifiedBy.person.lastName}" />

                                                        <p:spacer height="5px" />

                                                        <p:commandButton    id="occperiod-periodmetadata-subview-startdate-button-withdraw"
                                                                            ajax="true"
                                                                            styleClass="noFill"
                                                                            actionListener="#{occInspectionBB.certifyOccPeriodField}"
                                                                            rendered="#{systemServicesBB.bbSessionUser.keyCard.hasSysAdminPermissions}"
                                                                            disabled="false"
                                                                            value="remove date lock"
                                                                            icon="fa fa-unlock"
                                                                            update="occperiod-form-periodmetadata
                                                                            form-messages-global"
                                                                            title="remove the lock on the period start date">
                                                            <f:param name="fieldtocertify" value="startdate" />
                                                            <f:param name="certifymode" value="withdraw" />
                                                        </p:commandButton>
                                                    </f:subview>
                                                </f:subview>
                                            </h:panelGroup>

                                            <h:panelGroup>
                                                <h:outputText value="End date:"
                                                              styleClass="ui-label font-smaller"/>
                                                <div class="field-lock-status-icon-container">
                                                    <i class="material-icons">
                                                        <h:outputText id="occperiod-periodmetadata-icon-enddate"
                                                                      value="#{empty occInspectionBB.currentOccPeriod.endDateCertifiedTS ? 'block' : 'verified_user'}"/>
                                                    </i>
                                                </div>

                                                <h:outputText value="#{empty occInspectionBB.currentOccPeriod.endDate ? 'no end date' : occInspectionBB.getPrettyDateNoTime(occInspectionBB.currentOccPeriod.endDate)}" />

                                            </h:panelGroup>

                                            <h:panelGroup>
                                                <f:subview id="occperiod-periodmetadata-subview-enddate-container">

                                                    <f:subview id="occperiod-periodmetadata-subview-enddate-unlocked"
                                                               rendered="#{empty occInspectionBB.currentOccPeriod.endDateCertifiedTS}">

                                                        <h:outputText value="Edit end date: "
                                                                      styleClass="ui-label font-smaller"/>
                                                        <p:calendar    id="occperiod-periodmetadata-cal-enddate"
                                                                       value="#{occInspectionBB.currentOccPeriod.endDateUtilDate}"
                                                                       mode="popup"
                                                                       showOn="button" pattern="EEE, dd MMM, yyyy"
                                                                       navigator="true" tabindex="16" timeInput="false" showHour="false" showMinute="false" showSecond="false" showMillisec="false"
                                                                       showButtonPanel="true" showTodayButton="true"
                                                                       required="false">
                                                            <p:ajax />
                                                        </p:calendar>

                                                        <p:spacer height="5px" />

                                                        <p:commandButton    id="occperiod-periodmetadata-subview-enddate-button-certify"
                                                                            ajax="true"

                                                                            styleClass="noFill"
                                                                            actionListener="#{occInspectionBB.certifyOccPeriodField}"
                                                                            rendered="#{systemServicesBB.bbSessionUser.keyCard.hasEnfOfficialPermissions}"
                                                                            disabled="false"
                                                                            value="lock end date"
                                                                            icon="fa fa-shield"
                                                                            update="occperiod-form-periodmetadata
                                                                            form-messages-global"
                                                                            title="finalize occupancy period end date">
                                                            <f:param name="fieldtocertify" value="enddate" />
                                                            <f:param name="certifymode" value="certify" />
                                                        </p:commandButton>
                                                    </f:subview>

                                                    <f:subview id="occperiod-periodmetadata-subview-enddate-locked"
                                                               rendered="#{!empty occInspectionBB.currentOccPeriod.endDateCertifiedTS}">

                                                        <h:outputText styleClass="ui-label-inline" value="End date locked at " />
                                                        <h:outputText styleClass="data-text" value="#{occInspectionBB.getPrettyDateNoTime(occInspectionBB.currentOccPeriod.endDateCertifiedTS)}" />
                                                        <p:spacer height="0px" />
                                                        <h:outputText styleClass="ui-label-inline" value=" by " />
                                                        <h:outputText styleClass="data-text" value="#{occInspectionBB.currentOccPeriod.endDateCertifiedBy.person.firstName}" />
                                                        <h:outputText styleClass="data-text" value=" " />
                                                        <h:outputText styleClass="data-text" value="#{occInspectionBB.currentOccPeriod.endDateCertifiedBy.person.lastName}" />

                                                        <p:spacer height="5px" />

                                                        <p:commandButton    id="occperiod-periodmetadata-subview-enddate-button-withdraw"
                                                                            ajax="true"
                                                                            styleClass="noFill"
                                                                            actionListener="#{occInspectionBB.certifyOccPeriodField}"
                                                                            rendered="#{systemServicesBB.bbSessionUser.keyCard.hasSysAdminPermissions}"
                                                                            disabled="false"
                                                                            value="remove date lock"
                                                                            update="occperiod-form-periodmetadata
                                                                            form-messages-global"
                                                                            icon="fa fa-unlock"
                                                                            title="finalize occupancy period ending date. Note that some period types do not allow empty end dates">
                                                            <f:param name="fieldtocertify" value="enddate" />
                                                            <f:param name="certifymode" value="withdraw" />
                                                        </p:commandButton>
                                                    </f:subview>

                                                </f:subview>
                                            </h:panelGroup>
                                        </h:panelGrid>
                                        <p:spacer height="5px" />
                                        <p:commandButton    id="occperiod-button-advancedperiodsettings"
                                                            ajax="true"
                                                            styleClass="noFill button-size-small"
                                                            actionListener="#{occInspectionBB.updateOccPeriodInitialize}"
                                                            oncomplete="PF('occperiod-dialog-periodmetadata-var').show()"
                                                            icon="fa fa-gears"
                                                            value="period id #{occInspectionBB.currentOccPeriod.periodID} settings"
                                                            update="occperiod-dialog-periodmetadata-form
                                                            "/>
                                    </h:form>
                                </p:panel>

                                <p:panel id="occperiod-panel-proposals"
                                         toggleable="true"
                                         widgetVar="occperiod-panel-proposals-var"
                                         collapsed="false"
                                         header="Tasks and notices">


                                    <h:form id="occperiod-panel-proposals-messages-form">
                                        <h:messages id="occperiod-panel-proposals-messages" globalOnly="true" showDetail="true" showSummary="true"
                                                    warnClass="msgWarn" infoClass="msgInfo" fatalClass="msgFatal" errorClass="msgError">
                                        </h:messages>
                                    </h:form>

                                    <h:form id="occperiod-form-proposals">
                                        <p:dataScroller id="proposals-proposalscroller"
                                                        var="proposal"
                                                        widgetVar="proposals-proposalscroller-var"
                                                        value="#{occInspectionBB.currentOccPeriod.proposalListVisible}"
                                                        rowIndexVar="#{proposal.proposalID}">
                                            <div class="outlinedBox">
                                                <div class="proposal-metadata-container">
                                                    <div class="proposal-propbuttoncontainer">
                                                        <p:commandButton    id="proposal-button-showdescription"
                                                                            styleClass="noFill button-size-small button-moreinfo"
                                                                            icon="fa fa-info"/>

                                                        <p:overlayPanel id="proposal-overlaypanel-proposaldescription"
                                                                        for="proposal-button-showdescription"
                                                                        hideEffect="fade"
                                                                        dynamic="true"
                                                                        showCloseIcon="true"
                                                                        style="width:300px"
                                                                        modal="false">

                                                            <h:outputText       styleClass="proposal-description"
                                                                                value="#{proposal.directive.description}" />
                                                        </p:overlayPanel>

                                                        <p:commandButton    id="proposal-button-propmetadata"
                                                                            ajax="true"
                                                                            styleClass="noFill button-size-small"
                                                                            actionListener="#{occInspectionBB.proposals_initiateViewPropMetadata(proposal)}"
                                                                            oncomplete="PF('occperiod-dialog-proposalmetadata-var').show()"
                                                                            icon="fa fa-gears"
                                                                            update="occperiod-dialog-proposalmetadata-form
                                                                            occperiod-form-events
                                                                            occperiod-form-proposals"/>

                                                        <p:commandButton    id="proposal-button-rejectionreason"
                                                                            styleClass="noFill button-size-small"
                                                                            oncomplete="PF('occperiod-rejectproposal-dialog-var').show()"
                                                                            rendered="#{!proposal.directive.requiredEvaluationForBOBClose 
                                                                                        or systemServicesBB.bbSessionUser.keyCard.hasSysAdminPermissions }"
                                                                            icon="fa fa-trash"/>
                                                    </div>
                                                    <div class="proposal-prophead">
                                                        <h:outputText value="#{proposal.directive.title}" />
                                                    </div>
                                                    <p:spacer height="5px" />
                                                    <h:panelGrid   id="occperiod-proposals-panelgrid-propinfo"
                                                                   columns="1"
                                                                   style="clear:both;"
                                                                   columnClasses="gridTd"
                                                                   rendered="true">
                                                        <h:panelGroup>
                                                            <h:outputText styleClass="ui-label-inline"
                                                                          value="Intended for: "  />
                                                            <h:outputText styleClass="data-text"
                                                                          value="#{occInspectionBB.currentProposal.responderIntended.person.firstName}" />
                                                            <h:outputText styleClass="data-text"
                                                                          value=" " />
                                                            <h:outputText styleClass="data-text"
                                                                          value="#{occInspectionBB.currentProposal.responderIntended.person.lastName}" />
                                                        </h:panelGroup>
                                                    </h:panelGrid>
                                                </div>

                                                <p:dataScroller id="proposals-choicescroller"
                                                                var="choice"
                                                                widgetVar="proposals-choicescroller-var"
                                                                value="#{proposal.directive.choiceListVisible}"
                                                                rowIndexVar="#{choice.choiceID}">

                                                    <p:commandButton    id="proposal-choice-button-choose"
                                                                        ajax="true"
                                                                        styleClass="proposal-choice-button"
                                                                        actionListener="#{occInspectionBB.proposals_makeChoice(choice, proposal)}"
                                                                        disabled="#{!choice.canChoose}"
                                                                        value="#{choice.title}"
                                                                        icon="#{choice.icon.fontAwesome}"
                                                                        title="#{choice.description}"
                                                                        update="occperiod-form-proposals
                                                                        occperiod-panel-proposals-messages-form
                                                                        occperiod-form-events:occperiod-events-datatable"/>
                                                    <p:spacer height="5px" />
                                                </p:dataScroller>
                                            </div>
                                        </p:dataScroller>

                                        <p:spacer height="5px" />

                                        <h:outputText styleClass="ui-label-inline font-smaller" value="show hidden proposals? " />
                                        <p:selectBooleanCheckbox id="proposals-boolcheckbox-showhiddenprops" value="#{occInspectionBB.currentOccPeriod.showHiddenProposals}" >
                                            <p:ajax update="proposals-proposalscroller" />
                                        </p:selectBooleanCheckbox>

                                        <h:outputText styleClass="ui-label-inline font-smaller" value="show inactive proposals? " />
                                        <p:selectBooleanCheckbox id="proposals-boolcheckbox-showinactiveprops" value="#{occInspectionBB.currentOccPeriod.showInactiveProposals}" >
                                            <p:ajax update="proposals-proposalscroller" />
                                        </p:selectBooleanCheckbox>

                                    </h:form>
                                </p:panel>

                                <p:panel id="occperiod-permits"
                                         toggleable="true"
                                         collapsed="false"
                                         header="Permits">

                                    <h:form id="occperiod-permits-form-datatable">

                                        <p:commandButton    id="occperiod-permits-button-newpermit"
                                                            value="Configure new permit"
                                                            ajax="true"
                                                            process="@form"
                                                            actionListener="#{occInspectionBB.reports_initializeOccPermitReport}"
                                                            oncomplete="PF('occperiod-configurereport-occpermit-var').show()"
                                                            disabled="#{empty occInspectionBB.currentOccPeriod.authorizedTS}"
                                                            rendered="#{systemServicesBB.bbSessionUser.keyCard.hasMuniStaffPermissions}"
                                                            icon="fa fa-plus"
                                                            update="occperiod-configurereport-occpermit-form"/>

                                        <p:spacer height="5px" />

                                        <p:dataTable
                                            id="occperiod-permits-datatable-permits"
                                            var="permit"
                                            rowKey="#{permit.permitID}"
                                            value="#{occInspectionBB.currentOccPeriod.permitList}"
                                            tableStyleClass="primeDataTable"
                                            draggableColumns="true"
                                            resizableColumns="true">

                                            <p:column width="10%">
                                                <f:facet name="header">
                                                    <h:outputText value="Print" />
                                                </f:facet>
                                                <p:commandButton ajax="false"
                                                                 action="#{occInspectionBB.initializeOccPermitReport(permit)}"
                                                                 value="print"
                                                                 icon="fa fa-print"
                                                                 rendered="#{systemServicesBB.bbSessionUser.keyCard.hasMuniStaffPermissions}"/>
                                            </p:column>

                                            <p:column width="10%">
                                                <f:facet name="header">
                                                    <h:outputText value="Permit ID" />
                                                </f:facet>
                                                <h:outputText value="#{permit.permitID}"/>
                                            </p:column>

                                            <p:column width="10%">
                                                <f:facet name="header">
                                                    <h:outputText value="Date issued" />
                                                </f:facet>
                                                <h:outputText value="#{occInspectionBB.getPrettyDate(permit.dateIssued)}"/>
                                            </p:column>

                                            <p:column width="10%">
                                                <f:facet name="header">
                                                    <h:outputText value="Issuee" />
                                                </f:facet>
                                                <h:outputText value="#{permit.issuedTo.firstName}"/>
                                                <h:outputText value=" "/>
                                                <h:outputText value="#{permit.issuedTo.LastName}"/>
                                                <p:spacer height="0px"/>
                                                <h:outputText value=" ("/>
                                                <h:outputText value="#{permit.issuedTo.personType.label}"/>
                                                <h:outputText value=", ID:"/>
                                                <h:outputText value="#{permit.issuedTo.personID}"/>
                                                <h:outputText value=")"/>
                                            </p:column>

                                            <p:column width="15%">
                                                <f:facet name="header">
                                                    <h:outputText value="Issuer" />
                                                </f:facet>
                                                <h:outputText value="#{permit.issuedBy.person.firstName}"/>
                                                <h:outputText value=""/>
                                                <h:outputText value="#{permit.issuedBy.person.LastName}"/>
                                                <p:spacer height="0px"/>
                                                <h:outputText value=" (User ID:"/>
                                                <h:outputText value="#{permit.issuedBy.userID}"/>
                                                <h:outputText value=")"/>
                                            </p:column>

                                        </p:dataTable>
                                    </h:form>
                                </p:panel>

                                <p:panel id="occperiod-template-panel"
                                         toggleable="true"
                                         collapsed="false"
                                         rendered="false"
                                         header="Inspection checklist builder" >


                                    <h:form id="occperiod-checklisttemplate-form-settings">
                                        <h2>
                                            Inspection checklist builder
                                        </h2>

                                        <div class="occperiod-template-metadata">
                                            <h:outputText styleClass="ui-label-inline" value="Checklist title: " />
                                            <h:outputText styleClass="data-text" value="#{occInspectionBB.currentInspection.checklistTemplate.title}" />
                                            <h:outputText styleClass="data-text" value=" (ID: " />
                                            <h:outputText styleClass="data-text" value="#{occInspectionBB.currentInspection.checklistTemplate.inspectionChecklistID}" />
                                            <h:outputText styleClass="data-text" value=")" />
                                        </div>

                                        <h:outputText value="Mark newly added space with compliance?"
                                                      styleClass="ui-label-inline"/>

                                        <p:selectBooleanCheckbox id="occperiod-template-switch-marknewelementswithcompliance"
                                                                 value="#{occInspectionBB.markNewlyAddedSpacesWithCompliance}"/>

                                        <p:spacer height="5px" />

                                        <p:commandButton    id="occperiod-template-button-addallrequiredspacetypes"
                                                            ajax="true" 
                                                            actionListener="#{occInspectionBB.checklistAction_addAllRequiredSpaceTypes}"
                                                            rendered="#{systemServicesBB.bbSessionUser.keyCard.hasEnfOfficialPermissions}"
                                                            value="add all required spaces"  
                                                            icon="fa fa-clone"
                                                            update=" form-inspecteditems
                                                            occperiod-inspecteditems-form-messages
                                                            "/>
                                    </h:form>
                                    <p:spacer height="5px" />

                                    <h:form id="occperiod-checklisttemplate-form-spacetype">

                                        <h:panelGrid   id="violation-ord-fulltext-pg"
                                                       columns="3"
                                                       columnClasses="gridTd, gridTd"
                                                       rendered="true">
                                            <h:panelGroup>
                                                <p:selectOneListbox id="listbox-occspacetype"
                                                                    required="true"
                                                                    value="#{occInspectionBB.selectedOccSpaceType}"
                                                                    tabindex="1">
                                                    <p:ajax update="listbox-occspaces
                                                            occperiod-checklisttemplate-button-addwithcompliance
                                                            occperiod-checklisttemplate-button-addasuninspected"
                                                            listener="#{occInspectionBB.loadSpacesInType}"
                                                            />
                                                    <f:converter converterId="occSpaceTypeConverter" />
                                                    <f:selectItems value="#{occInspectionBB.currentInspection.checklistTemplate.occSpaceTypeTemplateList}"
                                                                   var="st" itemLabel="#{st.spaceTypeTitle}" />
                                                </p:selectOneListbox>
                                            </h:panelGroup>
                                            <h:panelGroup>

                                                <p:selectOneListbox id="listbox-occspaces"
                                                                    required="true"
                                                                    value="#{occInspectionBB.selectedOccSpace}"
                                                                    tabindex="2">
                                                        <p:ajax update="occperiod-checklisttemplate-scroller-elementlist
                                                                occperiod-checklisttemplate-button-addwithcompliance
                                                                occperiod-checklisttemplate-button-addasuninspected"
                                                                listener="#{occInspectionBB.loadElementsInSpace}"
                                                                /> 
                                                        <f:converter converterId="occSpaceConverter" />
                                                        <f:selectItems value="#{occInspectionBB.spacesInTypeList}" 
                                                                       var="sp" itemLabel="#{sp.name}" />

                                                    </p:selectOneListbox>
                                                     
                                                 </h:panelGroup>
                                                 <h:panelGroup>
                                                 
                                                            <p:commandButton       id="occperiod-checklisttemplate-button-addwithcompliance"
                                                                                   ajax="true" 
                                                                                   actionListener="#{occInspectionBB.checklistAction_addSpaceToChecklist(occInspectionBB.selectedOccSpace)}"
                                                                                   rendered="#{systemServicesBB.bbSessionUser.keyCard.hasEnfOfficialPermissions}"
                                                                                   disabled="#{empty occInspectionBB.selectedOccSpace}"
                                                                                   value="mark added items with compliance"  
                                                                                   icon="fa fa-check"
                                                                                   update=" form-inspecteditems
                                                                                            occperiod-inspecteditems-form-messages">
                                                                <f:param name="occperiod-elementstatusonadd" value="#{comp}"/>
                                                                
                                                            </p:commandButton>
                                                            
                                                            <p:spacer height="5px" />
                                                            
                                                            <p:commandButton       id="occperiod-checklisttemplate-button-addasuninspected"
                                                                                   ajax="true" 
                                                                                   actionListener="#{occInspectionBB.checklistAction_addSpaceToChecklist(occInspectionBB.selectedOccSpace)}"
                                                                                   rendered="#{systemServicesBB.bbSessionUser.keyCard.hasEnfOfficialPermissions}"
                                                                                   disabled="#{empty occInspectionBB.selectedOccSpace}"
                                                                                   value="add items as uninspected"  
                                                                                   icon="fa fa-circle-o"
                                                                                   update=" form-inspecteditems
                                                                                   occperiod-inspecteditems-form-messages">
                                                                <f:param name="occperiod-elementstatusonadd" value="uninsp"/>
                                                            </p:commandButton>
                                                 </h:panelGroup>
                                             </h:panelGrid>
                                            <h:outputText styleClass="ui-label" value="Elements in this space:" />
                                            
                                                <p:dataScroller
                                                    id="occperiod-checklisttemplate-scroller-elementlist"
                                                    widgetVar="var-scroller-inspectiontemplate-spacetypelist-spacelist-elementlist"
                                                    var="codeElement"
                                                    
                                                    value="#{occInspectionBB.elementsInSpaceList}"
                                                    rowIndexVar="#{codeElement.elementID}">

                                                </p:selectOneListbox>

                                            </h:panelGroup>
                                            <h:panelGroup>

                                                <p:commandButton       id="occperiod-checklisttemplate-button-addwithcompliance"
                                                                       ajax="true" 
                                                                       actionListener="#{occInspectionBB.checklistAction_addSpaceToChecklist(occInspectionBB.selectedOccSpace)}"
                                                                       rendered="#{sessionBean.sessionUser.keyCard.hasEnfOfficialPermissions}"
                                                                       disabled="#{empty occInspectionBB.selectedOccSpace}"
                                                                       value="mark added items with compliance"  
                                                                       icon="fa fa-check"
                                                                       update=" form-inspecteditems
                                                                       occperiod-inspecteditems-form-messages">
                                                    <f:param name="occperiod-elementstatusonadd" value="#{comp}"/>
                                                </p:commandButton>

                                                <p:spacer height="5px" />

                                                <p:commandButton       id="occperiod-checklisttemplate-button-addasuninspected"
                                                                       ajax="true" 
                                                                       actionListener="#{occInspectionBB.checklistAction_addSpaceToChecklist(occInspectionBB.selectedOccSpace)}"
                                                                       rendered="#{sessionBean.sessionUser.keyCard.hasEnfOfficialPermissions}"
                                                                       disabled="#{empty occInspectionBB.selectedOccSpace}"
                                                                       value="add items as uninspected"  
                                                                       icon="fa fa-circle-o"
                                                                       update=" form-inspecteditems
                                                                       occperiod-inspecteditems-form-messages">
                                                    <f:param name="occperiod-elementstatusonadd" value="uninsp"/>
                                                </p:commandButton>


                                            </h:panelGroup>
                                        </h:panelGrid>
                                        <h:outputText styleClass="ui-label" value="Elements in this space:" />

                                        <p:dataScroller
                                            id="occperiod-checklisttemplate-scroller-elementlist"
                                            widgetVar="var-scroller-inspectiontemplate-spacetypelist-spacelist-elementlist"
                                            var="codeElement"

                                            value="#{occInspectionBB.elementsInSpaceList}"
                                            rowIndexVar="#{codeElement.elementID}">

                                        </p:dataScroller>
                                        <p:spacer height="5px" />

                                        <p:commandButton    id="occperiod-permits-button-newpermit"
                                                            value="view static template"
                                                            ajax="true"
                                                            actionListener="#{occInspectionBB.viewStaticChecklistTemplate}"
                                                            oncomplete="PF('occperiod-dialog-fullchecklisttemplate-var').show()"
                                                            disabled="false"
                                                            rendered="true"
                                                            icon="fa fa-align-left"
                                                            update="occperiod-configurereport-occpermit-form"/>
                                    </h:form>
                                </p:panel>
                            </div>


                            <div id="inspection-inspectedelementscol" class="object-column">

                                <h:form id="occperiod-messages-form-rightcolheader">
                                    <h:messages id="occperiod-messages-messages-rightcolheader" globalOnly="true" showDetail="true" showSummary="true"
                                                warnClass="msgWarn" infoClass="msgInfo" fatalClass="msgFatal" errorClass="msgError">
                                    </h:messages>
                                </h:form>
                                <p:panel    id="occperiod-panel-events"
                                            widgetVar="occperiod-panel-events-var"
                                            toggleable="true"
                                            collapsed="false"
                                            header="Events">
                                    <h:form id="occperiod-form-events">

                                        <h2>Add new event</h2>
                                        <h:panelGrid columns="3" border="0"
                                                     cellpadding="5" columnClasses="gridTd, gridTd, gridTd"
                                                     footerClass="gridFooter" style="vertical-align: top;">

                                            <h:panelGroup>
                                                <h:outputLabel styleClass="ui-label" for="newEventTypeMenu">
                                                    <h:outputText value="Step 1: Choose type"/>
                                                </h:outputLabel>
                                                <p:selectOneMenu id="newEventTypeMenu"
                                                                 required="true"
                                                                 value="#{occInspectionBB.selectedEventCategory}"
                                                                 tabindex="10">
                                                    <f:converter converterId="eventCategoryConverter" />
                                                    <p:ajax update="categoryList
                                                            event-add-dialog-show-cb"
                                                            immediate="true"/>
                                                    <f:selectItems value="#{occInspectionBB.eventCategoryList}"
                                                                   var="et"
                                                                   itemLabel="#{et.label}" />
                                                </p:selectOneMenu>
                                                <h:message for="newEventTypeMenu" showDetail="false" showSummary="true"
                                                           warnClass="msgWarn" infoClass="msgInfo" fatalClass="msgFatal" errorClass="msgError" />
                                            </h:panelGroup>

                                            <h:panelGroup>
                                                <h:outputLabel styleClass="ui-label" for="categoryList">
                                                    <h:outputText value="Step 2: Choose category"/>
                                                </h:outputLabel>


                                                <p:selectOneListbox style="width: 300px;"
                                                                    id="categoryList"
                                                                    value="#{caseProfileBB.selectedEventCategory}"
                                                                    tabindex="10">

                                                    <p:ajax update="
                                                            event-add-dialog-show-cb"
                                                            immediate="true"/>
                                                    <f:converter converterId="eventCategoryConverter"/>
                                                    <f:selectItems  id="catItemsList" value="#{caseProfileBB.eventCategoryList}" var="ec" itemValue="#{ec}" itemLabel="#{ec.eventCategoryTitle}"/>
                                                </p:selectOneListbox>

                                                <h:message for="categoryList" showDetail="false" showSummary="true"
                                                           warnClass="msgWarn" infoClass="msgInfo" fatalClass="msgFatal" errorClass="msgError" />

                                            </h:panelGroup>

                                            <h:panelGroup>
                                                <p:commandButton    id="event-add-dialog-show-cb"
                                                                    ajax="true"
                                                                    process="@form"
                                                                    actionListener="#{occInspectionBB.events_initializeEvent}"
                                                                    oncomplete="PF('occperiod-events-dialog-addeditevent-var').show()"
                                                                    disabled="#{empty occInspectionBB.selectedEventCategory}"
                                                                    rendered="#{systemServicesBB.bbSessionUser.keyCard.hasMuniStaffPermissions}"
                                                                    value="Create new event"  
                                                                    icon="fa fa-plus"
                                                                    update="occperiod-events-dialog-form"/>
                                            </h:panelGroup>
                                        </h:panelGrid>


                                        <p:dataTable
                                            id="occperiod-events-datatable"
                                            var="e"
                                            rowKey="#{e.eventID}"
                                            value="#{occInspectionBB.currentOccPeriod.visibleEventList}"
                                            tableStyleClass="primeDataTable"
                                            resizableColumns="true"
                                            rowExpandMode="multiple"
                                            expandedRow="false"
                                            filteredValue="#{occInspectionBB.filteredEventList}"
                                            widgetVar="caseEventTable"
                                            >
                                            <!--<p:ajax event="rowSelect" update="selectedRowLabel"/>-->

                                            <p:column width="3%" exportable="false">
                                                <p:rowToggler/>
                                            </p:column>

                                            <p:column width="4%">
                                                <i class="material-icons"><h:outputText value="#{e.category.icon.materialIcon}"/></i>
                                            </p:column>

                                            <p:column width="12%" sortBy="#{e.dateOfRecord}">
                                                <f:facet name="header">
                                                    <h:outputText value="Date" />
                                                </f:facet>
                                                <div class="rowExpansion">
                                                    <h:outputText value="#{e.dateOfRecordPretty}"/>
                                                </div>
                                            </p:column>

                                            <p:column width="4%" sortBy="#{e.eventID}">
                                                <f:facet name="header">
                                                    <h:outputText value="ID" />
                                                </f:facet>
                                                <h:outputText value="#{e.eventID}"/>
                                            </p:column>
                                            <ui:remove>
                                                <p:column width="20%" sortBy="#{e.category.eventType.label}"
                                                          filterBy="#{e.category.eventType.label}">
                                                    <f:facet name="header">
                                                        <h:outputText value="Type" />
                                                    </f:facet>
                                                    <h:outputText value="#{e.category.eventType.label}"/>
                                                </p:column>
                                            </ui:remove>

                                            <p:column width="15%" sortBy="#{e.category.eventCategoryTitle}"
                                                      filterBy="#{e.category.eventCategoryTitle}">
                                                <f:facet name="header">
                                                    <h:outputText value="Category" />
                                                </f:facet>
                                                <div class="rowExpansion">
                                                    <h:outputText value="#{e.category.eventCategoryTitle}"/>
                                                </div>
                                            </p:column>
                                            <p:column width="5%" filterBy="#{e.owner.person.lastName}"
                                                      sortBy="#{e.owner.person.lastName}">

                                                <f:facet name="header">
                                                    <h:outputText value="Owner" />
                                                </f:facet>
                                                <h:outputText value="#{e.owner.person.lastName}"/>
                                            </p:column>


                                            <p:column width="10%" exportable="false">
                                                <f:facet name="header">
                                                    <h:outputText value="Hide" />
                                                </f:facet>
                                                <p:commandButton    id="occperiod-events-button-hideevent"
                                                                    icon="fa fa-moon-o"
                                                                    ajax="true"
                                                                    disabled="#{e.hidden}"
                                                                    rendered="#{sessionUserBean.sessionUser.keyCard.hasEnfOfficialPermissions}"
                                                                    actionListener="#{occInspectionBB.hideEvent(e)}"
                                                                    update="occperiod-events-datatable
                                                                    occperiod-messages-messages-rightcolheader"
                                                                    />
                                                <p:commandButton id="occperiod-events-button-showevent"
                                                                 icon="fa fa-star"
                                                                 ajax="true"
                                                                 disabled="#{!e.hidden}"
                                                                 actionListener="#{occInspectionBB.unHideEvent(e)}"
                                                                 rendered="#{sessionUserBean.sessionUser.keyCard.hasEnfOfficialPermissions}"
                                                                 update="occperiod-events-datatable
                                                                 occperiod-messages-messages-rightcolheader"
                                                                 />

                                            </p:column>
                                            <p:column width="4%" exportable="false">
                                                <f:facet name="header">
                                                    <h:outputText value="Edit" />
                                                </f:facet>
                                                <p:commandButton icon="fa fa-edit"
                                                                 ajax="true"
                                                                 actionListener="#{occInspectionBB.initiateEventEdit(e)}"
                                                                 oncomplete="PF('occperiod-events-dialog-addeditevent-var').show()"
                                                                 update="occperiod-events-dialog-form"
                                                                 />
                                            </p:column>
                                            <p:rowExpansion>
                                                <div class="outlinedBox">
                                                    <h2>
                                                        <h:outputText value="#{e.category.eventType.label}:#{e.category.eventCategoryTitle}"/>
                                                        <h:outputText value="; Event ID: "/>
                                                        <h:outputText value="#{e.eventID}"/>
                                                    </h2>
                                                    <h:panelGrid columns="4" cellpadding="10" footerClass="gridFooter"
                                                                 columnClasses="gridTd, gridTd, gridTd, gridTd">
                                                        <h:panelGroup>
                                                            <h:outputText styleClass="bold" value="Description" />
                                                            <div class="rowExpansion">
                                                                <h:outputText value="#{e.description}"/>
                                                            </div>
                                                        </h:panelGroup>

                                                        <h:panelGroup>
                                                            <h:outputText styleClass="bold" value="Disclose to Municipality Staff?" />
                                                            <div class="rowExpansion">
                                                                <h:outputText value="#{e.discloseToMunicipality}"/>
                                                            </div>
                                                        </h:panelGroup>

                                                        <h:panelGroup>
                                                            <h:outputText styleClass="bold" value="Disclose to Public?" />
                                                            <div class="rowExpansion">
                                                                <h:outputText value="#{e.discloseToPublic}"/>
                                                            </div>
                                                        </h:panelGroup>

                                                        <h:panelGroup>
                                                            <h:outputText styleClass="bold" value="Creation time stamp"/>
                                                            <div class="rowExpansion">
                                                                <h:outputText value="#{e.timestampPretty}"/>
                                                            </div>
                                                        </h:panelGroup>

                                                        <h:panelGroup>
                                                            <h:outputText styleClass="bold" value="Active Event?"/>
                                                            <div class="rowExpansion">
                                                                <h:outputText value="#{e.active}"/>
                                                            </div>
                                                        </h:panelGroup>

                                                        <f:facet name="footer" class="leftalign">
                                                            <h:outputLabel styleClass="bold" style="text-align: left" value="Notes"/>
                                                            <p:spacer height="15px"/>
                                                            <div class="rowExpansion" style="text-align: left">
                                                                <h:outputText escape="false" value="#{e.notes}"/>
                                                            </div>
                                                        </f:facet>

                                                    </h:panelGrid>
                                                </div>
                                            </p:rowExpansion>

                                        </p:dataTable>

                                        <p:spacer height="5px" />

                                        <h:outputText styleClass="ui-label-inline" value="show hidden events: " />

                                        <p:selectBooleanCheckbox id="events-showhidden-sbcb"
                                                                 style="margin-right: 5px;"
                                                                 value="#{occInspectionBB.currentOccPeriod.showHiddenEvents}" >
                                            <p:ajax update="occperiod-events-datatable" />

                                        </p:selectBooleanCheckbox>

                                        <h:outputText styleClass="ui-label-inline" value="show inactive events: " />

                                        <p:selectBooleanCheckbox id="events-inactive-sbcb"
                                                                 value="#{occInspectionBB.currentOccPeriod.showInactiveEvents}">
                                            <p:ajax update="occperiod-events-datatable" />
                                        </p:selectBooleanCheckbox>
                                    </h:form>
                                </p:panel>

                                <p:panel id="occperiod-fees"
                                         toggleable="true"
                                         collapsed="false"
                                         header="Fees"
                                         rendered="true">

                                    <h:form id="occperiod-fees-form-messages">
                                        <h:messages id="occperiod-fees-messages" globalOnly="true" showDetail="true" showSummary="true"
                                                    warnClass="msgWarn" infoClass="msgInfo" fatalClass="msgFatal" errorClass="msgError">
                                        </h:messages>
                                    </h:form>

                                    <h:form id="occperiod-fees-form">

                                            <h:panelGroup>
                                                  <p:commandButton   id="occperiod-inspection-button-notes"
                                                                    rendered="#{systemServicesBB.bbSessionUser.keyCard.hasEnfOfficialPermissions}"
                                                                    value="add note"  
                                                                    icon="fa fa-sticky-note-o"
                                                                     actionListener="#{occInspectionBB.initiateNoteOnInspection()}"
                                                                     oncomplete="PF('occperiod-dialog-inspection-notes-var').show()"
                                                                     update="occperiod-dialog-inspection-notes-form"/>

                                            <p:column width="3%">
                                                <f:facet name="header">
                                                    <h:outputText value="Exp"/>
                                                </f:facet>
                                                <p:rowToggler/>
                                            </p:column>
                                            <p:column width="8%">
                                                <f:facet name="header">
                                                    <h:outputText value="ID" />
                                                </f:facet>
                                                <h:outputText value="#{fee.occPerAssignedFeeID}"/>
                                            </p:column>


                                             
                                             
                                         </h:panelGrid>
                                        
                                        <p:commandButton  id="occperiod-checklist-button-showmetatdatadialog"
                                                          ajax="true" 
                                                          actionListener="#{occInspectionBB.checklistAction_beginInspectionMetadataEdit}"
                                                          rendered="#{systemServicesBB.bbSessionUser.keyCard.hasEnfOfficialPermissions}"
                                                          onclick="PF('occperiod-dialog-inspectionsettings-var').show()"
                                                          value="configure inspection"  
                                                          icon="fa fa-gears"
                                                          update="inspectionsettings-form-messages
                                                          inspectionsettings-form-configureinspections
                                                          form-dialog-inspectionmetadata"/>
                                        
                                        <p:commandButton  id="occperiod-checklist-button-certifyinspection"
                                                          ajax="true" 
                                                          actionListener="#{occInspectionBB.checklistAction_certifyInspection}"
                                                          rendered="#{systemServicesBB.bbSessionUser.keyCard.hasEnfOfficialPermissions}"
                                                          disabled="#{!occInspectionBB.currentInspection.readyForPassedCertification}"
                                                          value="certify passed inspection"  
                                                          icon="fa thumbs-up"
                                                          update="form-dialog-inspectionmetadata
                                                                    occperiod-form-periodmetadata"/>
                                        
                                          
                                        <h2>Checklist tools</h2>
                                        
                                          <p:commandButton   id="occperiod-checklist-button-inspectnewspace"
                                                               ajax="true" 
                                                               actionListener="#{occInspectionBB.initializeSpaceAdd}"
                                                               rendered="#{systemServicesBB.bbSessionUser.keyCard.hasEnfOfficialPermissions}"
                                                               onclick="PF('occinspection-dialog-addspace-var').show()"
                                                               style="width: 100%; height: 30px; font-weight: bold;"
                                                               value="inspect new space"
                                                               disabled="#{empty occInspectionBB.currentInspection}"
                                                               icon="fa fa-plus"
                                                               update="occinspection-dialog-addspace-form-info
                                                               occinspection-dialog-addspace-form-adder"/>
                                          
                                          <p:spacer height="5px" />
                                          
                                          <p:commandButton   id="occperiod-checklist-button-configtodolist"
                                                               ajax="true" 
                                                               actionListener="#{occInspectionBB.reports_initializeOccInspectionReport}"
                                                               rendered="#{systemServicesBB.bbSessionUser.keyCard.hasMuniReaderPermissions}"
                                                               onclick="PF('occperiod-configurereport-occinspection-var').show()"
                                                               value="print inspection to-do list"
                                                               disabled="false"
                                                               icon="fa fa-print"
                                                               update="occperiod-configurereport-occinspection-form"/>
                                          
                                          <p:commandButton  id="occperiod-checklist-button-markcomplianceforallelements"
                                                            ajax="true" 
                                                            actionListener="#{occInspectionBB.checklistAction_recordComplianceForAllElements()}"
                                                            rendered="#{systemServicesBB.bbSessionUser.keyCard.hasEnfOfficialPermissions}"
                                                            value="mark compliance for all items"  
                                                            icon="fa fa-check"
                                                            disabled="true"
                                                            update="form-inspecteditems"/>
                                        
                                          <p:spacer height="5px" />
                                          
                                          <p:commandButton   id="occperiod-checklist-button-showonlyfailedelements"
                                                               ajax="true" 
                                                               actionListener="#{occInspectionBB.filterChecklist_failedItems}"
                                                               value="filter: only failed items"
                                                               disabled="false"
                                                               styleClass="button-size-small noFill"
                                                               icon="fa fa-close"
                                                               update="form-inspecteditems
                                                               occperiod-checklisttemplate-form-settings"/>
                                          
                                          <p:commandButton   id="occperiod-checklist-button-showonlyuninspectedelements"
                                                               ajax="true" 
                                                               actionListener="#{occInspectionBB.filterChecklist_uninspectedItems}"
                                                               value="filter: only uninspected items"
                                                               disabled="false"
                                                               icon="fa fa-circle-o"
                                                               update="form-inspecteditems
                                                               occperiod-checklisttemplate-form-settings"/>
                                          
                                          <p:commandButton   id="occperiod-checklist-button-showall"
                                                               ajax="true" 
                                                               actionListener="#{occInspectionBB.filterChecklist_allItems}"
                                                               value="filter: show all items"
                                                               disabled="false"
                                                               icon="fa fa-list-alt"
                                                               style="margin-right: 5px"
                                                               update="form-inspecteditems
                                                               occperiod-checklisttemplate-form-settings"/>
                                          
                                          <h:outputText class="ui-label-inline" value="include empty spaces?" />
                                          <p:selectBooleanCheckbox id="occperiod-checklist-boolcb-includeemptyspaces"
                                                                   value="#{occInspectionBB.currentInspection.includeEmtpySpaces}">
                                              <p:ajax update="form-inspecteditems"/>
                                          </p:selectBooleanCheckbox>
                                    </h:form>
                                    
                                    <p:separator />
                                    

                                            <p:column width="10%" sortBy="#{fee.fee.amount}"
                                                      filterBy="#{fee.fee.amount}">
                                                <f:facet name="header">
                                                    <h:outputText value="Amount" />
                                                </f:facet>
                                                <h:outputText value="#{fee.fee.amount}"/>
                                            </p:column>

                                            <p:column width="15%" filterBy="#{fee.fee.effectiveDate}"
                                                      sortBy="#{fee.fee.effectiveDate}">
                                                <f:facet name="header">
                                                    <h:outputText value="Effective" />
                                                </f:facet>
                                                <h:outputText value="#{fee.fee.effectiveDate}"/>
                                            </p:column>

                                                    <p:commandButton   id="occperiod-inspectedspace-button-editlocation"
                                                                       ajax="true" 
                                                                       actionListener="#{occInspectionBB.editLocation(inspace)}"
                                                                       rendered="#{systemServicesBB.bbSessionUser.keyCard.hasEnfOfficialPermissions}"
                                                                       onclick="PF('occperiod-location-dialog-var').show()"
                                                                       value="edit location"  
                                                                       disabled="false"
                                                                       icon="fa fa-map-pin"
                                                                       update="
                                                                       occperiod-location-form
                                                                       "/>
                                                    <p:commandButton   id="occperiod-inspectedspace-button-removespace"
                                                                       ajax="true"
                                                                       actionListener="#{occInspectionBB.checklistAction_removeSpaceFromChecklist(inspace)}"
                                                                       rendered="#{systemServicesBB.bbSessionUser.keyCard.hasEnfOfficialPermissions}"
                                                                       value="remove space"  
                                                                       icon="fa fa-trash-o"
                                                                       update="form-inspecteditems
                                                                       occperiod-inspecteditems-form-messages
                                                                       "/>
                                                </div>
                                                <div class="occperiod-inspace-header">
                                                    <h:outputText styleClass="data-text" value="#{inspace.name}" />
                                                </div>
                                                <div class="occperiod-inspace-info">
                                                    <f:subview id="occperiod-inspace-info-location-subview"
                                                               rendered="#{inspace.location.locationID != -1}">
                                                        <h:outputText value="Location: " />
                                                        <h:outputText value="#{inspace.location.locationDescription}" />
                                                        <h:outputText value=" | " />
                                                    </f:subview>
                                                    <h:outputText value="Showing " />
                                                    <h:outputText value="#{inspace.inspectedElementListVisible.size()}" />
                                                    <h:outputText value=" / " />
                                                    <h:outputText value="#{inspace.inspectedElementList.size()} total items" />

                                                </div>
                                            </div>

                                            <p:spacer height="5px" />

                                            <p:dataScroller
                                                id="scroller-inspectedspacelist-elementlist"
                                                widgetVar="var-scroller-inspectedspacelist-elementlist"
                                                var="inelement"

                                                value="#{inspace.inspectedElementListVisible}"
                                                rowIndexVar="#{inelement.inspectedSpaceElementID}">

                                                <div class="occperiod-inelement-header">
                                                    <h:outputText  styleClass="data-text" value="#{inelement.ordSubSecTitle}" />
                                                    <h:outputText  styleClass="data-text" value=" (&#167;" />
                                                    <h:outputText  styleClass="data-text" value="#{inelement.ordSubSecNum}" />
                                                    <h:outputText  styleClass="data-text" value=", " />
                                                    <h:outputText  styleClass="data-text" value="#{inelement.ordSecTitle}; " />
                                                    <h:outputText  styleClass="data-text" value=")" />
                                                </div>

                                                <h:panelGrid    id="occperiod-inspectedspace-panelgrid-inspelement"
                                                                columns="3"
                                                                cellpadding="10" footerClass="gridFooter"
                                                                columnClasses="gridTd, gridTd, gridTd"
                                                                rendered="true">
                                                    <h:panelGroup>

                                                        <div class="status-display-container">
                                                            <div class="status-display-icon-container">
                                                                <i class="material-icons status-display-icon-i #{inelement.status.icon.styleClass}">
                                                                    <h:outputText id="status-display-icon-ot" value="#{inelement.status.icon.materialIcon}"/>
                                                                </i>
                                                            </div>
                                                        </div>
                                                        <p:spacer height="5px" />
                                                        <h:outputLabel styleClass="#{inelement.status.icon.styleClass}"
                                                                       value="#{inelement.status.statusEnum.label}" />
                                                    </h:panelGroup>

                                                    <h:panelGroup>

                                                        <f:subview      id="occperiod-inspectedspace-subview-compliancedata"
                                                                        rendered="#{!(empty inelement.complianceGrantedTS)}">

                                                            <h:outputText value="Compliance granted by: "
                                                                          styleClass="ui-label-inline #{inelement.status.icon.styleClass}" />

                                                            <h:outputText  value="#{inelement.complianceGrantedBy.person.firstName} #{inelement.complianceGrantedBy.person.lastName}"
                                                                           styleClass="data-text #{inelement.status.icon.styleClass}" />

                                                            <h:outputText styleClass="ui-label-inline #{inelement.status.icon.styleClass}" value=" on " />
                                                            <h:outputText  styleClass="data-text #{inelement.status.icon.styleClass}" value="#{occInspectionBB.getPrettyDate(inelement.complianceGrantedTS)}" />
                                                            <p:spacer height="5px" />
                                                        </f:subview>
                                                    </h:panelGroup>
                                                    <h:panelGroup>

                                                        <f:subview id="occperiod-checklist-inelescroller-subview-compliance"
                                                                   rendered="#{empty inelement.complianceGrantedTS}">

                                                            <p:commandButton   id="occperiod-checklist-inelescroller-button-compliance"
                                                                               ajax="true" 
                                                                               actionListener="#{occInspectionBB.checklistAction_recordComplianceWithElement(inelement)}"
                                                                               rendered="#{sessionBean.sessionUser.keyCard.hasEnfOfficialPermissions}"
                                                                               disabled="#{!(empty inelement.complianceGrantedTS)}"
                                                                               value="compliance"  
                                                                               icon="fa fa-check-square-o"
                                                                               update="form-inspecteditems
                                                                               occperiod-inspecteditems-form-messages
                                                                               occperiod-checklisttemplate-form-settings"/>
                                                        </f:subview>

                                                        <p:spacer height="5px" />
                                                        <f:subview id="occperiod-checklist-subview-reinspect"
                                                                   rendered="#{empty inelement.complianceGrantedTS}">

                                                            <p:commandButton   id="occperiod-checklist-scroller-inEle-button-reinspectionwithoutcompliance"
                                                                               ajax="true" 
                                                                               actionListener="#{occInspectionBB.checklistAction_inspectElementWithoutCompliance(inelement)}"
                                                                               rendered="#{sessionBean.sessionUser.keyCard.hasEnfOfficialPermissions}"
                                                                               disabled="#{!(empty inelement.complianceGrantedTS or empty inelement.complianceGrantedTS)}"
                                                                               value="failure"  
                                                                               icon="fa fa-eye"
                                                                               update="form-inspecteditems
                                                                               occperiod-inspecteditems-form-messages
                                                                               occperiod-checklisttemplate-form-settings"/>

                                                        </f:subview>

                                                        <p:spacer height="5px" />
                                                        <f:subview id="occperiod-checklist-subview-withdrawcompliance"
                                                                   rendered="#{!(empty inelement.complianceGrantedTS)}">

                                                            <p:commandButton   id="occperiod-checklist-scroller-inEle-button-removecompliance"
                                                                               ajax="true" 
                                                                               actionListener="#{occInspectionBB.checklistAction_removeComplianceWithElement(inelement)}"
                                                                               rendered="#{sessionBean.sessionUser.keyCard.hasEnfOfficialPermissions}"
                                                                               disabled="#{(empty inelement.complianceGrantedTS)}"
                                                                               value="withdraw compliance"  
                                                                               icon="fa fa-minus-square-o"
                                                                               update="form-inspecteditems
                                                                               occperiod-inspecteditems-form-messages
                                                                               occperiod-checklisttemplate-form-settings
                                                                               "/>


                                                        </f:subview>
                                                        <p:spacer height="5px" />
                                                        <f:subview id="occperiod-checklist-subview-clearinspection"
                                                                   rendered="#{!(empty inelement.lastInspectedTS)}">


                                                            <p:commandButton   id="occperiod-checklist-scroller-inEle-button-clearinspection"
                                                                               ajax="true" 
                                                                               actionListener="#{occInspectionBB.checklistAction_clearInspectionOfElement(inelement)}"
                                                                               rendered="#{sessionBean.sessionUser.keyCard.hasEnfOfficialPermissions}"
                                                                               disabled="#{!(!(empty inelement.lastInspectedTS) or !(empty inelement.complianceGrantedTS))}"
                                                                               value="clear inspection"  
                                                                               icon="fa fa-eraser"
                                                                               update="form-inspecteditems
                                                                               occperiod-inspecteditems-form-messages
                                                                               "/>

                                                        </f:subview>

                                                        <p:spacer height="5px" />

                                                        <p:fieldset legend="Inspection tips" 
                                                                    toggleable="true" 
                                                                    toggleSpeed="500"
                                                                    collapsed="true">

                                                            <h:outputText value="Code guide inspection tips:" escape="false" />
                                                            <h:outputText value="#{inelement.guideEntry.inspectionGuidelines}" escape="false" />
                                                        </p:fieldset>
                                                    </h:panelGroup>
                                                    <h:panelGroup>

                                                        <f:subview      id="occperiod-inspectedspace-subview-compliancedata2"
                                                                        rendered="#{!(empty inelement.complianceGrantedTS)}">

                                                            <h:outputText value="Compliance granted by: " 
                                                                          styleClass="ui-label-inline #{inelement.status.icon.styleClass}" />

                                                            <h:outputText  value="#{inelement.complianceGrantedBy.person.firstName} #{inelement.complianceGrantedBy.person.lastName}" 
                                                                           styleClass="data-text #{inelement.status.icon.styleClass}" />

                                                            <h:outputText styleClass="ui-label-inline #{inelement.status.icon.styleClass}" value=" on " />
                                                            <h:outputText  styleClass="data-text #{inelement.status.icon.styleClass}" value="#{occInspectionBB.getPrettyDate(inelement.complianceGrantedTS)}" />
                                                            <p:spacer height="5px" />

                                                        </f:subview>

                                                        <h:outputText styleClass="ui-label-inline" value="Last inspected by: " />
                                                        <h:outputText  styleClass="data-text" value="#{inelement.lastInspectedBy.person.firstName} #{inelement.lastInspectedBy.person.lastName}" />
                                                        <h:outputText styleClass="ui-label-inline" value=" on " />
                                                        <h:outputText  styleClass="data-text" value="#{occInspectionBB.getPrettyDate(inelement.lastInspectedTS)}" />

                                                        <p:spacer height="5px" />

                                                        <h:outputText styleClass="ui-label-inline" value="Notes: " />

                                                        <h:outputText  styleClass="data-text" value="#{inelement.notes}" escape="false"/>

                                                        <p:spacer height="5px" />

                                                        <p:commandButton   id="occperiod-checklist-scroller-inEle-button-notes"
                                                                           rendered="#{sessionBean.sessionUser.keyCard.hasEnfOfficialPermissions}"
                                                                           value="add note"  
                                                                           icon="fa fa-sticky-note-o"
                                                                           actionListener="#{occInspectionBB.checklistAction_initiateNoteOnInspectedElement(inelement)}"
                                                                           oncomplete="PF('occperiod-dialog-notes-var').show()"
                                                                           update="occperiod-dialog-notes-form"/>


                                                    </h:panelGroup>
                                                </h:panelGrid>

                                                                <f:subview id="occperiod-checklist-inelescroller-subview-compliance"
                                                                           rendered="#{empty inelement.complianceGrantedTS}">

                                                                    <p:commandButton   id="occperiod-checklist-inelescroller-button-compliance"
                                                                                       ajax="true" 
                                                                                       actionListener="#{occInspectionBB.checklistAction_recordComplianceWithElement(inelement)}"
                                                                                       rendered="#{systemServicesBB.bbSessionUser.keyCard.hasEnfOfficialPermissions}"
                                                                                       disabled="#{!(empty inelement.complianceGrantedTS)}"
                                                                                       value="compliance"  
                                                                                       icon="fa fa-check-square-o"
                                                                                       update="form-inspecteditems
                                                                                       occperiod-inspecteditems-form-messages
                                                                                       occperiod-checklisttemplate-form-settings"/>
                                                                </f:subview>

                                                                <p:spacer height="5px" />
                                                                <f:subview id="occperiod-checklist-subview-reinspect"
                                                                           rendered="#{empty inelement.complianceGrantedTS}">

                                                                    <p:commandButton   id="occperiod-checklist-scroller-inEle-button-reinspectionwithoutcompliance"
                                                                                       ajax="true" 
                                                                                       actionListener="#{occInspectionBB.checklistAction_inspectElementWithoutCompliance(inelement)}"
                                                                                       rendered="#{systemServicesBB.bbSessionUser.keyCard.hasEnfOfficialPermissions}"
                                                                                       disabled="#{!(empty inelement.complianceGrantedTS or empty inelement.complianceGrantedTS)}"
                                                                                       value="failure"  
                                                                                       icon="fa fa-eye"
                                                                                       update="form-inspecteditems
                                                                                       occperiod-inspecteditems-form-messages
                                                                                       occperiod-checklisttemplate-form-settings"/>
                                                                </f:subview>

                                                                <p:spacer height="5px" />
                                                                <f:subview id="occperiod-checklist-subview-withdrawcompliance"
                                                                           rendered="#{!(empty inelement.complianceGrantedTS)}">
                                                                    <p:commandButton   id="occperiod-checklist-scroller-inEle-button-removecompliance"
                                                                                       ajax="true" 
                                                                                       actionListener="#{occInspectionBB.checklistAction_removeComplianceWithElement(inelement)}"
                                                                                       rendered="#{systemServicesBB.bbSessionUser.keyCard.hasEnfOfficialPermissions}"
                                                                                       disabled="#{(empty inelement.complianceGrantedTS)}"
                                                                                       value="withdraw compliance"  
                                                                                       icon="fa fa-minus-square-o"
                                                                                       update="form-inspecteditems
                                                                                       occperiod-inspecteditems-form-messages
                                                                                       occperiod-checklisttemplate-form-settings
                                                                                       "/>
                                                                </f:subview>
                                                                <p:spacer height="5px" />
                                                                <f:subview id="occperiod-checklist-subview-clearinspection"
                                                                           rendered="#{!(empty inelement.lastInspectedTS)}">


                                                                    <p:commandButton   id="occperiod-checklist-scroller-inEle-button-clearinspection"
                                                                                       ajax="true" 
                                                                                       actionListener="#{occInspectionBB.checklistAction_clearInspectionOfElement(inelement)}"
                                                                                       rendered="#{systemServicesBB.bbSessionUser.keyCard.hasEnfOfficialPermissions}"
                                                                                       disabled="#{!(!(empty inelement.lastInspectedTS) or !(empty inelement.complianceGrantedTS))}"
                                                                                       value="clear inspection"  
                                                                                       icon="fa fa-eraser"
                                                                                       update="form-inspecteditems
                                                                                       occperiod-inspecteditems-form-messages
                                                                                       "/>
                                                                </f:subview>

                                                                <p:spacer height="5px" />

                                                                <p:fieldset legend="Inspection tips" 
                                                                            toggleable="true" 
                                                                            toggleSpeed="500"
                                                                            collapsed="true">

                                                                    <h:outputText value="Code guide inspection tips:" escape="false" />
                                                                    <h:outputText value="#{inelement.guideEntry.inspectionGuidelines}" escape="false" />
                                                                </p:fieldset>
                                                            </h:panelGroup>
                                                        <h:panelGroup>

                                                                <f:subview      id="occperiod-inspectedspace-subview-compliancedata"
                                                                                rendered="#{!(empty inelement.complianceGrantedTS)}">
                                                                    <h:outputText value="Compliance granted by: " 
                                                                                  styleClass="ui-label-inline #{inelement.status.icon.styleClass}" />
                                                                    <h:outputText  value="#{inelement.complianceGrantedBy.person.firstName} #{inelement.complianceGrantedBy.person.lastName}" 
                                                                                   styleClass="data-text #{inelement.status.icon.styleClass}" />
                                                                    <h:outputText styleClass="ui-label-inline #{inelement.status.icon.styleClass}" value=" on " />
                                                                    <h:outputText  styleClass="data-text #{inelement.status.icon.styleClass}" value="#{occInspectionBB.getPrettyDate(inelement.complianceGrantedTS)}" />
                                                                    <p:spacer height="5px" />
                                                                </f:subview>

                                                                <h:outputText styleClass="ui-label-inline" value="Last inspected by: " />
                                                                <h:outputText  styleClass="data-text" value="#{inelement.lastInspectedBy.person.firstName} #{inelement.lastInspectedBy.person.lastName}" />
                                                                <h:outputText styleClass="ui-label-inline" value=" on " />
                                                                <h:outputText  styleClass="data-text" value="#{occInspectionBB.getPrettyDate(inelement.lastInspectedTS)}" />

                                                                <p:spacer height="5px" />

                                                                <h:outputText styleClass="ui-label-inline" value="Notes: " />

                                                                <h:outputText  styleClass="data-text" value="#{inelement.notes}" escape="false"/>

                                                                <p:spacer height="5px" />

                                                                <p:commandButton   id="occperiod-checklist-scroller-inEle-button-notes"
                                                                                   rendered="#{systemServicesBB.bbSessionUser.keyCard.hasEnfOfficialPermissions}"
                                                                                   value="add note"  
                                                                                   icon="fa fa-sticky-note-o"
                                                                                    actionListener="#{occInspectionBB.checklistAction_initiateNoteOnInspectedElement(inelement)}"
                                                                                    oncomplete="PF('occperiod-dialog-notes-var').show()"
                                                                                    update="occperiod-dialog-notes-form"/>
                                                            </h:panelGroup>
                                                    </h:panelGrid>
                                                <hr />  
                                            </p:dataScroller>
                                        </p:dataScroller>
                                    </h:form>

                                </p:panel>
                            </div>
                        </div>
                    </div>


                    <p:dialog   id="occperiod-dialog-periodmetadata"
                                height="400" width="600"
                                widgetVar="occperiod-dialog-periodmetadata-var"
                                closable="true"
                                header="occupancy period settings"
                                rendered="#{systemServicesBB.bbSessionUser.keyCard.hasEnfOfficialPermissions}"
                                >

                        <h:form id="occperiod-dialog-periodmetadata-form">

                            <h:messages id="occperiod-dialog-periodmetadata-messages"
                                        globalOnly="true" showDetail="true" showSummary="true"
                                        warnClass="msgWarn" infoClass="msgInfo" fatalClass="msgFatal" errorClass="msgError">
                            </h:messages>

                            <h:panelGrid columns="2"
                                         columnClasses="gridTd, gridTd">

                                <h:panelGroup>
                                    <h:outputText value="Period type:"
                                                  styleClass="ui-label font-smaller"/>
                                    <p:selectOneMenu
                                        id="som-occperiodtype" tabindex="1"
                                        value="#{occInspectionBB.selectedOccPeriodType}">

                                        <f:converter converterId="occPeriodTypeConverter"/>
                                        <f:selectItem itemLabel="Select a period type..." itemDisabled="true" noSelectionOption="true"/>
                                        <f:selectItems id="si-typelist"
                                                       value="#{occInspectionBB.occPeriodTypeList}"
                                                       var ="opt"
                                                       itemValue="#{opt}"
                                                       itemLabel="#{opt.title}" />
                                    </p:selectOneMenu>

                                    <p:spacer height="5px" />

                                    <p:commandButton    id="occperiod-periodmetadata-subview-typelock-unlocked-button-changetype"
                                                        ajax="true"
                                                        styleClass="noFill"
                                                        actionListener="#{occInspectionBB.up}"
                                                        disabled="#{systemServicesBB.bbSessionUser.keyCard.hasEnfOfficialPermissions}"
                                                        value="change period type"
                                                        icon="fa fa-edit"
                                                        title="update period type"/>

                                </h:panelGroup>
                            </h:panelGrid>

                            <p:commandButton    id="occperiod-updatemetadata-button-cancel"
                                                ajax="true"  tabindex="27"
                                                value="Cancel"
                                                icon="fa fa-stop"
                                                immediate="true"
                                                onclick="PF('occperiod-dialog-periodmetadata-var').hide()"
                                                />

                            <p:commandButton id="button-updatemetadata" ajax="true"
                                             value="update period settings"
                                             actionListener="#{occInspectionBB.updateOccPeriodCommit}"
                                             icon="fa fa-thumbs-o-up" tabindex="28"
                                             oncomplete="PF('occperiod-dialog-periodmetadata-var').hide()"
                                             update="
                                             occperiod-form-periodmetadata
                                             form-messages-global"
                                             />
                        </h:form>
                    </p:dialog>

                    <p:dialog   id="occinspection-dialog-addspace"
                                height="500" width="700"
                                widgetVar="occinspection-dialog-addspace-var"
                                closable="true" 
                                header="inspect a space"
                                rendered="#{systemServicesBB.bbSessionUser.keyCard.hasEnfOfficialPermissions}"
                                >
                         
                                    <h:form id="occinspection-dialog-addspace-form-info">
                                            
                                        <h2>
                                            Inspection checklist builder
                                        </h2>
                                        
                                        <div class="occperiod-template-metadata">
                                            <h:outputText styleClass="ui-label-inline" value="Checklist title: " />
                                            <h:outputText styleClass="data-text" value="#{occInspectionBB.currentInspection.checklistTemplate.title}" />
                                            <h:outputText styleClass="data-text" value=" (ID: " />
                                            <h:outputText styleClass="data-text" value="#{occInspectionBB.currentInspection.checklistTemplate.inspectionChecklistID}" />
                                            <h:outputText styleClass="data-text" value=")" />
                                        </div>
                                        
                                        <h:outputText value="Mark newly added space as: " 
                                                      styleClass="ui-label-inline"/>
                                        
                                         <p:selectOneMenu
                                            id="report-insp-filter-som"
                                            value="#{occInspectionBB.selectedInspectedElementAddValue}">

                                            
                                            <f:selectItems id="status-list" 
                                                           value="#{occInspectionBB.inspectedElementAddValueCandidateList}" 
                                                           var ="option" 
                                                           itemValue="#{option}" 
                                                           itemLabel="#{option.label}" />
                                            <p:ajax />
                                        </p:selectOneMenu>
                                        
                                        <p:spacer height="5px" />
                                        
                                        <p:commandButton    id="occinspection-dialog-addspace-button-addallrequiredspacetypes"
                                                            ajax="true" 
                                                            actionListener="#{occInspectionBB.checklistAction_addAllRequiredSpaceTypes}"
                                                            oncomplete="PF('occinspection-dialog-addspace-var').hide()"
                                                            rendered="#{systemServicesBB.bbSessionUser.keyCard.hasEnfOfficialPermissions}"
                                                            value="add all required spaces"  
                                                            icon="fa fa-clone"
                                                             update=" form-inspecteditems
                                                                    occperiod-inspecteditems-form-messages
                                                                    "/>
                                    </h:form>
                                        <p:spacer height="5px" />
                                        
                                    <h:form id="occinspection-dialog-addspace-form-adder">
                                            
                                             <h:panelGrid   id="occinspection-dialog-addspace-grid" 
                                                            columns="3" 
                                                            columnClasses="gridTd, gridTd" 
                                                            rendered="true">
                                                 <h:panelGroup>
                                                    <p:selectOneListbox id="occinspection-dialog-addspace-listbox-occspacetype" 
                                                                        required="true" 
                                                                        value="#{occInspectionBB.selectedOccSpaceType}" 
                                                                        tabindex="1">
                                                        <p:ajax update="occinspection-dialog-addspace-listbox-occspaces
                                                                occinspection-dialog-addspace-button-add"                                                               
                                                                listener="#{occInspectionBB.loadSpacesInType}"
                                                                /> 
                                                        <f:converter converterId="occSpaceTypeConverter" />
                                                        <f:selectItems value="#{occInspectionBB.currentInspection.checklistTemplate.occSpaceTypeTemplateList}" 
                                                                       var="st" itemLabel="#{st.spaceTypeTitle}" />
                                                    </p:selectOneListbox>
                                                 </h:panelGroup>
                                                 <h:panelGroup>
                                                     
                                                    <p:selectOneListbox id="occinspection-dialog-addspace-listbox-occspaces" 
                                                                    required="true" 
                                                                    value="#{occInspectionBB.selectedOccSpace}" 
                                                                    tabindex="2">
                                                        <p:ajax update="occinspection-dialog-addspace-scroller-elementlist
                                                                occinspection-dialog-addspace-button-add"
                                                                listener="#{occInspectionBB.loadElementsInSpace}"
                                                                /> 
                                                        <f:converter converterId="occSpaceConverter" />
                                                        <f:selectItems value="#{occInspectionBB.spacesInTypeList}" 
                                                                       var="sp" itemLabel="#{sp.name}" />

                                                    </p:selectOneListbox>
                                                     
                                                 </h:panelGroup>
                                                 <h:panelGroup>
                                                 
                                                            <p:commandButton       id="occinspection-dialog-addspace-button-add"
                                                                                   ajax="true" 
                                                                                   actionListener="#{occInspectionBB.checklistAction_addSpaceToChecklist(occInspectionBB.selectedOccSpace)}"
                                                                                   rendered="#{systemServicesBB.bbSessionUser.keyCard.hasEnfOfficialPermissions}"
                                                                                   disabled="#{empty occInspectionBB.selectedOccSpace}"
                                                                                   oncomplete="PF('occinspection-dialog-addspace-var').hide()"
                                                                                   value="add to checklist"  
                                                                                   icon="fa fa-plus"
                                                                                   update=" form-inspecteditems
                                                                                            occperiod-inspecteditems-form-messages">
                                                                
                                                            </p:commandButton>
                                                            
                                                            
                                                          
                                        
                                                 </h:panelGroup>
                                             </h:panelGrid>
                                            <h:outputText styleClass="ui-label" value="Elements in this space:" />
                                            
                                                <p:dataScroller
                                                    id="occinspection-dialog-addspace-scroller-elementlist"
                                                    widgetVar="occinspection-dialog-addspace-scroller-elementlist-var"
                                                    var="codeElement"
                                                    value="#{occInspectionBB.elementsInSpaceList}"
                                                    rowIndexVar="#{codeElement.elementID}">

                        <h:form id="occinspection-dialog-addspace-form-info">

                            <h2>
                                Inspection checklist builder
                            </h2>

                            <div class="occperiod-template-metadata">
                                <h:outputText styleClass="ui-label-inline" value="Checklist title: " />
                                <h:outputText styleClass="data-text" value="#{occInspectionBB.currentInspection.checklistTemplate.title}" />
                                <h:outputText styleClass="data-text" value=" (ID: " />
                                <h:outputText styleClass="data-text" value="#{occInspectionBB.currentInspection.checklistTemplate.inspectionChecklistID}" />
                                <h:outputText styleClass="data-text" value=")" />
                            </div>

                            <h:outputText value="Mark newly added space as: " 
                                          styleClass="ui-label-inline"/>

                            <p:selectOneMenu
                                id="report-insp-filter-som"
                                value="#{occInspectionBB.selectedInspectedElementAddValue}">


                                <f:selectItems id="status-list" 
                                               value="#{occInspectionBB.inspectedElementAddValueCandidateList}" 
                                               var ="option" 
                                               itemValue="#{option}" 
                                               itemLabel="#{option.label}" />
                                <p:ajax />
                            </p:selectOneMenu>

                            <p:spacer height="5px" />

                            <p:commandButton    id="occinspection-dialog-addspace-button-addallrequiredspacetypes"
                                                ajax="true" 
                                                actionListener="#{occInspectionBB.checklistAction_addAllRequiredSpaceTypes}"
                                                oncomplete="PF('occinspection-dialog-addspace-var').hide()"
                                                rendered="#{sessionBean.sessionUser.keyCard.hasEnfOfficialPermissions}"
                                                value="add all required spaces"  
                                                icon="fa fa-clone"
                                                update=" form-inspecteditems
                                                occperiod-inspecteditems-form-messages
                                                "/>
                        </h:form>
                        <p:spacer height="5px" />

                        <h:form id="occinspection-dialog-addspace-form-adder">

                            <h:panelGrid   id="occinspection-dialog-addspace-grid" 
                                           columns="3" 
                                           columnClasses="gridTd, gridTd" 
                                           rendered="true">
                                <h:panelGroup>
                                    <p:selectOneListbox id="occinspection-dialog-addspace-listbox-occspacetype" 
                                                        required="true" 
                                                        value="#{occInspectionBB.selectedOccSpaceType}" 
                                                        tabindex="1">
                                        <p:ajax update="occinspection-dialog-addspace-listbox-occspaces
                                                occinspection-dialog-addspace-button-add"                                                               
                                                listener="#{occInspectionBB.loadSpacesInType}"
                                                /> 
                                        <f:converter converterId="occSpaceTypeConverter" />
                                        <f:selectItems value="#{occInspectionBB.currentInspection.checklistTemplate.occSpaceTypeTemplateList}" 
                                                       var="st" itemLabel="#{st.spaceTypeTitle}" />
                                    </p:selectOneListbox>
                                </h:panelGroup>
                                <h:panelGroup>

                                    <p:selectOneListbox id="occinspection-dialog-addspace-listbox-occspaces" 
                                                        required="true" 
                                                        value="#{occInspectionBB.selectedOccSpace}" 
                                                        tabindex="2">
                                        <p:ajax update="occinspection-dialog-addspace-scroller-elementlist
                                                occinspection-dialog-addspace-button-add"
                                                listener="#{occInspectionBB.loadElementsInSpace}"
                                                /> 
                                        <f:converter converterId="occSpaceConverter" />
                                        <f:selectItems value="#{occInspectionBB.spacesInTypeList}" 
                                                       var="sp" itemLabel="#{sp.name}" />

                                    </p:selectOneListbox>

                                </h:panelGroup>
                                <h:panelGroup>

                                    <p:commandButton       id="occinspection-dialog-addspace-button-add"
                                                           ajax="true" 
                                                           actionListener="#{occInspectionBB.checklistAction_addSpaceToChecklist(occInspectionBB.selectedOccSpace)}"
                                                           rendered="#{sessionBean.sessionUser.keyCard.hasEnfOfficialPermissions}"
                                                           disabled="#{empty occInspectionBB.selectedOccSpace}"
                                                           oncomplete="PF('occinspection-dialog-addspace-var').hide()"
                                                           value="add to checklist"  
                                                           icon="fa fa-plus"
                                                           update=" form-inspecteditems
                                                           occperiod-inspecteditems-form-messages">

                                    </p:commandButton>




                                </h:panelGroup>
                            </h:panelGrid>
                            <h:outputText styleClass="ui-label" value="Elements in this space:" />

                            <p:dataScroller
                                id="occinspection-dialog-addspace-scroller-elementlist"
                                widgetVar="occinspection-dialog-addspace-scroller-elementlist-var"
                                var="codeElement"
                                value="#{occInspectionBB.elementsInSpaceList}"
                                rowIndexVar="#{codeElement.elementID}">

                                <div class="outlinedBox">

                                    <h:outputLabel styleClass="bold" value="Ordindance: "  />
                                    <p:spacer height="5px" />
                                    <h:outputText  value="&#167;#{codeElement.ordSecNum}:" />
                                    <h:outputText  value="#{codeElement.ordSecTitle}; " />
                                    <h:outputText  value="&#167;&#167;#{codeElement.ordSubSecNum} " />
                                    <h:outputText  value="#{codeElement.ordSubSecTitle}" />
                                    <p:spacer height="2px" />

                                </div>
                            </p:dataScroller>
                            <p:spacer height="5px" />
                            <p:commandButton    id="occinspection-dialog-addspace-button-newpermit"
                                                value="view static template"  
                                                ajax="true" 
                                                actionListener="#{occInspectionBB.viewStaticChecklistTemplate}" 
                                                oncomplete="PF('occperiod-dialog-fullchecklisttemplate-var').show()"
                                                disabled="false"
                                                rendered="true"
                                                icon="fa fa-align-left"
                                                update="occperiod-configurereport-occpermit-form"/>
                        </h:form>
                    </p:dialog>

                    <p:dialog   id="occperiod-dialog-notes"
                                height="300" width="650"
                                widgetVar="occperiod-dialog-notes-var"
                                closable="true"
                                header="notes"
                                rendered="#{systemServicesBB.bbSessionUser.keyCard.hasEnfOfficialPermissions}"
                                >

                        <h:form id="occperiod-dialog-notes-form">

                            <h:messages id="occperiod-dialog-notes-messages"
                                        globalOnly="true" showDetail="true" showSummary="true"
                                        warnClass="msgWarn" infoClass="msgInfo" fatalClass="msgFatal" errorClass="msgError">
                            </h:messages>

                            <h:panelGrid columns="1"
                                         columnClasses="gridTd, gridTd">

                                <h:panelGroup>
                                    <h:outputText styleClass="ui-label" value="Note text: "/>
                                    <p:editor   id="occperiod-notes-editor"
                                                value="#{occInspectionBB.formNoteText}"
                                                controls="bold italic underline strikethrough font size style color
                                                bullets numbering center undo redo rule link removeformat outdent
                                                indent link unlink copy cut paste rule alignleft center alignright"
                                                width="400" required="false"
                                                height="200"/>

                                    <h:message for="occperiod-checklist-overlay-notes-editor" showDetail="false" showSummary="true"
                                               warnClass="msgWarn" infoClass="msgInfo" fatalClass="msgFatal" errorClass="msgError" />

                                    <p:spacer height="5px" />

                                        <p:commandButton   id="occperiod-dialog-notes-button-addnote"
                                                           ajax="true" 
                                                           actionListener="#{occInspectionBB.checklistAction_addNoteToInspectedElement()}"
                                                           oncomplete="PF('occperiod-dialog-notes-var').hide()"
                                                           rendered="#{systemServicesBB.bbSessionUser.keyCard.hasEnfOfficialPermissions}"                                                                               
                                                           value="save note"  
                                                           icon="fa fa-sticky-note-o"
                                                           update="form-inspecteditems
                                                           occperiod-inspecteditems-form-messages
                                                           form-inspecteditems
                                                           "/>
                                 </h:panelGroup>
                             </h:panelGrid>
                        </h:form>
                    </p:dialog>



                    <p:dialog   id="occperiod-dialog-inspection-notes"
                                height="300" width="550"
                                widgetVar="occperiod-dialog-inspection-notes-var"
                                closable="true"
                                header="notes"
                                rendered="#{systemServicesBB.bbSessionUser.keyCard.hasEnfOfficialPermissions}"
                                >

                        <h:form id="occperiod-dialog-inspection-notes-form">

                            <h:messages id="occperiod-dialog-inspection-notes-messages"
                                        globalOnly="true" showDetail="true" showSummary="true"
                                        warnClass="msgWarn" infoClass="msgInfo" fatalClass="msgFatal" errorClass="msgError">
                            </h:messages>

                            <h:panelGrid columns="1"
                                         columnClasses="gridTd, gridTd">

                                <h:panelGroup>
                                    <h:outputText styleClass="ui-label" value="Note text: "/>
                                    <p:editor   id="occperiod-inspection-notes-editor"  
                                                value="#{occInspectionBB.formNoteText}" 
                                                controls="bold italic underline strikethrough font size style color 
                                                bullets numbering center undo redo rule link removeformat outdent 
                                                indent link unlink copy cut paste rule alignleft center alignright"
                                                width="500" required="false"
                                                height="200"/>

                                    <h:message for="occperiod-inspection-notes-editor" showDetail="false" showSummary="true" 
                                               warnClass="msgWarn" infoClass="msgInfo" fatalClass="msgFatal" errorClass="msgError" />

                                        <p:commandButton   id="occperiod-dialog-inspection-notes-button-addnote"
                                                           ajax="true" 
                                                           actionListener="#{occInspectionBB.attachNoteToInspection}"
                                                           oncomplete="PF('occperiod-dialog-inspection-notes-var').hide()"
                                                           rendered="#{systemServicesBB.bbSessionUser.keyCard.hasEnfOfficialPermissions}"                                                                               
                                                           value="save note"  
                                                           icon="fa fa-sticky-note-o"
                                                           update="
                                                           occperiod-checklist-form-settings
                                                           occperiod-inspecteditems-form-messages
                                                           "/>
                                 </h:panelGroup>
                             </h:panelGrid>
                        </h:form>
                    </p:dialog>



                    <p:dialog   id="occperiod-dialog-periodpropunit"
                                height="650" width="900"
                                widgetVar="occperiod-dialog-periodpropunit-var"
                                closable="true"
                                header="occupancy period property unit"
                                rendered="#{systemServicesBB.bbSessionUser.keyCard.hasEnfOfficialPermissions}"
                                >
                        <h:form id="occperiod-dialog-periodpropunit-form">
                            <h:messages id="occperiod-dialog-periodpropunit-messages"
                                        globalOnly="true" showDetail="true" showSummary="true"
                                        warnClass="msgWarn" infoClass="msgInfo" fatalClass="msgFatal" errorClass="msgError">
                            </h:messages>

                            <h:outputText   value="Property units on current property: #{sessionBean.sessionProperty.address} (#{sessionBean.sessionProperty.muni.muniName})"
                                            styleClass="ui-label font-smaller"/>

                            <p:selectOneMenu id="occperiod-dialog-periodpropunit-candidatepropunit-som" required="true"
                                             value="#{occInspectionBB.selectedPropertyUnit}">
                                <f:selectItem itemLabel="select a property unit..." noSelectionOption="true" />
                                <f:selectItems value="#{occInspectionBB.propertyUnitCandidateList}"  var="pu" itemValue="#{pu}"
                                               itemLabel="#{pu.unitNumber} (ID: #{pu.unitID})"/>
                                <f:converter converterId="propertyUnitConverter"/>
                            </p:selectOneMenu>

                            <p:spacer height="5px" />


                            <p:commandButton    id="occperiod-dialog-periodpropunit-button-cancel"
                                                ajax="true"  tabindex="27"
                                                value="Cancel"
                                                icon="fa fa-stop"
                                                immediate="true"
                                                onclick="PF('occperiod-dialog-periodpropunit-var').hide()"
                                                />

                            <p:commandButton id="occperiod-dialog-periodpropunit-button-submit" ajax="true"
                                             value="update property unit" action="#{occInspectionBB.checklistAction_editOccupancyInspectionMetadata}"
                                             icon="fa fa-thumbs-o-up" tabindex="28"
                                             oncomplete="PF('occperiod-dialog-periodpropunit-var').hide()"
                                             update="occperiod-form-address
                                             form-messages-global"
                                             />
                        </h:form>
                    </p:dialog>

                    <p:dialog   id="occperiod-dialog-inspectionsettings"
                                height="650" width="900"
                                widgetVar="occperiod-dialog-inspectionsettings-var"
                                closable="true" 
                                header="inspection configuration"
                                rendered="#{systemServicesBB.bbSessionUser.keyCard.hasEnfOfficialPermissions}"
                                >
                        <h:form id="inspectionsettings-form-messages">
                            <h:messages id="messages-dialog-inspections"
                                        globalOnly="true" showDetail="true" showSummary="true" 
                                        warnClass="msgWarn" infoClass="msgInfo" fatalClass="msgFatal" errorClass="msgError">
                            </h:messages>
                            
                        </h:form>
                        <h:form id="inspectionsettings-form-configureinspections">
                                
                             <p:selectOneMenu id="configureinspections-som-templates" required="false" 
                                              value="#{occInspectionBB.selectedInspectionTemplate}">
                                        <f:selectItem itemLabel="select a checklist..." noSelectionOption="true" />
                                        <f:selectItems value="#{occInspectionBB.inspectionTemplateCandidateList}"  var="template" itemValue="#{template}" 
                                                       itemLabel="#{template.title} (ID:#{template.inspectionChecklistID}, #{template.muni.muniName})"/>
                                        <f:converter converterId="occChecklistTemplateConverter"/>
                                        <p:ajax update="configureinspections-button-newinspection" />
                                </p:selectOneMenu>
                            
                              <p:commandButton id="configureinspections-button-newinspection" 
                                             ajax="true"
                                             value="attach new inspection" 
                                             actionListener="#{occInspectionBB.checklistAction_implementNewInspectionChecklist}"
                                             disabled="#{empty occInspectionBB.selectedInspectionTemplate}"
                                             icon="fa fa-plus" 
                                             tabindex="1"
                                             update="occperiod-inspectionconfig-inspectionlist
                                             form-dialog-inspectionmetadata
                                             inspectionsettings-form-messages
                                             "
                                             />
                            
                              <p:spacer height="5px" />
                            
                            <p:dataTable
                                id="occperiod-inspectionconfig-inspectionlist"
                                widgetVar="occperiod-inspectionconfig-inspectionlist-var"
                                var="inspection"
                                value="#{occInspectionBB.currentOccPeriod.inspectionList}"
                                rowIndexVar="#{inspection.inspectionID}">

                                <p:column width="5%">
                                    <f:facet name="header">
                                        <h:outputText styleClass="ui-label-inline" value="ID" />
                                    </f:facet>
                                    <h:outputText styleClass="data-text" value="#{inspection.inspectionID}" />
                                </p:column>
                                <p:column>
                                    <f:facet name="header">
                                        <h:outputText styleClass="ui-label-inline" value="Date created" />
                                    </f:facet>
                                        <h:outputText styleClass="data-text" value="#{occInspectionBB.getPrettyDateNoTime(inspection.creationTS)}" />
                                </p:column>
                                <p:column>
                                    <f:facet name="header">
                                        <h:outputText styleClass="ui-label-inline" value="Checklist" />
                                    </f:facet>
                                    <h:outputText styleClass="data-text" value="#{inspection.checklistTemplate.title} (#{inspection.checklistTemplate.inspectionChecklistID})" />
                                </p:column>
                                <p:column>
                                    <f:facet name="header">
                                        <h:outputText styleClass="ui-label-inline" value="Status" />
                                    </f:facet>
                                    <h:outputText styleClass="data-text" value="#{empty inspection.passedInspectionTS ? 'incomplete' : occInspectionBB.getPrettyDateNoTime(inspection.passedInspectionTS)}" />
                                </p:column>
                                <p:column>
                                    <f:facet name="header">
                                        <h:outputText styleClass="ui-label-inline" value="Inspector" />
                                    </f:facet>
                                    <h:outputText styleClass="data-text" value="#{inspection.inspector.person.firstName} #{inspection.inspector.person.lastName}" />
                                </p:column>
                                <p:column>
                                    <f:facet name="header">
                                        <h:outputText styleClass="ui-label-inline" value="Active?" />
                                    </f:facet>
                                    <h:outputText styleClass="data-text" value="#{inspection.active}" />
                                </p:column>

                                <p:column>
                                    <f:facet name="header">
                                        <h:outputText styleClass="ui-label-inline" value="tools" />
                                    </f:facet>
                                    <p:commandButton   id="occperiod-inspectionconfig-button-activateinspection"
                                                       ajax="true" 
                                                       value="activate"
                                                       disabled="false"
                                                       actionListener="#{occInspectionBB.checklistAction_activateOccInspection(inspection)}"
                                                       rendered="#{systemServicesBB.bbSessionUser.keyCard.hasEnfOfficialPermissions}"
                                                       icon="fa fa-bolt"
                                                       update="form-dialog-inspectionmetadata
                                                       occperiod-inspecteditems-form-messages
                                                       occperiod-checklist-form-settings
                                                       form-inspecteditems
                                                       occperiod-checklisttemplate-form-settings
                                                       occperiod-checklisttemplate-form-spacetype"
                                                       />
                                </p:column>
                            </p:dataTable>
                        </h:form>

                        <ui:remove> <!-- REMOVE THIS UI:REMOVE ELEMENT BEFORE PUSH. 
                                         LOOK FOR ANOTHER COMMENT ABOVE, THIS FORM HAS AN UPDATE STATEMENT. -->

                            <h:form id="inspectionsettings-form-configureinspections">


                                <p:selectOneMenu id="configureinspections-som-templates" required="false" 
                                                 value="#{occInspectionBB.selectedInspectionTemplate}">
                                    <f:selectItem itemLabel="select a checklist..." noSelectionOption="true" />
                                    <f:selectItems value="#{occInspectionBB.inspectionTemplateCandidateList}"  var="template" itemValue="#{template}" 
                                                   itemLabel="#{template.title} (ID:#{template.inspectionChecklistID}, #{template.muni.muniName})"/>
                                    <f:converter converterId="occChecklistTemplateConverter"/>
                                    <p:ajax update="configureinspections-button-newinspection" />
                                </p:selectOneMenu>

                                <p:commandButton id="configureinspections-button-newinspection" 
                                                 ajax="true"
                                                 value="attach new inspection" 
                                                 actionListener="#{occInspectionBB.implementNewInspectionChecklist}"
                                                 disabled="#{empty occInspectionBB.selectedInspectionTemplate}"
                                                 icon="fa fa-plus" 
                                                 tabindex="1"
                                                 oncomplete="PF('occperiod-dialog-inspectionsettings-var"
                                                 update="occperiod-checklist-form-settings
                                                 inspectionsettings-form-messages
                                                 form-inspecteditems
                                                 occperiod-inspecteditems-form-messages"
                                                 />

                                <p:spacer height="5px" />

                                <p:dataTable
                                    id="occperiod-inspectionconfig-inspectionlist"
                                    widgetVar="occperiod-inspectionconfig-inspectionlist-var"
                                    var="inspection"
                                    value="#{occInspectionBB.currentOccPeriod.inspectionList}"
                                    rowIndexVar="#{inspection.inspectionID}">

                                    <p:column width="5%">
                                        <f:facet name="header">
                                            <h:outputText styleClass="ui-label-inline" value="ID" />
                                        </f:facet>
                                        <h:outputText styleClass="data-text" value="#{inspection.inspectionID}" />
                                    </p:column>
                                    <p:column>
                                        <f:facet name="header">
                                            <h:outputText styleClass="ui-label-inline" value="Date created" />
                                        </f:facet>
                                        <h:outputText styleClass="data-text" value="#{occInspectionBB.getPrettyDateNoTime(inspection.creationTS)}" />
                                    </p:column>
                                    <p:column>
                                        <f:facet name="header">
                                            <h:outputText styleClass="ui-label-inline" value="Checklist" />
                                        </f:facet>
                                        <h:outputText styleClass="data-text" value="#{inspection.checklistTemplate.title} (#{inspection.checklistTemplate.inspectionChecklistID})" />
                                    </p:column>
                                    <p:column>
                                        <f:facet name="header">
                                            <h:outputText styleClass="ui-label-inline" value="Status" />
                                        </f:facet>
                                        <h:outputText styleClass="data-text" value="#{empty inspection.passedInspectionTS ? 'incomplete' : occInspectionBB.getPrettyDateNoTime(inspection.passedInspectionTS)}" />
                                    </p:column>
                                    <p:column>
                                        <f:facet name="header">
                                            <h:outputText styleClass="ui-label-inline" value="Inspector" />
                                        </f:facet>
                                        <h:outputText styleClass="data-text" value="#{inspection.inspector.person.firstName} #{inspection.inspector.person.lastName}" />
                                    </p:column>
                                    <p:column>
                                        <f:facet name="header">
                                            <h:outputText styleClass="ui-label-inline" value="Active?" />
                                        </f:facet>
                                        <h:outputText styleClass="data-text" value="#{inspection.active}" />
                                    </p:column>

                                    <p:column>
                                        <f:facet name="header">
                                            <h:outputText styleClass="ui-label-inline" value="tools" />
                                        </f:facet>
                                        <p:commandButton   id="occperiod-inspectionconfig-button-activateinspection"
                                                           ajax="true" 
                                                           value="activate"
                                                           disabled="false"
                                                           actionListener="#{occInspectionBB.activateOccInspection(inspection)}"
                                                           rendered="#{sessionBean.sessionUser.keyCard.hasEnfOfficialPermissions}"
                                                           icon="fa fa-bolt"
                                                           update="form-dialog-inspectionmetadata
                                                           @this
                                                           occperiod-inspecteditems-form-messages
                                                           occperiod-checklist-form-settings
                                                           form-inspecteditems
                                                           occperiod-checklisttemplate-form-settings
                                                           occperiod-checklisttemplate-form-spacetype"
                                                           />
                                    </p:column>
                                </p:dataTable>
                            </h:form>

                        </ui:remove>

                        <h:form id="form-dialog-inspectionmetadata">

                            <h:panelGrid columns="2"
                                         columnClasses="gridTd, gridTd">


                                <h:panelGroup>
                                    <h:outputText styleClass="ui-label-inline" value="Inspection ID: " />
                                    <h:outputText  styleClass="data-text" value="#{occInspectionBB.currentInspection.inspectionID}" />
                                    <p:spacer height="3px" />
                                </h:panelGroup>

                                <h:panelGroup>
                                    <h:outputText styleClass="ui-label-inline" value="Inspector: " />
                                    <h:outputText  styleClass="data-text" value="#{occInspectionBB.currentInspection.inspector.person.firstName}
                                                   #{occInspectionBB.currentInspection.inspector.person.lastName}
                                                   (ID:#{occInspectionBB.currentInspection.inspector.userID})" />

                                    <p:spacer height="5px" />

                                    <p:selectOneMenu id="cecases-criteria-user" required="false"
                                                     value="#{occInspectionBB.selectedInspector}">
                                        <f:selectItem itemLabel="select an inspector..." noSelectionOption="true" />
                                        <f:selectItems value="#{occInspectionBB.inspectorCandidateList}"  var="u" itemValue="#{u}" 
                                                       itemLabel="#{u.person.firstName} #{u.person.lastName} (ID:#{u.username})"/>
                                        <f:converter converterId="userConverter"/>
                                    </p:selectOneMenu>

                                </h:panelGroup>
                                <h:panelGroup>
                                    <h:outputText styleClass="ui-label-inline" value="Checklist template: " />
                                    <h:outputText  styleClass="data-text" value="#{occInspectionBB.currentInspection.checklistTemplate.title}" />
                                    <h:outputText  styleClass="data-text" value=" " />
                                    <h:outputText  styleClass="data-text" value="(ID:#{occInspectionBB.currentInspection.checklistTemplate.inspectionChecklistID})" />
                                    <p:spacer height="0px" />
                                    <h:outputText  styleClass="data-text" value="#{occInspectionBB.currentInspection.checklistTemplate.description}" />
                                    <p:spacer height="0px" />
                                    <h:outputText  styleClass="data-text" value="#{occInspectionBB.currentInspection.checklistTemplate.governingCodeSource.sourceName}" />
                                    <h:outputText  styleClass="data-text" value="(#{occInspectionBB.currentInspection.checklistTemplate.governingCodeSource.sourceYear})" />

                                    <p:spacer height="5px" />

                                    <p:inputText    id="occperiod-metadata-input-checklisttemplateid"
                                                    value="#{occInspectionBB.currentInspection.checklistTemplate.inspectionChecklistID}"
                                                    required="true"/>

                                    <h:message for="cecases-search-relative-dates-start-it" showDetail="false" showSummary="true"
                                               warnClass="msgWarn" infoClass="msgInfo" fatalClass="msgFatal" errorClass="msgError" />

                                </h:panelGroup>
                                <h:panelGroup>
                                    <h:outputText styleClass="ui-label-inline" value="Inspection date of record:" />
                                    <h:outputText  styleClass="data-text" value="#{occInspectionBB.getPrettyDate(currentInspection.effectiveDateOfRecord)}" />

                                    <p:calendar     id="cal-dialog-inspectionmetadata-inspeffectivedate"
                                                    value="#{occInspectionBB.currentInspection.effectiveDateOfRecordUtilDate}"
                                                    mode="popup"
                                                    showOn="button" pattern="EEE, dd MMM, yyyy"
                                                    navigator="true" tabindex="16" timeInput="false" showHour="false" showMinute="false" showSecond="false" showMillisec="false"
                                                    showButtonPanel="true" showTodayButton="true"
                                                    required="false"/>

                                    <h:message for="cal-dialog-inspectionmetadata-inspeffectivedate" showDetail="false" showSummary="true"
                                               warnClass="msgWarn" infoClass="msgInfo" fatalClass="msgFatal" errorClass="msgError" />

                                </h:panelGroup>
                                <h:panelGroup>
                                    <h:outputText styleClass="ui-label-inline" value="Public access control code: " />
                                    <h:outputText  styleClass="data-text" value="#{occInspectionBB.currentInspection.pacc}" />
                                    <p:spacer height="0px" />
                                    <h:outputText styleClass="ui-label-inline" value="Public access enabled: " />
                                    <h:outputText  styleClass="data-text" value="#{occInspectionBB.currentInspection.enablePacc}" />

                                </h:panelGroup>
                                <h:panelGroup>
                                    <h:outputText styleClass="ui-label" value="Max occupants: " />
                                    <p:inputText    id="occperiod-metadata-input-maxocc"
                                                    value="#{occInspectionBB.currentInspection.maxOccupantsAllowed}"
                                                    required="false">
                                        <p:clientValidator />
                                    </p:inputText>
                                    <h:outputText styleClass="ui-label" value="Number bedrooms: " />
                                    <p:inputText    id="occperiod-metadata-input-bedrooms"
                                                    value="#{occInspectionBB.currentInspection.numBedrooms}"
                                                    required="false">
                                        <p:clientValidator />
                                    </p:inputText>

                                    <h:outputText styleClass="ui-label" value="Number bathrooms: " />
                                    <p:inputText    id="occperiod-metadata-input-bathrooms"
                                                    value="#{occInspectionBB.currentInspection.numBathrooms}"
                                                    required="false">
                                        <p:clientValidator />
                                    </p:inputText>


                                </h:panelGroup>
                                <h:panelGroup>
                                    <h:outputText styleClass="ui-label-inline" value="Third party inspector: " />
                                    <h:outputText  styleClass="data-text" value="#{occInspectionBB.currentInspection.thirdPartyInspector.firstName}
                                                   #{occInspectionBB.currentInspection.thirdPartyInspector.lastName}" />
                                    <h:outputText styleClass="ui-label-inline" value="Third party approval timestamp: " />
                                    <h:outputText  styleClass="data-text" value="#{occInspectionBB.getPrettyDate(occInspectionBB.currentInspection.thirdPartyInspectorApprovalTS)}" />

                                    <h:outputText styleClass="ui-label-inline" value="Third party inspection certified by:" />
                                    <h:outputText  styleClass="data-text" value="#{occInspectionBB.currentInspection.thirdPartyApprovalBy.person.firstName}
                                                   #{occInspectionBB.currentInspection.thirdPartyApprovalBy.person.lastName}" />

                                </h:panelGroup>
                                <h:panelGroup>
                                    <h:outputText styleClass="ui-label-inline" value="Notes:" />
                                    <h:outputText  styleClass="data-text" value="#{occInspectionBB.currentInspection.notes}" escape="false" />

                                </h:panelGroup>
                            </h:panelGrid>


                            <p:spacer height="5px"/>



                            <p:commandButton    id="occperiod-button-cancelmetadata"
                                                ajax="true"  tabindex="27"
                                                value="Cancel"
                                                icon="fa fa-stop"
                                                immediate="true"
                                                onclick="PF('occperiod-dialog-inspectionsettings-var').hide()"
                                                />

                            <p:commandButton id="occperiod-button-updatemetadata" 
                                             ajax="true"
                                             value="update metadata" 
                                             action="#{occInspectionBB.checklistAction_editOccupancyInspectionMetadata}"
                                             icon="fa fa-thumbs-o-up" 
                                             tabindex="28"
                                             oncomplete="PF('occperiod-dialog-inspectionsettings-var').hide()"
                                             update="occperiod-checklist-form-settings"
                                             />

                        </h:form>
                    </p:dialog>



                    <p:dialog   id="occperiod-dialog-blobs"
                                header="Photos and docs attached to checklist element ID: #{occInspectionBB.currentInSpcEl.inspectedSpaceElementID}"
                                widgetVar="occperiod-dialog-blobs-var"
                                closable="true"
                                rendered="#{systemServicesBB.bbSessionUser.keyCard.hasMuniReaderPermissions}">

                        <h:form id="occperiod-dialog-blobs-form">
                            <p:scrollPanel style="width:1000px; height:400px" mode="native">
                                <p:dataTable
                                    id="photoTable"
                                    var="photoid"
                                    value="#{occInspectionBB.currentInSpcEl.blobList}"
                                    rowKey="#{photoid}"
                                    tableStyleClass="primeDataTable"
                                    draggableRows="false" tabindex="6">
                                    <p:column width="10%">
                                        <f:facet name="header">
                                            <h:outputText value="Manage"/>
                                        </f:facet>
                                        <p:commandButton ajax="true"
                                                         actionListener="#{caseProfileBB.deletePhoto(photoid)}"
                                                         value="Delete"
                                                         icon="fa fa-bomb"
                                                         rendered="#{systemServicesBB.bbSessionUser.keyCard.hasSysAdminPermissions}"
                                                         update=":photo-form:photoTable"/>
                                    </p:column>
                                    <p:column>
                                        <f:facet name="header">
                                            <h:outputText value="Photo"/>
                                        </f:facet>
                                        <p:graphicImage width="100%" value="#{imageServices.image}">
                                            <f:param name="photoID" value="#{photoid}"/>
                                        </p:graphicImage>
                                    </p:column>
                                    <p:column width="20%">
                                        <f:facet name="header">
                                            <h:outputText value="Description"/>
                                        </f:facet>
                                        <h:outputText escape="false" value="#{imageServices.getPhotograph(photoid).description}"/>
                                    </p:column>
                                </p:dataTable>
                            </p:scrollPanel>
                            <p:spacer height="15px"/>
                            <p:commandButton ajax="true"
                                             icon="fa fa-stop"
                                             value="close"
                                             onclick="PF('occperiod-dialog-blobs-var').hide()"/>
                        </h:form>
                    </p:dialog>




                    <p:dialog    id="occperiod-events-dialog-addeditevent"
                                 height="650" width="900"
                                 widgetVar="occperiod-events-dialog-addeditevent-var"
                                 closable="true" 
                                 rendered="#{systemServicesBB.bbSessionUser.keyCard.hasMuniStaffPermissions}">


                        <h:form id="occperiod-events-dialog-form">

                            <h1>
                                Add/edit occupancy period event
                            </h1>

                            <p:outputLabel for="add-event-ec-ot">
                                <h:outputText styleClass="bold" value="Event:"/>
                            </p:outputLabel>
                            <h:outputText id="add-event-ec-ot" value="#{occInspectionBB.currentEvent.category.eventCategoryTitle}"/>
                            <h:outputText id="add-event-ec-ot2" value=" (cat ID:#{occInspectionBB.currentEvent.eventID})"/>

                            <p:spacer height="5px"/>

                            <p:outputLabel for="add-event-et-ot">
                                <h:outputText styleClass="bold" value="Event type:"/>
                            </p:outputLabel>
                            <h:outputText id="add-event-et-ot" value="#{occInspectionBB.currentEvent.category.eventType.label}"/>

                            <p:spacer height="5px"/>

                            <p:outputLabel for="add-event-cd-ot">
                                <h:outputText styleClass="bold" value="Cateogry description:"/>
                            </p:outputLabel>
                            <h:outputText id="add-event-cd-ot" value="#{occInspectionBB.currentEvent.category.eventCategoryDesc}"/>



                            <h2>Event details</h2>

                            <h:panelGrid columns="2" border="0"
                                         cellpadding="5" columnClasses="gridTd, gridTd"
                                         footerClass="gridFooter">

                                <f:facet name="header">
                                    <h:panelGroup>
                                        <p:outputLabel for="eventDesc">
                                            <h:outputText value="Short Description:"/>
                                        </p:outputLabel>
                                        <p:inputText id="eventDesc" value="#{occInspectionBB.currentEvent.description}"
                                                     style="width: 600px;" tabindex="3" required="true" styleClass="inputText"/>
                                        <h:message for="eventDesc" showDetail="false" showSummary="true"
                                                   warnClass="msgWarn" infoClass="msgInfo" fatalClass="msgFatal" errorClass="msgError" />
                                    </h:panelGroup>
                                </f:facet>

                                <h:panelGroup>

                                    <h:outputLabel for="activeEvent">
                                        <h:outputText value="Active Event?"/>
                                    </h:outputLabel>
                                    <p:spacer height="5px"/>
                                    <p:selectBooleanCheckbox tabindex="18" id="activeEvent" value="#{occInspectionBB.currentEvent.active}" />

                                </h:panelGroup>

                                <h:panelGroup>
                                    <h:outputLabel for="eventDateCal">
                                        <h:outputText value="Date of Record"/>
                                    </h:outputLabel>
                                    <p:spacer height="5px"/>
                                    <p:calendar value="#{occInspectionBB.currentEvent.dateOfRecordUtilDate}"
                                                mode="popup"  id="eventDateCal"
                                                showOn="button" pattern="EEE, dd MMM, yyyy HH:mm:ss"
                                                navigator="true" tabindex="16" timeInput="true" showHour="true" showMinute="true" showSecond="false" showMillisec="false"
                                                showButtonPanel="true" showTodayButton="true"
                                                required="true"/>
                                    <h:message for="eventDateCal" showDetail="false" showSummary="true"
                                               warnClass="msgWarn" infoClass="msgInfo" fatalClass="msgFatal" errorClass="msgError" />
                                </h:panelGroup>

                                <h:panelGroup>
                                    <h:outputLabel for="discloseToMuniIS">
                                        <h:outputText value="Disclose to Municipalities"/>
                                    </h:outputLabel>
                                    <p:spacer height="5px"/>
                                    <p:selectBooleanCheckbox tabindex="18" id="discloseToMuniIS" value="#{occInspectionBB.currentEvent.discloseToMunicipality}" />
                                </h:panelGroup>

                                <h:panelGroup>
                                    <h:outputLabel for="discloseToPublic">
                                        <h:outputText value="Disclose to Public"/>
                                    </h:outputLabel>
                                    <p:spacer height="5px"/>
                                    <p:selectBooleanCheckbox tabindex="18" id="discloseToPublic" value="#{occInspectionBB.currentEvent.discloseToPublic}" />
                                </h:panelGroup>


                                <f:facet name="footer">

                                    <h:outputLabel for="eventNotes">
                                        <h:outputText value="Event Notes:"/>
                                    </h:outputLabel>
                                    <h:panelGroup>
                                        <p:editor id="eventNotes" value="#{occInspectionBB.currentEvent.notes}"
                                                  controls="bold italic underline strikethrough font size style color
                                                  bullets numbering center undo redo rule link removeformat outdent
                                                  indent link unlink copy cut paste rule alignleft center alignright"
                                                  width="700"
                                                  height="100"/>
                                        <h:message for="eventNotes" showDetail="false" showSummary="true"
                                                   warnClass="msgWarn" infoClass="msgInfo" fatalClass="msgFatal" errorClass="msgError" />
                                    </h:panelGroup>
                                </f:facet>

                            </h:panelGrid>

                            <h2>Connect persons to event</h2>

                            <h:form id="add-person-to-event-form">

                                <h:panelGroup>
                                    <p:outputLabel id="person-list-menu-ol" for="person-list-menu" value="Current person list:"/>
                                    <p:selectOneMenu id="person-list-menu" required="false" value="#{occInspectionBB.selectedPerson}">
                                        <f:selectItem itemLabel="select a person..." noSelectionOption="true" />
                                        <f:selectItems value="#{sessionBean.sessionPersonList}"  var="p" itemValue="#{p}"
                                                       itemLabel="#{p.firstName} #{p.lastName} (id:#{p.personID})"/>
                                        <f:converter converterId="personConverter"/>
                                    </p:selectOneMenu>
                                    <h:message for="person-list-menu" showDetail="false" showSummary="true"
                                               warnClass="msgWarn" infoClass="msgInfo" fatalClass="msgFatal" errorClass="msgError" />
                                </h:panelGroup>

                                <p:commandButton    ajax="true" actionListener="#{occInspectionBB.events_queuePerson}"
                                                    value="Add selected person to event" disabled="true"
                                                    update="persons-to-add-ds"/>
                                <p:spacer height="5px"/>

                                <p:dataScroller     id="persons-to-add-ds"
                                                    value="#{occInspectionBB.currentEvent.personList}"
                                                    var="pers">
                                    <h:outputText value="#{pers.firstName} #{pers.lastName} (id:#{pers.personID})"/>
                                    <p:commandButton    ajax="true"
                                                        icon="fa fa-trash"
                                                        immediate="true"
                                                        actionListener="#{occInspectionBB.events_deQueuePersonFromEvent(pers)}"
                                                        update="persons-to-add-ds"/>
                                </p:dataScroller>

                                <p:spacer height="5px"/>

                                <p:commandButton ajax="true"
                                                 value="Cancel" icon="fa fa-stop"
                                                 onclick="PF('occperiod-events-dialog-addeditevent-var').hide()"/>

                                <p:commandButton ajax="true" actionListener="#{occInspectionBB.events_attachNewEvent}"
                                                 value="Create new event" icon="fa fa-plus"
                                                 oncomplete="PF('occperiod-events-dialog-addeditevent-var').hide()"
                                                 disabled="#{!(occInspectionBB.currentEvent.eventID == 0)}"
                                                 rendered="#{systemServicesBB.bbSessionUser.keyCard.hasMuniStaffPermissions}"
                                                 update="occperiod-form-events
                                                 occperiod-messages-form-rightcolheader"/>

                                <p:commandButton ajax="true" actionListener="#{occInspectionBB.events_commitEventEdits}"
                                                 value="Edit event" icon="fa fa-edit"
                                                 disabled="#{occInspectionBB.currentEvent.eventID != 0}"
                                                 rendered="#{systemServicesBB.bbSessionUser.keyCard.hasMuniStaffPermissions}"
                                                 oncomplete="PF('occperiod-events-dialog-addeditevent-var').hide()"
                                                 update="occperiod-form-events
                                                 occperiod-messages-form-rightcolheader"/>

                                <p:commandButton ajax="true" actionListener="#{occInspectionBB.deleteSelectedEvent}"
                                                 value="Nuke event" icon="fa fa-bomb"
                                                 oncomplete="PF('occperiod-events-dialog-addeditevent-var').hide()"
                                                 rendered="#{sessionBeasessionUserer.keyCard.hasSysAdminPermissions}"
                                                 update="occperiod-form-events
                                                 occperiod-messages-form-rightcolheader
                                                 "/>
                            </h:form>


                        </h:form>
                    </p:dialog>

                    <p:dialog   id="occperiod-configurereport-occinspection-dialog"
                                height="650" width="900"
                                widgetVar="occperiod-configurereport-occinspection-var"
                                closable="true" 
                                rendered="#{systemServicesBB.bbSessionUser.keyCard.hasMuniStaffPermissions}"
                                
                                >
                        <h:form id="occperiod-configurereport-occinspection-form">
                            <h:messages id="occperiod-configurereport-occinspection-messages"
                                        globalOnly="true" showDetail="true" showSummary="true"
                                        warnClass="msgWarn" infoClass="msgInfo" fatalClass="msgFatal" errorClass="msgError">
                            </h:messages>

                            <h2>Configure inspection report</h2>

                            <h:panelGrid columns="2"
                                         columnClasses="gridTd, gridTd">

                                <f:facet name="header">
                                    <div class="occperiod-configurereport-occinspection-headerinfocontainer">

                                        <h:outputLabel for="occperiod-report-occinspection-it-title" value="Report title"/>

                                        <p:spacer height="5px"/>

                                        <p:inputText id="occperiod-report-occinspection-it-title"
                                                     style="width: 300px;"
                                                     value="#{occInspectionBB.reportConfigOccInspec.title}"/>
                                        <h:outputText styleClass="italic"
                                                      value="note: your name and the current date and time will be automatically inserted" />



                                        <h:outputLabel for="report-case-profile-notes-ita" value="Notes: "/>
                                        <p:spacer height="5px"/>
                                        <p:inputText id="report-case-profile-notes-ita"
                                                     style="width: 300px; height: 100px;"
                                                     value="#{occInspectionBB.reportConfigOccInspec.notes}"/>
                                        <p:spacer height="5px"/>
                                    </div>
                                </f:facet>

                                <h:panelGroup>
                                    <h3>Inspection checklist view options</h3>

                                    <h:outputLabel class="ui-label-inline"
                                                   value="Include full occupancy period information? "
                                                   for="report-insp-incperiodinfo-cb" />
                                    <p:selectBooleanCheckbox id="report-insp-incperiodinfo-cb"
                                                             value="#{occInspectionBB.reportConfigOccInspec.includeOccPeriodInfoHeader}" />

                                    <p:spacer height="5px" />

                                    <h:outputLabel class="ui-label-inline"
                                                   value="Checklist items to include: "
                                                   for="report-insp-filter-som" />
                                    <p:selectOneMenu
                                        id="report-insp-filter-som"
                                        value="#{occInspectionBB.reportConfigOccInspec.viewSetting}">

                                        <f:selectItem itemLabel="Select a list view option..." itemDisabled="true" noSelectionOption="true"/>
                                        <f:selectItems id="si-typelist"
                                                       value="#{occInspectionBB.itemFilterOptions}"
                                                       var ="option"
                                                       itemValue="#{option}"
                                                       itemLabel="#{option.label}" />
                                    </p:selectOneMenu>


                                    <p:spacer height="5px" />



                                </h:panelGroup>

                                <h:panelGroup>

                                    <h:outputLabel class="ui-label-inline"
                                                   value="Include photos of failed elements? "
                                                   for="report-insp-incphotofailed-cb" />
                                    <p:selectBooleanCheckbox id="report-insp-incphotofailed-cb"
                                                             value="#{occInspectionBB.reportConfigOccInspec.includePhotos_fail}"
                                                             disabled="true"/>

                                    <p:spacer height="5px" />

                                    <h:outputLabel class="ui-label-inline"
                                                   value="Include photos of passed elements? "
                                                   for="report-insp-incphotopassed-cb" />
                                    <p:selectBooleanCheckbox id="report-insp-incphotopassed-cb"
                                                             value="#{occInspectionBB.reportConfigOccInspec.includePhotos_pass}"
                                                             disabled="true"/>

                                </h:panelGroup>

                                <h:panelGroup>
                                    <h:outputLabel class="ui-label-inline"
                                                   value="Include full ordinance text? "
                                                   for="report-insp-incordtext-cb" />
                                    <p:selectBooleanCheckbox id="report-insp-incordtext-cb"
                                                             value="#{occInspectionBB.reportConfigOccInspec.includeFullOrdText}"
                                                             disabled="false"/>

                                    <p:spacer height="5px" />

                                    <h:outputLabel class="ui-label-inline"
                                                   value="Include notes on checklist items? "
                                                   for="report-insp-incnotes-cb" />
                                    <p:selectBooleanCheckbox id="report-insp-incnotes-cb"
                                                             value="#{occInspectionBB.reportConfigOccInspec.includeElementNotes}"
                                                             disabled="false"/>

                                    <p:spacer height="5px" />

                                    <h:outputLabel class="ui-label-inline"
                                                   value="Include last inspected info? "
                                                   for="report-insp-inclastinspecinfo-cb" />
                                    <p:selectBooleanCheckbox id="report-insp-inclastinspecinfo-cb"
                                                             value="#{occInspectionBB.reportConfigOccInspec.includeElementLastInspectedInfo}"
                                                             disabled="false"/>

                                    <p:spacer height="5px" />

                                    <h:outputLabel class="ui-label-inline"
                                                   value="Include compliance info? "
                                                   for="report-insp-inccompinfo-cb" />
                                    <p:selectBooleanCheckbox id="report-insp-inccompinfo-cb"
                                                             value="#{occInspectionBB.reportConfigOccInspec.includeElementComplianceInfo}"
                                                             disabled="false"/>

                                    <p:spacer height="5px" />

                                    <h:outputLabel class="ui-label-inline"
                                                   value="Include failed item remedy suggestions? "
                                                   for="report-insp-incremedy-cb" />
                                    <p:selectBooleanCheckbox id="report-insp-incremedy-cb"
                                                             value="#{occInspectionBB.reportConfigOccInspec.includeRemedyInfo}"
                                                             disabled="true"/>

                                    <p:spacer height="5px" />

                                </h:panelGroup>
                                <h:panelGroup>

                                    <h:outputLabel class="ui-label-inline"
                                                   value="Include officer signature? "
                                                   for="report-insp-incsig-cb" />
                                    <p:selectBooleanCheckbox id="report-insp-incsig-cb"
                                                             value="#{occInspectionBB.reportConfigOccInspec.includeSignature}"
                                                             disabled="true"/>


                                </h:panelGroup>

                            </h:panelGrid>

                            <p:commandButton   id="occperiod-configurereport-occinspection-button-cancel"
                                               ajax="true"
                                               value="Cancel" icon="fa fa-stop"
                                               onclick="PF('occperiod-configurereport-occinspection-var').hide()"/>

                            <p:commandButton    id="occperiod-configurereport-occinspection-button-generate"
                                                ajax="false"
                                                action="#{occInspectionBB.reports_generateOccInspectionReport}"
                                                value="Generate report" icon="fa fa-list-ul"
                                                />
                        </h:form>

                    </p:dialog>

                    <p:dialog   id="occperiod-configurereport-occpermit-dialog"
                                height="650" width="900"
                                widgetVar="occperiod-configurereport-occpermit-var"
                                closable="true" 
                                rendered="#{systemServicesBB.bbSessionUser.keyCard.hasEnfOfficialPermissions}"
                                >

                        <h:form id="occperiod-configurereport-occpermit-form">

                            <h:messages id="occperiod-configurereport-occpermit-messages"
                                        globalOnly="true" showDetail="true" showSummary="true"
                                        warnClass="msgWarn" infoClass="msgInfo" fatalClass="msgFatal" errorClass="msgError">
                            </h:messages>


                            <h:panelGrid columns="2"
                                         columnClasses="gridTd, gridTd">

                            </h:panelGrid>
                            <p:commandButton   id="occperiod-configurereport-occpermit-button-cancel"
                                               ajax="true"
                                               value="Cancel" icon="fa fa-stop"
                                               onclick="PF('occperiod-configurereport-occpermit-var').hide()"/>

                            <p:commandButton    id="occperiod-configurereport-occpermit-button-generate"
                                                ajax="false"
                                                action="#{occInspectionBB.reports_generateOccPermit(currentOccPermit)}"
                                                value="Generate permit" icon="fa fa-plus"
                                                disabled="false"
                                                rendered="#{systemServicesBB.bbSessionUser.keyCard.hasMuniStaffPermissions}"/>
                        </h:form>
                    </p:dialog>


                    <p:dialog   id="occperiod-rejectproposal-dialog"
                                height="650" width="900"
                                widgetVar="occperiod-rejectproposal-dialog-var"
                                closable="true" 
                                rendered="#{systemServicesBB.bbSessionUser.keyCard.hasEnfOfficialPermissions}"
                                >

                        <h:form id="occperiod-rejectproposal-form">

                            <h:messages id="occperiod-rejectproposal-messages"
                                        globalOnly="true" showDetail="true" showSummary="true"
                                        warnClass="msgWarn" infoClass="msgInfo" fatalClass="msgFatal" errorClass="msgError">
                            </h:messages>


                            <h:outputText styleClass="ui-label" value="reason for rejecting proposal" />

                            <p:inputText    id="proposal-rejectreason-it"
                                            value="#{occInspectionBB.formProposalRejectionReason}"
                                            required="true"/>



                            <p:commandButton    id="proposal-button-reject"
                                                ajax="true"
                                                styleClass="noFill button-size-small"
                                                actionListener="#{occInspectionBB.rejectProposal(proposal)}"
                                                rendered="#{!proposal.directive.requiredEvaluationForBOBClose}"
                                                oncomplete="PF('occperiod-rejectproposal-dialog-var').hide()"
                                                icon="fa fa-hand-stop-o"
                                                update="occperiod-form-proposals
                                                occperiod-form-events
                                                occperiod-panel-proposals-messages-form"/>
                        </h:form>
                    </p:dialog>

                    <p:dialog   id="occperiod-location-dialog"
                                height="300" width="400"
                                widgetVar="occperiod-location-dialog-var"
                                closable="true"
                                header="locations"
                                rendered="#{systemServicesBB.bbSessionUser.keyCard.hasEnfOfficialPermissions}"
                                >

                        <h:form id="occperiod-location-form">

                            <h:messages id="occperiod-location-messages"
                                        globalOnly="true" showDetail="true" showSummary="true"
                                        warnClass="msgWarn" infoClass="msgInfo" fatalClass="msgFatal" errorClass="msgError">
                            </h:messages>

                            <h:outputText styleClass="dialog-title"
                                          value="Update location option 1: Reassign to an existing location: "
                                          rendered="#{occInspectionBB.currentLocation.locationID != 0}"/>
                            <h:outputText styleClass="dialog-title"
                                          value="Option 1: Choose an existing location: "
                                          rendered="#{occInspectionBB.currentLocation.locationID == 0}"/>

                            <h:panelGrid columns="1"
                                         columnClasses="gridTd">

                                <h:panelGroup>
                                    <p:spacer height="5px" />
                                        <p:selectOneMenu
                                            id="som-occperiodtype" tabindex="1"
                                            value="#{occInspectionBB.selectedLocation}">

                                            <f:converter converterId="occLocationDescriptorConverter"/>
                                            <f:selectItem itemLabel="Select a location..." itemDisabled="true" noSelectionOption="true"/>
                                            <f:selectItems id="si-typelist" 
                                                           value="#{occInspectionBB.workingLocationList}" 
                                                           var ="loc" 
                                                           itemValue="#{loc}" 
                                                           itemLabel="#{loc.locationDescription} (fl. #{loc.locationDescription})" />
                                            </p:selectOneMenu>

                                            <p:commandButton    id="occperiod-location-button-existinglocation"
                                                                ajax="true" 
                                                                action="#{occInspectionBB.attachExistingLocation}"
                                                                value="add new location" icon="fa fa-plus"
                                                                disabled="false"
                                                                update="occperiod-messages-form-rightcolheader:occperiod-messages-messages-rightcolheader"
                                                                rendered="#{systemServicesBB.bbSessionUser.keyCard.hasEnfOfficialPermissions}"
                                                                oncomplete="PF('occperiod-location-dialog-var').hide()"/>
                                    
                                                  
                                </h:panelGroup>

                                <h:panelGroup>
                                    <h:outputText styleClass="dialog-title"
                                                  value="Edit location details: "
                                                  rendered="#{occInspectionBB.currentLocation.locationID != 0}"/>
                                    <h:outputText styleClass="dialog-title"
                                                  value="Create a new location: "
                                                  rendered="#{occInspectionBB.currentLocation.locationID == 0}"/>

                                    <h:outputText styleClass="ui-label" value="Create a new location: " />

                                    <p:spacer height="5px" />

                                    <p:outputLabel for="occperiod-location-it-desc">
                                        <h:outputText value="Location name: "/>
                                    </p:outputLabel>
                                    <p:inputText    id="occperiod-location-it-desc"
                                                    value="#{occInspectionBB.currentLocation.locationDescription}"
                                                    style="width: 200px;"
                                                    tabindex="3"
                                                    required="true"
                                                    styleClass="inputText"/>
                                    <h:message for="occperiod-location-it-desc" showDetail="false" showSummary="true"
                                               warnClass="msgWarn" infoClass="msgInfo" fatalClass="msgFatal" errorClass="msgError" />
                                </h:panelGroup>

                                <h:panelGroup>
                                    <p:outputLabel for="occperiod-location-it-floor">
                                        <h:outputText value="Building floor number (0 = bsmt; 1 = ground...)"/>
                                    </p:outputLabel>
                                    <p:inputText    id="occperiod-location-it-floor"
                                                    value="#{occInspectionBB.currentLocation.locationDescription}"
                                                    style="width: 30px;"
                                                    tabindex="3"
                                                    type="integer"
                                                    required="true"
                                                    styleClass="inputText"/>
                                    <h:message for="occperiod-location-it-floor" showDetail="false" showSummary="true"
                                               warnClass="msgWarn" infoClass="msgInfo" fatalClass="msgFatal" errorClass="msgError" />

                                </h:panelGroup>

                            </h:panelGrid>


                            <p:commandButton   id="occperiod-location-button-closedialog"
                                               ajax="true"
                                               value="Cancel" icon="fa fa-stop"
                                               onclick="PF('occperiod-location-dialog-var').hide()"/>

                            <p:commandButton    id="occperiod-location-button-addNewLocation"
                                                ajax="true"
                                                action="#{occInspectionBB.addNewLocationDescriptor}"
                                                value="add new location" icon="fa fa-plus"
                                                disabled="false"
                                                update="occperiod-messages-form-rightcolheader:occperiod-messages-messages-rightcolheader"
                                                rendered="#{systemServicesBB.bbSessionUser.keyCard.hasEnfOfficialPermissions}"
                                                oncomplete="PF('occperiod-location-dialog-var').hide()"/>
                        </h:form>
                    </p:dialog>

                    <p:dialog  id="occperiod-inspaceconfig-dialog"
                               height="650" width="900"
                               widgetVar="occperiod-inspaceconfig-var"
                               closable="true" 
                               rendered="#{systemServicesBB.bbSessionUser.keyCard.hasEnfOfficialPermissions}"
                               >

                        <h:form id="occperiod-inspaceconfig-form">

                            <h:messages id="occperiod-inspaceconfig-messages"
                                        globalOnly="true" showDetail="true" showSummary="true"
                                        warnClass="msgWarn" infoClass="msgInfo" fatalClass="msgFatal" errorClass="msgError">
                            </h:messages>


                            <h:panelGrid columns="2"
                                         border="0"
                                         cellpadding="5"
                                         columnClasses="gridTd, gridTd">

                                <f:facet name="header">


                                    <h:outputLabel for="report-case-profile-title-it" value="Report title"/>

                                    <p:spacer height="5px"/>

                                    <p:inputText id="report-case-profile-title-it" style="width: 300px;" value="#{caseProfileBB.reportCECase.title}"/>
                                    <h:outputText styleClass="italic" value="note: your name and the current date and time will be automatically inserted" />

                                    <p:spacer height="5px"/>

                                    <h:outputLabel class="bold" value="Include case name" for="report-case-profile-casename-chkbox" />
                                    <p:selectBooleanCheckbox id="report-case-profile-casename-chkbox" value="#{caseProfileBB.reportCECase.includeCaseName}" />

                                    <p:spacer height="5px"/>

                                    <h:outputLabel for="report-case-profile-notes-ita" value="Notes"/>
                                    <p:spacer height="5px"/>
                                    <p:inputText id="report-case-profile-notes-ita" style="width: 300px; height: 100px;" value="#{caseProfileBB.reportCECase.notes}"/>
                                    <p:spacer height="5px"/>
                                </f:facet>

                            </h:panelGrid>
                        </h:form>

                    </p:dialog>


                    <p:dialog   id="occperiod-inspaceeleconfig-dialog"
                                height="650" width="900"
                                widgetVar="occperiod-inspaceeleconfig-var"
                                closable="true" 
                                rendered="#{systemServicesBB.bbSessionUser.keyCard.hasEnfOfficialPermissions}"
                                >

                        <h:form id="occperiod-inspaceeleconfig-form">

                            <h:messages id="occperiod-inspaceeleconfig-messages"
                                        globalOnly="true" showDetail="true" showSummary="true"
                                        warnClass="msgWarn" infoClass="msgInfo" fatalClass="msgFatal" errorClass="msgError">
                            </h:messages>


                            <h:panelGrid columns="2"
                                         columnClasses="gridTd, gridTd">

                            </h:panelGrid>
                        </h:form>

                    </p:dialog>


                    <p:dialog   id="occperiod-inspectionconfig-dialog"
                                height="650" width="900"
                                widgetVar="occperiod-inspaceeleconfig-var"
                                closable="true" 
                                rendered="#{systemServicesBB.bbSessionUser.keyCard.hasEnfOfficialPermissions}"
                                >

                        <h:form id="occperiod-inspectionconfig-form">

                            <h:messages id="occperiod-inspectionconfig-messages"
                                        globalOnly="true" showDetail="true" showSummary="true"
                                        warnClass="msgWarn" infoClass="msgInfo" fatalClass="msgFatal" errorClass="msgError">
                            </h:messages>

                    <p:dialog   id="occperiod-dialog-proposalmetadata"
                                height="650" width="900"
                                widgetVar="occperiod-dialog-proposalmetadata-var"
                                closable="true" 
                                rendered="#{systemServicesBB.bbSessionUser.keyCard.hasMuniStaffPermissions}"
                                >


                            <p:dataTable
                                id="occperiod-inspectionconfig-inspectionlist"
                                widgetVar="occperiod-inspectionconfig-inspectionlist-var"
                                var="inspection"
                                value="#{occInspectionBB.currentOccPeriod.inspectionList}"
                                rowIndexVar="#{inspection.inspectionID}">

                                <p:column width="5%">
                                    <f:facet name="header">
                                        <h:outputText styleClass="ui-label-inline" value="ID" />
                                    </f:facet>
                                    <h:outputText styleClass="data-text" value="#{inspection.inspectionID}" />
                                </p:column>
                                <p:column>
                                    <f:facet name="header">
                                        <h:outputText styleClass="ui-label-inline" value="Date created" />
                                    </f:facet>
                                    <h:outputText styleClass="data-text" value="#{occInspectionBB.getPrettyDateNoTime(inspection.creationTS)}" />
                                </p:column>
                                <p:column>
                                    <f:facet name="header">
                                        <h:outputText styleClass="ui-label-inline" value="Status" />
                                    </f:facet>
                                    <h:outputText styleClass="data-text" value="#{empty inspection.passedInspectionTS ? 'incomplete' : occInspectionBB.getPrettyDateNoTime(inspection.passedInspectionTS)}" />
                                </p:column>
                                <p:column>
                                    <f:facet name="header">
                                        <h:outputText styleClass="ui-label-inline" value="Inspector" />
                                    </f:facet>
                                    <h:outputText styleClass="data-text" value="#{inspection.inspector.person.firstName} #{inspection.inspector.person.lastName}" />
                                </p:column>
                                <p:column>
                                    <f:facet name="header">
                                        <h:outputText styleClass="ui-label-inline" value="Active?" />
                                    </f:facet>
                                    <h:outputText styleClass="data-text" value="#{inspection.active}" />
                                </p:column>

                                <p:column>
                                    <f:facet name="header">
                                        <h:outputText styleClass="ui-label-inline" value="Activate" />
                                    </f:facet>
                                    <p:commandButton   id="occperiod-inspectionconfig-button-activateinspection"
                                                       ajax="true"
                                                       actionListener="#{occInspectionBB.activateOccInspection(inspection)}"
                                                       rendered="#{sessionBean.sessionUser.keyCard.hasEnfOfficialPermissions}"
                                                       icon="fa fa-bolt"
                                                       />
                                </p:column>
                                <p:rowExpansion>
                                    <div class="outlinedBox">
                                        <h3>Proposal tools</h3>
                                        <p:commandButton    id="proposal-choice-button-clearchoice"
                                                                        ajax="true" 
                                                                        styleClass="proposal-choice-button"
                                                                        actionListener="#{occInspectionBB.proposals_clearProposal(pr)}"
                                                                        rendered="#{systemServicesBB.bbSessionUser.keyCard.hasEnfOfficialPermissions and !(empty pr.responseTS)}"
                                                                        value="Revoke choice and reset proposal"
                                                                        update="occperiod-form-proposals
                                                                        occperiod-panel-proposals-messages-form
                                                                        occperiod-form-events:occperiod-events-datatable"/>
                                        
                                        <h:panelGrid    id="proposals-grid-rowexp" 
                                                        columns="2" 
                                                        columnClasses="td-dense" 
                                                        rendered="true">
                                            <h:panelGroup>

                                                <h:outputText styleClass="ui-label-inline" 
                                                              value="Proposal ID: "  />
                                                <h:outputText styleClass="data-text" 
                                                              value="#{pr.proposalID}" />

                                                <p:spacer height="5px" />

                                                <h:outputText styleClass="ui-label-inline" 
                                                              value="Directive ID:"  />
                                                <h:outputText styleClass="data-text" 
                                                              value="#{pr.directive.directiveID}" />

                                                <p:spacer height="5px" />

                                                <h:outputText styleClass="ui-label-inline" 
                                                              value="Generating event ID: "  />
                                                <h:outputText styleClass="data-text" 
                                                              value="#{pr.generatingEventID}" />

                                            </h:panelGroup>

                                            <h:panelGroup>

                                                <h:outputText styleClass="ui-label-inline" 
                                                              value="Initiator: "  />
                                                <h:outputText styleClass="data-text" 
                                                              value="#{pr.initiator.person.lastName}" />
                                                <h:outputText value=" (ID: " styleClass="data-text" />
                                                <h:outputText styleClass="data-text" 
                                                              value="#{pr.initiator.userID}" />
                                                <h:outputText value=")" styleClass="data-text" />

                                                <p:spacer height="5px" />

                                                <h:outputText styleClass="ui-label-inline" 
                                                              value="Responder intended: "  />
                                                <h:outputText styleClass="data-text" 
                                                              value="#{pr.responderIntended.person.lastName}" />
                                                <h:outputText value=" (ID: " styleClass="data-text" />
                                                <h:outputText styleClass="data-text" 
                                                              value="#{pr.responderIntended.userID}" />
                                                <h:outputText value=")" styleClass="data-text" />

                                                <p:spacer height="5px" />

                                                <h:outputText styleClass="ui-label-inline" 
                                                              value="Responder actual: "  />
                                                <h:outputText styleClass="data-text" 
                                                              value="#{pr.responderActual.person.lastName}" />
                                                <h:outputText value=" (ID: " styleClass="data-text" />
                                                <h:outputText styleClass="data-text" 
                                                              value="#{pr.responderActual.userID}" />
                                                <h:outputText value=")" styleClass="data-text" />


                                            </h:panelGroup>
                                            <h:panelGroup>
                                                <h:outputText styleClass="ui-label-inline" 
                                                              value="Activates on: "  />
                                                <h:outputText styleClass="data-text" 
                                                              value="#{occInspectionBB.getPrettyDate(pr.activatesOn)}" />

                                                <p:spacer height="5px" />

                                                <h:outputText styleClass="ui-label-inline" 
                                                              value="Expires on: "  />
                                                <h:outputText styleClass="data-text" 
                                                              value="#{occInspectionBB.getPrettyDate(pr.expiresOn)}" />

                                                <p:spacer height="5px" />

                                                <h:outputText styleClass="ui-label-inline" 
                                                              value="Response timestamp: "  />
                                                <h:outputText styleClass="data-text" 
                                                              value="#{occInspectionBB.getPrettyDate(pr.responseTS)}" />
                                            </h:panelGroup>

                                            <h:panelGroup>
                                                <h:outputText styleClass="ui-label-inline" 
                                                              value="Active : "  />
                                                <h:outputText styleClass="data-text" 
                                                              value="#{pr.active}" />

                                                <p:spacer height="5px" />

                                                <h:outputText styleClass="ui-label-inline" 
                                                              value="Hidden: "  />
                                                <h:outputText styleClass="data-text" 
                                                              value="#{pr.hidden}" />

                                                <p:spacer height="5px" />

                                                <h:outputText styleClass="ui-label-inline" 
                                                              value="Rejected: "  />
                                                <h:outputText styleClass="data-text" 
                                                              value="#{pr.proposalRejected}" />
                                                <p:spacer height="5px" />

                                                <h:outputText styleClass="ui-label-inline" 
                                                              value="Order: "  />
                                                <h:outputText styleClass="data-text" 
                                                              value="#{pr.order}" />
                                            </h:panelGroup>

                        </h:form>

                    </p:dialog>


                    <p:dialog   id="occperiod-notes-dialog"
                                height="650" width="900"
                                widgetVar="occperiod-inspaceeleconfig-var"
                                closable="true"
                                rendered="#{sessionBean.sessionUser.keyCard.hasEnfOfficialPermissions}"
                                >

                        <h:form id="occperiod-notes-form">

                            <h:messages id="occperiod-notes-messages"
                                        globalOnly="true" showDetail="true" showSummary="true"
                                        warnClass="msgWarn" infoClass="msgInfo" fatalClass="msgFatal" errorClass="msgError">
                            </h:messages>

                            <h:panelGrid columns="2"
                                         columnClasses="gridTd, gridTd">

                            </h:panelGrid>
                        </h:form>

                    </p:dialog>

                    <p:dialog   id="occperiod-dialog-proposalmetadata"
                                height="650" width="900"
                                widgetVar="occperiod-dialog-proposalmetadata-var"
                                closable="true"
                                rendered="#{sessionBean.sessionUser.keyCard.hasMuniStaffPermissions}"
                                >

                        <h:form id="occperiod-dialog-proposalmetadata-form">

                            <h:messages id="occperiod-dialog-proposalmetadata-messages"
                                        globalOnly="true" showDetail="true" showSummary="true"
                                        warnClass="msgWarn" infoClass="msgInfo" fatalClass="msgFatal" errorClass="msgError">
                            </h:messages>


                            <h:panelGrid    id="violation-ord-fulltext-pg"
                                            columns="2"
                                            columnClasses="gridTd, gridTd"
                                            rendered="true">
                                <h:panelGroup>

                                    <h:outputText styleClass="ui-label-inline"
                                                  value="Proposal ID: "  />
                                    <h:outputText styleClass="data-text"
                                                  value="#{occInspectionBB.currentProposal.proposalID}" />

                                    <p:spacer height="5px" />

                                    <h:outputText styleClass="ui-label-inline"
                                                  value="Directive ID:"  />
                                    <h:outputText styleClass="data-text"
                                                  value="#{occInspectionBB.currentProposal.directive.directiveID}" />

                                    <p:spacer height="5px" />

                                    <h:outputText styleClass="ui-label-inline"
                                                  value="Generating event ID: "  />
                                    <h:outputText styleClass="data-text"
                                                  value="#{occInspectionBB.currentProposal.generatingEventID}" />

                                </h:panelGroup>

                                <h:panelGroup>

                                    <h:outputText styleClass="ui-label-inline"
                                                  value="Initiator: "  />
                                    <h:outputText styleClass="data-text"
                                                  value="#{occInspectionBB.currentProposal.initiator.person.lastName}" />
                                    <h:outputText value=" (ID: " styleClass="data-text" />
                                    <h:outputText styleClass="data-text"
                                                  value="#{occInspectionBB.currentProposal.initiator.userID}" />
                                    <h:outputText value=")" styleClass="data-text" />

                                    <p:spacer height="5px" />

                                    <h:outputText styleClass="ui-label-inline"
                                                  value="Responder intended: "  />
                                    <h:outputText styleClass="data-text"
                                                  value="#{occInspectionBB.currentProposal.responderIntended.person.lastName}" />
                                    <h:outputText value=" (ID: " styleClass="data-text" />
                                    <h:outputText styleClass="data-text"
                                                  value="#{occInspectionBB.currentProposal.responderIntended.userID}" />
                                    <h:outputText value=")" styleClass="data-text" />

                                    <p:spacer height="5px" />

                                    <h:outputText styleClass="ui-label-inline"
                                                  value="Responder actual: "  />
                                    <h:outputText styleClass="data-text"
                                                  value="#{occInspectionBB.currentProposal.responderActual.person.lastName}" />
                                    <h:outputText value=" (ID: " styleClass="data-text" />
                                    <h:outputText styleClass="data-text"
                                                  value="#{occInspectionBB.currentProposal.responderActual.userID}" />
                                    <h:outputText value=")" styleClass="data-text" />


                                </h:panelGroup>
                                <h:panelGroup>
                                    <h:outputText styleClass="ui-label-inline"
                                                  value="Activates on: "  />
                                    <h:outputText styleClass="data-text"
                                                  value="#{occInspectionBB.getPrettyDate(occInspectionBB.currentProposal.activatesOn)}" />

                                    <p:spacer height="5px" />

                                    <h:outputText styleClass="ui-label-inline"
                                                  value="Expires on: "  />
                                    <h:outputText styleClass="data-text"
                                                  value="#{occInspectionBB.getPrettyDate(occInspectionBB.currentProposal.expiresOn)}" />

                                    <p:spacer height="5px" />

                                    <h:outputText styleClass="ui-label-inline"
                                                  value="Response timestamp: "  />
                                    <h:outputText styleClass="data-text"
                                                  value="#{occInspectionBB.getPrettyDate(occInspectionBB.currentProposal.responseTimestamp)}" />
                                </h:panelGroup>

                                <h:panelGroup>
                                    <h:outputText styleClass="ui-label-inline"
                                                  value="Active : "  />
                                    <h:outputText styleClass="data-text"
                                                  value="#{occInspectionBB.currentProposal.active}" />

                                    <p:spacer height="5px" />

                                    <h:outputText styleClass="ui-label-inline"
                                                  value="Hidden: "  />
                                    <h:outputText styleClass="data-text"
                                                  value="#{occInspectionBB.currentProposal.hidden}" />

                                    <p:spacer height="5px" />

                                    <h:outputText styleClass="ui-label-inline"
                                                  value="Rejected: "  />
                                    <h:outputText styleClass="data-text"
                                                  value="#{occInspectionBB.currentProposal.proposalRejected}" />
                                    <p:spacer height="5px" />

                                    <h:outputText styleClass="ui-label-inline"
                                                  value="Order: "  />
                                    <h:outputText styleClass="data-text"
                                                  value="#{occInspectionBB.currentProposal.order}" />
                                </h:panelGroup>

                                <h:panelGroup>
                                    <h:outputText styleClass="ui-label-inline"
                                                  value="Generating event ID: "  />
                                    <h:outputText styleClass="data-text"
                                                  value="#{!(empty occInspectionBB.currentProposal.generatingEvent) ? occInspectionBB.currentProposal.generatingEvent.eventID : 'no event'}" />

                                                <h:outputText styleClass="ui-label-inline" 
                                                              value="refuseToBeHidden: " />
                                                <h:outputText styleClass="data-text" 
                                                              value="#{pr.directive.refuseToBeHidden}" />
                                            </h:panelGroup>
                                        </h:panelGrid>
                                        
                                        <p:spacer height="5px" />
                                        
                                            <h:outputText value="Choices offered by this directive"
                                            styleClass="ui-label" />
                              
                                        
                                         <p:dataTable   id="periodmetadata-proposals-choices-table"
                                                        var="ch"
                                                        rowKey="#{ch.choiceID}"
                                                        value="#{pr.directive.choiceList}"
                                                        tableStyleClass="primeDataTable"
                                                        draggableColumns="true"
                                                        expandedRow="false"
                                                        rowExpandMode="multiple"
                                                        resizableColumns="true">
                                             <p:column width="8%">
                                                 <f:facet name="header">
                                                     <h:outputText value="ID" />
                                                 </f:facet>
                                                 <h:outputText value="#{ch.choiceID}"/>
                                             </p:column>
                                             
                                             <p:column width="8%">
                                                 <f:facet name="header">
                                                     <h:outputText value="Title" />
                                                 </f:facet>
                                                 <h:outputText value="#{ch.title}"/>
                                             </p:column>
                                             
                                             <p:column width="8%">
                                                 <f:facet name="header">
                                                     <h:outputText value="Hidden?" />
                                                 </f:facet>
                                                 <h:outputText value="#{ch.hidden}"/>
                                             </p:column>
                                             
                                             <p:column width="8%">
                                                 <f:facet name="header">
                                                     <h:outputText value="Active?" />
                                                 </f:facet>
                                                 <h:outputText value="#{ch.active}"/>
                                             </p:column>
                                             
                                             <p:column width="8%">
                                                 <f:facet name="header">
                                                     <h:outputText value="UsrCanChoose?" />
                                                 </f:facet>
                                                 <h:outputText value="#{ch.canChoose}"/>
                                             </p:column>
                                             
                                             <p:column width="8%">
                                                 <f:facet name="header">
                                                     <h:outputText value="Choose min rnk" />
                                                 </f:facet>
                                                 <h:outputText value="#{ch.minimumRequiredUserRankToChoose}"/>
                                             </p:column>
                                             <p:column width="8%">
                                                 <f:facet name="header">
                                                     <h:outputText value="View min rnk?" />
                                                 </f:facet>
                                                 <h:outputText value="#{ch.minimumRequiredUserRankToView}"/>
                                             </p:column>
                                             <p:column width="8%">
                                                 <f:facet name="header">
                                                     <h:outputText value="Order" />
                                                 </f:facet>
                                                 <h:outputText value="#{ch.relativeOrder}"/>
                                             </p:column>
                                            <p:column width="10%">
                                                <f:facet name="header">
                                                    <h:outputText value="Choose" />
                                                </f:facet>
                                            <p:commandButton    id="proposal-choice-button-choose-dialog"
                                                                ajax="true" 
                                                                styleClass="proposal-choice-button"
                                                                actionListener="#{occInspectionBB.proposals_makeChoice(ch, pr)}"
                                                                disabled="#{!ch.canChoose}"
                                                                value="Choose"
                                                                icon="#{ch.icon.fontAwesome}"
                                                                title="#{ch.description}"
                                                                update="occperiod-form-proposals
                                                                occperiod-panel-proposals-messages-form
                                                                occperiod-form-events:occperiod-events-datatable"/>
                                            </p:column>
                                             
                                             <p:rowExpansion>
                                                 <div class="outlinedBox">
                                                     <h:outputText styleClass="ui-label-inline" value="Description: "/>
                                                     <h:outputText styleClass="data-text" value="#{ch.description}"/>
                                                 </div>
                                             </p:rowExpansion>
                                         </p:dataTable>
                                    </div>
                                </p:rowExpansion>
                            </p:dataTable>
                          </h:form>
                              
                            <h2>Event rule listing</h2>
                              
                            <h:form id="occperiod-propoals-eventrules-form">
                                
                                
                                 <h:outputLabel styleClass="ui-label" for="eventrules-newruleid-it">
                                        <h:outputText value="Event rule ID: "/>
                                </h:outputLabel>
                                <p:inputText id="eventrules-newruleid-it" type="number"
                                                 value="#{occInspectionBB.formEventRuleIDToAdd}" >
                                </p:inputText>
                                <h:message for="eventrules-newruleid-it" showDetail="false" showSummary="true"  
                                           warnClass="msgWarn" infoClass="msgInfo" fatalClass="msgFatal" errorClass="msgError" />
                                
                                <p:commandButton    id="eventrules-addnewrulebyid-cb"
                                                    ajax="true" 
                                                    styleClass="proposal-choice-button"
                                                    actionListener="#{occInspectionBB.rules_initiateEventRuleCreate}"
                                                    rendered="#{systemServicesBB.bbSessionUser.keyCard.hasEnfOfficialPermissions}"
                                                    value="Add rule by ID"
                                                    icon="fa fa-plus"
                                                    update="occperiod-proposals-eventrules-datatable
                                                    occperiod-dialog-proposalmetadata-form-messages 
                                                    periodmetadata-form-proposalsconfig"/>
                                <p:spacer height="5px" />
                                
                                 <h:outputLabel styleClass="ui-label" for="occperiod-eventruleset-solb">
                                        <h:outputText value="Choose an event rule set: "/>
                                </h:outputLabel>
                                
                                 <p:selectOneMenu style="width: auto;" 
                                                        id="occperiod-eventruleset-solb" 
                                                        value="#{occInspectionBB.selectedEventRuleSet}" 
                                                        tabindex="10">
                                        <f:converter converterId="eventRuleSetConverter" />
                                        <p:ajax />
                                        <f:selectItems  id="occperiod-eventruleset-selitems" 
                                                        value="#{occInspectionBB.eventRuleSetList}" 
                                                        var="rsl" 
                                                        itemValue="#{rsl}" 
                                                        itemLabel="#{rsl.title} (ID: #{rsl.rulseSetID})"/>
                                </p:selectOneMenu>
                                <h:message for="occperiod-eventruleset-solb" showDetail="false" showSummary="true"  
                                           warnClass="msgWarn" infoClass="msgInfo" fatalClass="msgFatal" errorClass="msgError" />
                                
                                <p:commandButton    id="eventrules-button-addruleset"
                                                    ajax="true" 
                                                    styleClass="proposal-choice-button"
                                                    actionListener="#{occInspectionBB.rules_addEventRuleSet(occInspectionBB.selectedEventRuleSet)}"
                                                    rendered="#{systemServicesBB.bbSessionUser.keyCard.hasEnfOfficialPermissions}"
                                                    value="Add rule by set"
                                                    icon="fa fa-plus"
                                                    update="occperiod-proposals-eventrules-datatable
                                                    occperiod-dialog-proposalmetadata-form-messages 
                                                    periodmetadata-form-proposalsconfig"/>
                                <p:spacer height="5px" />
                                
                                <p:commandButton    id="eventrules-addnewrule-cb"
                                                    ajax="true" 
                                                    styleClass="proposal-choice-button"
                                                    actionListener="#{occInspectionBB.rules_initiateEventRuleCreate}"
                                                    rendered="#{systemServicesBB.bbSessionUser.keyCard.hasEnfOfficialPermissions}"
                                                    value="Create new event rule"
                                                    oncomplete="PF('occperiod-dialog-addediteventrule-var').show()"
                                                    icon="fa fa-plus"
                                                    update="occperiod-dialog-addediteventrule-form"/>
                                
                                <p:spacer height="5px" />
                                
                                 <h:outputLabel styleClass="ui-label" for="occperiod-viewoptionsrules-solb">
                                        <h:outputText value="ruleslist view options: "/>
                                </h:outputLabel>

                                <p:selectOneMenu style="width: 300px;" 
                                                        id="occperiod-viewoptionsrules-solb" 
                                                        value="#{occInspectionBB.selectedRulesViewOption}" 
                                                        tabindex="10">

                                        <p:ajax update="occperiod-proposals-eventrules-datatable"                                                           
                                                immediate="true"/>
                                        <f:selectItems  id="occperiod-viewoptionsrules-selitems" 
                                                        value="#{occInspectionBB.rulesViewOptions}" 
                                                        var="rvo" 
                                                        itemValue="#{rvo}" 
                                                        itemLabel="#{rvo.label}"/>
                                    </p:selectOneMenu>

                                    <h:outputText styleClass="ui-label-inline"
                                                  value="Response event ID: "  />
                                    <h:outputText styleClass="data-text"
                                                  value="#{!(empty occInspectionBB.currentProposal.responseEvent) ? occInspectionBB.currentProposal.responseEvent.eventID : 'no event'}" />
                                </h:panelGroup>

                                <h:panelGroup>
                                    <h:outputText styleClass="ui-label-inline"
                                                  value="Notes: "  />
                                    <h:outputText styleClass="data-text"
                                                  escape="false"
                                                  value="#{occInspectionBB.currentProposal.notes}" />
                                </h:panelGroup>
                                <h:panelGroup>

                                    <h:outputText   styleClass="ui-label-inline"
                                                    value="directPropToDefaultMuniCEO: " />
                                    <h:outputText   styleClass="data-text"
                                                    value="#{occInspectionBB.currentProposal.directive.directPropToDefaultMuniCEO}" />

                                     <p:column width="8%">
                                        <f:facet name="header">
                                            <h:outputText value="Passed TS" />
                                        </f:facet>
                                         <h:outputText value="#{occInspectionBB.getPrettyDate(rule.passedRuleTS)}"/>
                                    </p:column>
                                    <p:rowExpansion>
                                        
                                    <p:commandButton    id="eventrules-editrule-cb"
                                                        ajax="true" 
                                                        styleClass="proposal-choice-button"
                                                        actionListener="#{occInspectionBB.rules_initiateEventRuleEdit(rule)}"
                                                        rendered="#{systemServicesBB.bbSessionUser.keyCard.hasEnfOfficialPermissions}"
                                                        value="Edit rule"
                                                        oncomplete="PF('occperiod-dialog-addediteventrule-var').show()"
                                                        icon="fa fa-plus"
                                                        update="occperiod-dialog-addediteventrule-form"/>
                                    
                                    <p:spacer height="5px" />

                                    <h:outputText styleClass="ui-label-inline"
                                                  value="directPropToDefaultMuniStaffer: " />

                                    <h:outputText styleClass="data-text"
                                                  value="#{occInspectionBB.currentProposal.directive.directPropToDefaultMuniStaffer}" />

                                    <p:spacer height="5px" />

                                    <h:outputText styleClass="ui-label-inline"
                                                  value="directPropToDeveloper: " />
                                    <h:outputText styleClass="data-text"
                                                  value="#{occInspectionBB.currentProposal.directive.directPropToDeveloper}" />

                                </h:panelGroup>
                                <h:panelGroup>

                                    <h:outputText styleClass="ui-label-inline"
                                                  value="executeChoiceIfLoneWolf: " />
                                    <h:outputText styleClass="data-text"
                                                  value="#{occInspectionBB.currentProposal.directive.executeChoiceIfLoneWolf}" />

                                    <p:spacer height="5px" />

                                    <h:outputText styleClass="ui-label-inline"
                                                  value="inactivateGeneratingEventOnEvaluation: " />
                                    <h:outputText styleClass="data-text"
                                                  value="#{occInspectionBB.currentProposal.directive.inactivateGeneratingEventOnEvaluation}" />

                                    <p:spacer height="5px" />

                                    <h:outputText styleClass="ui-label-inline"
                                                  value="maintainRelativeDateWindow: " />
                                    <h:outputText styleClass="data-text"
                                                  value="#{occInspectionBB.currentProposal.directive.maintainRelativeDateWindow}" />

                                    <p:spacer height="5px" />

                                    <h:outputText styleClass="ui-label-inline"
                                                  value="instantiateMultipleOnBOB: " />
                                    <h:outputText styleClass="data-text"
                                                  value="#{occInspectionBB.currentProposal.directive.instantiateMultipleOnBOB}" />

                                    <p:spacer height="5px" />

                                    <h:outputText styleClass="ui-label-inline"
                                                  value="applyToClosedBOBs: " />
                                    <h:outputText styleClass="data-text"
                                                  value="#{occInspectionBB.currentProposal.directive.applyToClosedBOBs}" />

                                    <p:spacer height="5px" />

                                    <h:outputText styleClass="ui-label-inline"
                                                  value="autoInactiveOnBOBClose: " />
                                    <h:outputText styleClass="data-text"
                                                  value="#{occInspectionBB.currentProposal.directive.autoInactiveOnBOBClose}" />

                                    <p:spacer height="5px" />

                                    <h:outputText styleClass="ui-label-inline"
                                                  value="autoInactiveOnGenEventInactivation: " />
                                    <h:outputText styleClass="data-text"
                                                  value="#{occInspectionBB.currentProposal.directive.autoInactiveOnGenEventInactivation}" />



                                </h:panelGroup>
                                <h:panelGroup>



                                    <h:outputText styleClass="ui-label-inline"
                                                  value="minimumRequiredUserRankToView: " />
                                    <h:outputText styleClass="data-text"
                                                  value="#{occInspectionBB.currentProposal.directive.minimumRequiredUserRankToView}" />

                                    <p:spacer height="5px" />

                                    <h:outputText styleClass="ui-label-inline"
                                                  value="minimumRequiredUserRankToEvaluate: " />
                                    <h:outputText styleClass="data-text"
                                                  value="#{occInspectionBB.currentProposal.directive.minimumRequiredUserRankToEvaluate}" />

                                    <p:spacer height="5px" />

                                    <h:outputText styleClass="ui-label-inline"
                                                  value="active: " />
                                    <h:outputText styleClass="data-text"
                                                  value="#{occInspectionBB.currentProposal.directive.active}" />

                                    <p:spacer height="5px" />

                                    <h:outputText styleClass="ui-label-inline"
                                                  value="hidden: " />
                                    <h:outputText styleClass="data-text"
                                                  value="#{occInspectionBB.currentProposal.directive.hidden}" />

                                    <p:spacer height="5px" />

                                    <h:outputText styleClass="ui-label-inline"
                                                  value="relativeorder: " />
                                    <h:outputText styleClass="data-text"
                                                  value="#{occInspectionBB.currentProposal.directive.relativeorder}" />

                                    <p:spacer height="5px" />

                                    <h:outputText styleClass="data-text"
                                                  value="directPropToMuniSysAdmin: " />
                                    <h:outputText styleClass="ui-label-inline"
                                                  value="#{occInspectionBB.currentProposal.directive.directPropToMuniSysAdmin}" />

                                    <p:spacer height="5px" />

                                    <h:outputText styleClass="ui-label-inline"
                                                  value="requiredEvaluationForBOBClose: " />
                                    <h:outputText styleClass="data-text"
                                                  value="#{occInspectionBB.currentProposal.directive.requiredEvaluationForBOBClose}" />

                                </h:panelGroup>
                                <h:panelGroup>
                                    <h:outputText styleClass="ui-label-inline"
                                                  value="forceHidePrecedingProps: " />
                                    <h:outputText styleClass="data-text"
                                                  value="#{occInspectionBB.currentProposal.directive.forceHidePrecedingProps}" />

                                    <p:spacer height="5px" />

                                    <h:outputText styleClass="ui-label-inline"
                                                  value="forceHideTrailingProps: " />
                                    <h:outputText styleClass="data-text"
                                                  value="#{occInspectionBB.currentProposal.directive.forceHideTrailingProps}" />

                                    <p:spacer height="5px" />

                                    <h:outputText styleClass="ui-label-inline"
                                                  value="refuseToBeHidden: " />
                                    <h:outputText styleClass="data-text"
                                                  value="#{occInspectionBB.currentProposal.directive.refuseToBeHidden}" />
                                </h:panelGroup>
                            </h:panelGrid>
                        </h:form>
                    </p:dialog>
                    
                    <p:dialog
                        id="occperiod-dialog-addediteventrule"
                        height="600" width="850"
                        widgetVar="occperiod-dialog-addediteventrule-var"
                        closable="true" 
                        rendered="#{systemServicesBB.bbSessionUser.keyCard.hasEnfOfficialPermissions}"
                        >
                        
                        <h:form id="occperiod-dialog-addediteventrule-form">
                            
                            <h2>Add and edit event rules</h2>

                         <h:panelGrid    id="eventrule-create-grid" 
                                        columns="2" 
                                        columnClasses="gridTD, gridTD" 
                                        rendered="true">
                                            
                            <h:panelGroup>
                                  <h:outputLabel for="rule-title-it">
                                      <h:outputText styleClass="ui-label" value="Rule title:"/>
                                  </h:outputLabel>
                                  <p:spacer height="3px"/>
                                  <p:inputText id="rule-title-it" value="#{occInspectionBB.currentEventRuleAbstract.title}" 
                                               style="width: 200px;" tabindex="3" required="true" styleClass="inputText"/>
                                  <h:message    id="rule-title-msg"
                                                for="rule-title-it" 
                                                showDetail="false" showSummary="true" 
                                                warnClass="msgWarn" infoClass="msgInfo" fatalClass="msgFatal" errorClass="msgError" />
                                  
                                  <p:spacer height="5px" />
                                  
                                  <h:outputLabel for="rule-title-it">
                                        <h:outputText styleClass="ui-label" 
                                                      value="Rule description" />
                                  </h:outputLabel>
                                  <p:inputText id="rule-desc-it" value="#{occInspectionBB.currentEventRuleAbstract.description}" 
                                               style="width: 200px;" tabindex="3" required="false" styleClass="inputText"/>
                                  <h:message    id="rule-descr-msg"
                                                for="rule-descr-it" 
                                                showDetail="false" showSummary="true" 
                                                warnClass="msgWarn" infoClass="msgInfo" fatalClass="msgFatal" errorClass="msgError" />
                            </h:panelGroup>
                             
                             <h:panelGroup>
                                 <h:outputText value=" " />
                             </h:panelGroup>
                        
                            <h:panelGroup>
                                
                                <h3>Required attributes</h3>
                                
                                <h:outputLabel  for="rule-lb-reqet">
                                    <h:outputText styleClass="ui-label" value="Required event type"/>
                                </h:outputLabel>
                                <p:selectOneMenu id="rule-lb-reqet" required="false" 
                                                    value="#{occInspectionBB.currentEventRuleAbstract.requiredEventType}" 
                                                    tabindex="3"
                                                    styleClass="full-width">
                                    <f:selectItem itemLabel="Select an event type..." itemDisabled="true" noSelectionOption="true"/>
                                    <f:selectItems value="#{occInspectionBB.eventTypeListAll}" var="et" itemLabel="#{et.label}" />
                                </p:selectOneMenu>
                                <h:message for="rule-lb-reqet" showDetail="false" showSummary="true" 
                                           warnClass="msgWarn" infoClass="msgInfo" fatalClass="msgFatal" errorClass="msgError" />
                                
                                <p:spacer height="5px" />
                                
                                 <h:outputLabel for="rule-lb-reqcat">
                                    <h:outputText styleClass="ui-label" value="Required event category"/>
                                </h:outputLabel>
                                <p:selectOneMenu id="rule-lb-reqcat" required="false" 
                                                    value="#{occInspectionBB.currentEventRuleAbstract.requiredEventCategory}" 
                                                    tabindex="3"
                                                    styleClass="full-width">
                                    <f:converter converterId="eventCategoryConverter" />
                                    <f:selectItem itemLabel="Select an event category..." itemDisabled="true" noSelectionOption="true"/>
                                    <f:selectItems value="#{occInspectionBB.eventCategoryListAllActive}" 
                                                   var="ec" 
                                                   itemLabel="#{ec.eventCategoryTitle} (ID: #{ec.categoryID})" />
                                </p:selectOneMenu>
                                <h:message for="rule-lb-reqcat" showDetail="true" showSummary="true" 
                                           warnClass="msgWarn" infoClass="msgInfo" fatalClass="msgFatal" errorClass="msgError" />
                                
                                <h:outputLabel styleClass="ui-label" 
                                               value="Req cat thresold (internal to type)" 
                                               for="rule-it-reqec-thres-typeint"/>
                                <p:spacer height="3px"/>
                                <p:inputText id="rule-it-reqec-thres-typeint" value="#{occInspectionBB.currentEventRuleAbstract.requiredECThreshold_typeInternalOrder}" 
                                               style="width: 20px;" 
                                               tabindex="3" 
                                               required="false" 
                                               styleClass="inputText"/>
                                <h:message     id="rule-reqec-thres-typeint-msg"
                                               for="rule-it-reqec-thres-typeint" 
                                               showDetail="false" showSummary="true" 
                                               warnClass="msgWarn" infoClass="msgInfo" fatalClass="msgFatal" errorClass="msgError" />
                                
                                <p:spacer height="3px"/>
                                
                                 <h:outputLabel styleClass="ui-label" 
                                               value="upper bound? (uncheck = lower bound)" 
                                               for="rule-reqrec-thres-global-upperbound-switch"/>
                                <p:selectBooleanCheckbox id="rule-req-thres-typeint-upperbound-switch"
                                                         value="#{occInspectionBB.currentEventRuleAbstract.requiredECThreshold_typeInternalOrder_treatAsUpperBound}" />
                                
                                <h:outputLabel styleClass="ui-label" 
                                               value="Req cat thresold (global order)" 
                                               for="rule-it-reqec-thres-global"/>
                                
                                <p:spacer height="3px"/>
                                
                                <p:inputText id="rule-it-reqec-thres-global" value="#{occInspectionBB.currentEventRuleAbstract.requiredECThreshold_globalOrder}" 
                                               style="width: 20px;" 
                                               tabindex="3" 
                                               required="false" 
                                               styleClass="inputText"/>
                                <h:message     id="rule-reqec-thres-global-msg"
                                               for="rule-it-reqec-thres-global" 
                                               showDetail="false" showSummary="true" 
                                               warnClass="msgWarn" infoClass="msgInfo" fatalClass="msgFatal" errorClass="msgError" />
                                
                                <p:spacer height="3px"/>
                                
                                <h:outputLabel styleClass="ui-label" 
                                               value="upper bound? (uncheck = lower bound)" 
                                               for="rule-reqrec-thres-global-upperbound-switch"/>
                                <p:selectBooleanCheckbox id="rule-reqrec-thres-global-upperbound-switch"
                                                         value="#{occInspectionBB.currentEventRuleAbstract.requiredECThreshold_globalOrder_treatAsUpperBound}" />
                            </h:panelGroup>    
                                
                        
                            <h:panelGroup>
                                <h3>Forbidden attributes</h3>
                                 <h:outputLabel styleClass="ui-label" for="rule-lb-forbiddenet">
                                    <h:outputText value="Forbidden event type"/>
                                </h:outputLabel>
                                <p:selectOneMenu id="rule-lb-forbiddenet" required="false" 
                                                    value="#{occInspectionBB.currentEventRuleAbstract.forbiddenEventType}" 
                                                    tabindex="3"
                                                    styleClass="full-width">
                                    <f:selectItem itemLabel="Select an event type..." itemDisabled="true" noSelectionOption="true"/>
                                    <f:selectItems value="#{occInspectionBB.eventTypeListAll}" var="et" itemLabel="#{et.label}" />
                                </p:selectOneMenu>
                                <h:message for="rule-lb-forbiddenet" showDetail="false" showSummary="true" 
                                           warnClass="msgWarn" infoClass="msgInfo" fatalClass="msgFatal" errorClass="msgError" />
                               
                                <p:spacer height="3px"/>
                                
                                <h:outputLabel styleClass="ui-label" for="rule-lb-forcat">
                                    <h:outputText value="Forbidden event category"/>
                                </h:outputLabel>
                                <p:selectOneMenu id="rule-lb-forcat" required="false" 
                                                    value="#{occInspectionBB.currentEventRuleAbstract.forbiddenEventCategory}" 
                                                    tabindex="3"
                                                    styleClass="full-width">
                                    <f:selectItem itemLabel="Select an event category..." itemDisabled="true" noSelectionOption="true"/>
                                    <f:converter converterId="eventCategoryConverter" />
                                    <f:selectItems value="#{occInspectionBB.eventCategoryListAllActive}" 
                                                   var="ec" itemLabel="#{ec.eventCategoryTitle}  (ID: #{ec.categoryID})" />
                                </p:selectOneMenu>
                                <h:message for="rule-lb-forcat" showDetail="false" showSummary="true" 
                                           warnClass="msgWarn" infoClass="msgInfo" fatalClass="msgFatal" errorClass="msgError" />
                                
                                <p:spacer height="3px"/>
                                
                                <h:outputLabel styleClass="ui-label" 
                                               value="Forbidden cat thresold (internal to type)" 
                                               for="rule-it-forec-thres-typeint"/>
                                
                                <p:spacer height="3px"/>
                               
                                <p:inputText id="rule-it-forec-thres-typeint" value="#{occInspectionBB.currentEventRuleAbstract.forbiddenECThreshold_typeInternalOrder}" 
                                               style="width: 20px;" 
                                               tabindex="3" 
                                               required="false" 
                                               styleClass="inputText"/>
                                <h:message     id="rule-forec-thres-typeint-msg"
                                               for="rule-it-forec-thres-typeint" 
                                               showDetail="false" showSummary="true" 
                                               warnClass="msgWarn" infoClass="msgInfo" fatalClass="msgFatal" errorClass="msgError" />
                                
                                <p:spacer height="3px"/>
                                
                                <h:outputLabel styleClass="ui-label" 
                                               value="upper bound? (uncheck = lower bound)" 
                                               for="rule-forec-thres-typeint-upperbound-switch"/>
                                <p:selectBooleanCheckbox id="rule-forec-thres-typeint-upperbound-switch"
                                                         value="#{occInspectionBB.currentEventRuleAbstract.forbiddenECThreshold_typeInternalOrder_treatAsUpperBound}" />
                                
                                <h:outputLabel styleClass="ui-label" 
                                               value="Forbidden cat thresold (global order)" 
                                               for="rule-it-forec-thres-global"/>
                                <p:spacer height="3px"/>
                                <p:inputText id="rule-it-forec-thres-global" value="#{occInspectionBB.currentEventRuleAbstract.forbiddenECThreshold_globalOrder}" 
                                               style="width: 20px;" 
                                               tabindex="3" 
                                               required="false" 
                                               styleClass="inputText"/>
                                <h:message     id="rule-forec-thres-global-msg"
                                               for="rule-it-forec-thres-global" 
                                               showDetail="false" showSummary="true" 
                                               warnClass="msgWarn" infoClass="msgInfo" fatalClass="msgFatal" errorClass="msgError" />
                                
                                <p:spacer height="3px"/>
                                
                                <h:outputLabel styleClass="ui-label" 
                                               value="upper bound? (uncheck = lower bound)" 
                                               for="rule-forec-thres-global-upperbound-switch"/>
                                <p:selectBooleanCheckbox id="rule-forec-thres-global-upperbound-switch"
                                                         value="#{occInspectionBB.currentEventRuleAbstract.forbiddenECThreshold_globalOrder_treatAsUpperBound}" />
                                
                            </h:panelGroup>    
                                
                            <h:panelGroup>
                                <h3>Other rule settings</h3>
                                
                                <h:outputLabel styleClass="ui-label" 
                                               value="Required pass for entity close" 
                                               for="rule-req-switch"/>
                                <p:selectBooleanCheckbox id="rule-req-switch"
                                                         value="#{occInspectionBB.currentEventRuleAbstract.mandatoryRulePassRequiredToCloseEntity}" />
                                
                                <p:spacer height="5px" />
                                
                                <h:outputLabel styleClass="ui-label" 
                                               value="Inactivate on entity close" 
                                               for="rule-inactivate-switch"/>
                                <p:selectBooleanCheckbox id="rule-inactivate-switch"
                                                         value="#{occInspectionBB.currentEventRuleAbstract.inactivateRuleOnEntityClose}" />
                                
                                <p:spacer height="5px" />
                                
                                <h:outputLabel styleClass="ui-label" 
                                               value="Active?" 
                                               for="rule-active-switch"/>
                                <p:selectBooleanCheckbox id="rule-active-switch"
                                                         value="#{occInspectionBB.currentEventRuleAbstract.activeRuleAbstract}" />
                                
                                <p:spacer height="3px"/>
                                
                                <h:outputLabel styleClass="ui-label" 
                                               value="Propmpting directive ID" 
                                               for="rule-promptprop"/>
                                <p:inputText id="rule-promptprop" 
                                             value="#{occInspectionBB.currentEventRuleAbstract.formPromptingDirectiveID}" 
                                               style="width: 20px;" 
                                               tabindex="3" 
                                               required="false" 
                                               styleClass="inputText"/>
                                <h:message     id="rule-promptprop-msg"
                                               for="rule-promptprop" 
                                               showDetail="false" showSummary="true" 
                                               warnClass="msgWarn" infoClass="msgInfo" fatalClass="msgFatal" errorClass="msgError" />
                                
                            
                            </h:panelGroup>    
                                
                            <h:panelGroup>
                                
                                <h3>Notes</h3>
                                
                                <p:spacer height="3px"/>
                            
                                <h:outputLabel styleClass="ui-label" 
                                               value="Notes" 
                                               for="rule-notes"/>
                                <p:spacer height="3px"/>
                                <p:inputTextarea id="rule-notes" 
                                             value="#{occInspectionBB.currentEventRuleAbstract.notes}" 
                                               style="width: 100%; height: 50px;" 
                                               tabindex="3" 
                                               required="false" 
                                               styleClass="inputText"/>
                                <h:message     id="rule-notes-msg"
                                               for="rule-notes" 
                                               showDetail="false" showSummary="true" 
                                               warnClass="msgWarn" infoClass="msgInfo" fatalClass="msgFatal" errorClass="msgError" />
                                
                            
                            </h:panelGroup>    
                                
                            <h:panelGroup>
                                <h3>Triggers</h3>
                                <h:outputLabel styleClass="ui-label" for="rule-lb-triggeredcatonpass">
                                    <h:outputText value="Event category triggered on rule pass"/>
                                </h:outputLabel>
                                <p:selectOneMenu id="rule-lb-triggeredcatonpass" required="false" 
                                                    value="#{occInspectionBB.currentEventRuleAbstract.triggeredECOnRulePass}" 
                                                    styleClass="full-width"
                                                    tabindex="3">
                                    <f:selectItem itemLabel="Select an event category..." itemDisabled="true" noSelectionOption="true"/>
                                    <f:converter converterId="eventCategoryConverter" />
                                    <f:selectItems value="#{occInspectionBB.eventCategoryListAllActive}" 
                                                   var="ec" 
                                                   itemLabel="#{ec.eventCategoryTitle} (ID: #{ec.categoryID})" />
                                </p:selectOneMenu>
                                <h:message for="rule-lb-triggeredcatonpass" showDetail="false" showSummary="true" 
                                           warnClass="msgWarn" infoClass="msgInfo" fatalClass="msgFatal" errorClass="msgError" />
                                
                                <p:spacer height="5px" />
                                
                                <h:outputLabel styleClass="ui-label" for="rule-lb-triggeredcatonfail">
                                    <h:outputText value="Event category triggered on rule fail"/>
                                </h:outputLabel>
                                <p:selectOneMenu id="rule-lb-triggeredcatonfail" required="false" 
                                                    value="#{occInspectionBB.currentEventRuleAbstract.triggeredECOnRuleFail}" 
                                                    tabindex="3" 
                                                    styleClass="full-width">
                                    <f:selectItem itemLabel="Select an event category..." itemDisabled="true" noSelectionOption="true"/>
                                    <f:converter converterId="eventCategoryConverter" />
                                    <f:selectItems value="#{occInspectionBB.eventCategoryListAllActive}" 
                                                   var="ec" itemLabel="#{ec.eventCategoryTitle} (ID: #{ec.categoryID})" />
                                </p:selectOneMenu>
                                <h:message for="rule-lb-triggeredcatonfail" showDetail="false" showSummary="true" 
                                           warnClass="msgWarn" infoClass="msgInfo" fatalClass="msgFatal" errorClass="msgError" />
                            </h:panelGroup>    
                        
                        
                        </h:panelGrid>
                        
                        <p:spacer height="5px" />
                        <h:outputLabel for="rule-addtotemplate-switch">
                            <h:outputText styleClass="ui-label" 
                                          value="Include new rule in other occ periods of type: #{occInspectionBB.currentOccPeriod.type.title}?" />
                        </h:outputLabel>
                            <p:selectBooleanCheckbox id="rule-addtotemplate-switch"
                                                     value="#{occInspectionBB.includeEventRuleInCurrentOccPeriodTemplate}" />
                                
                            <p:spacer height="5px" />

                            <p:commandButton   id="addediteventrule-dialog-close"
                                               ajax="true" 
                                               value="Cancel" icon="fa fa-stop" 
                                               onclick="PF('occperiod-dialog-addediteventrule-var').hide()"/>

                            <p:commandButton    id="addediteventrule-button-addrule"
                                                ajax="true" 
                                                actionListener="#{occInspectionBB.rules_commitEventRuleCreate}"
                                                value="create new rule" icon="fa fa-plus"
                                                disabled="#{!systemServicesBB.bbSessionUser.keyCard.hasEnfOfficialPermissions}"
                                                rendered="#{occInspectionBB.currentEventRuleAbstract.ruleid == 0}"
                                                oncomplete="PF('occperiod-dialog-addediteventrule-var').hide()"
                                                update="occperiod-dialog-proposalmetadata-form-messages
                                                periodmetadata-form-proposalsconfig
                                                occperiod-propoals-eventrules-form"/>

                            <p:commandButton    id="addediteventrule-button-editrule"
                                                ajax="true" 
                                                actionListener="#{occInspectionBB.rules_commitEventRuleEdits}"
                                                value="update rule" icon="fa fa-edit"
                                                disabled="#{!systemServicesBB.bbSessionUser.keyCard.hasEnfOfficialPermissions}"
                                                rendered="#{occInspectionBB.currentEventRuleAbstract.ruleid != 0}"
                                                oncomplete="PF('occperiod-dialog-addediteventrule-var').hide()"
                                                update="occperiod-dialog-proposalmetadata-form-messages
                                                periodmetadata-form-proposalsconfig
                                                occperiod-propoals-eventrules-form"/>
                            
                        </h:form>

                    <p:dialog
                        id="occperiod-dialog-fullchecklisttemplate"
                        height="600" width="400"
                        widgetVar="occperiod-dialog-fullchecklisttemplate-var"
                        closable="true" 
                        header="create and edit event rules"
                        rendered="#{systemServicesBB.bbSessionUser.keyCard.hasMuniStaffPermissions}"
                        >
                        <p:scrollPanel id="occperiod-dialog-fullchecklist-scrollpanel">

                            <h:form id="occperiod-checklisttemplate-form-fullchecklist">

                                <h3>Space types in this checklist</h3>

                                <p:dataScroller
                                    id="scroller-template-spacetypelist"
                                    widgetVar="var-scroller-inspectiontemplate-spacetypelist"
                                    var="spaceType"
                                    value="#{occInspectionBB.currentInspection.checklistTemplate.occSpaceTypeTemplateList}"
                                    rowIndexVar="#{spaceType.spaceTypeID}">

                                    <h2>
                                        <h:outputText styleClass="data-text" value="#{spaceType.spaceTypeTitle}" />
                                    </h2>
                                    <div class="datum">
                                        <h:outputText styleClass="ui-label-inline" value="Type: " />
                                        <h:outputText styleClass="data-text" value="#{spaceType.spaceTypeTitle}" />

                                        <p:spacer height="5px" />

                                        <h:outputText styleClass="ui-label-inline" value="Description: " />
                                        <h:outputText styleClass="data-text" value="#{spaceType.spaceTypeDescription}" />
                                    </div>

                                    <div class="datum">
                                        <h:outputText styleClass="ui-label-inline" value="Type ID:" />
                                        <h:outputText styleClass="data-text" value="#{spaceType.spaceTypeID}" />
                                    </div>

                                    <div class="outlinedBox">

                                        <h4>Spaces in this type</h4>

                                        <p:dataScroller
                                            id="scroller-template-spacetypelist-spacelist"
                                            widgetVar="var-scroller-inspectiontemplate-spacetypelist-spacelist"
                                            var="space"
                                            value="#{spaceType.spaceList}"
                                            rowIndexVar="#{space.spaceID}">

                                            <div class="outlinedBox">


                                                <div class="datum">
                                                    <h:outputText styleClass="ui-label-inline" value="Space name: " />
                                                    <h:outputText styleClass="data-text" value="#{space.name}" />

                                                    <p:spacer height="5px" />

                                                    <h:outputText styleClass="ui-label-inline" value="Description: " />
                                                    <h:outputText styleClass="data-text" value="#{space.description}" />
                                                </div>

                                                <div class="datum">
                                                    <h:outputText styleClass="ui-label-inline" value="Space ID:" />
                                                    <h:outputText styleClass="data-text" value="#{space.spaceID}" />
                                                </div>
                                                <p:dataScroller
                                                    id="scroller-template-spacetypelist-spacelist-elementlist"
                                                    widgetVar="var-scroller-inspectiontemplate-spacetypelist-spacelist-elementlist"
                                                    var="codeElement"
                                                    value="#{space.spaceElementList}"
                                                    rowIndexVar="#{codeElement.elementID}">

                                                    <div class="outlinedBox">

                                                        <h:outputLabel styleClass="bold" value="Ordindance: "  />
                                                        <p:spacer height="5px" />
                                                        <h:outputLabel value="#{codeElement.source.sourceName}
                                                                       (#{codeElement.source.sourceYear}), " />
                                                        <h:outputText  value="Ch. #{codeElement.ordchapterNo}:" />
                                                        <h:outputText  value="#{codeElement.ordchapterTitle}" />
                                                        <p:spacer height="2px" />

                                                        <h:outputText  value="&#167;#{codeElement.ordSecNum}:" />
                                                        <h:outputText  value="#{codeElement.ordSecTitle}; " />
                                                        <h:outputText  value="&#167;&#167;#{codeElement.ordSubSecNum} " />
                                                        <h:outputText  value="#{codeElement.ordSubSecTitle}" />

                                                        <p:spacer height="2px" />

                                                        <h:panelGrid    id="violation-ord-fulltext-pg"
                                                                        columns="1"
                                                                        columnClasses="gridTd"
                                                                        rendered="true">
                                                            <h:panelGroup>
                                                                <h:outputLabel styleClass="bold" value="Full ordinance text: "/>
                                                                <div class="ord-text">
                                                                    <h:outputText value="#{codeElement.ordTechnicalText}"/>
                                                                </div>
                                                            </h:panelGroup>

                                                        </h:panelGrid>
                                                    </div>
                                                </p:dataScroller>
                                            </div>
                                        </p:dataScroller>
                                    </div>
                                </p:dataScroller>
                            </h:form>
                        </p:scrollPanel>
                    </p:dialog>
                </f:view>
            </ui:define>
        </ui:composition>
    </h:body>
</html>

