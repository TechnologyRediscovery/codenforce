<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
                xmlns:h="http://xmlns.jcp.org/jsf/html"
                xmlns:f="http://xmlns.jcp.org/jsf/core"
                xmlns:p="http://primefaces.org/ui">

    <h:form id="events-growl-form">
        <p:growl id="events-growl" 
                 globalOnly="false"/>
    </h:form>

    <p:panel id="events-panel"
             toggleable="true"
             collapsed="false"
             header="Events (#{eventsBB.eventListSize}) on #{eventsBB.currentEventHolder.eventDomain.title} (ID:#{eventsBB.currentEventHolder.BObID})">

        <h:form id="events-form">

            <p:commandButton id="events-add-button"
                             styleClass="noFill button-size-small"
                             value="Add event"
                             icon="fa fa-plus"
                             actionListener="#{eventsBB.onEventAddInit}"
                             oncomplete="PF('event-add-dialog-var').show()"
                             update="event-add-dialog"/>

            <p:spacer height="5px"/>

            <p:selectOneMenu style="width: 300px;"
                             id="prop-viewoptionsevents-solb"
                             value="#{eventsBB.eventListFilterMode}"
                             tabindex="10">

                <p:ajax update="events-panel"
                        immediate="true"/>

                <f:selectItems id="prop-events-selitems"
                               value="#{eventsBB.eventListFilterModes}"
                               var="evo"
                               itemValue="#{evo}"
                               itemLabel="#{evo.label}"/>
            </p:selectOneMenu>

            <p:spacer height="5px"/>

            <p:dataTable id="events-table"
                         var="event"
                         sortMode="multiple"
                         value="#{eventsBB.eventList}"
                         tableStyleClass="primeDataTable"
                         rowKey="#{event.eventID}"
                         reflow="true">

                <p:column headerText="Date"
                          width="20%"
                          sortBy="#{event.timeStart}"
                          styleClass="centeredColumnContent">
                    <h:outputText value="#{empty event.timeStart ? eventsBB.getPrettyDate(event.creationts) : eventsBB.getPrettyDate(event.timeStart) }"/>
                </p:column>

                <p:column headerText="Category"
                          width="20%"
                          sortBy="#{event.category.eventCategoryTitle}"
                          styleClass="centeredColumnContent">

                    <div class="#{event.category.icon.styleClass}">
                        <i class="material-icons status-display-icon-i"><h:outputText value="#{event.category.icon.materialIcon}"/></i>
                    </div>

                    <h:outputText value="#{event.category.eventType.label}:"/>

                    <p:spacer height="1px" />

                    <h:outputText value="#{event.category.eventCategoryTitle}"/>
                </p:column>

                <p:column headerText="Description"
                          width="50%"
                          styleClass="centeredColumnContent wrapText">

                    <h:outputText value="#{event.description}"/>

                </p:column>

                <p:column headerText="Actions"
                          width="10%"
                          styleClass="centeredColumnContent">
                    <div class="restrict-main-contents-io-link link-button">
                        <p:commandLink id="event-open-button"
                                       styleClass="noFill button-size-small"
                                       value="view/edit"
                                       oncomplete="PF('event-profile-dialog-var').show()"
                                       update="event-profile-dialog event-profile-form">
                            <f:setPropertyActionListener target="#{eventsBB.currentEvent}" value="#{event}"/>
                        </p:commandLink>
                    </div>
                    <p:spacer height="3px" />
                    <h:outputText value="(ID:#{event.eventID})"/>
                    
                </p:column>
            </p:dataTable>
        </h:form>
    </p:panel>

    <!-- Dialogs -->


    <!-- Event profile dialog -->
    <p:dialog id="event-profile-dialog"
              height="600" width="1000"
              widgetVar="event-profile-dialog-var"
              responsive="true"
              resizable="true"
              closable="true"
              closeOnEscape="true"
              dynamic="true"
              modal="true"
              header="Event (ID: #{eventsBB.currentEvent.eventID}) Profile">

        <div class="p-grid nested-grid">
            <div class="p-col">
                <p:panel id="event-info-panel"
                         toggleable="true"
                         collapsed="false"
                         header="Event Details">
                    <h:form id="event-profile-form">



                        <p:commandButton id="event-edit-toggle-button"
                                         value="#{eventsBB.eventEditMode ? 'Save changes' : 'Edit'}"
                                         rendered="true"
                                         disabled="#{!eventsBB.currentEvent.active}"
                                         ajax="true"
                                         style="margin-right:10px;"
                                         icon="fa #{eventsBB.eventEditMode ? 'fa-check' : 'fa-pencil'}"
                                         actionListener="#{eventsBB.onEventEditModeToggleButtonPress}"
                                         update="@form
                                         events-growl-form"
                                         />



                            <p:commandButton    id="event-edit-cancel-button"
                                                ajax="true"
                                                rendered="#{eventsBB.eventEditMode}"
                                                value="Abort edit"
                                                actionListener="#{eventsBB.onEventEditCancelButtonChange}"
                                                update="@form
                                                events-growl-form"
                                                icon="fa fa-stop" />


                        <p:spacer height="5px" />
                        <div class="p-grid">


                            <div class="p-col-4">
                                <p:outputLabel for="event-domain-ot">
                                    <h:outputText value="Domain"/>
                                </p:outputLabel>
                            </div>
                            <div class="p-col-8">
                                <h:outputText id="event-domain-ot"
                                              value="#{eventsBB.currentEvent.domain.title} "/>
                            </div>

                            <div class="p-col-4">
                                <p:outputLabel for="event-et-ot">
                                    <h:outputText value="Type"/>
                                </p:outputLabel>
                            </div>
                            <div class="p-col-8">

                                <h:outputText id="event-et-ot"
                                              value="#{eventsBB.currentEvent.category.eventType.label} "/>
                            </div>

                            <div class="p-col-4">
                                <p:outputLabel for="event-ec-ot">
                                    <h:outputText value="Category"/>
                                </p:outputLabel>
                            </div>
                            <div class="p-col-8">
                                <h:outputText id="event-ec-ot"
                                              value="#{eventsBB.currentEvent.category.eventCategoryTitle}"/>
                            </div>

                            <div class="p-col-4">
                                <p:outputLabel for="event-descr-ot">
                                    <h:outputText value="Description"/>
                                </p:outputLabel>
                            </div>
                            <div class="p-col-8">
                                <h:outputText id="event-descr-ot"
                                              value="#{eventsBB.currentEvent.description}"
                                              rendered="#{!eventsBB.eventEditMode}"/>

                                <p:inputTextarea id="event-edit-descr"
                                             value="#{eventsBB.currentEvent.description}"
                                             rendered="#{eventsBB.eventEditMode}"
                                             style="width: 100%;"
                                             rows="5"
                                             cols="40"
                                             tabindex="3"
                                             required="false"/>
                            </div>

                            <div class="p-col-4">
                                <p:outputLabel for="event-st-ot">
                                    <h:outputText value="Start time"/>
                                </p:outputLabel>
                            </div>
                            <div class="p-col-8">

                                <h:outputText id="event-st-ot"
                                              value="#{eventsBB.getPrettyDate(eventsBB.currentEvent.timeStart)}"
                                              rendered="#{!eventsBB.eventEditMode}"/>

                                <p:datePicker value="#{eventsBB.currentEvent.timeStart}"
                                            id="event-edit-time-start-cal"
                                            rendered="#{eventsBB.eventEditMode}"
                                            style="width: 100%;"
                                            pattern="MM/dd/yyyy HH:mm"
                                            disabled="false"
                                            hideOnDateTimeSelect="true"
                                              showOnFocus="false"
                                              showIcon="true"
                                            showButtonBar="true"
                                            mask="true"
                                            tabindex="16" 
                                            timeInput="true" 
                                            required="true">

                                    <p:ajax update="event-edit-time-end-cal"/>
                                </p:datePicker>

                                <p:spacer height="5px" />
                                <h:outputLabel for="event-edit-time-start-cal"
                                               rendered="#{eventsBB.eventEditMode}">
                                    <h:outputText value="Duration (mins)"/>
                                </h:outputLabel>
                                <p:spacer height="3px" />
                                <p:inputNumber id="event-edit-duration-in"
                                               value="#{eventsBB.formEventDuration}"
                                               rendered="#{eventsBB.eventEditMode}"
                                               style="width: 50px;">
                                    <p:ajax listener="#{eventsBB.updateTimeEndFromDuration}"
                                            update="event-edit-time-end-cal"/>
                                </p:inputNumber>
                                <p:spacer height="2px" />
                                <h:outputText value="enter mins then press tab to update event end time" 
                                              rendered="#{eventsBB.eventEditMode}"
                                              style="font-style: italic; font-size: 0.7em;"/>
                            </div>

                            <div class="p-col-4">
                                <p:outputLabel for="event-time-end-ot">
                                    <h:outputText value="End time"/>
                                </p:outputLabel>
                            </div>
                            <div class="p-col-8">
                                <h:outputText id="event-time-end-ot"
                                              value="#{eventsBB.getPrettyDate(eventsBB.currentEvent.timeEnd)}"
                                              rendered="#{!eventsBB.eventEditMode}"/>
                                
                                
                                <p:datePicker value="#{eventsBB.currentEvent.timeEnd}"
                                            id="event-edit-time-end-cal"
                                            rendered="#{eventsBB.eventEditMode}"
                                            showButtonBar="true"
                                            style="width: 100%;"
                                            disabled="true"
                                            hideOnDateTimeSelect="true"
                                              showOnFocus="false"
                                              showIcon="true"
                                            mask="true"
                                            pattern="MM/dd/yyyy HH:mm"
                                            tabindex="16" 
                                            timeInput="true" 
                                            required="true"/>
                            </div>

                            <div class="p-col-4">
                                <p:outputLabel for="event-creator">
                                    <h:outputText value="Creation"/>
                                </p:outputLabel>
                            </div>
                            <div class="p-col-8">

                                <h:outputText id="event-creationts"
                                              value="#{eventsBB.getPrettyDate(eventsBB.currentEvent.creationts)}"/>
                                <p:spacer height="3px" />
                                <h:outputText id="event-creator-by"
                                              value="#{ !empty eventsBB.currentEvent.userCreator
                                                        ? 'By '
                                                        : ''}"/>
                                <h:outputText id="event-creator"
                                              value="#{ !empty eventsBB.currentEvent.userCreator
                                                        ? eventsBB.currentEvent.userCreator.human.name
                                                        : ''}"/>
                            </div>
                            <div class="p-col-4">
                                <p:outputLabel for="event-lastupdatedts">
                                    <h:outputText value="Last update"/>
                                </p:outputLabel>
                            </div>
                            <div class="p-col-8">

                                <h:outputText id="event-lastupdatedts"
                                              value="#{eventsBB.getPrettyDate(eventsBB.currentEvent.lastUpdatedTS)}"
                                              rendered="#{!eventsBB.eventEditMode}"/>
                                <p:spacer height="3px"
                                          rendered="#{!eventsBB.eventEditMode}"/>
                                <h:outputText id="event-lastupdator-by"
                                              value="#{ !empty eventsBB.currentEvent.lastUpdatedBy
                                                        ? 'By '
                                                        : ''}"
                                              rendered="#{!eventsBB.eventEditMode}"/>
                                <h:outputText id="event-lastupdatorname"
                                              value="#{ !empty eventsBB.currentEvent.lastUpdatedBy
                                                        ? eventsBB.currentEvent.lastUpdatedBy.human.name
                                                        : ''}"
                                              rendered="#{!eventsBB.eventEditMode}"/>
                            </div>

                            <div class="p-col-4">
                                <h:outputText value="Permissions"/>
                            </div>
                            <div class="p-col-8">
                                <p:outputLabel for="event-mintoview-ot">
                                    <h:outputText value="Rank req. to view: "/>
                                </p:outputLabel>
                                <h:outputText id="event-mintoview-ot"
                                              value="#{eventsBB.currentEvent.category.userRankMinimumToView}"
                                              rendered="#{!eventsBB.eventEditMode}"/>
                                <p:spacer height="5px" 
                                          rendered="#{!eventsBB.eventEditMode}"/>
                                <p:outputLabel for="event-mintoedit-ot">
                                    <h:outputText value="Rank req. to edit: "/>
                                </p:outputLabel>
                                <h:outputText id="event-mintoedit-ot"
                                              value="#{eventsBB.currentEvent.category.userRankMinimumToUpdate}"
                                              rendered="#{!eventsBB.eventEditMode}"/>
                            </div>
                            <div class="p-col-4">
                                <p:outputLabel for="event-active-ot">
                                    <h:outputText value="Active"/>
                                    <p:spacer height="5px" />
                                </p:outputLabel>
                                <p:commandLink id="case-reactivate-cb"
                                               actionListener="#{eventsBB.toggleEventActive}"
                                               disabled="#{eventsBB.eventEditMode}"
                                               style="color:blue;"
                                               value="#{eventsBB.currentEvent.active ? 'deactivate event' : 'reactivate event'}"
                                               update="events-panel
                                               events-growl-form"
                                               oncomplete="PF('event-profile-dialog-var').hide();"/>
                            </div>
                            <div class="p-col-8">
                                <h:outputText id="event-active-ot"
                                              value="#{eventsBB.currentEvent.active ? 'Yes' : 'No'}"/>
                            </div>
                        </div>
                    </h:form>
                </p:panel>
            </div>
            <div class="p-col">
                <p:panel id="event-persons-panel"
                         toggleable="true"
                         collapsed="false"
                         header="Person connections">

                    <h:form id="event-persons-panel-form">

                        <p:commandButton   id="event-persons-manage-button"
                                           ajax="true"
                                           actionListener="#{personBB.onSelectAndLinkPersonsInit(eventsBB.currentEvent)}"
                                           oncomplete="PF('human-search-dialog-var').show()"
                                           disabled="#{!eventsBB.currentEvent.active}"
                                           rendered="#{systemServicesBB.bbSessionUser.keyCard.hasMuniStaffPermissions}"
                                           value="Manage event-person links"
                                           update=" human-search-dialog
                                           events-growl-form
                                           search-query-form
                                           pers-selected-form
                                           hlh-humlist-form"
                                           icon="fa fa-user-plus"
                                           >
                            <f:param name="person-list-component-to-update"
                                     value="event-persons-panel-form" />
                            <p:ajax listener="#{eventsBB.onManageEventPersonButtonChange}" />
                        </p:commandButton>

                        <p:spacer height="5px" />

                        <p:dataTable id="event-persons-table"
                                     var="human"
                                     value="#{eventsBB.eventHumanLinkList}"
                                     tableStyleClass="primeDataTable"
                                     rowKey="#{human.humanID}"
                                     >

                            <p:column headerText="Name"
                                      width="85%"
                                      styleClass="centeredColumnContent">
                                <h:outputText value="#{human.name} is #{human.linkedObjectRole.title} this event"/>
                                <p:spacer height="3px" />
                                <h:outputText value="Link timestamp: #{eventsBB.getPrettyDate(human.linkCreatedTS)}"/>
                                <p:spacer height="3px" />
                                <h:outputText value="(Human ID: #{human.humanID}; Link ID: #{human.linkID})"/>

                            </p:column>

                            <p:column headerText="Actions"
                                      width="15%"
                                      styleClass="centeredColumnContent">
                                <p:commandLink      id="event-person-exploreperson-button"
                                                    ajax="true"
                                                    style="color:blue;"
                                                    action="#{personBB.onHumanViewLinkClick(human)}"
                                                    value="view"
                                                    update="person-info-form
                                                            person-profile-addresses-form
                                                            person-profile-phones-form
                                                            person-profile-emails-form
                                                            person-links-form
                                                            person-profile-dialog
                                                            persontools-growl-form"
                                                    oncomplete="PF('person-profile-dialog-var').show();"
                                                    />

                            </p:column>
                        </p:dataTable>
                    </h:form>
                </p:panel>
                <p:panel id="event-notes-panel"
                         toggleable="true"
                         collapsed="false"
                         header="Notes">

                    <h:form id="event-notes-form" >
                        <p:commandButton  id="event-notes-add-button"
                                          rendered="#{systemServicesBB.bbSessionUser.keyCard.hasMuniReaderPermissions}"
                                          value="Add New Note"
                                          disabled="false"
                                          icon="fa fa-sticky-note"
                                          actionListener="#{eventsBB.onNoteInitButtonChange}"
                                          oncomplete="PF('event-note-dialog-var').show()"
                                          update="event-note-form
                                          events-growl-form"/>
                        <p:spacer height="5px" />
                        <h:outputText id="event-note-ot"
                                      value="#{eventsBB.currentEvent.notes}"
                                      escape="false"/>
                    </h:form>
                </p:panel>
            </div>
        </div>
    </p:dialog>



    <!-- Event add dialog -->
    <p:dialog id="event-add-dialog"
              height="700" width="1500"
              widgetVar="event-add-dialog-var"
              responsive="true"
              resizable="true"
              closable="true"
              closeOnEscape="true"
              dynamic="true"
              modal="true"
              header="Attaching new event to object with ID #{eventsBB.currentEventHolder.BObID}"
              rendered="true">

        <h:form id="event-add-form">
            <div class="ui-g data_container_nested_restrict">

                <div class="ui-g-12 ui-md-12 ui-lg-6 restrict-data-field">
                    <div class="restrict-main-contents-io-title">
                        <h:outputLabel for="event-add-type-solb">
                            <h:outputText value="Type"/>
                        </h:outputLabel>
                    </div>

                    <div class="restrict-main-contents-io-content">
                        <p:growl for="event-add-type-solb"/>
                        <p:selectOneListbox id="event-add-type-solb"
                                            required="true"
                                            value="#{eventsBB.skeletonType}"
                                            tabindex="10">

                            <p:ajax update="event-add-form"/>

                            <f:selectItems value="#{eventsBB.listOfPotentialTypes}" var="et" itemLabel="#{et.label}"/>
                        </p:selectOneListbox>
                    </div>
                </div>

                <div class="ui-g-12 ui-md-12 ui-lg-6 restrict-data-field">
                    <div class="restrict-main-contents-io-title">
                        <h:outputLabel for="event-add-cat-solb">
                            <h:outputText value="Category"/>
                        </h:outputLabel>
                    </div>

                    <div class="restrict-main-contents-io-content">
                        <p:selectOneListbox id="event-add-cat-solb"
                                            style="width: 100%;"
                                            value="#{eventsBB.skeletonEvent.category}"
                                            tabindex="11">

                            <p:ajax listener="#{eventsBB.onCategoryChangeUpdateSkeletonEventMembers}"
                                    update="event-add-form" />

                            <f:converter converterId="eventCategoryConverter"/>

                            <f:selectItems value="#{eventsBB.listOfPotentialCategories}" var="ec" itemValue="#{ec}"
                                           itemLabel="#{ec.eventCategoryTitle}"/>

                        </p:selectOneListbox>
                    </div>

                    <p:spacer height="5px"/>

                    <div class="restrict-main-contents-io-content">
                        <p:selectBooleanCheckbox id="event-add-updatefields-sbb"
                                                 itemLabel="Auto fill event details"
                                                 title="Description and duration will be set automatically"
                                                 value="#{eventsBB.updateFieldsOnCategoryChange}">
                            <p:ajax/>
                        </p:selectBooleanCheckbox>
                    </div>
                </div>

                <div class="ui-g-12 ui-md-12 ui-lg-12 restrict-data-field">
                    <h2>
                        <h:outputText id="event-add-currtypecat-type-ot"
                                      value="#{eventsBB.skeletonType.label}"/>
                        <h:outputText value=": "/>
                        <h:outputText id="event-add-currtypecat-cat-ot"
                                      value="#{eventsBB.skeletonEvent.category.eventCategoryTitle}"/>
                    </h2>
                    <p:spacer height="3px"/>
                    <h:outputText id="event-add-currtypecat-desc"
                                  value="#{eventsBB.skeletonEvent.category.eventCategoryDesc}"/>
                </div>

                <div class="ui-g-12 ui-md-12 ui-lg-4 restrict-data-field">

                    <div class="restrict-main-contents-io-title">
                        <h:outputLabel for="event-add-time-start-cal">
                            <h:outputText value="Start time"/>
                        </h:outputLabel>
                    </div>

                    <div class="restrict-main-contents-io-content">
                        <p:growl for="event-add-time-start-cal"/>

                        <p:datePicker value="#{eventsBB.skeletonEvent.timeStart}"
                                    id="event-add-time-start-cal"
                                    pattern="MM/dd/yyyy HH:mm"
                                    tabindex="16" 
                                    timeInput="true" 
                                    showButtonBar="false"
                                    inline="false"
                                    hideOnDateTimeSelect="true"
                                              showOnFocus="false"
                                              showIcon="true"
                                    mask="true"
                                    hourFormat="24"
                                    required="true">
                            <p:ajax update="event-add-time-end-cal" listener="#{eventsBB.recalculateEndTime}"/>
                        </p:datePicker>
                    </div>
                </div>

                <div class="ui-g-12 ui-md-12 ui-lg-4 restrict-data-field">
                    <div class="restrict-main-contents-io-title">
                        <h:outputLabel for="event-add-time-start-cal">
                            <h:outputText value="Duration (mins)"/>
                        </h:outputLabel>
                    </div>

                    <div class="restrict-main-contents-io-content">
                        <p:inputNumber id="event-add-duration-in"
                                       value="#{eventsBB.skeletonDuration}"
                                       style="width: 50px;">
                            <p:ajax     listener="#{eventsBB.recalculateEndTime}"
                                        update="event-add-time-end-cal"/>
                        </p:inputNumber>
                    </div>
                </div>

                <div class="ui-g-12 ui-md-12 ui-lg-4 restrict-data-field">
                    <div class="restrict-main-contents-io-title">
                        <h:outputLabel for="event-add-time-end-cal">
                            <h:outputText value="End time"/>
                        </h:outputLabel>
                    </div>

                    <div class="restrict-main-contents-io-content">
                        <p:growl for="event-add-time-end-cal" />
                        <p:datePicker id="event-add-time-end-cal"
                                    value="#{eventsBB.skeletonEvent.timeEnd}"
                                    disabled="true"
                                    showButtonBar="false"
                                    mask="true"
                                    pattern="MM/dd/yyyy HH:mm"
                                    hideOnDateTimeSelect="true"
                                              showOnFocus="false"
                                              showIcon="true"
                                    tabindex="16" 
                                    timeInput="true" 
                                    hourFormat="24"
                                    required="true"/>
                    </div>
                </div>

                <div class="ui-g-12 ui-md-12 ui-lg-12 restrict-data-field">
                    <div class="restrict-main-contents-io-title">
                        <h:outputLabel for="event-add-descr-it">
                            <h:outputText value="Description"/>
                        </h:outputLabel>
                    </div>

                    <div class="restrict-main-contents-io-content">
                        <p:inputTextarea  id="event-add-descr-it" 
                                          value="#{eventsBB.skeletonEvent.description}" 
                                          style="width: 100%; height: 150px;" 
                                          tabindex="3" 
                                          required="false" />
                    </div>
                </div>
            </div>

            <div class="restrict-main-contents-io-button">
                <p:commandButton id="event-add-dialog-show-cb"
                                 disabled="#{empty eventsBB.skeletonEvent.category}"
                                 rendered="#{systemServicesBB.bbSessionUser.keyCard.hasMuniStaffPermissions}"
                                 value="Create new event"
                                 icon="fa fa-bolt"
                                 actionListener="#{eventsBB.createNewEvent}"
                                 oncomplete="PF('event-add-dialog-var').hide()"
                                 update="events-panel
                                 events-growl-form"/>
            </div>

            <div class="restrict-main-contents-io-button gray_button">
                <p:commandButton id="event-add-cancel-button"
                                 value="Cancel"
                                 oncomplete="PF('event-add-dialog-var').hide()"
                                 icon="fa fa-stop"/>
            </div>
        </h:form>
    </p:dialog>

    <!-- Event edit dialog -->
    <p:dialog id="event-note-dialog"
              height="400" width="400"
              widgetVar="event-note-dialog-var"
              responsive="true"
              resizable="true"
              closable="true"
              closeOnEscape="true"
              dynamic="true"
              modal="true"
              header="New note on event ID:#{eventsBB.currentEvent.eventID}">


        <h:form id="event-note-form">
            <h:outputText styleClass="ui-label" value="Note text: "/>
            <p:inputTextarea id="event-notes-editor"
                          value="#{eventsBB.formNoteText}"
                          required="false"
                          rows="5"
                          cols="40"
                          />
            
            <p:spacer height="5px" />
            <p style="font-style: italic">Your username and the current date are automatically included in the note.</p>
            <p:spacer height="5px" />

            <p:commandButton id="event-dialog-notes-button-addnote"
                             ajax="true"
                             disabled="false"
                             actionListener="#{eventsBB.onNoteCommitButtonChange}"
                             oncomplete="PF('event-note-dialog-var').hide()"
                             rendered="#{systemServicesBB.bbSessionUser.keyCard.hasMuniStaffPermissions}"
                             value="Attach Note"
                             styleClass="inline-button"
                             icon="fa fa-sticky-note-o"
                             update="event-notes-form
                             events-growl-form
                             "/>
        </h:form>

    </p:dialog>



    <!-- Stuff below here is currently unused -->

    <!-- Event deactivate dialog -->
    <!-- Note to self: This should be replaced with one of the confirmdialogs from the other page -->
    <p:dialog id="event-deactivate-dialog"
              height="300" width="400"
              widgetVar="event-deactivate-dialog-var"
              responsive="true"
              resizable="trie"
              closable="true"
              closeOnEscape="true"
              dynamic="true"
              modal="true"
              header="Deactivate event id #{eventsBB.currentEvent.eventID}"
              rendered="true">

        <h:form id="event-remove-form">
            <div class="ui-g data_container_nested_restrict">
                <div class="ui-g-12 ui-md-12 ui-lg-12 restrict-data-field">
                    <div class="restrict-data-field-label-inline">
                        <h:outputLabel for="event-remove-button">
                            <h:outputText value="Deactivated events can be recovered by changing event view options"/>
                        </h:outputLabel>
                    </div>
                </div>

                <div class="ui-g-12 ui-md-6 ui-lg-6 restrict-data-field">
                    <div class="restrict-main-contents-io-button gray_button">
                        <p:commandButton id="event-nuke-cancel-button"
                                         ajax="true"
                                         value="Cancel"
                                         process="@none"
                                         immediate="true"
                                         oncomplete="PF('event-deactivate-dialog-var').hide()"
                                         actionListener="#{eventsBB.onEventNukeCancelButtonChange}"
                                         icon="fa fa-stop"/>
                    </div>
                </div>

                <div class="ui-g-12 ui-md-6 ui-lg-6 restrict-data-field">
                    <div class="restrict-main-contents-io-button red_button">
                        <p:commandButton ajax="true" 
                                         actionListener="#{eventsBB.onEventRemoveCommitButtonChange}"
                                         value="Deactivate event"
                                         icon="fa fa-close"
                                         update="events-panel
                                         events-growl-form"
                                         rendered="true"/>
                    </div>
                </div>
            </div>
        </h:form>
    </p:dialog>

</ui:composition>