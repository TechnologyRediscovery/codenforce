<?xml version='1.0' encoding='UTF-8' ?>
<!--
Copyright (C) 2020 Turtle Creek Valley

This program is free software: you can redistribute it and/or modify
it under the terms of the GNU General Public License as published by
the Free Software Foundation, either version 3 of the License, or
(at your option) any later version.

This program is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
GNU General Public License for more details.

You should have received a copy of the GNU General Public License
along with this program.  If not, see <http://www.gnu.org/licenses/>.
-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:f="http://xmlns.jcp.org/jsf/core"
      xmlns:p="http://primefaces.org/ui">

    <h:head>
        <link rel="stylesheet" type="text/css" href="css/style.css"></link>
        <title>CE Case Profile</title>
    </h:head>

    <h:body id="cecase-lookup-profile-body">

        <ui:composition template="/restricted/navContainer_restricted.xhtml">
            <ui:define name="content">
                <f:view id="cecase-lookup-profile-view">


                    <p:outputPanel id="body-panel">

                        <h:form id="cecase-growl-form">

                            <p:growl id="cecase-growl"
                                     redisplay="true"/>
                        </h:form>

                        <h:form id="cecaselists-launcher">
                            <h1>
                                <h:outputText id="header-type-ot" value="#{ceCaseBB.currentCase.caseName} @ "/> 
                                <h:outputText id="header-addr-ot" value="#{ceCaseBB.currentCase.property.address.addressPretty1Line} "/>  
                                <h:outputText id="header-muni-ot" value="(#{ceCaseBB.currentCase.property.muni.muniName})"/>  
                            </h1>

                        </h:form>

                        <div class="mainContainer">
                            <div class="page-links">

                                <div class="restrict-main-contents-io-link link-button">
                                    <a href="#cecase-profile-panel">case profile</a>
                                </div>
                                <h:outputText value=" | " />
                                <div class="restrict-main-contents-io-link link-button">
                                    <a href="#cecase-violations-panel">
                                        <h:outputText value="violations (#{ceCaseBB.currentCase.violationList.size()})" />
                                    </a>
                                </div>
                                <h:outputText value=" | " />
                                <div class="restrict-main-contents-io-link link-button">
                                    <a href="#cecase-notices-panel">
                                        <h:outputText value="notices (#{ceCaseBB.currentCase.noticeList.size()})" />
                                    </a>
                                </div>
                                <h:outputText value=" | " />
                                <div class="restrict-main-contents-io-link link-button">
                                    <a href="#cecase-citations-panel">
                                        <h:outputText value="citations (#{ceCaseBB.currentCase.citationList.size()})" />
                                    </a>
                                </div>
                                <h:outputText value=" | " />
                                <div class="restrict-main-contents-io-link link-button">
                                    <a href="#cecase-events-panel">
                                        <h:outputText value="events (#{ceCaseBB.currentCase.eventList.size()})" />
                                    </a>
                                </div>
                                <h:outputText value=" | " />
                                <div class="restrict-main-contents-io-link link-button">
                                    <a href="#cecase-cears-panel">
                                        <h:outputText value="action requests (#{ceCaseBB.currentCase.ceActionRequestList.size()})" />
                                    </a>
                                </div>
                                <h:outputText value=" | " />
                                <div class="restrict-main-contents-io-link link-button">
                                    <a href="#cecase-blobs-panel">
                                        <h:outputText value="photos &amp; docs (#{ceCaseBB.currentCase.blobList.size()})" />
                                    </a>
                                </div>
                                <h:outputText value=" | " />
                                <div class="restrict-main-contents-io-link link-button">
                                    <a href="#cecase-fees-panel">
                                        <h:outputText value="fees" />
                                    </a>
                                </div>
                                <h:outputText value=" | " />
                                <div class="restrict-main-contents-io-link link-button">
                                    <a href="#cecase-payments-panel">
                                        <h:outputText value="payments" />
                                    </a>
                                </div>
                                <h:outputText value=" | " />
                                <div class="restrict-main-contents-io-link link-button">
                                    <a href="#cecase-notes-panel">
                                        <h:outputText value="notes" />
                                    </a>
                                </div>
                                <h:outputText value=" | " />
                                <div class="restrict-main-contents-io-link link-button">

                                    <a href="#cecase-public-panel">
                                        <h:outputText value="public access" />
                                    </a>
                                </div>
                            </div>

                            <div class="ui-g data_container_nested_restrict">
                                <div class="ui-g-12 ui-md-6 ui-lg-6 restrict-data-field">

                                    <p:panel    id="cecase-profile-panel"
                                                toggleable="true"
                                                widgetVar="cecase-profile-panel-var"
                                                collapsed="false"
                                                rendered="true"
                                                header="Code Enforcement Case | ID: #{ceCaseBB.currentCase.caseID}" >

                                        <h:form id="cecase-profile-form-0">
                                            <p:commandButton id="cecase-edit-button"  
                                                             value="#{ceCaseBB.editModeCurrentCase ? 'Save changes' : 'Edit case details'}"
                                                             rendered="#{systemServicesBB.bbSessionUser.keyCard.hasMuniStaffPermissions}"
                                                             icon="fa #{ceCaseBB.editModeCurrentCase ? 'fa-check' : 'fa-pencil'}"
                                                             actionListener="#{ceCaseBB.onToggleCECaseEditButtonChange}"
                                                             update="   @form
                                                             cecase-growl-form
                                                             cecase-profile-panel"/>

                                            <div class="gray_button">

                                                <p:commandButton id="cecase-edit-abort"
                                                                 value="Cancel"
                                                                 styleClass="gray-button"
                                                                 rendered="#{ceCaseBB.editModeCurrentCase}"
                                                                 icon="fa fa-stop"
                                                                 actionListener="#{ceCaseBB.onEditCECaseAbort}"
                                                                 update="@form
                                                                 cecase-growl-form"/>
                                            </div>

                                            <p:spacer height="5px" />


                                            <div class="p-grid">


                                                <div class="p-col-4 restrict-data-field-label-inline">
                                                    <h:outputText value="Property" />    
                                                </div>
                                                <div class="p-col-8 restrict-data-field-value-inline">
                                                    <h:outputText value="#{ceCaseBB.currentCase.property.address.addressPretty2LineEscapeFalse}"
                                                                  escape="false" />
                                                </div>
                                                <div class="p-col-4 restrict-data-field-label-inline">
                                                    <h:outputText value="Broadview" />    
                                                </div>

                                                <div class="p-col-8 restrict-data-field-value-inline">
                                                    <p:graphicImage value="#{blobsterBB.image}"
                                                                    alt="no preview available" 
                                                                    style="width: 150px" 
                                                                    cache="false"
                                                                    rendered="#true">
                                                        <f:param name="blobid" value="#{sessionBean.sessProperty.broadviewPhoto.photoDocID}"/>
                                                    </p:graphicImage>
                                                </div>


                                                <div class="p-col-4 restrict-data-field-label-inline">
                                                    <p:outputLabel for="case-status-ot">
                                                        <h:outputText value="Case status"/>
                                                    </p:outputLabel>
                                                </div>
                                                <div class="p-col-8 restrict-data-field-value-inline">
                                                    <h:outputLabel id="case-status-ot"
                                                                   value="#{ceCaseBB.currentCase.statusBundle.phase.caseOpen ? 'Open' : 'Closed'}"/>
                                                </div>


                                                <div class="p-col-4 restrict-data-field-label-inline">
                                                    <p:outputLabel for="case-phase-ot">
                                                        <h:outputText value="Phase"/>
                                                    </p:outputLabel>
                                                </div>
                                                <div class="p-col-8 restrict-data-field-value-inline">
                                                    <h:outputText id="case-phase-ot" 
                                                                  value="#{ceCaseBB.currentCase.statusBundle.phase.label}"/>
                                                </div>


                                                <div class="p-col-4 restrict-data-field-label-inline">
                                                    <h:outputText value="Property Unit associated?" />
                                                </div>
                                                <div class="p-col-8 restrict-data-field-value-inline">
                                                    <h:outputText value="#{empty ceCaseBB.currentCase.propertyUnit 
                                                                           ? 'None specified'
                                                                           : ceCaseBB.currentCase.propertyUnit.unitNumber}"
                                                                  rendered="#{!ceCaseBB.editModeCurrentCase}"/>


                                                    <p:selectBooleanCheckbox    id="cecase-details-isunitassociated-checkbox"
                                                                                value="#{ceCaseBB.formCurrentCaseUnitAssociated}"
                                                                                rendered="#{ceCaseBB.editModeCurrentCase}" >
                                                        <p:ajax update="cecase-unit-som" />
                                                    </p:selectBooleanCheckbox>
                                                    <p:spacer height="3px" />

                                                    <h:selectOneMenu id="cecase-unit-som"
                                                                     value="#{ceCaseBB.formSelectedUnit}"
                                                                     required="false"
                                                                     disabled="#{!ceCaseBB.formCurrentCaseUnitAssociated}"
                                                                     rendered="#{ceCaseBB.editModeCurrentCase}">

                                                        <f:converter converterId="propertyUnitConverter"/>
                                                        <f:selectItem itemLabel="select a unit on current property"
                                                                      noSelectionOption="true" 
                                                                      itemDisabled="true"/>
                                                        <f:selectItems id="cecase-unit-selectitems"
                                                                       value="#{ceCaseBB.currentCase.property.unitList}"
                                                                       var="pu" 
                                                                       itemValue="#{pu}" 
                                                                       itemLabel="#{pu.unitNumber} (ID:#{pu.unitID})"/>
                                                    </h:selectOneMenu>
                                                </div>


                                                <div class="p-col-4 restrict-data-field-label-inline">
                                                    <h:outputText value="Origination event" />
                                                </div>
                                                <div class="p-col-8 restrict-data-field-value-inline">

                                                    <h:outputText value="Current origination event category: " 
                                                                  rendered="#{ceCaseBB.editModeCurrentCase}"/>

                                                    <h:outputText value="#{!empty ceCaseBB.currentCase.originationEvent ? ceCaseBB.currentCase.originationEvent.category.eventCategoryTitle : 'no orig event'}" 
                                                                  rendered="true"/>

                                                    <p:spacer height="4px" />

                                                    <h:outputText value="Update to: " 
                                                                  rendered="#{ceCaseBB.editModeCurrentCase}"/>

                                                    <p:spacer height="4px" />
                                                    <h:selectOneMenu id="cecase-add-origevent-som"
                                                                     value="#{ceCaseBB.formCECaseOriginationEventCat}"
                                                                     rendered="#{ceCaseBB.editModeCurrentCase}"
                                                                     required="false"
                                                                     style="width:100%;">

                                                        <f:converter converterId="eventCategoryConverter"/>
                                                        <f:selectItem itemLabel="select an origination event category"
                                                                      noSelectionOption="true" 
                                                                      itemDisabled="false"/>
                                                        <f:selectItems id="cecase-add-origevent-selectitems"
                                                                       value="#{ceCaseBB.originationEventCategoryList}"
                                                                       var="ec" 
                                                                       itemValue="#{ec}" 
                                                                       itemLabel="#{ec.eventCategoryTitle}"/>
                                                    </h:selectOneMenu>

                                                </div>


                                                <div class="p-col-4 restrict-data-field-label-inline">


                                                    <h:form id="cecase-profile-casename-help-form">

                                                        <h:outputText value="Name "/>
                                                        <p:commandButton id="casename-help-button"
                                                                         icon="fa fa-question-circle-o"
                                                                         styleClass="button-help"
                                                                         type="button" />

                                                        <p:overlayPanel for="casename-help-button"
                                                                        style="width:350px;" 
                                                                        dismissable="true"
                                                                        showCloseIcon="true">
                                                            <h3>Code enforcement case names</h3>
                                                            <p>A case's name is a text field for INTERNAL office use only that allows managers to label a case something memorable,
                                                                such as 'deer feeding lady' or 'fridge in front yard' or 'imploded garage'. The case name appears on the dashboard's
                                                                case list for easy ID but does not by default print on case list reports .</p>
                                                        </p:overlayPanel>
                                                    </h:form>
                                                </div>
                                                <div class="p-col-8 restrict-data-field-value-inline">

                                                    <h:outputLabel id="case-name-ot"
                                                                   value="#{ceCaseBB.currentCase.caseName}"
                                                                   rendered="#{!ceCaseBB.editModeCurrentCase}"/>
                                                    <h:inputText    id="cecase-name-it"
                                                                    styleClass="data_field_value"
                                                                    value="#{ceCaseBB.currentCase.caseName}"
                                                                    rendered="#{ceCaseBB.editModeCurrentCase}"/>


                                                </div>

                                                <div class="p-col-4 restrict-data-field-label-inline">
                                                    <h:outputText value="Source"/>
                                                </div>
                                                <div class="p-col-8 restrict-data-field-value-inline">
                                                    <h:outputText value="#{!empty ceCaseBB.currentCase.source? ceCaseBB.currentCase.source.title : ''}" />
                                                    <h:selectOneMenu id="cecase-source-som"
                                                                     value="#{ceCaseBB.currentCase.source}"
                                                                     styleClass="data_field_value"
                                                                     rendered="#{ceCaseBB.editModeCurrentCase}">
                                                        <f:converter converterId="bobSourceConverter"/>
                                                        <f:selectItem itemLabel="select a source..." noSelectionOption="true" />
                                                        <f:selectItems id="cecase-source-selitem"
                                                                       value="#{ceCaseBB.bobSourceOptionList}"
                                                                       var="bs" itemValue="#{bs}" itemLabel="#{bs.title}"/>

                                                    </h:selectOneMenu>
                                                </div>

                                                <div class="p-col-4 restrict-data-field-label-inline">
                                                    <h:outputLabel value="Opening date"/>
                                                </div>
                                                <div class="p-col-8 restrict-data-field-value-inline">

                                                    <h:outputText id="selcase-odate-it" 
                                                                  value="#{ceCaseBB.getPrettyDateNoTime(ceCaseBB.currentCase.originationDate)}"
                                                                  rendered="#{!ceCaseBB.editModeCurrentCase}"/>
                                                    <h:outputText id="selcase-age-it" 
                                                                  value=" (#{ceCaseBB.currentCase.caseAge} days ago)" 
                                                                  rendered="#{empty ceCaseBB.currentCase.closingDate and !ceCaseBB.editModeCurrentCase}"/>

                                                    <p:datePicker 	id="cecase-date-origination-cal"
                                                                   value="#{ceCaseBB.currentCase.originationDate}"
                                                                   rendered="#{ceCaseBB.editModeCurrentCase}"
                                                                   style="width: 100%;"
                                                                   pattern="MM/dd/yyyy HH:mm"
                                                                   disabled="false"
                                                                   hideOnDateTimeSelect="true"
                                                                   showOnFocus="false"
                                                                   showIcon="true"
                                                                   showButtonBar="true"
                                                                   mask="true"
                                                                   timeInput="true" 
                                                                   required="true" />
                                                </div>
                                            </div>
                                        </h:form>

                                        <div class="p-grid">
                                            <div class="p-col-4 restrict-data-field-label-inline">
                                                <h:outputLabel value="Closing date"/>
                                            </div>
                                            <div class="p-col-8 restrict-data-field-value-inline">
                                                <h:form id="cecase-forceclose-form">
                                                    <h:outputText id="selcase-cdate-it" 
                                                                  value="#{ceCaseBB.getPrettyDateNoTime(ceCaseBB.currentCase.closingDate)}"
                                                                  rendered="#{!ceCaseBB.editModeCurrentCloseCase}"/>

                                                    <p:spacer height="3px" />

                                                    <h:outputText id="selcase-closing-evcat" 
                                                                  value="#{ceCaseBB.currentCase.closingEvent.category.eventCategoryTitle}"
                                                                  rendered="#{!empty ceCaseBB.currentCase.closingEvent}"/>
                                                    <p:spacer height="3px" />

                                                    <p:commandLink      id="cecase-forceclose-init-cb" 
                                                                        value="#{!empty ceCaseBB.currentCase.closingDate and !ceCaseBB.currentCase.statusBundle.phase.allowCaseClosure ? 'close case' : 'case closure not allowed'}"
                                                                        ajax="true" 
                                                                        actionListener="#{ceCaseBB.onCaseCloseInitButtonChange}"
                                                                        disabled="#{!empty ceCaseBB.currentCase.closingDate and !ceCaseBB.currentCase.statusBundle.phase.allowCaseClosure}"
                                                                        rendered="#{!ceCaseBB.editModeCurrentCloseCase}"
                                                                        style="color: blue; font-weight: bold; "
                                                                        update="@form"/>



                                                    <f:subview id="case-close-form-subview"
                                                               rendered="#{ceCaseBB.editModeCurrentCloseCase}">


                                                        <div   class="ui-g data-container">

                                                            <div class="ui-g-12 ui-md-12 ui-lg-12 data_field">

                                                                <p:outputLabel for="cecase-forceclose-evcat-som"
                                                                               styleClass="data_field_label">
                                                                    <h:outputText value="Reason for closure:"/>
                                                                </p:outputLabel>
                                                                <div class="restrict-main-contents-io-content">
                                                                    <h:selectOneMenu id="cecase-forceclose-evcat-som"
                                                                                     value="#{ceCaseBB.closingEventCategorySelected}"
                                                                                     styleClass="data_field_value"
                                                                                     disabled="#{!systemServicesBB.bbSessionUser.keyCard.hasEnfOfficialPermissions}">

                                                                        <f:converter converterId="eventCategoryConverter"/>
                                                                        <f:selectItem itemLabel="select a closing event category"
                                                                                      noSelectionOption="true" />
                                                                        <f:selectItems id="cecase-forceclose-evcat-selitems"
                                                                                       value="#{ceCaseBB.closingEventList}"
                                                                                       var="ec" itemValue="#{ec}" itemLabel="#{ec.eventCategoryTitle}"/>
                                                                    </h:selectOneMenu>
                                                                </div>
                                                            </div>

                                                            <div class="ui-g-12 ui-md-6 ui-lg-6 data_field">
                                                                <p:outputLabel for="case-close-date"
                                                                               styleClass="data_field_label">
                                                                    <h:outputText value="Closing data of record"  />
                                                                </p:outputLabel>

                                                                <div class="restrict-main-contents-io-content">

                                                                    <p:datePicker  id="case-close-date"
                                                                                   value="#{ceCaseBB.currentCase.closingDate}"
                                                                                   rendered="true"
                                                                                   style="width: 100%;"
                                                                                   pattern="MM/dd/yyyy HH:mm"
                                                                                   disabled="false"
                                                                                   hideOnDateTimeSelect="true"
                                                                                   showOnFocus="false"
                                                                                   showIcon="true"
                                                                                   showButtonBar="true"
                                                                                   mask="true"
                                                                                   timeInput="true" 
                                                                                   required="true" />


                                                                </div>
                                                            </div>
                                                            <div class="ui-g-12 ui-md-12 ui-lg-12 data_field">
                                                                <h:outputText value="when a case is closed, violations without compliance are automatically nullified" />
                                                            </div>
                                                            <div class="ui-g-12 ui-md-6 ui-lg-6 data_field">
                                                                <p:commandButton    id="cecase-forceclose-button"
                                                                                    ajax="false"
                                                                                    value="Close case ID #{ceCaseBB.currentCase.caseID}"
                                                                                    action="#{ceCaseBB.onCaseForceCloseCommitButtonChnage}"
                                                                                    icon="fa fa-folder"/>

                                                            </div>
                                                            <div class="ui-g-12 ui-md-6 ui-lg-6 data_field">

                                                                <div class="restrict-main-contents-io-button gray_button">

                                                                    <p:commandButton    id="cecase-forceclse-abort-button1"
                                                                                        ajax="true"
                                                                                        value="cancel"
                                                                                        actionListener="#{ceCaseBB.onCaseCloseAbortLinkClick}"
                                                                                        icon="fa fa-stop"
                                                                                        update="@form"/>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </f:subview>
                                                </h:form>

                                            </div>


                                            <div class="p-col-4 restrict-data-field-label-inline">
                                                <h:outputText value="Manager"/>
                                            </div>
                                            <div class="p-col-8 restrict-data-field-value-inline">

                                                <h:form id="cecase-changemanager-form">


                                                    <h:outputText id="case-manager-ot" 
                                                                  value="#{ceCaseBB.currentCase.caseManager.human.name}"
                                                                  rendered="#{!ceCaseBB.editModeCurrentCaseManager}"/>  

                                                    <p:spacer height="4px" />

                                                    <h:outputText id="case-manager-username"
                                                                  value="(User:#{ceCaseBB.currentCase.caseManager.username})"
                                                                  rendered="#{!ceCaseBB.editModeCurrentCaseManager}"/>

                                                    <p:spacer height="4px" />

                                                    <div class="restrict-main-contents-io-link link-button">

                                                        <p:commandLink      id="cecase-manager-edit-toggle-clink"
                                                                            ajax="true"
                                                                            actionListener="#{ceCaseBB.onToggleCECaseManagerEdit}"
                                                                            value="#{ceCaseBB.editModeCurrentCaseManager ? 'save edits':'change manager'}"
                                                                            update="@form
                                                                            cecase-growl-form"
                                                                            />
                                                        <h:outputText value=" "
                                                                      styleClass="spacer-char" />

                                                        <p:commandLink      id="cecase-manager-edit-abort-clink"
                                                                            ajax="true"
                                                                            actionListener="#{ceCaseBB.onEditManagerAbort}"
                                                                            value="cancel"
                                                                            rendered="#{ceCaseBB.editModeCurrentCaseManager}"
                                                                            update="@form
                                                                            cecase-growl-form"
                                                                            />
                                                    </div>

                                                    <p:spacer height="5px" />

                                                    <p:outputLabel for="cecase-manager-som"
                                                                   styleClass="data_field_label">
                                                        <h:outputText value="Choose a new manager user"
                                                                      rendered="#{ceCaseBB.editModeCurrentCaseManager}"/>
                                                    </p:outputLabel>

                                                    <div class="restrict-main-contents-io-content">
                                                        <p:selectOneMenu  id="cecase-manager-som"
                                                                          tabindex="1"
                                                                          rendered="#{ceCaseBB.editModeCurrentCaseManager}"
                                                                          value="#{ceCaseBB.currentCase.caseManager}"
                                                                          >
                                                            <f:selectItem itemLabel="select a user "
                                                                          noSelectionOption="true"
                                                                          itemDisabled="true"/>
                                                            <f:selectItems id="cecase-search-user-field-val-items"
                                                                           value="#{systemServicesBB.userListForSearch}"
                                                                           var="usr" itemValue="#{usr}" itemLabel="#{usr.human.firstName} #{usr.human.lastName}; username #{usr.username}" />
                                                            <f:converter converterId="userConverter" />
                                                        </p:selectOneMenu>
                                                    </div>
                                                </h:form>
                                            </div>
                                        </div>

                                        <div class="p-grid">

                                            <div class="p-col-4 restrict-data-field-label-inline">

                                                <h:outputText value="Record"  />
                                            </div>

                                            <div class="p-col-8 restrict-data-field-value-inline">
                                                <h:form id="cecase-profile-record-form">

                                                    <h:outputText      id="cecase-record-ot"
                                                                       value="#{ceCaseBB.currentCase.active ? 'Active record':'Deactivated record'}"  />
                                                    <h:outputText value=" " 
                                                                  styleClass="inline-space-single"/>
                                                    <h:outputText id="cecase-id-ot"
                                                                  value="(ID:#{ceCaseBB.currentCase.caseID})" />

                                                    <p:spacer height="3px" />

                                                    <h:outputText value="Last updated: #{ceCaseBB.getPrettyDate(ceCaseBB.currentCase.lastUpdatedTS)}" />

                                                    <p:spacer height="3px" />

                                                    <h:outputText      id="cecase-propinfo-ot"
                                                                       value="#{ceCaseBB.currentCase.propertyInfoCase ? 'Property info case':'Normal Code Enf Case'}"  />

                                                    <p:spacer height="3px" />

                                                    <div class="restrict-main-contents-io-link link-button">

                                                        <p:commandLink      id="cecase-recordstatus-edit-init-clink"
                                                                            ajax="true"
                                                                            actionListener="#{ceCaseBB.onToggleEditCECaseRecordStatus}"
                                                                            value="#{ceCaseBB.editModeCurrentCaseRecord ? 'save changes':'designate a property info case'}"
                                                                            update="@form
                                                                            cecase-growl-form"
                                                                            />


                                                        <p:commandLink      id="cecase-recordstatus-edit-abort-clink"
                                                                            ajax="true"
                                                                            actionListener="#{ceCaseBB.onEditRecordAbort(ev)}"
                                                                            value="cancel"
                                                                            rendered="#{ceCaseBB.editModeCurrentCaseRecord}"
                                                                            update="@form
                                                                            cecase-growl-form"
                                                                            />

                                                    </div>

                                                    <p:spacer height="5px" />
                                                    <h:outputText value="Is this case a property info container?" 
                                                                  rendered="#{ceCaseBB.editModeCurrentCaseRecord}"/>
                                                    <p:selectBooleanCheckbox  id="cecase-propinfo-sb"
                                                                              value="#{ceCaseBB.currentCase.propertyInfoCase}"
                                                                              styleClass="data_field_value"
                                                                              rendered="#{ceCaseBB.editModeCurrentCaseRecord}"
                                                                              disabled="#{ceCaseBB.currentCase.violationList.size() ne 0}">
                                                    </p:selectBooleanCheckbox>
                                                </h:form>
                                            </div>
                                        </div>

                                        <h:form id="case-refresh-trigger-form">
                                            <h:outputText value="#{ceCaseBB.reloadCECaseTrigger}" />
                                        </h:form>



                                    </p:panel>

                                    <ui:include src="compositions/noticesOfViolation.xhtml" />


                                    <p:panel    id="cecase-persons-panel"
                                                toggleable="true"
                                                widgetVar="cecase-persons-panel-var"
                                                collapsed="false"
                                                header="Case-Linked Persons"
                                                rendered="true">
                                        <h:form id="cecase-persons-panel-form">

                                            <p:commandButton   id="cecase-persons-manage-button"
                                                               ajax="true"
                                                               actionListener="#{personBB.onSelectAndLinkPersonsInit(ceCaseBB.currentCase)}"
                                                               oncomplete="PF('human-search-dialog-var').show()"
                                                               rendered="#{systemServicesBB.bbSessionUser.keyCard.hasMuniStaffPermissions}"
                                                               value="Manage CE Case to person links"
                                                               update=" human-search-dialog
                                                               persontools-growl-form
                                                               search-query-form
                                                               pers-selected-form
                                                               hlh-humlist-form"
                                                               icon="fa fa-user-plus"
                                                               >
                                                <f:param name="person-list-component-to-update"
                                                         value="cecase-persons-panel-form" />

                                            </p:commandButton>

                                            <p:spacer height="5px" />

                                            <p:dataTable id="prop-persons-table"
                                                         var="csehl"
                                                         value="#{ceCaseBB.managedCECaseHumanLinkList}"
                                                         tableStyleClass="primeDataTable"
                                                         rowKey="#{csehl.humanID}"
                                                         >


                                                <p:column headerText="Name"
                                                          width="35%"
                                                          styleClass="centeredColumnContent">
                                                    <h:outputText value="#{csehl.name}" />

                                                </p:column>

                                                <p:column headerText="Role"
                                                          width="35%"
                                                          styleClass="centeredColumnContent">
                                                    <h:outputText value="#{csehl.linkedObjectRole.title}"/>
                                                    <p:spacer height="3px" />
                                                    <h:outputText value="#{csehl.linkedObjectRole.schema.TARGET_OBJECT_FRIENDLY_NAME}" />
                                                    <h:outputText value="(ID:#{csehl.parentObjectID})" />

                                                </p:column>

                                                <p:column headerText="Actions"
                                                          width="30%"
                                                          styleClass="centeredColumnContent">
                                                    <p:commandLink      id="prop-person-exploreperson-cl"
                                                                        ajax="true"
                                                                        style="color:blue;"
                                                                        action="#{personBB.onHumanViewLinkClick(csehl)}"
                                                                        value="View Person"
                                                                        oncomplete="PF('person-profile-dialog-var').show();"
                                                                        />
                                                    <h:outputText value=" (HumID: #{csehl.humanID})" />
                                                    <p:spacer height="3px" />
                                                    <p:commandLink      id="prop-personlink-vieweditlink-cl"
                                                                        ajax="true"
                                                                        style="color:blue;"
                                                                        action="#{personBB.onHumanLinkEditInitButtonChange(csehl, ceCaseBB.currentCase)}"
                                                                        value="View/Edit link"
                                                                        oncomplete="PF('humanlink-viewedit-dialog-var').show();"
                                                                        update="humanlink-viewedit-dialog
                                                                        humanlink-viewedit-form"
                                                                        >
                                                        <f:param name="person-list-component-to-update"
                                                                 value="cecase-persons-panel-form" />
                                                    </p:commandLink>
                                                    <h:outputText value=" (LnkID: #{csehl.linkID})" />

                                                </p:column>
                                            </p:dataTable>
                                        </h:form>
                                    </p:panel>

                                    <ui:include src="compositions/citations.xhtml" />
                                </div>

                                <div class="ui-g-12 ui-md-6 ui-lg-6 restrict-data-field">

                                    <p:panel id="cecase-actions-panel"
                                             toggleable="true"
                                             collapsed="false"
                                             header="Case tools "
                                             rendered="true"
                                             >

                                        <h:form id="cecase-tools-form">

                                            <p:commandButton   id="print-case-cb"
                                                               ajax="true" 
                                                               actionListener="#{ceCaseBB.prepareReportCECase}"
                                                               icon="fa fa-print"
                                                               oncomplete="PF('report-case-profile-diaglog-var').show()"
                                                               value="Print case profile "
                                                               update="report-case-profile-form"/>
                                        </h:form>

                                    </p:panel>

                                    <p:panel id="cecase-events-future-panel"
                                             toggleable="true"
                                             collapsed="false"
                                             header="Upcoming Events"
                                             rendered="true"
                                             >

                                        <h:form id="cecase-events-future-form">


                                            <p:dataTable id="cecase-events-future-table"
                                                         var="eventfuture"
                                                         value="#{ceCaseBB.currentCase.futureEventList}"
                                                         tableStyleClass="primeDataTable"
                                                         rowKey="#{eventfuture.eventID}"
                                                         >

                                                <p:column headerText="ID"
                                                          width="10%"
                                                          styleClass="centeredColumnContent">

                                                    <h:outputText value="#{eventfuture.eventID}"/>

                                                </p:column>
                                                <p:column headerText="Date"
                                                          sortBy="#{eventfuture.timeStart}"
                                                          styleClass="centeredColumnContent">
                                                    <h:outputText value="#{empty eventfuture.timeStart ? ceCaseBB.getPrettyDate(eventfuture.creationts) : ceCaseBB.getPrettyDate(eventfuture.timeStart) }" />


                                                </p:column>

                                                <p:column headerText="Category"
                                                          sortBy="#{eventfuture.category.eventCategoryTitle}"
                                                          styleClass="centeredColumnContent">
                                                    <div class="#{eventfuture.category.icon.styleClass}">
                                                        <i class="material-icons status-display-icon-i">
                                                            <h:outputText value="#{eventfuture.category.icon.materialIcon}" />
                                                        </i>
                                                    </div>
                                                    <h:outputText value="#{eventfuture.category.eventType.label}:" />
                                                    <p:spacer height="1px" />
                                                    <h:outputText value="#{eventfuture.category.eventCategoryTitle}" />


                                                </p:column>

                                                <p:column headerText="Description"
                                                          styleClass="centeredColumnContent wrapText">

                                                    <h:outputText value="#{eventfuture.description}"/>

                                                </p:column>

                                                <p:column headerText="Actions"
                                                          styleClass="centeredColumnContent">




                                                    <div class="restrict-main-contents-io-link link-button">
                                                        <p:commandLink      id="event-open0-button"
                                                                            ajax="true"
                                                                            styleClass="noFill button-size-small"
                                                                            action="#{ceCaseBB.onEventViewButtonChange(eventfuture)}"
                                                                            value="View"
                                                                            rendered="false"
                                                                            oncomplete="PF('event-profile-dialog-var').show()"
                                                                            update="event-profile-dialog
                                                                            event-profile-form"
                                                                            />

                                                    </div>

                                                    <h:outputText value="&nbsp;&nbsp;|" />

                                                    <div class="restrict-main-contents-io-link link-button">

                                                        <p:commandLink      id="event-update0-button"
                                                                            ajax="true"
                                                                            styleClass="noFill button-size-small link-button"
                                                                            action="#{ceCaseBB.onEventViewButtonChange(eventfuture)}"
                                                                            value="Update"
                                                                            rendered="false"
                                                                            oncomplete="PF('event-profile-dialog-var').show()"
                                                                            update="event-profile-dialog
                                                                            event-profile-form"
                                                                            />
                                                    </div>
                                                    <p:spacer height="3px" />

                                                    <div class="restrict-main-contents-io-link link-button">
                                                        <p:commandLink      id="event-dismiss0-button"
                                                                            ajax="true"
                                                                            rendered="false"
                                                                            styleClass="noFill button-size-small"
                                                                            action="#{ceCaseBB.onEventViewButtonChange(eventfuture)}"
                                                                            value="Dismiss and deactivate"
                                                                            oncomplete="PF('event-deactivate-dialog-var').show()"
                                                                            update="event-profile-dialog
                                                                            event-profile-form"
                                                                            />
                                                    </div>

                                                </p:column>
                                            </p:dataTable>
                                        </h:form>
                                    </p:panel>

                                    <ui:include src="compositions/codeViolations.xhtml" />

                                    <ui:include src="/restricted/compositions/inspectionTools.xhtml"/>



                                    <p:panel id="inspections-panel"
                                             toggleable="true"
                                             widgetVar="inspections-panel-var"
                                             collapsed="false"
                                             header="Field Inspections">
                                        <h:form id="cecase-inspections-form">


                                            <p:commandButton id="inspections-newbutton"
                                                             value="New inspection"
                                                             disabled="#{!empty ceCaseBB.currentCase.closingDate}"
                                                             rendered="#{systemServicesBB.bbSessionUser.keyCard.hasMuniStaffPermissions}"
                                                             icon="fa fa-plus"
                                                             oncomplete="PF('inspections-selectchecklist-var').show()"
                                                             actionListener="#{fieldInspectionBB.onCreateInspectionInitButtonChange(ceCaseBB.currentCase)}"
                                                             update="inspections-selectchecklist-form">
                                                <f:param name="initiating-inspection-list-component-id" value="cecase-inspections-form" />
                                            </p:commandButton>

                                            <p:spacer height="5px"/>

                                            <p:dataTable    id="cecase-inspections-table"
                                                            var="inspection"
                                                            value="#{ceCaseBB.managedCECaseFieldInspectionList}"
                                                            rowKey="#{inspection.inspectionID}"
                                                            reflow="true"
                                                            lazy="false">

                                                <p:column headerText="Date"
                                                          style="width:20%;">
                                                    <h:outputText value="#{ceCaseBB.getPrettyDate(inspection.effectiveDateOfRecord)}" />
                                                </p:column>
                                                <p:column headerText="Inspector"
                                                          style="width:25%;">
                                                    <h:outputText value="#{inspection.inspector.human.name}" />
                                                </p:column>
                                                <p:column headerText="Determination"
                                                          style="width:30%;">
                                                    <h:outputText value="#{empty inspection.determination ? '(in process)':inspection.determination.title}" />
                                                </p:column>
                                                <p:column headerText="Actions"
                                                          style="width:25%;">
                                                    <p:commandLink  id="inspection-details-cl"
                                                                    value="view/edit"
                                                                    actionListener="#{fieldInspectionBB.onViewEditInspectionLinkClick(ceCaseBB.currentCase, inspection)}"
                                                                    ajax="true"
                                                                    style="color:blue;"
                                                                    oncomplete="PF('inspection-profile-dialog-var').show()"
                                                                    rendered="#{systemServicesBB.bbSessionUser.keyCard.hasMuniStaffPermissions}"
                                                                    update="inspectiontools-growl-form
                                                                    inspection-profile-dialog
                                                                    inspection-profile-form
                                                                    inspection-advancedtools-form
                                                                    inspection-actions-form
                                                                    inspection-inspectedspaces-form"
                                                                    >
                                                        <f:param name="initiating-inspection-list-component-id" value="cecase-inspections-form" />
                                                    </p:commandLink>
                                                    <p:spacer height="3px" />
                                                    <h:outputText value="(ID:#{inspection.inspectionID})" />
                                                </p:column>
                                            </p:dataTable>
                                        </h:form>
                                    </p:panel>

                                    <ui:include src="../compositions/eventsPanel.xhtml"/>

                                    <p:panel id="cecase-cears-panel"
                                             toggleable="true"
                                             collapsed="false"
                                             header="Action Requests (#{ceCaseBB.currentCase.ceActionRequestList.size()})"
                                             rendered="true"
                                             >

                                        <h:form id="cecase-cears-form">
                                            <p:dataTable id="requestTable"
                                                         var="r"
                                                         rowKey="#{r.requestID}"
                                                         value="#{ceCaseBB.currentCase.ceActionRequestList}"
                                                         tableStyleClass="primeDataTable"
                                                         >

                                                <p:column headerText="Date"
                                                          styleClass="centeredColumnContent">

                                                    <h:outputText value="#{ceCaseBB.getPrettyDateNoTime(r.dateOfRecord)}"/>

                                                </p:column>
                                                <p:column headerText="Issue Type"
                                                          styleClass="centeredColumnContent">

                                                    <h:outputText value="#{r.issue.name}"/>

                                                </p:column>

                                                <p:column headerText="Status"
                                                          styleClass="centeredColumnContent">

                                                    <h:outputText value="#{r.requestStatus.statusTitle}"/>

                                                </p:column>
                                                <p:column width="10%">
                                                    <f:facet name="header">
                                                        <h:outputText value="View" />
                                                    </f:facet>

                                                </p:column>
                                            </p:dataTable>
                                        </h:form>
                                    </p:panel>
                                    <ui:include src="/restricted/compositions/blobTools.xhtml" />

                                    <p:panel id="cecase-blobs-panel"
                                             toggleable="true"
                                             collapsed="false"
                                             header="Files and Photos"
                                             rendered="true"
                                             >

                                        <h:form id="cecase-blobs-form">

                                            <p:commandButton    id="cecase-blob-add-button"
                                                                ajax="true"
                                                                styleClass="noFill button-size-small"
                                                                actionListener="#{blobUtilitiesBB.onUploadBlobInitButtonChange(ceCaseBB.currentCase)}"
                                                                oncomplete="PF('blob-upload-dialog-var').show()"
                                                                update="blob-upload-dialog
                                                                blob-uploadconnect-tabview"
                                                                value="Upload photo or document"
                                                                icon="fa fa-upload"
                                                                >
                                                <f:param name="blob-list-component-to-update" value="cecase-blobs-form" />
                                            </p:commandButton>

                                            <p:spacer height="5px" />

                                            <p:dataTable
                                                id="cecase-blobs-table"
                                                var="blob"
                                                value="#{ceCaseBB.managedBlobLightListFromCECase}"
                                                rowKey="#{blob.photoDocID}"
                                                tableStyleClass="primeDataTable"
                                                resizableColumns="true"
                                                draggableRows="false" tabindex="6">

                                                <p:column width="15%">
                                                    <f:facet name="header">
                                                        <h:outputText value="File Type"/>
                                                    </f:facet>
                                                    <h:outputText value="#{blob.type.title}"/>
                                                    <!-- type icon here -->
                                                </p:column>

                                                <p:column width="15%">
                                                    <f:facet name="header">
                                                        <h:outputText value="IDs"/>
                                                    </f:facet>
                                                    <h:outputText value="linkID: #{blob.photoDocID}"/>
                                                    <br/>
                                                    <h:outputText value="bytesID: #{blob.bytesID}"/>

                                                </p:column>

                                                <p:column width="45%">
                                                    <f:facet name="header">
                                                        <h:outputText value="Info"/>
                                                    </f:facet>
                                                    <div class="rowExpansion">
                                                        <h:outputText value="title: #{blob.title}"/>
                                                        <br/>
                                                        <h:outputText value="descr: #{blob.description}"/>
                                                        <br/>
                                                        <h:outputText value="filename: #{blob.filename}"/>
                                                        <br/>
                                                        <h:outputText value="created: #{ceCaseBB.getPrettyDateNoTime(blob.createdTS)}"/>
                                                    </div>
                                                </p:column>


                                                <p:column>
                                                    <f:facet name="header">
                                                        <h:outputText value="Actions"/>
                                                    </f:facet>
                                                    <p:commandButton 
                                                        value="Download" 
                                                        ajax="false"
                                                        icon="fa fa-arrow-down" 
                                                        styleClass="ui-button-outlined">
                                                        <p:fileDownload value="#{blobRetrieveBB.retrieveBlob(blob)}"
                                                                        />
                                                    </p:commandButton>
                                                    <br/>
                                                    <div class="restrict-main-contents-io-link link-button">

                                                        <p:commandLink      id="blob-update-button"
                                                                            ajax="true"
                                                                            styleClass="noFill button-size-small"
                                                                            action="#{blobUtilitiesBB.onViewBlobLinkClick(blob, ceCaseBB.currentCase)}"
                                                                            value="view"
                                                                            oncomplete="PF('blobs-viewblob-dialog-var').show()"
                                                                            update="blobs-viewblob-dialog
                                                                            blob-viewblob-form"
                                                                            />
                                                        <p:spacer height="3px" />
                                                        <p:commandLink      id="blob-edit-button"
                                                                            ajax="true"
                                                                            styleClass="noFill button-size-small"
                                                                            action="#{blobUtilitiesBB.onBlobEditMetaDataInitLinkClick(blob, ceCaseBB.currentCase)}"
                                                                            value="edit"
                                                                            oncomplete="PF('blobs-vieweditmetadata-dialog-var').show()"
                                                                            update="blob-vieweditmetadata-dialog
                                                                            blob-veweditmetadata-form"
                                                                            >
                                                            <f:param name="blob-list-component-to-update" value="cecase-blobs-form" />
                                                        </p:commandLink>
                                                        <p:spacer height="3px" />
                                                        <p:commandLink      id="blob-remove-button"
                                                                            ajax="true"
                                                                            styleClass="noFill button-size-small"
                                                                            action="#{blobUtilitiesBB.onDeactivateBlobInitLinkClick(blob, ceCaseBB.currentCase)}"
                                                                            oncomplete="PF('blobs-deactivate-dialog-var').show();"
                                                                            value="remove"
                                                                            update="blob-deactivate-dialog
                                                                            blob-deactivate-form"
                                                                            >
                                                            <f:param name="blob-list-component-to-update" value="cecase-blobs-form" />
                                                        </p:commandLink>
                                                    </div>
                                                </p:column>
                                            </p:dataTable>
                                        </h:form>
                                    </p:panel>

                                    <ui:include src="../compositions/feesPanel.xhtml"/>
                                    <ui:include src="../compositions/paymentsPanel.xhtml"/>

                                    <p:panel id="caseprofile-todos-panel"
                                             toggleable="true"
                                             widgetVar="caseprofile-panel-todos-var"
                                             collapsed="false"
                                             rendered="false"
                                             header="TODOs (#{ceCaseBB.currentCase.proposalList.size()})">



                                        <h:form id="cecase-todos-form">


                                            <p:commandButton    id="caseprofile-todos-settings-button"
                                                                ajax="fase"
                                                                value="View Complete Workflow"
                                                                styleClass="noFill button-size-small"
                                                                action="#{ceCaseBB.onProposalsListButtonChange}"
                                                                icon="fa fa-gears"
                                                                />


                                            <h:outputLabel styleClass="ui-label" for="cecase-viewoptionsproposals-solb">
                                                <h:outputText value="proposal list view options: "/>
                                            </h:outputLabel>

                                            <p:selectOneMenu style="width: 300px;"
                                                             id="cecase-viewoptionsproposals-solb"
                                                             value="#{workflowBB.selectedProposalsViewOption}"
                                                             tabindex="10">

                                                <p:ajax update="proposals-proposalscroller"
                                                        immediate="true"/>
                                                <f:selectItems  id="cecase-viewoptionsproposals-selitems"
                                                                value="#{workflowBB.proposalsViewOptions}"
                                                                var="pvo"
                                                                itemValue="#{pvo}"
                                                                itemLabel="#{pvo.label}"/>
                                            </p:selectOneMenu>

                                            <h:message for="cecase-viewoptionsproposals-solb" showDetail="false" showSummary="true"
                                                       warnClass="msgWarn" infoClass="msgInfo" fatalClass="msgFatal" errorClass="msgError" />


                                            <p:dataScroller id="proposals-proposalscroller"
                                                            var="proposal"
                                                            widgetVar="proposals-proposalscroller-var"
                                                            value="#{ceCaseBB.currentCase.assembleProposalList(workflowBB.selectedProposalsViewOption)}"
                                                            rowIndexVar="#{proposal.proposalID}">
                                                <div class="outlinedBox">
                                                    <div class="proposal-metadata-container">
                                                        <div class="proposal-propbuttoncontainer">
                                                            <p:commandButton    id="proposal-button-showdescription"
                                                                                styleClass="noFill button-size-small button-moreinfo"
                                                                                icon="fa fa-info"/>

                                                            <p:overlayPanel id="proposal-overlaypanel-proposaldescription"
                                                                            for="proposal-button-showdescription"
                                                                            dynamic="true"
                                                                            showCloseIcon="true"
                                                                            style="width:300px"
                                                                            modal="false">

                                                                <h:outputText       styleClass="proposal-description"
                                                                                    value="#{proposal.directive.description}" />
                                                            </p:overlayPanel>


                                                            <p:commandButton    id="proposal-button-rejectionreason"
                                                                                styleClass="noFill button-size-small"
                                                                                oncomplete="PF('cecase-rejectproposal-dialog-var').show()"
                                                                                rendered="#{!proposal.directive.requiredEvaluationForBOBClose
                                                                                            or systemServicesBB.bbSessionUser.keyCard.hasSysAdminPermissions }"
                                                                                icon="fa fa-hand-stop-o"/>
                                                        </div>
                                                        <div class="proposal-prophead">
                                                            <h:outputText value="#{proposal.directive.title}" />
                                                        </div>
                                                        <p:spacer height="5px" />

                                                        <h:outputText styleClass="ui-label-inline"
                                                                      value="Intended for: "  />
                                                        <h:outputText styleClass="data-text"
                                                                      value="#{proposal.responderIntended.human.firstName}" />
                                                        <h:outputText styleClass="data-text"
                                                                      value=" " />
                                                        <h:outputText styleClass="data-text"
                                                                      value="#{proposal.responderIntended.human.lastName}" />
                                                    </div>

                                                    <p:dataScroller id="proposals-choicescroller"
                                                                    var="choice"
                                                                    widgetVar="proposals-choicescroller-var"
                                                                    value="#{proposal.directive.choiceListVisible}"
                                                                    rowIndexVar="#{choice.chosenChoice.choiceID}">

                                                        <p:commandButton    id="proposal-choice-button-choose"
                                                                            ajax="true"
                                                                            styleClass="proposal-choice-button"
                                                                            actionListener="#{workflowBB.proposals_makeChoice(choice, proposal)}"
                                                                            disabled="#{!choice.chosenChoice.canChoose or !(empty proposal.responseTS)}"
                                                                            value="#{choice.chosenChoice.title}"
                                                                            icon="#{choice.chosenChoice.icon.fontAwesome}"
                                                                            title="#{choice.chosenChoice.description}"
                                                                            update="cecase-form-proposals
                                                                            cecase-growl-form"/>
                                                        <p:spacer height="5px" />
                                                    </p:dataScroller>
                                                </div>
                                            </p:dataScroller>

                                        </h:form>
                                    </p:panel>

                                    <ui:include src="../compositions/notesPanel.xhtml"/>


                                    <!--Update Table-->
                                    <p:panel id="cecase-public-panel"
                                             toggleable="true"
                                             collapsed="false"
                                             header="Public Access Settings"
                                             rendered="true"
                                             >
                                        <h:form id="cecase-public-form">


                                            <div    id="cecase-public-container-div"
                                                    class="ui-g data-container">

                                                <div    id="cecase-pacc-div"
                                                        class="ui-g-12 ui-md-12 ui-lg-12 data_field">

                                                    <p:outputLabel for="cecase-pacc-it"
                                                                   styleClass="data_field_label">
                                                        <h:outputText value="Public access control code"/>
                                                    </p:outputLabel>

                                                    <h:inputText    id="cecase-pacc-it"
                                                                    styleClass="data_field_value"
                                                                    value="#{ceCaseBB.currentCase.publicControlCode}"/>


                                                    <p:outputLabel for="cecase-pacc-access-sb"
                                                                   styleClass="data_field_label">
                                                        <h:outputText value="Allow access using ref num?"  />
                                                    </p:outputLabel>
                                                    <p:selectBooleanButton id="cecase-pacc-access-sb"
                                                                           onLabel="Yes"
                                                                           onIcon="fa fa-thumbs-o-up"
                                                                           offLabel="No"
                                                                           offIcon="fa fa-hand-stop-o"
                                                                           value="#{ceCaseBB.currentCase.paccEnabled}"
                                                                           styleClass="data_field_value"
                                                                           disabled="#{!systemServicesBB.bbSessionUser.keyCard.hasMuniStaffPermissions}">
                                                    </p:selectBooleanButton>


                                                    <p:outputLabel for="cecase-pacc-forwardlink-sb"
                                                                   styleClass="data_field_label">
                                                        <h:outputText value="Allow action request linking?"  />
                                                    </p:outputLabel>

                                                    <p:selectBooleanButton  id="cecase-pacc-forwardlink-sb"
                                                                            onLabel="Yes"
                                                                            onIcon="fa fa-thumbs-o-up"
                                                                            offLabel="No"
                                                                            offIcon="fa fa-hand-stop-o"
                                                                            value="#{ceCaseBB.currentCase.allowForwardLinkedPublicAccess}"
                                                                            styleClass="data_field_value"
                                                                            disabled="#{!sessionBeasessionUserer.keyCard.hasMuniStaffPermissions}">
                                                    </p:selectBooleanButton>
                                                </div>

                                            </div>


                                            <p:commandButton    id="cecase-public-commit-button"
                                                                ajax="false"
                                                                value="Update Public Access Settings"
                                                                action="#{ceCaseBB.onCaseUpdateButtonChange}"
                                                                icon="fa fa-users"/>
                                        </h:form>
                                    </p:panel>

                                </div>
                            </div>
                        </div>
                    </p:outputPanel>





                    <p:dialog   id="cecase-remove-dialog"
                                height="300" width="750"
                                widgetVar="cecase-remove-dialog-var"
                                closable="true"
                                resizable="true"
                                closeOnEscape="true"
                                modal="true"
                                header="Deactivate Code Enforcement Case"
                                >

                        <h:form id="cecase-remove-form">

                            <p>Only cases with zero violations can be deactivated.</p>
                            <!--Remove Button-->
                            <p:commandButton
                                icon="fa fa-trash"
                                ajax="true"
                                actionListener="#{ceCaseBB.onCaseRemoveCommitButtonChange}"
                                value="Deactivate Code Enforcement Case ID:#{ceCaseBB.currentCase.caseID}"
                                update="cecase-profile-record-form
                                cecase-growl-form"
                                />

                        </h:form>

                    </p:dialog>




                    <p:dialog   id="cecase-rejectproposal-dialog"
                                height="650" width="900"
                                widgetVar="cecase-rejectproposal-dialog-var"
                                closable="true"
                                resizable="true"
                                closeOnEscape="true"
                                modal="true"
                                rendered="#{systemServicesBB.bbSessionUser.keyCard.hasEnfOfficialPermissions}"
                                >

                        <h:form id="cecase-rejectproposal-form">


                            <h:outputText styleClass="ui-label" value="reason for rejecting proposal" />

                            <p:inputText    id="proposal-rejectreason-it"
                                            value="#{workflowBB.formProposalRejectionReason}"
                                            required="true"/>

                            <p:commandButton    id="proposal-button-reject"
                                                ajax="true"
                                                styleClass="noFill button-size-small"
                                                actionListener="#{workflowBB.rejectProposal(proposal)}"
                                                rendered="#{systemServicesBB.bbSessionUser.keyCard.hasEnfOfficialPermissions}"
                                                oncomplete="PF('cecase-rejectproposal-dialog-var').hide()"
                                                icon="fa fa-hand-stop-o"
                                                update="cecase-todos-form
                                                cecase-growl-form"/>
                        </h:form>
                    </p:dialog>




                    <p:dialog   id="cecase-report-dialog"
                                widgetVar="report-case-profile-diaglog-var"
                                height="600"
                                width="1000"
                                closable="true"
                                modal="true"
                                resizable="true"
                                dynamic="true"
                                closeOnEscape="true"
                                responsive="true"
                                header="Configure case profile report (Case ID:#{ceCaseBB.currentCase.caseID}"
                                >

                        <h:form id="report-case-profile-form">

                            <div class="restrict-main-contents-io-link"
                                 style="font-size: 2em;">

                                <p:commandLink  ajax="false" 
                                                action="#{ceCaseBB.generateReportCECase}"
                                                value="Click to generate case profile report in new tab" 
                                                target="_blank"
                                                rendered="#{systemServicesBB.bbSessionUser.keyCard.hasMuniReaderPermissions}"
                                                />
                            </div>

                            <p:spacer height="3px" />
                            <p style="font-style: italic; font-size: 0.8em;">
                                If you want to tweak your settings after generating a report, you'll need 
                                to close this dialog and re-open it with a click of the button for printing a case profile report.
                            </p>
                            <p:spacer height="3px" />

                            <div class="p-grid nested-grid">

                                <div class="p-col-6">
                                    <div class="p-grid">
                                        <div class="p-col-12">
                                            <h2>General code enforcement case options</h2>
                                        </div>

                                        <div class="p-col-8 restrict-data-field-label-inline">
                                            <h:outputLabel value="Include case name" 
                                                           for="report-case-profile-casename-chkbox" />
                                        </div>
                                        <div class="p-col-4 restrict-main-contents-io-content">                    
                                            <p:selectBooleanCheckbox id="report-case-profile-casename-chkbox" 
                                                                     value="#{ceCaseBB.reportCECase.includeCaseName}" />
                                        </div>

                                        <div class="p-col-12">
                                            <h2>Notices of violation</h2>
                                        </div>


                                        <div class="p-col-8 restrict-data-field-label-inline">
                                            <h:outputLabel value="Include returned and unmailed NOVs" 
                                                           for="report-case-profile-allnotices-chkbox" />
                                        </div>
                                        <div class="p-col-4 restrict-main-contents-io-content">                    
                                            <p:selectBooleanCheckbox id="report-case-profile-allnotices-chkbox" 
                                                                     value="#{ceCaseBB.reportCECase.includeAllNotices}" />
                                        </div>

                                        <div class="p-col-8 restrict-data-field-label-inline">
                                            <h:outputLabel value="Include full letter text of notices of violation: " 
                                                           for="report-case-profile-noticetext-chkbox" />
                                        </div>
                                        <div class="p-col-4 restrict-main-contents-io-content">                    
                                            <p:selectBooleanCheckbox id="report-case-profile-noticetext-chkbox" 
                                                                     value="#{ceCaseBB.reportCECase.includeNoticeFullText}" />
                                        </div>


                                        <div class="p-col-12">
                                            <h2>Code violations</h2>
                                        </div>


                                        <div class="p-col-8 restrict-data-field-label-inline">
                                            <h:outputLabel value="Include full ordinance text in violations" 
                                                           for="report-case-profile-ordtext-chkbox" />
                                        </div>
                                        <div class="p-col-4 restrict-main-contents-io-content">                    
                                            <p:selectBooleanCheckbox id="report-case-profile-ordtext-chkbox" 
                                                                     value="#{ceCaseBB.reportCECase.includeFullOrdinanceText}" />
                                        </div>

                                        <div class="p-col-8 restrict-data-field-label-inline">
                                            <h:outputLabel value="Include violation photos" 
                                                           for="report-case-profile-violatios-photos-chkbox" />
                                        </div>
                                        <div class="p-col-4 restrict-main-contents-io-content">                    
                                            <p:selectBooleanCheckbox id="report-case-profile-violatios-photos-chkbox" 
                                                                     value="#{ceCaseBB.reportCECase.includeViolationPhotos}" />
                                        </div>

                                        <div class="p-col-8 restrict-data-field-label-inline">
                                            <h:outputLabel value="Include violation notes" 
                                                           for="report-case-profile-violation-notes-chkbox" />
                                        </div>
                                        <div class="p-col-4 restrict-main-contents-io-content">                    
                                            <p:selectBooleanCheckbox id="report-case-profile-violation-notes-chkbox" 
                                                                     value="#{ceCaseBB.reportCECase.includeViolationNotes}" />
                                        </div>

                                        <div class="p-col-8 restrict-data-field-label-inline">
                                            <h:outputLabel value="Photo column count (min: 1, max:4)" 
                                                           for="report-case-profile-photos-violation-cols" />
                                        </div>
                                        <div class="p-col-4 restrict-main-contents-io-content">                    
                                            <p:inputNumber id="report-case-profile-photos-violation-cols" 
                                                           minValue="1"
                                                           maxValue="4"
                                                           validatorMessage="Column count must be between 1 and 4"
                                                           value="#{ceCaseBB.reportCECase.violationPhotoColumnCount}" />
                                        </div>


                                        <div class="p-col-12">
                                            <h2>Field inspection reports</h2>
                                        </div>


                                        <div class="p-col-8 restrict-data-field-label-inline">
                                            <h:outputLabel value="Include full field inspection reports" 
                                                           for="report-case-profile-firs-chkbox" />
                                        </div>
                                        <div class="p-col-4 restrict-main-contents-io-content">                    
                                            <p:selectBooleanCheckbox id="report-case-profile-firs-chkbox" 
                                                                     value="#{ceCaseBB.reportCECase.includeFieldInspectionReports}" />
                                        </div>

                                        <div class="p-col-8 restrict-data-field-label-inline">
                                            <h:outputLabel value="Include photos on field inspection reports" 
                                                           for="report-case-profile-firs-photos-chkbox" />
                                        </div>
                                        <div class="p-col-4 restrict-main-contents-io-content">                    
                                            <p:selectBooleanCheckbox id="report-case-profile-firs-photos-chkbox" 
                                                                     value="#{ceCaseBB.reportCECase.includeFieldInspectionReportsWithPhotos}" />
                                        </div>


                                        <div class="p-col-12">
                                            <h2>File uploads</h2>
                                        </div>


                                        <div class="p-col-8 restrict-data-field-label-inline">
                                            <h:outputLabel value="Include links to download attachments from report tab directly" 
                                                           for="report-case-profile-broadview-chkbox" />
                                        </div>
                                        <div class="p-col-4 restrict-main-contents-io-content">                    
                                            <p:selectBooleanCheckbox id="report-case-profile-broadview-chkbox" 
                                                                     value="#{ceCaseBB.reportCECase.includePropertyBroadviewPhoto}" />
                                        </div>


                                        <div class="p-col-8 restrict-data-field-label-inline">
                                            <h:outputLabel value="Include links to download attachments from report tab directly" 
                                                           for="report-case-profile-downloadlinks-chkbox" />
                                        </div>
                                        <div class="p-col-4 restrict-main-contents-io-content">                    
                                            <p:selectBooleanCheckbox id="report-case-profile-downloadlinks-chkbox" 
                                                                     value="#{ceCaseBB.reportCECase.includeDocDownloadLinks}" />
                                        </div>



                                        <div class="p-col-8 restrict-data-field-label-inline">
                                            <h:outputLabel value="Include links to download attachments from report tab directly" 
                                                           for="report-case-profile-caseblobpool-chkbox" />
                                        </div>
                                        <div class="p-col-4 restrict-main-contents-io-content">                    
                                            <p:selectBooleanCheckbox id="report-case-profile-caseblobpool-chkbox" 
                                                                     value="#{ceCaseBB.reportCECase.includeCECasePhotoPool}" />
                                        </div>


                                        <div class="p-col-12">
                                            <h2>Action requests</h2>
                                        </div>
                                        <div class="p-col-8 restrict-data-field-label-inline">
                                            <h:outputLabel value="Include linked action requests" 
                                                           for="report-case-profile-cears-chkbox" />
                                        </div>
                                        <div class="p-col-4 restrict-main-contents-io-content">                    
                                            <p:selectBooleanCheckbox id="report-case-profile-cears-chkbox" 
                                                                     value="#{ceCaseBB.reportCECase.includeActionRequsts}" />
                                        </div>
                                        <div class="p-col-8 restrict-data-field-label-inline">
                                            <h:outputLabel value="Include action request photos" 
                                                           for="report-case-profile-cears-photos-chkbox" />
                                        </div>
                                        <div class="p-col-4 restrict-main-contents-io-content">                    
                                            <p:selectBooleanCheckbox id="report-case-cears-photos-chkbox" 
                                                                     value="#{ceCaseBB.reportCECase.includeActionRequestPhotos}" />
                                        </div>


                                        <div class="p-col-8 restrict-data-field-label-inline">
                                            <h:outputLabel value="Action request photo column count (min: 1, max:4)" 
                                                           for="report-case-cear-photos-cols" />
                                        </div>
                                        <div class="p-col-4 restrict-main-contents-io-content">                    
                                            <p:inputNumber id="report-case-cear-photos-cols" 
                                                           minValue="1"
                                                           maxValue="4"
                                                           validatorMessage="Column count must be between 1 and 4"
                                                           value="#{ceCaseBB.reportCECase.cearColumnCount}" />
                                        </div>
                                        <div class="p-col-12">
                                            <h2>Fees and payments</h2>
                                        </div>
                                        <div class="p-col-8 restrict-data-field-label-inline">
                                            <h:outputLabel value="Include fee and payment records" 
                                                           for="report-case-profile-feepmt-chkbox" />
                                        </div>
                                        <div class="p-col-4 restrict-main-contents-io-content">                    
                                            <p:selectBooleanCheckbox id="report-case-profile-feepmt-chkbox" 
                                                                     value="#{ceCaseBB.reportCECase.includeFeeAndPaymentInfo}" />
                                        </div>

                                        <div class="p-col-4 restrict-data-field-label-inline">

                                            <div class="p-col-12">
                                                <h2>Report notes</h2>
                                            </div>
                                            <h:outputLabel for="report-case-profile-notes-ita" 
                                                           value="Report notes"/>
                                        </div>
                                        <div class="p-col-8 restrict-main-contents-io-content">                    
                                            <p:inputTextarea id="report-case-profile-notes-ita" 
                                                             cols="30"
                                                             rows="5"
                                                             value="#{ceCaseBB.reportCECase.notes}"/>
                                            <p:spacer height="3px" />
                                            <p style="font-style: italic; font-size: 0.8em;">
                                                This text will appear in the report header.
                                            </p>
                                        </div>
                                    </div>
                                </div>
                                <div class="p-col-6">
                                    <div class="p-grid">
                                        <div class="p-col-12">
                                            <h2>Photo options</h2>
                                        </div>

                                        <div class="p-col-8 restrict-data-field-label-inline">
                                            <h:outputLabel value="Include photo filenames" 
                                                           for="report-case-profile-photos-filenames" />
                                        </div>
                                        <div class="p-col-4 restrict-main-contents-io-content">                    
                                            <p:selectBooleanCheckbox id="report-case-profile-photos-filenames" 
                                                                     value="#{ceCaseBB.reportCECase.includePhotoFilenames}" />
                                        </div>
                                        <div class="p-col-8 restrict-data-field-label-inline">
                                            <h:outputLabel value="Include cecase photo pool" 
                                                           for="report-case-profile-photos-case" />
                                        </div>
                                        <div class="p-col-4 restrict-main-contents-io-content">                    
                                            <p:selectBooleanCheckbox id="report-case-profile-photos-case" 
                                                                     value="#{ceCaseBB.reportCECase.includeCECasePhotoPool}" />
                                        </div>


                                        <div class="p-col-8 restrict-data-field-label-inline">
                                            <h:outputLabel value="Case photo column count (min: 1, max:4)" 
                                                           for="report-case-profile-photos-case-cols" />
                                        </div>
                                        <div class="p-col-4 restrict-main-contents-io-content">                    
                                            <p:inputNumber id="report-case-profile-photos-case-cols" 
                                                           minValue="1"
                                                           maxValue="4"
                                                           validatorMessage="Column count must be between 1 and 4"
                                                           value="#{ceCaseBB.reportCECase.ceCasePhotoPoolColumnCount}" />
                                        </div>

                                        <div class="p-col-12 restrict-data-field-label-inline">
                                            <h2>Person data options</h2>
                                        </div>
                                        <div class="p-col-8 restrict-data-field-label-inline">
                                            <h:outputLabel value="Include case connected persons" 
                                                           for="report-case-profile-names-checkbox" />
                                        </div>
                                        <div class="p-col-4 restrict-main-contents-io-content">                    
                                            <p:selectBooleanCheckbox id="report-case-profile-names-checkbox" 
                                                                     value="#{ceCaseBB.reportCECase.includeAssociatedPersons}" />
                                        </div>

                                        <div class="p-col-8 restrict-data-field-label-inline">
                                            <h:outputLabel value="Include persons linked to parent property but not case" 
                                                           for="report-case-profile-names-prop-checkbox" />
                                        </div>
                                        <div class="p-col-4 restrict-main-contents-io-content">                    
                                            <p:selectBooleanCheckbox id="report-case-profile-names-prop-checkbox" 
                                                                     value="#{ceCaseBB.reportCECase.includeAssociatedPersonsOnParentProperty}" />
                                        </div>


                                        <div class="p-col-8 restrict-data-field-label-inline">
                                            <h:outputLabel value="Include person contact (address(es), phones, and emails)" 
                                                           for="report-case-profile-names-contact-checkbox" />
                                        </div>
                                        <div class="p-col-4 restrict-main-contents-io-content">                    
                                            <p:selectBooleanCheckbox id="report-case-profile-names-contact-checkbox" 
                                                                     value="#{ceCaseBB.reportCECase.includePersonAddrPhoneEmail}" />
                                        </div>

                                        <div class="p-col-12 restrict-data-field-label-inline">
                                            <h2>Event history report options</h2>
                                        </div>

                                        <div class="p-col-8 restrict-data-field-label-inline">
                                            <h:outputLabel value="Include code officer only events: " 
                                                           for="report-case-profile-events-officer-chkbox" />
                                        </div>
                                        <div class="p-col-4 restrict-main-contents-io-content">                    
                                            <p:selectBooleanCheckbox id="report-case-profile-events-officer-chkbox" 
                                                                     value="#{ceCaseBB.reportCECase.includeOfficerOnlyEvents}" />
                                        </div>

                                        <div class="p-col-8 restrict-data-field-label-inline">
                                            <h:outputLabel value="Include municipality disclsoed events: " 
                                                           for="report-case-profile-events-muni-chkbox" />
                                        </div>
                                        <div class="p-col-4 restrict-main-contents-io-content">                    
                                            <p:selectBooleanCheckbox id="report-case-profile-events-muni-chkbox" 
                                                                     value="#{ceCaseBB.reportCECase.includeMunicipalityDiclosedEvents}" />
                                        </div>
                                        <div class="p-col-8 restrict-data-field-label-inline">
                                            <h:outputLabel value="Include hidden events: " 
                                                           for="report-case-profile-hidden-chkbox" />
                                        </div>
                                        <div class="p-col-4 restrict-main-contents-io-content">                    
                                            <p:selectBooleanCheckbox id="report-case-profile-hidden-chkbox" 
                                                                     value="#{ceCaseBB.reportCECase.includeHiddenEvents}" />
                                        </div>

                                        <div class="p-col-8 restrict-data-field-label-inline">
                                            <h:outputLabel value="Include inactive events: " 
                                                           for="report-case-profile-inactive-chkbox" />
                                        </div>
                                        <div class="p-col-4 restrict-main-contents-io-content">                    
                                            <p:selectBooleanCheckbox id="report-case-profile-inactive-chkbox" 
                                                                     value="#{ceCaseBB.reportCECase.includeInactiveEvents}" />
                                        </div>

                                        <div class="p-col-8 restrict-data-field-label-inline">

                                            <h:outputLabel value="Include event notes: " 
                                                           for="report-case-profile-eventnotes-chkbox" />
                                        </div>
                                        <div class="p-col-4 restrict-main-contents-io-content">                    
                                            <p:selectBooleanCheckbox id="report-case-profile-eventnotes-chkbox" 
                                                                     value="#{ceCaseBB.reportCECase.includeEventNotes}" />
                                        </div>

                                        <div class="p-col-8 restrict-data-field-label-inline">

                                            <h:outputLabel value="Include event metadata " 
                                                           for="report-case-profile-eventmeta-chkbox" />
                                        </div>
                                        <div class="p-col-4 restrict-main-contents-io-content">                    
                                            <p:selectBooleanCheckbox id="report-case-profile-eventmeta-chkbox" 
                                                                     value="#{ceCaseBB.reportCECase.includeEventMetadata}" />
                                        </div>

                                        <div class="p-col-8 restrict-data-field-label-inline">

                                            <h:outputLabel value="Include event person associations " 
                                                           for="report-case-profile-event-personlinks" />
                                        </div>
                                        <div class="p-col-4 restrict-main-contents-io-content">                    
                                            <p:selectBooleanCheckbox id="report-case-profile-event-personlinks" 
                                                                     value="#{ceCaseBB.reportCECase.includeEventPersonLinks}" />
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </h:form>
                    </p:dialog>
                </f:view>
            </ui:define>
        </ui:composition>
    </h:body>
</html>

