<ui:composition xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
                xmlns:h="http://xmlns.jcp.org/jsf/html"
                xmlns:f="http://xmlns.jcp.org/jsf/core"
                xmlns:p="http://primefaces.org/ui"
                xmlns="http://www.w3.org/1999/xhtml">

    <h:form id="violation-growl-form" >
        <p:growl id="violation-growl" />


    </h:form>

    <p:panel id="cecase-violations-panel"
             toggleable="true"
             collapsed="false"
             header="Code Violations (#{ceCaseBB.currentCase.violationList.size()})"
             rendered="true"
             >


        <h:form id="violationedit-test-form">


        </h:form>

        <h:form id="cecase-violations-form">

            <p:commandButton    id="cecase-violation-add-button"
                                ajax="true"
                                styleClass="noFill button-size-small"
                                actionListener="#{ceCaseBB.onViolationAddInit}"
                                value="Add Violations"
                                disabled="#{!empty ceCaseBB.currentCase.closingDate}"
                                oncomplete="PF('violation-selectelement-dialog-var').show()"
                                icon="fa fa-plus"
                                style="margin-right: 5px;"
                                update="violation-selectelement-dialog
                                violation-selectelement-form"
                                />

            <p:commandButton    id="cecase-violation-migrate-showpathwayoptions"
                                ajax="true"
                                styleClass="noFill button-size-small"
                                actionListener="#{migrationBB.onMigrationInitButtonChange}"
                                value="Transfer violations"
                                disabled="#{ceCaseBB.currentCase.violationList.size() eq 0}"
                                oncomplete="PF('violation-migrate-choosepath-dialog-var').show()"
                                icon="fa fa-mail-forward"
                                update="violation-migrate-choosepath-dialog
                                violation-migrate-choosepath-form"
                                />

            <p:spacer height="5px" />

            <p:dataTable
                id="cecase-violations-table"
                var="v"
                rowKey="#{v.violationID}"
                value="#{ceCaseBB.currentCase.violationList}"
                tableStyleClass="primeDataTable"
                draggableColumns="true"
                reflow="true">

                <p:column width="10%" sortBy="#{v.status.label}">
                    <f:facet name="header">
                        <h:outputText value="Status" />
                    </f:facet>
                    <i class="material-icons"><h:outputText value="#{v.icon.materialIcon}" /></i>
                    <p:spacer height="2px" />
                    <h:outputText value="#{!(empty v.status) ? v.status.label : ''}" />

                </p:column>

                <p:column width="30%"
                          styleClass="wrapText">

                    <f:facet name="header">
                        <h:outputText value="Ordinance" />
                    </f:facet>

                    <h:outputText  value="#{v.violatedEnfElement.headerString}"
                                   escape="false"/>

                </p:column>

                <p:column width="20%"
                          styleClass="wrapText">
                    <f:facet name="header">
                        <h:outputText value="Date" />
                    </f:facet>
                    <h:outputText value="#{(empty v.actualComplianceDate) and (empty v.nullifiedTS) ? 'Compliance due on ' : ''}"
                                  styleClass="compliance-date-stipulated"/>
                    <p:spacer height="3px"
                              rendered="#{empty(v.actualComplianceDate) }"/>
                    <h:outputText value="#{(empty v.actualComplianceDate) and (empty v.nullifiedTS)  ? ceCaseBB.getPrettyDate(v.stipulatedComplianceDate) : ''}"
                                  styleClass="compliance-date-stipulated"/>

                    <h:outputText value="#{!empty(v.actualComplianceDate) ? 'Compliance achieved on '  : ''}"
                                  styleClass="compliance-date"/>
                    <p:spacer height="3px"
                              rendered="#{!empty(v.actualComplianceDate) }"/>
                    <h:outputText value="#{!empty(v.actualComplianceDate) ? ceCaseBB.getPrettyDate(v.actualComplianceDate) : ''}"
                                  styleClass="compliance-date"/>

                    <h:outputText value="#{!empty(v.nullifiedTS) ? 'Nullified on '  : ''}"
                                  styleClass="compliance-date-nullified"/>
                    <p:spacer height="3px"
                              rendered="#{!empty(v.nullifiedTS) }"/>
                    <h:outputText value="#{!empty(v.nullifiedTS) ? ceCaseBB.getPrettyDate(v.nullifiedTS): ''}"
                                  styleClass="compliance-date-nullified"/>
                </p:column>

                <p:column width="5%"
                          sortBy="#{v.daysUntilStipulatedComplianceDate}">
                    <f:facet name="header">
                        <h:outputText value="Days left" />
                    </f:facet>
                    <h:outputText value="#{empty v.actualComplianceDate and empty v.nullifiedTS ? v.daysUntilStipulatedComplianceDate: ''}"/>

                </p:column>

                <p:column width="20%">
                    <f:facet name="header">
                        <h:outputText value="Actions" />
                    </f:facet>

                    <p:commandButton  id="violation-compliance-init-cb"
                                      ajax="true"
                                      value="Record compliance"
                                      actionListener="#{ceCaseBB.onViolationRecordComplianceInitButtonChange(v)}"
                                      icon="fa fa-check"
                                      rendered="#{systemServicesBB.bbSessionUser.keyCard.hasEnfOfficialPermissions 
                                                  and empty v.actualComplianceDate 
                                                  and empty v.nullifiedTS
                                                  and empty v.transferredTS}"
                                      update="violation-compliance-dialog
                                      violation-compliance-form"
                                      oncomplete="PF('violation-compliance-dialog-var').show()"/>

                    <p:spacer height="5px" />

                    <div class="restrict-main-contents-io-link link-button">

                        <p:commandLink  id="violation-update-init-cb"
                                        ajax="true"
                                        value="view/edit"
                                        actionListener="#{ceCaseBB.onViolationView(v)}"
                                        rendered="#{systemServicesBB.bbSessionUser.keyCard.hasMuniReaderPermissions}"
                                        update="violation-category-header-form
                                        violation-details-dialog
                                        violation-details-form
                                        violation-blobs-form
                                        violation-notes-form"
                                        oncomplete="PF('violation-details-dialog-var').show()"/>
                    </div>
                </p:column>
            </p:dataTable>
        </h:form>
    </p:panel>

    <p:dialog   id="violation-migrate-choosepath-dialog"
                height="400" width="500"
                widgetVar="violation-migrate-choosepath-dialog-var"
                responsive="true"
                dynamic="true"
                modal="true"
                resizable="true"
                closable="true"
                closeOnEscape="true"
                rendered="true"
                header="Choose violation transfer pathway">

        <h:form id="violation-migrate-choosepath-form">

            <p:selectOneMenu id="violation-migrate-path-som"
                             value="#{migrationBB.selectedTransferPathway}"
                             style="width: 100%;"
                             required="true"
                             tabindex="1"
                             requiredMessage="A transfer pathway is required"
                             >

                <f:selectItem itemLabel="select a pathway"
                              noSelectionOption="true"
                              itemDisabled="true"/>

                <f:selectItems id="violation-migrate-path-selitems"
                               value="#{migrationBB.transferOptionsListCaseViolation}"
                               var="pathway" itemValue="#{pathway}" itemLabel="#{pathway.description}"/>
            </p:selectOneMenu>

            <p:spacer height="5px" />

            <p:commandButton    id="violation-migrate-init-button"
                                actionListener="#{migrationBB.onTransferPathwaySelectionCompleteButtonChange}"
                                ajax="true"
                                value="Configure migration"
                                icon="fa fa-arrow-right"
                                oncomplete="PF('violation-migrate-choosepath-dialog-var').hide(); PF('migration-configuration-dialog-var').show();"
                                update="@form:@parent:migration-configuration-dialog
                                @form:@parent:migration-configuration-form
                                @form:@parent:migration-growl-form"/>
        </h:form>
    </p:dialog>

    <ui:include src="/restricted/compositions/violationMigration.xhtml" />

    <p:dialog   id="violation-add-dialog"
                height="700" width="1200"
                widgetVar="violation-add-dialog-var"
                responsive="true"
                dynamic="true"
                modal="true"
                resizable="true"
                closable="true"
                closeOnEscape="true"
                rendered="true"
                header="Record New Code Violations @ #{ceCaseBB.currentCase.property.address.addressPretty1Line}">

        <h:form id="violation-add-form">

            <p:growl id="violation-add-growl"/>


            <div class="ui-g data_container_nested_restrict">


                <div class="restrict-main-contents-io-button">


                    <p:commandButton    id="violation-insert-button0"
                                        ajax="false"
                                        value="Record Violations"
                                        action="#{ceCaseBB.onViolationAddCommitButtonChange}"
                                        icon="fa fa-warning" />
                </div>

                <div class="restrict-main-contents-io-button gray_button">

                    <p:commandButton    id="violation-insert-abort-button0"
                                        ajax="false"
                                        value="Cancel"
                                        process="@none"
                                        immediate="true"
                                        action="#{ceCaseBB.onViolationAddAbortButtonChange}"
                                        icon="fa fa-stop" />
                </div>
            </div>
            <p:spacer height="5px" />

            <p:scrollPanel style="height:600px; width:950px;">

                <ui:repeat value="#{ceCaseBB.selectedViolationList}"
                           var="bcv">
                    <div class="ui-g data_container_nested_restrict">
                        <!--NESTED DATA FIELD -->
                        <div class="ui-g-12 ui-md-12 ui-lg-12 restrict-data-field">

                            <!--NESTED DATA LABEL INLINE -->
                            <div class="restrict-data-field-label-inline" >
                                <h:outputLabel value="Ordinance Details: #{bcv.violatedEnfElement.headerString}"
                                               escape="false"
                                               style="font-size: 2em;"/>
                            </div>
                            <!--NESTED DATA VALUE INLINE -->
                            <div class="restrict-data-field-value-inline" >

                                <h:outputText   id="violation-add-ord-text"
                                                styleClass="monospace"
                                                value="#{bcv.violatedEnfElement.ordTechnicalText}"
                                                escape="false" />
                            </div>
                        </div>

                        <div class="ui-g-12 ui-md-12 ui-lg-12 restrict-data-field">

                            <div class="restrict-main-contents-io-title" >
                                <p:outputLabel for="viol-descr">
                                    <h:outputText value="Description of code violation"/>
                                </p:outputLabel>
                            </div>
                            <div class="restrict-main-contents-io-content" >
                                <p:growl for="viol-descr" />
                                <p:inputTextarea id="viol-descr"
                                                 value="#{bcv.description}"
                                                 tabindex="1"
                                                 style="width: 100%"
                                                 required="true" />
                            </div>
                        </div>


                        <div class="ui-g-12 ui-md-12 ui-lg-12 restrict-data-field">

                            <div class="restrict-main-contents-io-content" >
                                <p:selectBooleanCheckbox id="violation-findings-makedefault-chkbx-0"
                                                         value="#{bcv.makeFindingsDefault}"
                                                         itemLabel="Make these findings the default for enforcable ordinance ID:#{bcv.codeViolated.codeSetElementID}"
                                                         tabindex="5"
                                                         />
                            </div>

                        </div>

                        <div class="ui-g-6 ui-md-6 ui-lg-6 restrict-data-field">

                            <div class="restrict-main-contents-io-title" >
                                <h:outputLabel for="viol-date-dor">
                                    <h:outputText value="Date of Record"/>
                                </h:outputLabel>
                            </div>

                            <div class="restrict-main-contents-io-content" >


                                <p:datePicker id="viol-date-dor"
                                              value="#{bcv.dateOfRecord}"
                                              rendered="true"
                                              style="width: 100%;"
                                              pattern="MM/dd/yyyy HH:mm"
                                              hideOnDateTimeSelect="true"
                                              showOnFocus="false"
                                              showIcon="true"
                                              disabled="false"
                                              mask="true"
                                              tabindex="2"
                                              timeInput="true"
                                              required="true" />


                            </div>
                        </div>

                        <div class="ui-g-6 ui-md-6 ui-lg-6 restrict-data-field">

                            <div class="restrict-main-contents-io-title" >
                                <h:outputLabel for="viol-date-stipcomp">
                                    <h:outputText value="Stipulated Compliance Date"/>
                                </h:outputLabel>
                            </div>

                            <div class="restrict-main-contents-io-content" >
                                <p:growl for="viol-date-stipcomp"/>

                                <p:datePicker id="viol-date-stipcomp"
                                              value="#{bcv.stipulatedComplianceDate}"
                                              rendered="true"
                                              style="width: 100%;"
                                              pattern="MM/dd/yyyy HH:mm"
                                              disabled="false"
                                              hideOnDateTimeSelect="true"
                                              showOnFocus="false"
                                              showIcon="true"
                                              showButtonBar="true"
                                              mask="true"
                                              tabindex="3"
                                              timeInput="true"
                                              required="true" />
                                <p:spacer height="3px" />

                                <h:outputText value="(Default value is based on the ordinance's default days to comply of
                                              #{bcv.codeViolated.normDaysToComply})"
                                              style="font-style: italic"/>
                            </div>
                        </div>

                        <div class="ui-g-6 ui-md-6 ui-lg-6 restrict-data-field">

                            <div class="restrict-main-contents-io-title" >

                                <p:outputLabel for="viol-penalty">
                                    <h:outputText value="Penalty ($)"/>
                                </p:outputLabel>
                            </div>
                            <div class="restrict-main-contents-io-content" >
                                <p:growl for="viol-penalty" />
                                <p:inputText id="viol-penalty"
                                             value="#{bcv.penalty}"
                                             tabindex="4"
                                             required="true"
                                             type="number"/>
                            </div>

                        </div>




                        <div class="ui-g-6 ui-md-6 ui-lg-6 restrict-data-field">

                            <div class="restrict-main-contents-io-title" >
                                <p:outputLabel  for="violation-severity-som">
                                    <h:outputText value="Violation severity" />
                                </p:outputLabel>
                            </div>
                            <div class="restrict-main-contents-io-content" >

                                <p:selectOneMenu id="violation-severity-som"
                                                 value="#{bcv.severityIntensity}"
                                                 style="width: 100%;"
                                                 required="true"
                                                 tabindex="6"
                                                 requiredMessage="A violation severity must be selected when adding a violation."
                                                 >
                                    <f:converter converterId="intensityClassConverter"/>

                                    <f:selectItem itemLabel="select a severity" noSelectionOption="true" />

                                    <f:selectItems id="violation-severity-selitems"
                                                   value="#{ceCaseBB.severityList}"
                                                   var="ic" itemValue="#{ic}" itemLabel="#{ic.numericRating}: #{ic.title}"/>

                                </p:selectOneMenu>

                            </div>
                        </div>
                        <div class="restrict-main-contents-io-button gray_button">

                            <p:commandButton    id="violation-removefrombatch"
                                                ajax="true"
                                                value="Remove violation"
                                                immediate="true"
                                                action="#{ceCaseBB.onViolationRemoveFromBatchButtonChange(bcv)}"
                                                icon="fa fa-eraser"
                                                update="violation-add-form"/>
                        </div>
                    </div>
                    <hr />
                </ui:repeat>
            </p:scrollPanel>


            <p:spacer height="5px"/>
            <div class="ui-g data_container_nested_restrict">

                <div class="restrict-main-contents-io-button">


                    <p:commandButton    id="violation-insert-button1"
                                        ajax="false"
                                        value="Record Violations"
                                        action="#{ceCaseBB.onViolationAddCommitButtonChange}"
                                        icon="fa fa-warning" />
                </div>

                <div class="restrict-main-contents-io-button gray_button">

                    <p:commandButton    id="violation-insert-abort-button1"
                                        ajax="false"
                                        value="Cancel"
                                        process="@none"
                                        immediate="true"
                                        action="#{ceCaseBB.onViolationAddAbortButtonChange}"
                                        icon="fa fa-stop" />
                </div>
            </div>

        </h:form>
    </p:dialog>


    <p:dialog   id="violation-details-dialog"
                height="700" width="1400"
                widgetVar="violation-details-dialog-var"
                responsive="true"
                resizable="true"
                closable="true"
                dynamic="true"
                modal="true"
                closeOnEscape="true"
                header="Details of Code Violation ID: #{ceCaseBB.currentViolation.violationID}"
                rendered="#{systemServicesBB.bbSessionUser.keyCard.hasMuniReaderPermissions}"
                >



        <div class="violation-cat-header">
            <h:form id="violation-category-header-form">


                <h:outputText value="#{ceCaseBB.currentViolation.violatedEnfElement.guideEntry.category}"/>
                <h:outputText value=":"/>
                <h:outputText value="#{ceCaseBB.currentViolation.violatedEnfElement.guideEntry.subCategory}"/>
                <h:outputText value=" "/>
                <p:commandLink id="violation-ord-details-cl"
                               oncomplete="PF('violation-ord-details-confdialog-var').show()"
                               value="View ordinance technical text"
                               style="color:blue; font-weight: bold;"
                               type="button" />

            </h:form>
        </div>
        <h2>
            <h:outputText    id="violation-add-chapter-ot"
                             value="#{ceCaseBB.currentViolation.violatedEnfElement.headerString}"
                             escape="false"/>
        </h2>

        <p:spacer height="5px" />

        <div class="p-grid nested-grid">
            <div class="p-col-6">



                <p:panel id="violation-details-panel"
                         toggleable="true"
                         collapsed="false"
                         header="Violation Details"
                         >
                    <h:form id="violation-details-form">



                        <p:commandButton id="violation-details-edit-togglebutton"
                                         value="#{ceCaseBB.editModeCurrentViolation ? 'save Changes' : 'edit'}"
                                         disabled="false"
                                         rendered="true"
                                         ajax="true"
                                         icon="fa #{ceCaseBB.editModeCurrentViolation ? 'fa-check' : 'fa-pencil'}"
                                         actionListener="#{ceCaseBB.onToggleViolationUpdateButtonPress}"
                                         oncomplete="PF('violation-details-dialog-var').show();"
                                         update="   @form
                                         violation-growl-form
                                         violation-details-stipcompdate-editinit-form
                                         violation-details-compliance-editinit-form" />

                        <div class="gray_button">
                            <p:commandButton id="inspections-inspectiondetails-abort"
                                             value="Cancel"
                                             styleClass="gray-button"
                                             rendered="#{ceCaseBB.editModeCurrentViolation}"
                                             icon="fa fa-stop"
                                             actionListener="#{ceCaseBB.onViolationUpdateAbort}"
                                             update="   @form
                                             violation-growl-form
                                             violation-details-stipcompdate-editinit-form
                                             violation-details-compliance-editinit-form"/>
                        </div>

                        <div class="p-grid">
                            <div class="p-col-4 restrict-data-field-label-inline">
                                <p:outputLabel for="violation-status-ot">
                                    <h:outputText value="Status"/>
                                </p:outputLabel>
                            </div>

                            <div class="p-col-8 restrict-data-field-value-inline">
                                <h:outputText id="violation-status-ot"
                                              value="#{ceCaseBB.currentViolation.status.label}"
                                              />
                            </div>

                            <div class="p-col-4 restrict-data-field-label-inline">
                                <p:outputLabel for="violation-prop-ot">
                                    <h:outputText value="Parent Objects:"/>
                                </p:outputLabel>

                            </div>
                            <div class="p-col-8 restrict-data-field-value-inline">
                                <h:outputText id="violation-prop-ot"
                                              value="#{ceCaseBB.currentCase.property.address.addressPretty2LineEscapeFalse}"
                                              escape="false"
                                              />
                                <h:outputText id="violation-prop1-ot"
                                              value=", #{ceCaseBB.currentCase.property.muni.muniName}"
                                              />
                                <h:outputText id="violation-prop2-ot"
                                              value="(ID:#{ceCaseBB.currentCase.property.propertyID}) "
                                              />
                                <p:spacer height="3px" />
                                <h:outputText id="violation-case-ot"
                                              value="#{ceCaseBB.currentCase.caseName}"/>
                                <h:outputText id="violation-case1-ot"
                                              value="(ID:#{ceCaseBB.currentCase.caseID})"/>
                            </div>




                            <div class="p-col-4 restrict-data-field-label-inline">

                                <div class="restrict-data-field-label-inline" >
                                    <p:outputLabel for="violation-findings-ot">
                                        <h:outputText value="Findings"/>
                                    </p:outputLabel>
                                </div>
                            </div>
                            <div class="p-col-8 restrict-data-field-value-inline">

                                <h:outputText id="violation-findings-ot"
                                              value="#{ceCaseBB.currentViolation.description}" 
                                              rendered="#{!ceCaseBB.editModeCurrentViolation}"/>

                                <p:inputTextarea id="violation-findings-it"
                                                 required="true"
                                                 rendered="#{ceCaseBB.editModeCurrentViolation}"
                                                 value="#{ceCaseBB.currentViolation.description}" />
                                <div class="restrict-main-contents-io-content" >
                                    <p:selectBooleanCheckbox id="violation-findings-makedefault-chkbx"
                                                             value="#{ceCaseBB.currentViolation.makeFindingsDefault}"
                                                             itemLabel="Make these findings the default for enforcable ordinance ID:#{ceCaseBB.currentViolation.codeViolated.codeSetElementID}"
                                                             rendered="#{ceCaseBB.editModeCurrentViolation}"
                                                             />
                                </div>
                            </div>

                            <div class="p-col-4 restrict-data-field-label-inline">
                                <h:outputText value="Severity"/>
                            </div>
                            <div class="p-col-8 restrict-data-field-value-inline">
                                <f:subview id="violation-details-severity-ot-subview"
                                           rendered="#{!ceCaseBB.editModeCurrentViolation}">
                                    <h:outputText    id="violation-severity-ot"
                                                     value="#{!(empty ceCaseBB.currentViolation.severityIntensity) ? ceCaseBB.currentViolation.severityIntensity.numericRating : ''}"/>
                                    <h:outputText    id="violation-severity-ot1"
                                                     value=": "/>
                                    <h:outputText    id="violation-severity-ot2"
                                                     value="#{!(empty ceCaseBB.currentViolation.severityIntensity) ? ceCaseBB.currentViolation.severityIntensity.title: ''}"/>
                                </f:subview>

                                <h:selectOneMenu id="violation-severity-update-som"
                                                 value="#{ceCaseBB.currentViolation.severityIntensity}" 
                                                 style="width: 100%;"
                                                 rendered="#{ceCaseBB.editModeCurrentViolation}">
                                    <f:converter converterId="intensityClassConverter"/>

                                    <f:selectItem itemLabel="select a severity" noSelectionOption="true" />

                                    <f:selectItems id="violation-severity-update-selitems"
                                                   value="#{ceCaseBB.severityList}"
                                                   var="ic" itemValue="#{ic}" itemLabel="#{ic.numericRating}: #{ic.title}"
                                                   rendered="#{ceCaseBB.editModeCurrentViolation}"/>
                                </h:selectOneMenu>
                            </div>

                            <div class="p-col-4 restrict-data-field-label-inline">

                                <p:outputLabel for="violation-penalty-ot">
                                    <h:outputText value="Penalty"/>
                                </p:outputLabel>

                            </div>
                            <div class="p-col-8 restrict-data-field-value-inline">
                                <h:outputText    id="violation-penalty-ot"
                                                 value="$#{ceCaseBB.currentViolation.penalty}"
                                                 rendered="#{!ceCaseBB.editModeCurrentViolation}"/>

                                <p:inputText id="viol-penalty"
                                             value="#{ceCaseBB.currentViolation.penalty}"
                                             tabindex="3"
                                             required="true"
                                             type="number"
                                             rendered="#{ceCaseBB.editModeCurrentViolation}"/>
                            </div>

                            <div class="p-col-4 restrict-data-field-label-inline">
                                <h:outputText value="Date of record" />

                            </div>
                            <div class="p-col-8 restrict-data-field-value-inline">

                                <f:subview id="violation-details-dor-ot-subview">

                                    <h:outputText id="propinfo-ot-unfitstart-1"
                                                  value="#{ceCaseBB.getPrettyDate(ceCaseBB.currentViolation.dateOfRecord)}" 
                                                  rendered="#{!ceCaseBB.editModeCurrentViolation}"/>
                                    <div class="restrict-data-field-value-vertical" >
                                        <h:outputText   id="violation-creator-ot0"
                                                        value="#{!(empty ceCaseBB.currentViolation.createdBy) ? 'Declared by ' : ''}"/>
                                        <h:outputText   id="violation-creator-ot1"
                                                        value="#{!(empty ceCaseBB.currentViolation.createdBy) ? ceCaseBB.currentViolation.createdBy.human.name : ''}"/>
                                    </div>
                                </f:subview>

                                <p:datePicker 	id="violation-update-dor-cal"
                                               value="#{ceCaseBB.currentViolation.dateOfRecord}"
                                               disabled="#{!empty ceCaseBB.currentCase.closingDate}"
                                               rendered="#{ceCaseBB.editModeCurrentViolation}"
                                               style="width: 100%;"
                                               pattern="MM/dd/yyyy HH:mm"
                                               showButtonBar="true"
                                               mask="true"
                                               hideOnDateTimeSelect="true"
                                               showOnFocus="false"
                                               showIcon="true"
                                               tabindex="16"
                                               timeInput="true"
                                               required="true" />
                            </div>
                        </div>
                    </h:form>

                    <div class="p-grid">
                        <div class="p-col-4 restrict-data-field-label-inline">
                            <h:outputText value="Stipulated compliance due" />

                            <p:spacer height="5px" />
                        </div>
                        <div class="p-col-8 restrict-data-field-value-inline">
                            <h:form id="violation-details-stipcompdate-editinit-form">

                                <h:outputText   id="violation-stipcompdate-ot"
                                                value="#{ceCaseBB.getPrettyDate(ceCaseBB.currentViolation.stipulatedComplianceDate)}"/>
                                <p:spacer height="3px" />
                                <p:commandLink    id="violation-update-stipdate-init-cb"
                                                  ajax="true"
                                                  actionListener="#{ceCaseBB.onViolationUpdateStipDateInitButtonChange}"
                                                  oncomplete="PF('violation-update-stipdate-dialog-var').show()"
                                                  rendered="#{(empty ceCaseBB.currentViolation.actualComplianceDate)
                                                              and (empty ceCaseBB.currentViolation.nullifiedTS)}"
                                                  disabled="#{ceCaseBB.editModeCurrentViolation}"
                                                  style="color: blue; font-weight: bold;"
                                                  styleClass="noFill"
                                                  value="Change Stip. Comp. Date"
                                                  update="violation-update-stipdate-dialog
                                                  violation-update-stipdate-form"/>

                            </h:form>
                        </div>

                        <div class="p-col-4 restrict-data-field-label-inline">
                            <h:outputText value="Compliance" />
                            <p:spacer height="5px" />
                        </div>
                        <div class="p-col-8 restrict-data-field-value-inline">
                            <h:form id="violation-details-compliance-editinit-form">
                                <p:commandButton    id="violation-compliance-fromdetails-init-cb"
                                                    value="Record Compliance"
                                                    actionListener="#{ceCaseBB.onViolationRecordComplianceInitButtonChange}"
                                                    ajax="true"
                                                    rendered="#{(empty ceCaseBB.currentViolation.nullifiedTS) 
                                                                and (empty ceCaseBB.currentViolation.complianceTimeStamp)
                                                                and (empty ceCaseBB.currentViolation.transferredTS)}"
                                                    icon="fa fa-edit"
                                                    styleClass="noFill"
                                                    disabled="#{ceCaseBB.editModeCurrentViolation}"
                                                    oncomplete="PF('violation-compliance-dialog-var').show()"
                                                    update="violation-compliance-dialog
                                                    violation-compliance-form"
                                                    />

                                <h:outputText   id="violation-compdate-ot"
                                                value="Achieved on #{ceCaseBB.getPrettyDate(ceCaseBB.currentViolation.actualComplianceDate)}"
                                                rendered="#{!empty ceCaseBB.currentViolation.actualComplianceDate}"/>
                                <h:outputText   id="violation-compby-ot0"
                                                value="#{!(empty ceCaseBB.currentViolation.complianceUser) ? 'Certified by user ' : ''}"/>
                                <h:outputText   id="violation-compby-ot1"
                                                value="#{!(empty ceCaseBB.currentViolation.complianceUser) ? ceCaseBB.currentViolation.complianceUser.human.firstName : ''}"/>
                                <h:outputText   id="violation-compby-ot2"
                                                value=" "/>
                                <h:outputText   id="violation-compby-ot3"
                                                value="#{!(empty ceCaseBB.currentViolation.complianceUser) ? ceCaseBB.currentViolation.complianceUser.human.lastName : ''}"/>
                                <p:spacer height="3px" />
                                <h:outputText   id="violation-comp-notes-ot0"
                                                value="#{!(empty ceCaseBB.currentViolation.complianceNote) ? 'Note: ' : ''}"/>
                                <h:outputText   id="violation-comp-notes-ot1"
                                                value="#{ceCaseBB.currentViolation.complianceNote}"
                                                rendered="#{!empty ceCaseBB.currentViolation.actualComplianceDate}"/>
                            </h:form>
                        </div>
                        <div class="p-col-4 restrict-data-field-label-inline">

                            <h:outputLabel      for="nullified-ts-ot"
                                                value="Nullified"/>

                        </div>
                        <div class="p-col-8 restrict-data-field-value-inline">
                            <h:form id="violation-details-nullifiedinit-form">

                                <div class="restrict-main-contents-io-link">
                                    <p:commandLink    id="violation-nullify-init-cb"
                                                      ajax="true"
                                                      actionListener="#{ceCaseBB.onViolationNullifyInitButtonChange}"
                                                      oncomplete="PF('violation-nullify-dialog-var').show()"
                                                      rendered="#{(empty ceCaseBB.currentViolation.nullifiedTS) and (empty ceCaseBB.currentViolation.complianceTimeStamp)}"
                                                      style="color: blue;"
                                                      styleClass="noFill"
                                                      value="Nullify Violation"
                                                      update="violation-nullify-dialog
                                                      violation-nullify-form"/>
                                </div>
                                <h:outputText   id="nullified-ts-ot"
                                                value="#{ceCaseBB.getPrettyDate(ceCaseBB.currentViolation.nullifiedTS)}"/>
                                <h:outputText   id="violation-nullifiedby-ot0"
                                                value="#{!(empty ceCaseBB.currentViolation.nullifiedUser) ? 'Nullified by user ' : ''}"/>
                                <h:outputText   id="violation-nullifiedby-ot1"
                                                value="#{!(empty ceCaseBB.currentViolation.nullifiedUser) ? ceCaseBB.currentViolation.nullifiedUser.human.firstName : ''}"/>
                                <h:outputText   id="violation-nullifiedby-ot2"
                                                value=" "/>
                                <h:outputText   id="violation-nullifiedby-ot3"
                                                value="#{!(empty ceCaseBB.currentViolation.nullifiedUser) ? ceCaseBB.currentViolation.nullifiedUser.human.lastName : ''}"/>
                            </h:form>
                        </div>

                        <div class="p-col-4 restrict-data-field-label-inline">
                            <h:outputText value="record status:" />
                        </div>
                        <div class="p-col-8 restrict-data-field-value-inline">
                            <h:form id="violation-details-recordedit-init-form">

                                <h:outputText value="#{ceCaseBB.currentViolation.active? 'Active record':'Deactivated'}" />

                                <p:spacer height="3px" />

                                <p:commandLink id="violation-nuke-init-cl"
                                               oncomplete="PF('violation-remove-dialog-var').show()"
                                               value="Deactivate violation"
                                               style="color:blue; font-weight: bold;"
                                               type="button" />

                                <p:commandLink    id="violation-reactivate-init-cb"
                                                  ajax="true"
                                                  rendered="#{!empty ceCaseBB.currentViolation.nullifiedTS}"
                                                  actionListener="#{ceCaseBB.onViolationNullifyInitButtonChange}"
                                                  oncomplete="PF('violation-reactivate-dialog-var').show()"
                                                  disabled="false"
                                                  style="color: blue;"
                                                  styleClass="noFill"
                                                  value="Reactivate violation"
                                                  update="violation-reactivate-dialog
                                                  violation-reactivate-form"/>
                            </h:form>
                        </div>
                    </div>
                </p:panel>
            </div>

            <div class="p-col-6">
                <p:panel id="violation-blobs-panel"
                         toggleable="true"
                         collapsed="false"
                         header="Photos and documents"
                         >
                    <h:form id="violation-blobs-form">
                        <p:commandButton    id="violation-blob-add-button"
                                            ajax="true"
                                            styleClass="noFill button-size-small"
                                            actionListener="#{blobUtilitiesBB.onUploadBlobInitButtonChange(ceCaseBB.currentViolation)}"
                                            oncomplete="PF('blob-upload-dialog-var').show()"
                                            update="blob-upload-dialog
                                            blob-uploadconnect-tabview"
                                            value="Upload photo or document"
                                            icon="fa fa-upload"
                                            >
                            <f:param name="blob-list-component-to-update" value="violation-blobs-form" />
                        </p:commandButton>

                        <p:spacer height="5px" />

                        <p:dataTable
                            id="violation-blobs-table"
                            var="vblob"
                            value="#{ceCaseBB.managedViolationBlobList}"
                            rowKey="#{blob.photoDocID}"
                            tableStyleClass="primeDataTable"
                            resizableColumns="true"
                            draggableRows="false" tabindex="6">

                            <p:column width="25%"
                                      sortBy="#{vblob.type.title}">
                                <f:facet name="header">
                                    <h:outputText value="Type and IDs"/>
                                </f:facet>
                                <h:outputText value="#{vblob.type.title}"/>
                                <br/>
                                <h:outputText value="linkID: #{vblob.photoDocID}"/>
                                <br/>
                                <h:outputText value="bytesID: #{vblob.bytesID}"/>
                                <!-- type icon here -->
                            </p:column>

                            <p:column width="50%">
                                <f:facet name="header">
                                    <h:outputText value="Info"/>
                                </f:facet>
                                <div class="rowExpansion">
                                    <h:outputText value="title: #{vblob.title}"/>
                                    <br/>
                                    <h:outputText value="descr: #{vblob.description}"/>
                                    <br/>
                                    <h:outputText value="filename: #{vlob.filename}"/>
                                    <br/>
                                    <h:outputText value="created: #{ceCaseBB.getPrettyDateNoTime(vblob.createdTS)}"/>
                                </div>
                            </p:column>


                            <p:column width="25%">
                                <f:facet name="header">
                                    <h:outputText value="Actions"/>
                                </f:facet>
                                <p:commandButton
                                    value="Download"
                                    ajax="false"
                                    icon="fa fa-arrow-down"
                                    styleClass="ui-button-outlined">
                                    <p:fileDownload value="#{blobRetrieveBB.retrieveBlob(blob)}"
                                                    />
                                </p:commandButton>
                                <br/>
                                <div class="restrict-main-contents-io-link link-button">

                                    <p:commandLink      id="vblob-update-button"
                                                        value="view"
                                                        ajax="true"
                                                        styleClass="noFill button-size-small"
                                                        action="#{blobUtilitiesBB.onViewBlobLinkClick(vblob, ceCaseBB.currentViolation)}"
                                                        oncomplete="PF('blobs-viewblob-dialog-var').show()"
                                                        update="blobs-viewblob-dialog
                                                        blob-viewblob-form"
                                                        >
                                        <f:param name="blob-list-component-to-update" value="violation-blobs-form" />
                                    </p:commandLink>
                                    <p:spacer height="3px" />
                                    <p:commandLink      id="vblob-edit-button"
                                                        value="edit"
                                                        ajax="true"
                                                        styleClass="noFill button-size-small"
                                                        action="#{blobUtilitiesBB.onBlobEditMetaDataInitLinkClick(vblob, ceCaseBB.currentViolation)}"
                                                        oncomplete="PF('blobs-vieweditmetadata-dialog-var').show()"
                                                        update="blob-vieweditmetadata-dialog
                                                        blob-veweditmetadata-form"
                                                        >
                                        <f:param name="blob-list-component-to-update" value="violation-blobs-form" />
                                    </p:commandLink>
                                    <p:spacer height="3px" />
                                    <p:commandLink      id="vblob-remove-button"
                                                        ajax="true"
                                                        styleClass="noFill button-size-small"
                                                        action="#{blobUtilitiesBB.onDeactivateBlobInitLinkClick(vblob, ceCaseBB.currentViolation)}"
                                                        oncomplete="PF('blobs-deactivate-dialog-var').show();"
                                                        value="remove"
                                                        update="blob-deactivate-dialog
                                                        blob-deactivate-form"
                                                        >
                                        <f:param name="blob-list-component-to-update" value="violation-blobs-form" />
                                    </p:commandLink>
                                </div>
                            </p:column>
                        </p:dataTable>
                    </h:form>
                </p:panel>

                <p:panel id="violation-notes-panel"
                         toggleable="true"
                         collapsed="false"
                         header="Notes"
                         >

                    <h:form id="violation-notes-panel-form">



                        <div class="p-grid">
                            <div class="p-col-4 restrict-data-field-label-inline">
                                <h:outputText value="Notes:" />
                                <p:spacer height="3px" />

                                <p:commandLink  id="violation-notes-init-cb"
                                                style="color:blue; font-weight: bold;"
                                                ajax="true"
                                                value="add note"
                                                actionListener="#{ceCaseBB.onViolationNotesInitButtonChange}"
                                                rendered="#{systemServicesBB.bbSessionUser.keyCard.hasEnfOfficialPermissions}"
                                                update="violation-notes-dialog
                                                violation-notes-form"
                                                oncomplete="PF('violation-notes-dialog-var').show()"/>

                            </div>
                            <div class="p-col-8 restrict-data-field-value-inline">

                                <h:outputText id="violation-note-ot"
                                              value="#{ceCaseBB.currentViolation.notes}"
                                              escape="false" />

                            </div>
                        </div>
                    </h:form>


                </p:panel>
            </div>
        </div>
    </p:dialog>

    <p:confirmDialog id="violation-ord-details-confdialog"
                     widgetVar="violation-ord-details-confdialog-var"
                     closeOnEscape="true"
                     closable="true"
                     responsive="true">

        <h2>


            <h:outputText   id="violation-details-title"
                            value="#{ceCaseBB.currentViolation.violatedEnfElement.headerString}"
                            escape="false" />

        </h2>


        <div class="restrict-data-field-label-inline" >
            <p:outputLabel for="violation-ord-id-ot">
                <h:outputText value="Ordinance ID: "/>
            </p:outputLabel>
        </div>
        <div class="restrict-data-field-value-inline" >
            <h:outputText       id="violation-ord-id-ot"
                                value="#{ceCaseBB.currentViolation.violatedEnfElement.elementID} "/>
        </div>


        <div class="ui-g data_container_nested_restrict">
            <div class="ui-g-12 ui-md-6 ui-lg-4 restrict-data-field" >
                <div class="restrict-data-field-label-inline" >

                    <h:outputLabel  for="violation-ord-text-hf"
                                    styleClass="data_field_label" >
                        <h:outputText value="Ordinance Text" />
                    </h:outputLabel>
                </div>
                <div class="restrict-data-field-value-inline" >


                    <h:outputText   id="violation-add-ord-text"
                                    styleClass="monospace"
                                    value="#{ceCaseBB.currentViolation.violatedEnfElement.ordTechnicalText}"
                                    escape="false" />
                </div>
            </div>
            <div class="ui-g-12 ui-md-6 ui-lg-4 restrict-data-field" >

                <div class="restrict-data-field-label-inline" >

                    <p:outputLabel for="violation-enfguidelines-ot"
                                   styleClass="data_field_label">
                        <h:outputText value="Enforcement Guidelines"/>
                    </p:outputLabel>
                </div>
                <div class="restrict-data-field-value-inline" >

                    <h:outputText    id="violation-enfguidelines-ot"
                                     styleClass="data_field_value"
                                     value="#{!(empty ceCaseBB.currentViolation.violatedEnfElement.guideEntry) ? ceCaseBB.currentViolation.violatedEnfElement.guideEntry.enforcementGuidelines :'' }"/>
                </div>
            </div>
        </div>


    </p:confirmDialog>



    <p:dialog   id="violation-update-stipdate-dialog"
                height="500" width="700"
                widgetVar="violation-update-stipdate-dialog-var"
                responsive="true"
                dynamic="true"
                modal="true"
                resizable="true"
                closable="true"
                closeOnEscape="true"
                header="Extend compliance timeframe for violation ID: #{ceCaseBB.currentViolation.violationID}"
                rendered="#{systemServicesBB.bbSessionUser.keyCard.hasEnfOfficialPermissions}"
                >

        <h:form id="violation-update-stipdate-form">
            <h4>Current Compliance date</h4>
            <p>
                <h:outputText value="#{ceCaseBB.getPrettyDate(ceCaseBB.currentViolation.stipulatedComplianceDate)} "/>
            </p>

            <div class="ui-g data_container_nested_restrict">

                <div class="ui-g-12 ui-md-12 ui-lg-12 restrict-data-field">


                    <div class="restrict-main-contents-io-title" >

                        <p:outputLabel for="update-stipdate-sbb"
                                       styleClass="data_field_label">
                            <h:outputText value="Select an extension method:"
                                          rendered="true"/>
                        </p:outputLabel>
                    </div>
                    <div class="restrict-main-contents-io-content" >

                        <p:selectBooleanButton id="violation-update-stipdate-sbb"
                                               onLabel="Pick a date"
                                               offLabel="Enter a number of days from today"
                                               styleClass="selectButton"
                                               rendered="true"
                                               value="#{ceCaseBB.formExtendStipCompUsingDate}"
                                               >
                            <p:ajax update="update-stipdate-cal
                                    update-stipdate-numdays-it" />
                        </p:selectBooleanButton>
                    </div>

                </div>
                <div class="ui-g-12 ui-md-12 ui-lg-12 restrict-data-field">

                    <div class="restrict-main-contents-io-title" >
                        <h:outputLabel for="update-stipdate-cal">
                            <h:outputText value="New stipulated compliance date"/>
                        </h:outputLabel>
                    </div>

                    <div class="restrict-main-contents-io-content" >
                        <p:growl for="update-stipdate-cal"/>

                        <p:datePicker  id="update-stipdate-cal"
                                       value="#{ceCaseBB.currentViolation.stipulatedComplianceDate}"
                                       disabled="#{!ceCaseBB.formExtendStipCompUsingDate}"
                                       rendered="true"
                                       style="width: 100%;"
                                       pattern="MM/dd/yyyy HH:mm"
                                       showButtonBar="true"
                                       hideOnDateTimeSelect="true"
                                       showOnFocus="false"
                                       showIcon="true"
                                       mask="true"
                                       tabindex="16"
                                       timeInput="true"
                                       required="true" />


                    </div>
                </div>


                <div class="ui-g-12 ui-md-12 ui-lg-12 restrict-data-field">
                    <div class="restrict-main-contents-io-title" >

                        <p:outputLabel  for="update-stipdate-numdays-it"
                                        value="Set new compliance date this Number of days from today"/>
                    </div>

                    <div class="restrict-main-contents-io-content" >

                        <p:inputText id="update-stipdate-numdays-it"
                                     disabled="#{ceCaseBB.formExtendStipCompUsingDate}"
                                     value="#{ceCaseBB.formExtendedStipCompDaysFromToday}"
                                     style="width: 50px;"
                                     tabindex="3"
                                     type="number"
                                     required="false"
                                     styleClass="inputText"/>

                        <h:message for="update-stipdate-numdays-it" showDetail="false" showSummary="true"
                                   warnClass="msgWarn" infoClass="msgInfo" fatalClass="msgFatal" errorClass="msgError" />

                    </div>

                </div>


                <div class="restrict-main-contents-io-title" >
                    <h:outputLabel for="update-stipdate-cal">
                        <h:outputText value="Event log description"/>
                    </h:outputLabel>
                </div>

                <div class="restrict-main-contents-io-content" >
                    <p:inputTextarea id="violation-updatestipdate-evreason-ita"
                                     value="#{ceCaseBB.formViolationStipCompDateExtReason}" />
                </div>
            </div>

            <p:commandButton
                id="update-stipdate-sbb"
                icon="fa fa-calendar"
                ajax="true"
                actionListener="#{ceCaseBB.onViolationExtendStipCompDateCommitButtonChange}"
                value="Save new stipulated Complaince Date"
                disabled="false"
                oncomplete="PF('violation-update-stipdate-dialog-var').hide();"
                update="cecase-violations-form
                cecase-violations-panel
                violation-details-dialog
                violation-details-form
                violation-growl-form"
                />

            <p:spacer height="5px" />

            <div class="gray_button">
                <p:commandButton    id="violation-update-stipdate-cancel-button"
                                    ajax="true"  tabindex="27"
                                    value="Cancel"
                                    icon="fa fa-stop"
                                    immediate="true"
                                    process="@none"
                                    onclick="PF('violation-update-stipdate-dialog-var').hide()"
                                    />
            </div>
        </h:form>
    </p:dialog>


    <p:dialog   id="violation-compliance-dialog"
                height="600" width="600"
                widgetVar="violation-compliance-dialog-var"
                responsive="true"
                dynamic="true"
                modal="true"
                resizable="true"
                closable="true"
                closeOnEscape="true"
                header="Record compliance with violation ID: #{ceCaseBB.currentViolation.violationID}"
                rendered="#{systemServicesBB.bbSessionUser.keyCard.hasEnfOfficialPermissions}"
                >


        <h:form id="violation-compliance-form">
            <h2>
                <h:outputText value="#{ceCaseBB.currentViolation.violatedEnfElement.headerString}" />
            </h2>
            <div class="ui-g data_container_nested_restrict">

                <div class="ui-g-12 ui-md-12 ui-lg-12 restrict-data-field">


                    <div class="restrict-main-contents-io-title" >

                        <p:outputLabel for="violation-compliance-it">
                            <h:outputText value="Describe the mitigation actions taken"/>
                        </p:outputLabel>
                    </div>
                    <div class="restrict-main-contents-io-content" >

                        <p:inputTextarea id="violation-compliance-it"
                                         required="true"
                                         value="#{ceCaseBB.currentViolation.complianceNote}" />

                    </div>

                </div>
                <div class="ui-g-12 ui-md-12 ui-lg-12 restrict-data-field">

                    <div class="restrict-main-contents-io-title" >
                        <h:outputLabel for="violation-compliance-dor">
                            <h:outputText value="Compliance date of record"/>
                        </h:outputLabel>
                    </div>

                    <div class="restrict-main-contents-io-content" >
                        <p:growl for="violation-compliance-dor"/>
                        <p:datePicker 	id="violation-compliance-dor"
                                       value="#{ceCaseBB.complianceDateForm}"
                                       rendered="true"
                                       style="width: 100%;"
                                       pattern="MM/dd/yyyy HH:mm"
                                       disabled="false"
                                       showButtonBar="true"
                                       hideOnDateTimeSelect="true"
                                       showOnFocus="false"
                                       showIcon="true"
                                       mask="true"
                                       timeInput="true"
                                       required="true" />
                    </div>
                </div>
            </div>

            <p:spacer height="5px" />

            <p:commandButton
                icon="fa fa-check-circle-o"
                ajax="true"
                actionListener="#{ceCaseBB.onViolationRecordComplianceCommitButtonChange}"
                value="Record compliance"
                oncomplete="PF('violation-compliance-dialog-var').hide();"
                update="cecase-violations-form
                cecase-violations-panel
                violation-details-dialog
                violation-details-form
                violation-growl-form"
                />

        </h:form>

    </p:dialog>




    <p:dialog   id="violation-remove-dialog"
                height="400" width="600"
                widgetVar="violation-remove-dialog-var"
                responsive="true"
                dynamic="true"
                modal="true"
                resizable="true"
                closable="true"
                closeOnEscape="true"
                header="Deactivate Violation (ID:#{ceCaseBB.currentViolation.violationID})"
                rendered="#{systemServicesBB.bbSessionUser.keyCard.hasEnfOfficialPermissions}"
                >

        <h:form id="violation-remove-form">

            <div class="ui-g data_container_nested_restrict">
                <div class="ui-g-12 ui-md-6 ui-lg-4 restrict-data-field" >
                    <div class="restrict-data-field-label-inline" >

                        <h:outputLabel  for="violation-remove-button">
                            <h:outputText value="Violations cannot be nuked if they have been used in a notice of violation or citation." />
                        </h:outputLabel>
                    </div>
                </div>
                <div class="ui-g-12 ui-md-6 ui-lg-4 restrict-data-field" >

                    <div class="restrict-main-contents-io-button red_button">


                        <p:commandButton
                            id="violation-remove-button"
                            icon="fa fa-trash"
                            ajax="false"
                            action="#{ceCaseBB.onViolationRemoveCommitButtonChange}"
                            value="Remove Violation ID:#{ceCaseBB.currentViolation.violationID}"
                            />
                    </div>

                    <div class="restrict-main-contents-io-button gray_button">


                        <p:commandButton    id="violation-nuke-cancel-button"
                                            ajax="true"
                                            tabindex="27"
                                            value="Cancel"
                                            icon="fa fa-stop"
                                            immediate="true"
                                            process="@none"
                                            onclick="PF('violation-remove-dialog-var').hide()"
                                            />


                    </div>
                </div>
            </div>

        </h:form>

    </p:dialog>


    <p:dialog   id="violation-nullify-dialog"
                height="300" width="600"
                widgetVar="violation-nullify-dialog-var"
                responsive="true"
                resizable="true"
                closable="true"
                dynamic="true"
                modal="true"
                closeOnEscape="true"
                header="Nullify Violation"
                rendered="#{systemServicesBB.bbSessionUser.keyCard.hasEnfOfficialPermissions}"
                >
        <h:form id="violation-nullify-form">

            <div class="ui-g data_container_nested_restrict">
                <div class="ui-g-12 ui-md-12 ui-lg-12 restrict-data-field" >
                    <div class="restrict-data-field-label-inline" >

                        <h:outputLabel  for="violation-nullify-button">
                            <h:outputText value="Nullify a code violation that was once legitimate but is no longer relevant for case closure." />
                        </h:outputLabel>
                    </div>
                </div>
                <div class="ui-g-12 ui-md-12 ui-lg-12 restrict-data-field" >

                    <div class="restrict-main-contents-io-button red_button">


                        <p:commandButton
                            id="violation-nullify-button"
                            icon="fa fa-trash"
                            ajax="false"
                            action="#{ceCaseBB.onViolationNullifyCommitButtonChange}"
                            value="Nullify Violation ID:#{ceCaseBB.currentViolation.violationID}"
                            />
                    </div>


                    <div class="restrict-main-contents-io-button gray_button">


                        <p:commandButton    id="violation-nullify-cancel-button"
                                            ajax="true"
                                            tabindex="27"
                                            value="Cancel"
                                            icon="fa fa-stop"
                                            immediate="true"
                                            process="@none"
                                            onclick="PF('violation-nullify-dialog-var').hide()"
                                            />


                    </div>
                </div>
            </div>

        </h:form>

    </p:dialog>

    <p:dialog   id="violation-reactivate-dialog"
                height="300" width="600"
                widgetVar="violation-reactivate-dialog-var"
                responsive="true"
                resizable="true"
                closable="true"
                dynamic="true"
                modal="true"
                closeOnEscape="true"
                header="Reactivate Violation"
                rendered="#{systemServicesBB.bbSessionUser.keyCard.hasEnfOfficialPermissions}"
                >
        <h:form id="violation-reactivate-form">

            <div class="ui-g data_container_nested_restrict">

                <div class="ui-g-12 ui-md-12 ui-lg-12 restrict-data-field" >

                    <div class="restrict-main-contents-io-button">


                        <p:commandButton
                            id="violation-reactivate-button"
                            icon="fa fa-bolt"
                            ajax="false"
                            action="#{ceCaseBB.onViolationReactivateButtonChange}"
                            value="Reactivate Violation ID:#{ceCaseBB.currentViolation.violationID}"
                            />
                    </div>


                    <div class="restrict-main-contents-io-button gray_button">


                        <p:commandButton    id="violation-nullify-cancel-button"
                                            ajax="true"
                                            tabindex="27"
                                            value="Cancel"
                                            icon="fa fa-stop"
                                            immediate="true"
                                            process="@none"
                                            onclick="PF('violation-reactivate-dialog-var').hide()"
                                            />


                    </div>
                </div>
            </div>

        </h:form>

    </p:dialog>



    <p:dialog   id="violation-notes-dialog"
                height="600" width="800"
                widgetVar="violation-notes-dialog-var"
                responsive="true"
                resizable="true"
                closable="true"
                closeOnEscape="true"
                dynamic="true"
                modal="true"
                header="Violation notes"
                rendered="#{systemServicesBB.bbSessionUser.keyCard.hasEnfOfficialPermissions}"
                >

        <h:form id="violation-notes-form">

            <h:outputText styleClass="ui-label" value="Note text: "/>
            <p:textEditor   id="violation-notes-editor"
                            value="#{ceCaseBB.formNoteText}"
                            required="true"
                            secure="false"
                            height="200"/>


            <p:spacer height="5px" />
            <p>Note note: your name, username, and the current date/time are automatically included.</p>
            <p:spacer height="5px" />
            
            <p:commandButton    id="violation-note-button-cancel"
                                ajax="true"  tabindex="27"
                                value="Cancel"
                                process="@none"
                                icon="fa fa-stop"
                                immediate="true"
                                onclick="PF('violation-notes-dialog-var').hide()"
                                />

            <p:commandButton   id="violation-dialog-notes-button-addnote"
                               ajax="true"
                               actionListener="#{ceCaseBB.onViolationNoteCommitButtonChange}"
                               oncomplete="PF('violation-notes-dialog-var').hide()"
                               rendered="#{systemServicesBB.bbSessionUser.keyCard.hasMuniStaffPermissions}"
                               value="Attach Note"
                               styleClass="inline-button"
                               icon="fa fa-sticky-note-o"
                               update="violation-notes-form
                               violation-notes-panel-form"/>

            <p:spacer height="5px" />
            <h2>
                <h:outputText  value="Notes on violatio ID #{ceCaseBB.currentViolation.violationID}" />
            </h2>
        </h:form>
    </p:dialog>

    <p:dialog   id="violation-selectelement-dialog"
                height="800" width="1600"
                widgetVar="violation-selectelement-dialog-var"
                responsive="true"
                dynamic="true"
                modal="true"
                resizable="true"
                closable="true"
                closeOnEscape="true"
                header="Choose Ordinance"
                rendered="#{systemServicesBB.bbSessionUser.keyCard.hasEnfOfficialPermissions}"
                >

        <h:form id="violation-selectelement-form">
            <p:commandButton    id="viol-selectelement-done-cb"
                                ajax="true"
                                tabindex="27"
                                value="Add selected violations"
                                icon="fa fa-check"
                                actionListener="#{ceCaseBB.onOrdinanceSelectionCompleteButtonChange}"
                                oncomplete="PF('violation-add-dialog-var').show()"
                                update="violation-add-form"/>

            <p:spacer height="5px" />

            <p:dataTable
                id="enforcableCodeSetElementTable"
                var="cse"
                value="#{sessionBean.sessCodeSet.enfCodeElementList}"
                rowKey="#{cse.codeSetElementID}"
                tableStyleClass="primeDataTable"
                scrollable="true"
                resizableColumns="true"
                draggableColumns="true"
                rowExpandMode="single"
                selection="#{ceCaseBB.selectedElementList}"
                filteredValue="#{ceCaseBB.filteredElementList}"
                expandedRow="false"
                widgetVar="codeSetElementListTable">

                <p:column   selectionMode="multiple"
                            style="width:16px;text-align:center"/>

                <p:column width="3%">
                    <f:facet name="header">
                        <h:outputText value="Exp"/>
                    </f:facet>
                    <p:rowToggler/>
                </p:column>

                <p:column width="10%" sortBy="#{cse.source.sourceName}"
                          filterBy="#{cse.source.sourceName}">
                    <f:facet name="header">
                        <h:outputText value="Source" />
                    </f:facet>
                    <h:outputText value="#{cse.source.sourceName}(#{cse.source.sourceYear})"/>
                </p:column>

                <p:column width="5%"
                          sortBy="#{cse.ordchapterNo}">
                    <f:facet name="header">
                        <h:outputText value="Chap#"/>
                    </f:facet>
                    <h:outputText value="#{cse.ordchapterNo}"/>
                </p:column>

                <p:column width="15%" sortBy="#{cse.ordchapterTitle}"
                          filterBy="#{cse.ordchapterTitle}">
                    <f:facet name="header">
                        <h:outputText value="Chapter"/>
                    </f:facet>
                    <h:outputText value="#{cse.ordchapterTitle}"/>
                </p:column>

                <p:column width="5%" sortBy="#{cse.ordSecNum}">
                    <f:facet name="header">
                        <h:outputText value="Sec#" />
                    </f:facet>
                    <h:outputText value="#{cse.ordSecNum}"/>
                </p:column>

                <p:column width="12%" sortBy="#{cse.ordSecTitle}"
                          filterBy="#{cse.ordSecTitle}">
                    <f:facet name="header">
                        <h:outputText value="Section" />
                    </f:facet>
                    <h:outputText value="#{cse.ordSecTitle}"/>
                </p:column>

                <p:column width="5%" sortBy="#{cse.ordSubSecNum}">
                    <f:facet name="header">
                        <h:outputText value="Sub#" />
                    </f:facet>
                    <h:outputText value="#{cse.ordSubSecNum}"/>
                </p:column>

                <p:column sortBy="#{cse.ordSubSecTitle}"
                          filterBy="#{cse.ordSubSecTitle}"
                          width="12%">
                    <f:facet name="header">
                        <h:outputText value="SubSec. Title" />
                    </f:facet>
                    <h:outputText value="#{cse.ordSubSecTitle}"/>
                </p:column>
                <p:column sortBy="#{cse.ordSubSubSecNum}"
                          filterBy="#{cse.ordSubSubSecNum}"
                          width="6%">
                    <f:facet name="header">
                        <h:outputText value="SubSub#" />
                    </f:facet>
                    <h:outputText value="#{cse.ordSubSubSecNum}"/>
                </p:column>

                <p:column width="10%" sortBy="#{cse.guideEntry.category}"
                          filterBy="#{cse.guideEntry.category}">
                    <f:facet name="header">
                        <h:outputText value="Category" />
                    </f:facet>
                    <h:outputText value="#{cse.guideEntry.category}"/>
                    <p:spacer height="2px" />
                    <h:outputText value="#{cse.guideEntry.subCategory}"/>
                </p:column>

                <p:rowExpansion>
                    <div class="outlinedBox">


                        <h2>Details</h2>
                        <h:outputText escape="false" value="Code element ID: #{cse.elementID}"/>

                        <h2>Enforceability Info</h2>
                        <h:outputLabel styleClass="bold" value="Munimum Penalty"/>
                        <p:spacer height="15px"/>
                        <div class="rowExpansion">
                            <h:outputText escape="false" value="$#{cse.minPenalty}"/>
                        </div>

                        <h:outputLabel styleClass="bold" value="Norm Penalty"/>
                        <p:spacer height="15px"/>
                        <div class="rowExpansion">
                            <h:outputText escape="false" value="$#{cse.normPenalty}"/>
                        </div>

                        <h:outputLabel styleClass="bold" value="Maximum Penalty"/>
                        <p:spacer height="15px"/>
                        <div class="rowExpansion">
                            <h:outputText escape="false" value="$#{cse.maxPenalty}"/>
                        </div>

                        <h:outputLabel styleClass="bold" value="Penalty Notes"/>
                        <p:spacer height="15px"/>
                        <div class="rowExpansion">
                            <h:outputText escape="false" value="#{cse.penaltyNotes}"/>
                        </div>

                        <h:outputLabel styleClass="bold" value="Default days to comply"/>
                        <p:spacer height="15px"/>
                        <div class="rowExpansion">
                            <h:outputText escape="false" value="#{cse.normDaysToComply}"/>
                        </div>

                        <h:outputLabel styleClass="bold" value="Compliance timeframe Notes"/>
                        <p:spacer height="15px"/>
                        <div class="rowExpansion">
                            <h:outputText escape="false" value="#{cse.daysToComplyNotes}"/>
                        </div>

                        <h:outputLabel styleClass="bold" value="Municipality specific implementation notes"/>
                        <p:spacer height="15px"/>
                        <div class="rowExpansion">
                            <h:outputText escape="false" value="#{cse.muniSpecificNotes}"/>
                        </div>
                    </div>

                    <div class="outlinedBox">
                        <h2>Code Element Content</h2>

                        <h:outputLabel styleClass="bold" value="Technical Text"/>
                        <p:spacer height="15px"/>
                        <div class="rowExpansion">
                            <h:outputText escape="false" value="#{cse.ordTechnicalText}"/>
                        </div>

                        <p:spacer height="15px"/>

                        <h:outputLabel styleClass="bold" value="Human friendly text"/>
                        <div class="rowExpansion">
                            <h:outputText escape="false" value="#{cse.ordHumanFriendlyText}"/>
                        </div>
                        <p:spacer height="15px"/>
                        <h:outputLabel styleClass="bold" value="Code Guide: Enforcement Tips"/>
                        <div class="rowExpansion">
                            <h:outputText escape="false" value="#{cse.guideEntry.enforcementGuidelines}"/>
                        </div>

                        <p:spacer height="15px"/>

                        <h:outputLabel styleClass="bold" value="Code guide: Inspection Tips"/>
                        <div class="rowExpansion">
                            <h:outputText escape="false" value="#{cse.guideEntry.inspectionGuidelines}"/>
                        </div>
                    </div>
                </p:rowExpansion>
            </p:dataTable>
        </h:form>

    </p:dialog>



</ui:composition>