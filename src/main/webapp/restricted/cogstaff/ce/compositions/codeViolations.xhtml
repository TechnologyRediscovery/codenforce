<ui:composition xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
                xmlns:h="http://xmlns.jcp.org/jsf/html"
                xmlns:f="http://xmlns.jcp.org/jsf/core"
                xmlns:p="http://primefaces.org/ui"
                xmlns="http://www.w3.org/1999/xhtml">

    <p:panel id="cecase-violations-panel"
             toggleable="true"
             collapsed="false"
             header="Code Violations (#{ceCaseSearchProfileBB.currentCase.violationList.size()})"
             rendered="true"
             >


        <h:form id="cecase-violations-form">

            <p:commandButton    id="cecase-violation-add-button"
                                ajax="true"
                                styleClass="noFill button-size-small"
                                actionListener="#{ceCaseSearchProfileBB.onViolationAddInit}"
                                value="Add Violations"
                                disabled="#{!empty ceCaseSearchProfileBB.currentCase.closingDate}"

                                oncomplete="PF('violation-selectelement-dialog-var').show()"
                                icon="fa fa-plus"
                                update="violation-selectelement-dialog
                                violation-selectelement-form"

                                />

            <p:spacer height="5px" />

            <p:dataTable
                id="cecase-violations-table"
                var="v"
                rowKey="#{v.violationID}"
                value="#{ceCaseSearchProfileBB.currentCase.violationList}"
                tableStyleClass="primeDataTable"
                draggableColumns="true"
                reflow="true">


                <!--<p:ajax event="rowSelect" update="selectedRowLabel"/>-->

                <p:column width="10%" sortBy="#{v.status.label}">
                    <f:facet name="header">
                        <h:outputText value="Status" />
                    </f:facet>
                    <i class="material-icons"><h:outputText value="#{v.icon.materialIcon}" /></i>
                    <p:spacer height="2px" />
                    <h:outputText value="#{!(empty v.status) ? v.status.label : ''}" />

                </p:column>

                <p:column width="10%"
                          styleClass="wrapText">

                    <f:facet name="header">
                        <h:outputText value="Ordinance" />
                    </f:facet>

                    <h:outputText  value="&#167;#{v.violatedEnfElement.ordSecNum}:" />
                    <h:outputText  value="#{v.violatedEnfElement.ordSecTitle}; " />
                    <h:outputText  value="&#167;&#167;#{v.violatedEnfElement.ordSubSecNum} " />
                    <h:outputText  value="#{v.violatedEnfElement.ordSubSecTitle}" />

                </p:column>

                <p:column width="10%"
                          styleClass="wrapText">
                    <f:facet name="header">
                        <h:outputText value="Date" />
                    </f:facet>
                    <h:outputText value="#{(empty v.actualComplianceDate) and (empty v.nullifiedTS) ? 'Compliance due on ' : ''}"
                                  styleClass="compliance-date-stipulated"/>
                    <h:outputText value="#{(empty v.actualComplianceDate) and (empty v.nullifiedTS)  ? v.stipulatedComplianceDatePretty : ''}"
                                  styleClass="compliance-date-stipulated"/>
                    <h:outputText value="#{!empty(v.actualComplianceDate) ? 'Compliance achieved on '  : ''}"
                                  styleClass="compliance-date"/>
                    <h:outputText value="#{!empty(v.actualComplianceDate) ? v.actualComplianceDatePretty : ''}"
                                  styleClass="compliance-date"/>
                    <h:outputText value="#{!empty(v.nullifiedTS) ? 'Nullified on '  : ''}"
                                  styleClass="compliance-date-nullified"/>
                    <h:outputText value="#{!empty(v.nullifiedTS) ? ceCaseSearchProfileBB.getPrettyDate(v.nullifiedTS): ''}"
                                  styleClass="compliance-date-nullified"/>
                </p:column>

                <p:column width="5%"
                          sortBy="#{v.daysUntilStipulatedComplianceDate}">
                    <f:facet name="header">
                        <h:outputText value="Days left" />
                    </f:facet>
                    <h:outputText value="#{empty v.actualComplianceDate and empty v.nullifiedTS ? v.daysUntilStipulatedComplianceDate: ''}"/>

                </p:column>

                <p:column width="20%">
                    <f:facet name="header">
                        <h:outputText value="Actions" />
                    </f:facet>

                    <p:commandButton  id="violation-compliance-init-cb"
                                      ajax="true"
                                      value="Record compliance"
                                      actionListener="#{ceCaseSearchProfileBB.onViolationRecordComplianceInitButtonChange(v)}"
                                      icon="fa fa-check"
                                      rendered="#{systemServicesBB.bbSessionUser.keyCard.hasEnfOfficialPermissions and empty v.actualComplianceDate and empty v.nullifiedTS}"
                                      update="violation-compliance-dialog
                                      violation-compliance-form"
                                      oncomplete="PF('violation-compliance-dialog-var').show()"/>

                    <p:spacer height="5px" />

                    <div class="restrict-main-contents-io-link link-button">

                        <p:commandLink  id="violation-update-init-cb"
                                        ajax="true"
                                        value="edit"
                                        actionListener="#{ceCaseSearchProfileBB.onViolationUpdateInitButtonChange(v)}"
                                        rendered="#{systemServicesBB.bbSessionUser.keyCard.hasMuniReaderPermissions}"
                                        update="violation-details-dialog
                                        violation-details-form"
                                        oncomplete="PF('violation-details-dialog-var').show()"/>


                    </div>


                    <h:outputText value=" | "
                                  styleClass="link-button"/>

                    <div class="restrict-main-contents-io-link link-button">

                        <p:commandLink  id="violation-notes-init-cb"
                                        ajax="true"
                                        value="notes"
                                        actionListener="#{ceCaseSearchProfileBB.onViolationNotesInitButtonChange(v)}"
                                        rendered="#{systemServicesBB.bbSessionUser.keyCard.hasEnfOfficialPermissions}"
                                        update="violation-notes-dialog
                                        violation-notes-form"
                                        oncomplete="PF('violation-notes-dialog-var').show()"/>


                    </div>
                </p:column>

            </p:dataTable>


        </h:form>

    </p:panel>


    <p:dialog   id="violation-add-dialog"
                height="700" width="1200"
                widgetVar="violation-add-dialog-var"
                responsive="true"
                modal="true"
                resizable="true"
                closable="true"
                closeOnEscape="true"
                rendered="true"
                header="Record New Code Violations @ #{ceCaseSearchProfileBB.currentCase.property.addressString}">

        <h:form id="violation-add-form">

            <p:growl id="violation-add-growl"/>


            <div class="ui-g data_container_nested_restrict">


                <div class="restrict-main-contents-io-button">


                    <p:commandButton    id="violation-insert-button0"
                                        ajax="false"
                                        value="Record Violations"
                                        action="#{ceCaseSearchProfileBB.onViolationAddCommitButtonChange}"
                                        icon="fa fa-warning" />
                </div>

                <div class="restrict-main-contents-io-button gray_button">

                    <p:commandButton    id="violation-insert-abort-button0"
                                        ajax="false"
                                        value="Cancel"
                                        process="@none"
                                        immediate="true"
                                        action="#{ceCaseSearchProfileBB.onViolationAddAbortButtonChange}"
                                        icon="fa fa-stop" />
                </div>
            </div>
                <p:spacer height="5px" />

                <p:scrollPanel style="height:600px; width:950px;">

                    <ui:repeat value="#{ceCaseSearchProfileBB.selectedViolationList}"
                               var="bcv">
                        <div class="ui-g data_container_nested_restrict">
                            <!--NESTED DATA FIELD -->
                            <div class="ui-g-12 ui-md-12 ui-lg-12 restrict-data-field">

                                <!--NESTED DATA LABEL INLINE -->
                                <div class="restrict-data-field-label-inline" >
                                    <h:outputLabel value="Ordinance Details: #{bcv.violatedEnfElement.ordSubSecNum}: #{bcv.violatedEnfElement.ordSubSecTitle} " style="font-size: 2em;"/>
                                </div>
                                <!--NESTED DATA VALUE INLINE -->
                                <div class="restrict-data-field-value-inline" >
                                    <h:outputText    id="violation-add-source-ot"
                                                     value="Source: #{bcv.violatedEnfElement.source.sourceName} (#{bcv.violatedEnfElement.source.sourceYear})"/>

                                    <p:spacer height="2px" />

                                    <h:outputText    id="violation-add-chapter-ot"
                                                     value="Chapter #{bcv.violatedEnfElement.ordchapterNo}: #{bcv.violatedEnfElement.ordchapterTitle}"/>

                                    <p:spacer height="2px" />

                                    <h:outputText    id="violation-add-section-ot"
                                                     value="Section #{bcv.violatedEnfElement.ordSecNum}: #{bcv.violatedEnfElement.ordSecTitle}"/>

                                    <h:outputText value=" | " />

                                    <h:outputText    id="violation-add-subsection-ot"
                                                     value="Sub-Sec #{bcv.violatedEnfElement.ordSubSecNum}: #{bcv.violatedEnfElement.ordSubSecTitle}"/>

                                    <p:spacer height="2px" />

                                    <h:outputText    id="violation-add-category-ot"
                                                     value="Category: #{!(empty bcv.violatedEnfElement.guideEntry) ? bcv.violatedEnfElement.guideEntry.category :'' }"/>

                                    <p:spacer height="2px" />

                                    <h:outputText   id="violation-add-ord-text"
                                                    styleClass="monospace"
                                                    value="#{bcv.violatedEnfElement.ordTechnicalText}"
                                                    escape="false" />
                                </div>
                            </div>
                            <div class="ui-g-12 ui-md-12 ui-lg-12 restrict-data-field">

                                <div class="restrict-main-contents-io-title" >
                                    <h:outputLabel for="viol-date-dor">
                                        <h:outputText value="Date of Record"/>
                                    </h:outputLabel>
                                </div>

                                <div class="restrict-main-contents-io-content" >
                                    <p:growl for="viol-date-dor" />
                                    <p:calendar id="viol-date-dor"
                                                value="#{bcv.dateOfRecordUtilDate}" 
                                                mode="popup"  
                                                showOn="button" 
                                                pattern="EEE, dd MMM, yyyy HH:mm:ss"
                                                navigator="true" 
                                                tabindex="2" 
                                                timeInput="true" 
                                                showHour="true" 
                                                showMinute="true"
                                                showButtonPanel="true" 
                                                showTodayButton="true"
                                                required="true"/>
                                </div>
                            </div>

                            <div class="ui-g-12 ui-md-12 ui-lg-12 restrict-data-field">

                                <div class="restrict-main-contents-io-title" >
                                    <h:outputLabel for="viol-date-stipcomp">
                                        <h:outputText value="Stipulated Compliance Date"/>
                                    </h:outputLabel>
                                </div>

                                <div class="restrict-main-contents-io-content" >
                                    <p:growl for="viol-date-stipcomp"/>

                                    <h:outputText value="(Default value is based on the ordinance's default days to comply of 
                                                  #{bcv.codeViolated.normDaysToComply})"
                                                  style="font-style: italic"/>
                                    <p:spacer height="3px" />
                                    <p:calendar id="viol-date-stipcomp"
                                                value="#{bcv.stipulatedComplianceDateUtilDate}" 
                                                mode="popup"  
                                                showOn="button" 
                                                pattern="EEE, dd MMM, yyyy HH:mm:ss"
                                                navigator="true" 
                                                tabindex="1"
                                                timeInput="true" 
                                                showHour="true" 
                                                showMinute="true"
                                                showButtonPanel="true" 
                                                showTodayButton="true"
                                                required="true"/>
                                </div>
                            </div>

                            <div class="ui-g-12 ui-md-12 ui-lg-12 restrict-data-field">

                                <div class="restrict-main-contents-io-title" >

                                    <p:outputLabel for="viol-penalty">
                                        <h:outputText value="Penalty ($)"/>
                                    </p:outputLabel>
                                </div>
                                <div class="restrict-main-contents-io-content" >
                                    <p:growl for="viol-penalty" />
                                    <p:inputText id="viol-penalty" 
                                                 value="#{bcv.penalty}"
                                                 tabindex="3" 
                                                 required="true" 
                                                 type="number"/>
                                </div>

                            </div>

                            <div class="ui-g-12 ui-md-12 ui-lg-12 restrict-data-field">

                                <div class="restrict-main-contents-io-title" >
                                    <p:outputLabel for="viol-descr">
                                        <h:outputText value="Description of code violation"/>
                                    </p:outputLabel>
                                </div>
                                <div class="restrict-main-contents-io-content" >
                                    <p:growl for="viol-descr" />
                                    <p:inputTextarea id="viol-descr" 
                                                     value="#{bcv.description}"
                                                     tabindex="5" 
                                                     style="width: 100%"
                                                     required="true" />

                                </div>

                            </div>


                            <div class="ui-g-12 ui-md-12 ui-lg-12 restrict-data-field">

                                <div class="restrict-main-contents-io-content" >
                                    <p:selectBooleanCheckbox id="violation-findings-makedefault-chkbx-0"
                                                             value="#{bcv.makeFindingsDefault}"
                                                             itemLabel="Make these findings the default for enforcable ordinance ID:#{bcv.codeViolated.codeSetElementID}"
                                                             />
                                </div>

                            </div>

                            <div class="ui-g-12 ui-md-12 ui-lg-12 restrict-data-field">

                                <div class="restrict-main-contents-io-title" >
                                    <p:outputLabel  for="violation-severity-som">
                                        <h:outputText value="Violation severity" />
                                    </p:outputLabel>
                                </div>
                                <div class="restrict-main-contents-io-content" >

                                    <h:selectOneMenu id="violation-severity-som"
                                                     value="#{bcv.severityIntensity}" style="width:175px;height:25px">
                                        <f:converter converterId="intensityClassConverter"/>

                                        <f:selectItem itemLabel="select a severity" noSelectionOption="true" />

                                        <f:selectItems id="violation-severity-selitems"
                                                       value="#{ceCaseSearchProfileBB.severityList}"
                                                       var="ic" itemValue="#{ic}" itemLabel="#{ic.numericRating}: #{ic.title}"/>

                                    </h:selectOneMenu>

                                </div>
                            </div>
                            <div class="restrict-main-contents-io-button gray_button">

                                <p:commandButton    id="violation-removefrombatch"
                                                    ajax="true" 
                                                    value="Remove violation" 
                                                    immediate="true" 
                                                    action="#{ceCaseSearchProfileBB.onViolationRemoveFromBatchButtonChange(bcv)}" 
                                                    icon="fa fa-eraser" 
                                                    update="violation-add-form"/>
                            </div>
                        </div>
                        <hr />
                    </ui:repeat>
                </p:scrollPanel>


                <p:spacer height="5px"/>
                <div class="ui-g data_container_nested_restrict">

                    <div class="restrict-main-contents-io-button">


                        <p:commandButton    id="violation-insert-button1"
                                            ajax="false" 
                                            value="Record Violations" 
                                            action="#{ceCaseSearchProfileBB.onViolationAddCommitButtonChange}" 
                                            icon="fa fa-warning" />
                    </div>

                    <div class="restrict-main-contents-io-button gray_button">

                        <p:commandButton    id="violation-insert-abort-button1"
                                            ajax="false" 
                                            value="Cancel" 
                                            process="@none" 
                                            immediate="true" 
                                            action="#{ceCaseSearchProfileBB.onViolationAddAbortButtonChange}" 
                                            icon="fa fa-stop" />
                    </div>
                </div>

        </h:form>
    </p:dialog>


    <p:dialog   id="violation-details-dialog"
                height="600" width="1200"
                widgetVar="violation-details-dialog-var"
                responsive="true"
                resizable="true"
                closable="true"
                modal="true"
                closeOnEscape="true"
                header="Details of Code Violation ID: #{ceCaseSearchProfileBB.currentViolation.violationID}"
                rendered="#{systemServicesBB.bbSessionUser.keyCard.hasMuniReaderPermissions}"
                >

        <h:form id="violation-details-form">

            <h2>

                <h:outputText    id="violation-add-chapter-ot"
                                 value="ch #{ceCaseSearchProfileBB.currentViolation.violatedEnfElement.ordchapterNo}: #{ceCaseSearchProfileBB.currentViolation.violatedEnfElement.ordchapterTitle}"/>

                <h:outputText value=" , " />

                <h:outputText    id="violation-add-section-ot"
                                 value="sec #{ceCaseSearchProfileBB.currentViolation.violatedEnfElement.ordSecNum}: #{ceCaseSearchProfileBB.currentViolation.violatedEnfElement.ordSecTitle}"/>

                <h:outputText value=" , " />

                <h:outputText    id="violation-add-subsection-ot"
                                 value="sub-sec #{ceCaseSearchProfileBB.currentViolation.violatedEnfElement.ordSubSecNum}: #{ceCaseSearchProfileBB.currentViolation.violatedEnfElement.ordSubSecTitle}"/>

                <h:outputText value=" , "
                              rendered="#{!(empty ceCaseSearchProfileBB.currentViolation.violatedEnfElement.ordSubSubSecNum)}"/>

                <h:outputText    id="violation-add-subsubsection-ot"
                                 value="sub sub sec #{ceCaseSearchProfileBB.currentViolation.violatedEnfElement.ordSubSubSecNum}"
                                 rendered="#{!(empty ceCaseSearchProfileBB.currentViolation.violatedEnfElement.ordSubSubSecNum)}"/>
            </h2>

            <!-- Violation status; single line-->
            <div class="ui-g data_container_nested_restrict">
                <div class="ui-g-12 ui-md-12 ui-lg-12 restrict-data-field" >
                    <div class="restrict-main-contents-io-link">

                        <p:commandLink id="violation-ord-details-cl"
                                       oncomplete="PF('violation-ord-details-confdialog-var').show()"
                                       value="Ordinance technical text"
                                       style="color:blue;"
                                       type="button" />

                        <p:commandLink id="violation-nuke-init-cl"
                                       oncomplete="PF('violation-remove-dialog-var').show()"
                                       value="Nuke violation"
                                       style="color:blue;"
                                       type="button" />
                    </div>


                </div>
                <div class="ui-g-12 ui-md-12 ui-lg-12 restrict-data-field" >

                    <div class="restrict-data-field-label-inline" >
                        <p:outputLabel for="violation-status-ot">
                            <h:outputText value="Status"/>
                        </p:outputLabel>
                    </div>
                    <!--NESTED DATA VALUE INLINE -->
                    <div class="restrict-data-field-value-inline" >
                        <h:outputText id="violation-status-ot"
                                      value="#{ceCaseSearchProfileBB.currentViolation.status.label}"
                                      />
                    </div>
                </div>
                <div class="ui-g-12 ui-md-6 ui-lg-6 restrict-data-field" >

                    <div class="restrict-data-field-label-inline" >
                        <p:outputLabel for="violation-prop-ot">
                            <h:outputText value="Property"/>
                        </p:outputLabel>
                    </div>
                    <!--NESTED DATA VALUE INLINE -->
                    <div class="restrict-data-field-value-inline" >
                        <h:outputText id="violation-prop-ot"
                                      value="#{ceCaseSearchProfileBB.currentCase.property.addressString}"
                                      />
                        <h:outputText id="violation-prop1-ot"
                                      value=", #{ceCaseSearchProfileBB.currentCase.property.muni.muniName}"
                                      />
                        <h:outputText id="violation-prop2-ot"
                                      value="(ID:#{ceCaseSearchProfileBB.currentCase.property.propertyID}) "
                                      />
                    </div>
                </div>
                <div class="ui-g-12 ui-md-6 ui-lg-6 restrict-data-field" >

                    <div class="restrict-data-field-label-inline" >
                        <p:outputLabel for="violation-case-ot">
                            <h:outputText value="Case Name"/>
                        </p:outputLabel>
                    </div>
                    <!--NESTED DATA VALUE INLINE -->
                    <div class="restrict-data-field-value-inline" >
                        <h:outputText id="violation-case-ot"
                                      value="#{ceCaseSearchProfileBB.currentCase.caseName}"
                                      />
                        <h:outputText id="violation-case1-ot"
                                      value="(ID:#{ceCaseSearchProfileBB.currentCase.caseID})"
                                      />
                    </div>
                </div>
                <div class="ui-g-12 ui-md-6 ui-lg-4 restrict-data-field" >

                    <div class="restrict-data-field-label-inline" >
                        <p:outputLabel for="violation-ord-id-ot">
                            <h:outputText value="Ordinance ID"/>
                        </p:outputLabel>
                    </div>
                    <!--NESTED DATA VALUE INLINE -->
                    <div class="restrict-data-field-value-inline" >
                        <h:outputText       id="violation-ord-id-ot"
                                            value="#{ceCaseSearchProfileBB.currentViolation.violatedEnfElement.elementID} "/>
                    </div>
                </div>
                <div class="ui-g-12 ui-md-6 ui-lg-4 restrict-data-field" >

                    <div class="restrict-data-field-label-inline" >
                        <p:outputLabel for="violation-source-ot">
                            <h:outputText value="Source "/>
                        </p:outputLabel>
                    </div>
                    <!--NESTED DATA VALUE INLINE -->
                    <div class="restrict-data-field-value-inline" >

                        <h:outputText    id="violation-source-ot"
                                         value="#{ceCaseSearchProfileBB.currentViolation.violatedEnfElement.source.sourceName} (#{ceCaseSearchProfileBB.currentViolation.violatedEnfElement.source.sourceYear})"/>

                    </div>
                </div>
                <div class="ui-g-12 ui-md-6 ui-lg-4 restrict-data-field" >

                    <div class="restrict-data-field-label-inline" >
                        <p:outputLabel for="violation-cat-ot">
                            <h:outputText value="Category "/>
                        </p:outputLabel>
                    </div>
                    <!--NESTED DATA VALUE INLINE -->
                    <div class="restrict-data-field-value-inline" >

                        <h:outputText    id="violation-cat-ot"
                                         value="#{!(empty ceCaseSearchProfileBB.currentViolation.violatedEnfElement.guideEntry) ? ceCaseSearchProfileBB.currentViolation.violatedEnfElement.guideEntry.category :'' }"/>

                    </div>
                </div>

                <div class="ui-g-12 ui-md-12 ui-lg-12 restrict-data-field" >

                    <div class="restrict-data-field-label-inline" >
                        <p:outputLabel for="violation-findings-ot">
                            <h:outputText value="Findings"/>
                        </p:outputLabel>
                    </div>
                    <!--NESTED DATA VALUE INLINE -->
                    <div class="restrict-data-field-value-inline" >
                        <h:outputText id="violation-findings-ot"
                                      value="#{ceCaseSearchProfileBB.currentViolation.description}"
                                      />
                    </div>

                    <div class="restrict-main-contents-io-link">

                        <p:commandLink      id="violation-update-findings-init-cb"
                                            ajax="true"
                                            actionListener="#{ceCaseSearchProfileBB.onViolationUpdateFindingsInitButtonChange}"
                                            oncomplete="PF('violation-update-findings-dialog-var').show()"
                                            disabled="false"
                                            style="color: blue;"
                                            value="Edit findings" />
                    </div>
                </div>

                <div class="ui-g-12 ui-md-6 ui-lg-4 restrict-data-field" >
                    <div class="restrict-data-field-label-inline" >

                        <p:outputLabel for="violation-severity-ot">
                            <h:outputText value="Severity"/>
                        </p:outputLabel>

                    </div>
                    <!--NESTED DATA VALUE INLINE -->
                    <div class="restrict-data-field-value-inline" >

                        <h:outputText    id="violation-severity-ot"
                                         value="#{!(empty ceCaseSearchProfileBB.currentViolation.severityIntensity) ? ceCaseSearchProfileBB.currentViolation.severityIntensity.numericRating : ''}"/>
                        <h:outputText    id="violation-severity-ot1"
                                         value=": "/>
                        <h:outputText    id="violation-severity-ot2"
                                         value="#{!(empty ceCaseSearchProfileBB.currentViolation.severityIntensity) ? ceCaseSearchProfileBB.currentViolation.severityIntensity.title: ''}"/>
                    </div>

                </div>

                <div class="ui-g-12 ui-md-6 ui-lg-4 restrict-data-field" >
                    <div class="restrict-data-field-label-inline" >

                        <p:outputLabel for="violation-penalty-ot">
                            <h:outputText value="Penalty"/>
                        </p:outputLabel>
                    </div>
                    <!--NESTED DATA VALUE INLINE -->
                    <div class="restrict-data-field-value-inline" >
                        <h:outputText    id="violation-penalty-ot"
                                         value="$#{ceCaseSearchProfileBB.currentViolation.penalty}"/>
                    </div>
                </div>

                <div class="ui-g-12 ui-md-6 ui-lg-4 restrict-data-field" >

                    <div class="restrict-main-contents-io-link">

                        <p:commandLink    id="violation-update-penaltyseverity-init-cb"
                                          ajax="true"
                                          actionListener="#{ceCaseSearchProfileBB.onViolationUpdatePenaltySeverityInitButtonChange}"
                                          oncomplete="PF('violation-update-penaltyseverity-dialog-var').show()"
                                          disabled="false"
                                          style="color: blue;"
                                          styleClass="noFill"
                                          value="Edit Penality or Severity" />
                    </div>
                </div>

            </div>

            <!-- DOR, stipdate, and compliance date table-->
            <div class="ui-g data_container_nested_restrict">

                <!--NESTED DATA FIELD VERTICAL-->
                <div class="ui-g-2 ui-md-2 ui-lg-2 restrict-data-field-vertical">
                    <!--NESTED DATA LABEL VERTICAL -->
                    <div class="restrict-data-field-label-vertical" >
                        <h:outputLabel value=" "/>
                    </div>
                    <!--NESTED DATA VALUE VERTICAL -->
                    <div class="restrict-data-field-value-vertical" style="font-weight: 700;">
                        Date:
                    </div>
                    <!--NESTED DATA VALUE VERTICAL -->
                    <div class="restrict-data-field-value-vertical" style="font-weight: 700;">
                        Details:
                    </div>
                    <!--NESTED DATA VALUE VERTICAL -->
                    <div class="restrict-data-field-value-vertical" style="font-weight: 700;">
                        Actions:
                    </div>

                </div>

                <!--NESTED DATA FIELD VERTICAL-->
                <div class="ui-g-2 ui-md-2 ui-lg-2 restrict-data-field-vertical">
                    <!--NESTED DATA LABEL VERTICAL -->
                    <div class="restrict-data-field-label-vertical" >
                        <h:outputLabel value="Violation date of record"/>
                    </div>
                    <!--NESTED DATA VALUE VERTICAL -->
                    <div class="restrict-data-field-value-vertical" >
                        <h:outputText id="propinfo-ot-unfitstart-1"
                                      value="#{ceCaseSearchProfileBB.getPrettyDate(ceCaseSearchProfileBB.currentViolation.dateOfRecord)}" />
                    </div>
                    <!--NESTED DATA VALUE VERTICAL -->
                    <div class="restrict-data-field-value-vertical" >
                        <h:outputText   id="violation-creator-ot0"
                                        value="#{!(empty ceCaseSearchProfileBB.currentViolation.createdBy) ? 'Declared by ' : ''}"/>
                        <h:outputText   id="violation-creator-ot1"
                                        value="#{!(empty ceCaseSearchProfileBB.currentViolation.createdBy) ? ceCaseSearchProfileBB.currentViolation.createdBy.human.name : ''}"/>
                        <h:outputText value=" " />
                    </div>
                    <div class="restrict-main-contents-io-link">

                        <p:commandLink      id="violation-update-dor-init-cb"
                                            ajax="true"
                                            actionListener="#{ceCaseSearchProfileBB.onViolationUpdateDORInitButtonChange}"
                                            oncomplete="PF('violation-update-dor-dialog-var').show()"
                                            disabled="false"
                                            style="color: blue;"
                                            styleClass="noFill"
                                            value="Change Date of Record" />


                    </div>



                </div>

                <!--NESTED DATA FIELD VERTICAL-->
                <div class="ui-g-2 ui-md-2 ui-lg-2 restrict-data-field-vertical">
                    <!--NESTED DATA LABEL VERTICAL -->
                    <div class="restrict-data-field-label-vertical" >
                        <h:outputLabel value="Stipulated compliance"/>
                    </div>
                    <!--NESTED DATA VALUE VERTICAL -->
                    <div class="restrict-data-field-value-vertical" >
                        <h:outputText   id="violation-stipcompdate-ot"
                                        value="#{ceCaseSearchProfileBB.getPrettyDate(ceCaseSearchProfileBB.currentViolation.stipulatedComplianceDate)}"/>
                        <h:outputText value=" " />
                    </div>
                    <!--NESTED DATA VALUE VERTICAL -->
                    <div class="restrict-data-field-value-vertical" >
                        <h:outputText value=" " />
                    </div>

                    <div class="restrict-main-contents-io-link">
                        <p:commandLink    id="violation-update-stipdate-init-cb" 
                                          ajax="true" 
                                          actionListener="#{ceCaseSearchProfileBB.onViolationUpdateStipDateInitButtonChange}"
                                          oncomplete="PF('violation-update-stipdate-dialog-var').show()"
                                          disabled="#{!(empty ceCaseSearchProfileBB.currentViolation.actualComplianceDate)}"
                                          style="color: blue;"
                                          styleClass="noFill"
                                          value="Change Stip. Comp. Date"
                                          update="violation-update-stipdate-dialog
                                          violation-update-stipdate-form"/>



                    </div>
                </div>

                <!--NESTED DATA FIELD VERTICAL-->
                <div class="ui-g-2 ui-md-2 ui-lg-2 restrict-data-field-vertical">
                    <!--NESTED DATA LABEL VERTICAL -->
                    <div class="restrict-data-field-label-vertical" >
                        <h:outputLabel      for="violation-compdate-ot"
                                            value="Compliance achieved"/>
                    </div>
                    <!--NESTED DATA VALUE VERTICAL -->
                    <div class="restrict-data-field-value-vertical" >
                        <h:outputText   id="violation-compdate-ot"
                                        value="#{ceCaseSearchProfileBB.getPrettyDate(ceCaseSearchProfileBB.currentViolation.actualComplianceDate)}"/>
                        <h:outputText value=" " />

                    </div>
                    <!--NESTED DATA VALUE VERTICAL -->
                    <div class="restrict-data-field-value-vertical" >
                        <h:outputText   id="violation-compby-ot0"
                                        value="#{!(empty ceCaseSearchProfileBB.currentViolation.complianceUser) ? 'Certified by user ' : ''}"/>
                        <h:outputText   id="violation-compby-ot1"
                                        value="#{!(empty ceCaseSearchProfileBB.currentViolation.complianceUser) ? ceCaseSearchProfileBB.currentViolation.complianceUser.human.firstName : ''}"/>
                        <h:outputText   id="violation-compby-ot2"
                                        value=" "/>
                        <h:outputText   id="violation-compby-ot3"
                                        value="#{!(empty ceCaseSearchProfileBB.currentViolation.complianceUser) ? ceCaseSearchProfileBB.currentViolation.complianceUser.human.lastName : ''}"/>
                        <p:spacer height="3px" />
                        <h:outputText   id="violation-comp-notes-ot0"
                                        value="#{!(empty ceCaseSearchProfileBB.currentViolation.complianceNote) ? 'Note: ' : ''}"/>
                        <h:outputText   id="violation-comp-notes-ot1"
                                        value="#{ceCaseSearchProfileBB.currentViolation.complianceNote}"/>
                        <h:outputText value=" " />
                    </div>


                    <div class="restrict-data-field-value-vertical" >
                        <p:commandButton    id="violation-compliance-fromdetails-init-cb"
                                            ajax="true"
                                            actionListener="#{ceCaseSearchProfileBB.onViolationRecordComplianceInitButtonChange}"
                                            oncomplete="PF('violation-compliance-dialog-var').show()"
                                            disabled="false"
                                            icon="fa fa-edit"
                                            styleClass="noFill"
                                            value="Record Compliance" />


                    </div>
                </div>
                <!--NESTED DATA FIELD VERTICAL-->
                <div class="ui-g-2 ui-md-2 ui-lg-2 restrict-data-field-vertical">
                    <!--NESTED DATA LABEL VERTICAL -->
                    <div class="restrict-data-field-label-vertical" >
                        <h:outputLabel      for="nullified-ts-ot"
                                            value="Nullified"/>
                    </div>
                    <!--NESTED DATA VALUE VERTICAL -->
                    <div class="restrict-data-field-value-vertical" >
                        <h:outputText   id="nullified-ts-ot"
                                        value="#{ceCaseSearchProfileBB.getPrettyDate(ceCaseSearchProfileBB.currentViolation.nullifiedTS)}"/>
                        <h:outputText value=" " />

                    </div>
                    <!--NESTED DATA VALUE VERTICAL -->
                    <div class="restrict-data-field-value-vertical" >
                        <h:outputText   id="violation-nullifiedby-ot0"
                                        value="#{!(empty ceCaseSearchProfileBB.currentViolation.nullifiedUser) ? 'Nullified by user ' : ''}"/>
                        <h:outputText   id="violation-nullifiedby-ot1"
                                        value="#{!(empty ceCaseSearchProfileBB.currentViolation.nullifiedUser) ? ceCaseSearchProfileBB.currentViolation.nullifiedUser.human.firstName : ''}"/>
                        <h:outputText   id="violation-nullifiedby-ot2"
                                        value=" "/>
                        <h:outputText   id="violation-nullifiedby-ot3"
                                        value="#{!(empty ceCaseSearchProfileBB.currentViolation.nullifiedUser) ? ceCaseSearchProfileBB.currentViolation.nullifiedUser.human.lastName : ''}"/>
                        <h:outputText value=" " />

                    </div>

                    <div class="restrict-main-contents-io-link">
                        <p:commandLink    id="violation-nullify-init-cb"
                                          ajax="true"
                                          actionListener="#{ceCaseSearchProfileBB.onViolationNullifyInitButtonChange}"
                                          oncomplete="PF('violation-nullify-dialog-var').show()"
                                          disabled="false"
                                          style="color: blue;"
                                          styleClass="noFill"
                                          value="Nullify Violation" />


                    </div>
                </div>
            </div>

        </h:form>
    </p:dialog>

    <p:confirmDialog id="violation-ord-details-confdialog"
                     widgetVar="violation-ord-details-confdialog-var"
                     closeOnEscape="true"
                     closable="true"
                     responsive="true">

        >
        <div class="ui-g data_container_nested_restrict">
            <div class="ui-g-12 ui-md-6 ui-lg-4 restrict-data-field" >
                <div class="restrict-data-field-label-inline" >

                    <h:outputLabel  for="violation-ord-text-hf"
                                    styleClass="data_field_label" >
                        <h:outputText value="Ordinance Text" />
                    </h:outputLabel>
                </div>
                <div class="restrict-data-field-value-inline" >


                    <h:outputText   id="violation-add-ord-text"
                                    styleClass="monospace"
                                    value="#{ceCaseSearchProfileBB.currentViolation.violatedEnfElement.ordTechnicalText}"
                                    escape="false" />
                </div>
            </div>
            <div class="ui-g-12 ui-md-6 ui-lg-4 restrict-data-field" >

                <div class="restrict-data-field-label-inline" >

                    <p:outputLabel for="violation-enfguidelines-ot"
                                   styleClass="data_field_label">
                        <h:outputText value="Enforcement Guidelines"/>
                    </p:outputLabel>
                </div>
                <div class="restrict-data-field-value-inline" >

                    <h:outputText    id="violation-enfguidelines-ot"
                                     styleClass="data_field_value"
                                     value="#{!(empty ceCaseSearchProfileBB.currentViolation.violatedEnfElement.guideEntry) ? ceCaseSearchProfileBB.currentViolation.violatedEnfElement.guideEntry.enforcementGuidelines :'' }"/>
                </div>
            </div>
        </div>
    </p:confirmDialog>



    <p:dialog   id="violation-update-stipdate-dialog"
                height="700" width="500"
                widgetVar="violation-update-stipdate-dialog-var"
                responsive="true"
                modal="true"
                resizable="true"
                closable="true"
                closeOnEscape="true"
                header="Extend compliance timeframe for violation ID: #{ceCaseSearchProfileBB.currentViolation.violationID}"
                rendered="#{systemServicesBB.bbSessionUser.keyCard.hasEnfOfficialPermissions}"
                >

        <h:form id="violation-update-stipdate-form">
            <h4>Current Compliance date</h4>
            <p>
                <h:outputText value="#{ceCaseSearchProfileBB.getPrettyDate(ceCaseSearchProfileBB.currentViolation.stipulatedComplianceDate)} "/>
            </p>

            <div class="ui-g data_container_nested_restrict">

                <div class="ui-g-12 ui-md-12 ui-lg-12 restrict-data-field">


                    <div class="restrict-main-contents-io-title" >

                        <p:outputLabel for="update-stipdate-sbb"
                                       styleClass="data_field_label">
                            <h:outputText value="Select an extension method:"/>
                        </p:outputLabel>
                    </div>
                    <div class="restrict-main-contents-io-content" >

                        <p:selectBooleanButton id="violation-update-stipdate-sbb"
                                               onLabel="Pick a date"
                                               offLabel="Enter a number of days from today"
                                               styleClass="selectButton"
                                               value="#{ceCaseSearchProfileBB.extendStipCompUsingDate}"
                                               >
                            <p:ajax update="update-stipdate-cal
                                    update-stipdate-numdays-it" />
                        </p:selectBooleanButton>
                    </div>

                </div>
                <div class="ui-g-12 ui-md-12 ui-lg-12 restrict-data-field">

                    <div class="restrict-main-contents-io-title" >
                        <h:outputLabel for="update-stipdate-cal">
                            <h:outputText value="New stipulated compliance date"/>
                        </h:outputLabel>
                    </div>

                    <div class="restrict-main-contents-io-content" >
                        <p:growl for="update-stipdate-cal"/>


                        <p:calendar id="update-stipdate-cal"
                                    value="#{ceCaseSearchProfileBB.extendedStipCompDate}"
                                    disabled="#{!ceCaseSearchProfileBB.extendStipCompUsingDate}"
                                    mode="popup"
                                    showOn="button"
                                    pattern="EEE, dd MMM, yyyy HH:mm:ss"
                                    navigator="true"
                                    tabindex="1"
                                    timeInput="true"
                                    showHour="true"
                                    showMinute="true"
                                    showButtonPanel="true"
                                    showTodayButton="true"
                                    required="true"/>
                    </div>
                </div>


                <div class="ui-g-12 ui-md-12 ui-lg-12 restrict-data-field">
                    <div class="restrict-main-contents-io-title" >

                        <p:outputLabel  for="update-stipdate-numdays-it"
                                        value="Set new compliance date this Number of days from today"/>
                    </div>

                    <div class="restrict-main-contents-io-content" >

                        <p:inputText id="update-stipdate-numdays-it"
                                     disabled="#{ceCaseSearchProfileBB.extendStipCompUsingDate}"
                                     value="#{ceCaseSearchProfileBB.extendedStipCompDaysFromToday}"
                                     style="width: 50px;"
                                     tabindex="3"
                                     type="number"
                                     required="false"
                                     styleClass="inputText"/>

                        <h:message for="update-stipdate-numdays-it" showDetail="false" showSummary="true"
                                   warnClass="msgWarn" infoClass="msgInfo" fatalClass="msgFatal" errorClass="msgError" />

                    </div>

                </div>
            </div>

            <p:commandButton
                id="update-stipdate-sbb"
                icon="fa fa-calendar"
                ajax="false"
                action="#{ceCaseSearchProfileBB.onViolationExtendStipCompDateCommitButtonChange}"
                value="Change Stipulated Complaince Date"
                disabled="false"
                update="form-messages-growl"
                />
            <p:spacer height="5px" />

            <p:commandButton    id="violation-update-stipdate-cancel-button"
                                ajax="true"  tabindex="27"
                                value="Cancel"
                                icon="fa fa-stop"
                                immediate="true"
                                process="@none"
                                onclick="PF('violation-update-stipdate-dialog-var').hide()"
                                />



        </h:form>

    </p:dialog>

    <p:dialog   id="violation-update-dor-dialog"
                height="400" width="400"
                widgetVar="violation-update-dor-dialog-var"
                responsive="true"
                resizable="true"
                modal="true"
                closable="true"
                closeOnEscape="true"
                header="Update stipulated compliance date on violation ID: #{ceCaseSearchProfileBB.currentViolation.violationID}"
                rendered="#{systemServicesBB.bbSessionUser.keyCard.hasEnfOfficialPermissions}"
                >

        <h:form id="violation-update-dor-form">

            <div class="ui-g data_container_nested_restrict">
                <div class="ui-g-12 ui-md-12 ui-lg-12 restrict-data-field">

                    <div class="restrict-main-contents-io-title" >
                        <h:outputLabel for="violation-update-dor-cal">
                            <h:outputText value="Date of Record"/>
                        </h:outputLabel>
                    </div>

                    <div class="restrict-main-contents-io-content" >
                        <p:growl for="viol-date-update-dor" />
                        <p:calendar id="violation-update-dor-cal"
                                    value="#{ceCaseSearchProfileBB.currentViolation.dateOfRecordUtilDate}"
                                    disabled="#{!ceCaseSearchProfileBB.currentViolation.allowDORUpdate}"
                                    mode="popup"
                                    showOn="button"
                                    pattern="EEE, dd MMM, yyyy HH:mm:ss"
                                    navigator="true"
                                    tabindex="2"
                                    timeInput="true"
                                    showHour="true"
                                    showMinute="true"
                                    showButtonPanel="true"
                                    showTodayButton="true"
                                    required="true"/>
                    </div>
                </div>

                <div class="restrict-main-contents-io-button">


                    <p:commandButton
                        id="violation-update-dor-commit-button"
                        icon="fa fa-edit"
                        ajax="false"
                        action="#{ceCaseSearchProfileBB.onViolationUpdateDORCommitButtonChange}"
                        value="Update Date of Record for Violation ID:#{ceCaseSearchProfileBB.currentViolation.violationID}"
                        />
                </div>

                <div class="restrict-main-contents-io-button gray_button">


                    <p:commandButton    id="violation-update-dor-cancel-button"
                                        ajax="true"  tabindex="27"
                                        value="Cancel"
                                        icon="fa fa-stop"
                                        immediate="true"
                                        process="@none"
                                        onclick="PF('violation-update-dor-dialog-var').hide()"
                                        />


                </div>
            </div>
        </h:form>
    </p:dialog>

    <p:dialog   id="violation-compliance-dialog"
                height="600" width="600"
                widgetVar="violation-compliance-dialog-var"
                responsive="true"
                modal="true"
                resizable="true"
                closable="true"
                closeOnEscape="true"
                header="Record compliance with violation ID: #{ceCaseSearchProfileBB.currentViolation.violationID}"
                rendered="#{systemServicesBB.bbSessionUser.keyCard.hasEnfOfficialPermissions}"
                >


        <h:form id="violation-compliance-form">

            <div class="ui-g data_container_nested_restrict">

                <div class="ui-g-12 ui-md-12 ui-lg-12 restrict-data-field">


                    <div class="restrict-main-contents-io-title" >

                        <p:outputLabel for="violation-compliance-it">
                            <h:outputText value="Describe the mitigation actions taken"/>
                        </p:outputLabel>
                    </div>
                    <div class="restrict-main-contents-io-content" >

                        <p:inputTextarea id="violation-compliance-it"
                                         required="true"
                                         value="#{ceCaseSearchProfileBB.currentViolation.complianceNote}" />

                    </div>

                </div>
                <div class="ui-g-12 ui-md-12 ui-lg-12 restrict-data-field">

                    <div class="restrict-main-contents-io-title" >
                        <h:outputLabel for="violation-compliance-dor">
                            <h:outputText value="Compliance date of record"/>
                        </h:outputLabel>
                    </div>

                    <div class="restrict-main-contents-io-content" >
                        <p:growl for="violation-compliance-dor"/>


                        <p:calendar id="violation-compliance-dor"
                                    value="#{ceCaseSearchProfileBB.complianceDateForm}"
                                    disabled="false"
                                    mode="popup"
                                    showOn="button"
                                    pattern="EEE, dd MMM, yyyy HH:mm:ss"
                                    navigator="true"
                                    tabindex="1"
                                    timeInput="true"
                                    showHour="true"
                                    showMinute="true"
                                    showButtonPanel="true"
                                    showTodayButton="true"
                                    required="true"/>
                    </div>
                </div>


            </div>

            <p:spacer height="5px" />

            <p:commandButton
                icon="fa fa-check-circle-o"
                ajax="false"
                action="#{ceCaseSearchProfileBB.onViolationRecordComplianceCommitButtonChange}"
                value="Record compliance"
                update="messages-global-form"
                />

        </h:form>

    </p:dialog>


    <p:dialog   id="violation-update-penaltyseverity-dialog"
                height="400" width="600"
                widgetVar="violation-update-penaltyseverity-dialog-var"
                responsive="true"
                modal="true"
                resizable="true"
                closable="true"
                closeOnEscape="true"
                header="Update penality and severity on violation ID: #{ceCaseSearchProfileBB.currentViolation.violationID}"
                rendered="#{systemServicesBB.bbSessionUser.keyCard.hasEnfOfficialPermissions}"
                >

        <h:form id="violation-update-penalityseverity-form">
            <div class="ui-g data_container_nested_restrict">
                <div class="ui-g-12 ui-md-12 ui-lg-12 restrict-data-field">

                    <div class="restrict-main-contents-io-title" >
                        <p:outputLabel  for="violation-severity-update-som">
                            <h:outputText value="Violation severity" />
                        </p:outputLabel>
                    </div>
                    <div class="restrict-main-contents-io-content" >

                        <h:selectOneMenu id="violation-severity-update-som"
                                         value="#{ceCaseSearchProfileBB.currentViolation.severityIntensity}" style="width:175px;height:25px">
                            <f:converter converterId="intensityClassConverter"/>

                            <f:selectItem itemLabel="select a severity" noSelectionOption="true" />

                            <f:selectItems id="violation-severity-update-selitems"
                                           value="#{ceCaseSearchProfileBB.severityList}"
                                           var="ic" itemValue="#{ic}" itemLabel="#{ic.numericRating}: #{ic.title}"/>
                        </h:selectOneMenu>

                    </div>
                </div>

                <div class="ui-g-12 ui-md-12 ui-lg-12 restrict-data-field">

                    <div class="restrict-main-contents-io-title" >

                        <p:outputLabel for="viol-penalty">
                            <h:outputText value="Penalty ($)"/>
                        </p:outputLabel>
                    </div>
                    <div class="restrict-main-contents-io-content" >
                        <p:growl for="viol-penalty" />
                        <p:inputText id="viol-penalty"
                                     value="#{ceCaseSearchProfileBB.currentViolation.penalty}"
                                     tabindex="3"
                                     required="true"
                                     type="number"/>
                    </div>

                </div>

                <div class="restrict-main-contents-io-button">


                    <p:commandButton
                        id="violation-update-penaltyseverity-commit-button"
                        icon="fa fa-edit"
                        ajax="false"
                        action="#{ceCaseSearchProfileBB.onViolationUpdatePenaltySeverityCommitButtonChange()}"
                        value="Update Violation ID:#{ceCaseSearchProfileBB.currentViolation.violationID}"
                        />
                </div>

                <div class="restrict-main-contents-io-button gray_button">


                    <p:commandButton    id="violation-update-penalityseverity-cancel-button"
                                        ajax="true"  tabindex="27"
                                        value="Cancel"
                                        icon="fa fa-stop"
                                        immediate="true"
                                        process="@none"
                                        onclick="PF('violation-update-penaltyseverity-dialog-var').hide()"
                                        />


                </div>
            </div>
        </h:form>
    </p:dialog>



    <p:dialog   id="violation-update-findings-dialog"
                height="400" width="800"
                widgetVar="violation-update-findings-dialog-var"
                responsive="true"
                resizable="true"
                modal="true"
                closable="true"
                closeOnEscape="true"
                header="Update findings on violation ID: #{ceCaseSearchProfileBB.currentViolation.violationID}"
                rendered="#{systemServicesBB.bbSessionUser.keyCard.hasEnfOfficialPermissions}"
                >

        <h:form id="violation-update-findings-form">


            <div class="ui-g data_container_nested_restrict">

                <div class="ui-g-12 ui-md-12 ui-lg-12 restrict-data-field">


                    <div class="restrict-main-contents-io-title" >

                        <p:outputLabel for="violation-findings-it">
                            <h:outputText value="Violation findings"/>
                        </p:outputLabel>
                    </div>
                    <div class="restrict-main-contents-io-content" >

                        <p:inputTextarea id="violation-findings-it"
                                         required="true"
                                         value="#{ceCaseSearchProfileBB.currentViolation.description}" />

                    </div>

                </div>

                <div class="ui-g-12 ui-md-12 ui-lg-12 restrict-data-field">

                    <div class="restrict-main-contents-io-content" >
                        <p:selectBooleanCheckbox id="violation-findings-makedefault-chkbx"
                                                 value="#{ceCaseSearchProfileBB.formMakeFindingsDefault}"
                                                 itemLabel="Make these findings the default for enforcable ordinance ID:#{ceCaseSearchProfileBB.currentViolation.codeViolated.codeSetElementID}"
                                                 />
                    </div>

                </div>

                <div class="ui-g-12 ui-md-12 ui-lg-12 restrict-data-field">
                    <div class="restrict-main-contents-io-button">


                        <p:commandButton
                            id="violation-update-findings-commit-button"
                            icon="fa fa-edit"
                            ajax="false"
                            action="#{ceCaseSearchProfileBB.onViolationUpdateFindingsCommitButtonChange}"
                            value="Update findings on violation ID:#{ceCaseSearchProfileBB.currentViolation.violationID}"
                            />
                    </div>

                    <div class="restrict-main-contents-io-button gray_button">


                        <p:commandButton    id="violation-update-findings-cancel-button"
                                            ajax="true"
                                            tabindex="27"
                                            value="Cancel"
                                            icon="fa fa-stop"
                                            immediate="true"
                                            process="@none"
                                            onclick="PF('violation-update-findings-dialog-var').hide()"
                                            />


                    </div>
                </div>
            </div>
        </h:form>
    </p:dialog>



    <p:dialog   id="violation-remove-dialog"
                height="800" width="1600"
                widgetVar="violation-remove-dialog-var"
                responsive="true"
                modal="true"
                resizable="true"
                closable="true"
                closeOnEscape="true"
                header="Nuke Violation"
                rendered="#{systemServicesBB.bbSessionUser.keyCard.hasEnfOfficialPermissions}"
                >

        <h:form id="violation-remove-form">

            <div class="ui-g data_container_nested_restrict">
                <div class="ui-g-12 ui-md-6 ui-lg-4 restrict-data-field" >
                    <div class="restrict-data-field-label-inline" >

                        <h:outputLabel  for="violation-remove-button">
                            <h:outputText value="Violations cannot be nuked if they have been used in a notice of violation or citation." />
                        </h:outputLabel>
                    </div>
                </div>
                <div class="ui-g-12 ui-md-6 ui-lg-4 restrict-data-field" >

                    <div class="restrict-main-contents-io-button red_button">


                        <p:commandButton
                            id="violation-remove-button"
                            icon="fa fa-trash"
                            ajax="false"
                            action="#{ceCaseSearchProfileBB.onViolationRemoveCommitButtonChange}"
                            value="Remove Violation ID:#{ceCaseSearchProfileBB.currentViolation.violationID}"
                            />
                    </div>

                    <div class="restrict-main-contents-io-button gray_button">


                        <p:commandButton    id="violation-nuke-cancel-button"
                                            ajax="true"
                                            tabindex="27"
                                            value="Cancel"
                                            icon="fa fa-stop"
                                            immediate="true"
                                            process="@none"
                                            onclick="PF('violation-remove-dialog-var').hide()"
                                            />


                    </div>
                </div>
            </div>

        </h:form>

    </p:dialog>


    <p:dialog   id="violation-nullify-dialog"
                height="300" width="600"
                widgetVar="violation-nullify-dialog-var"
                responsive="true"
                resizable="true"
                closable="true"
                modal="true"
                closeOnEscape="true"
                header="Nullify Violation"
                rendered="#{systemServicesBB.bbSessionUser.keyCard.hasEnfOfficialPermissions}"
                >
        <h:form id="violation-nullify-form">

            <div class="ui-g data_container_nested_restrict">
                <div class="ui-g-12 ui-md-12 ui-lg-12 restrict-data-field" >
                    <div class="restrict-data-field-label-inline" >

                        <h:outputLabel  for="violation-nullify-button">
                            <h:outputText value="Nullify a code violation that was once legitimate but is no longer relevant for case closure." />
                        </h:outputLabel>
                    </div>
                </div>
                <div class="ui-g-12 ui-md-12 ui-lg-12 restrict-data-field" >

                    <div class="restrict-main-contents-io-button red_button">


                        <p:commandButton
                            id="violation-nullify-button"
                            icon="fa fa-trash"
                            ajax="false"
                            action="#{ceCaseSearchProfileBB.onViolationNullifyCommitButtonChange}"
                            value="Nullify Violation ID:#{ceCaseSearchProfileBB.currentViolation.violationID}"
                            />
                    </div>


                    <div class="restrict-main-contents-io-button gray_button">


                        <p:commandButton    id="violation-nullify-cancel-button"
                                            ajax="true"
                                            tabindex="27"
                                            value="Cancel"
                                            icon="fa fa-stop"
                                            immediate="true"
                                            process="@none"
                                            onclick="PF('violation-nullify-dialog-var').hide()"
                                            />


                    </div>
                </div>
            </div>

        </h:form>

    </p:dialog>



    <p:dialog   id="violation-photos-dialog"
                height="800" width="1600"
                widgetVar="violation-photos-dialog-var"
                responsive="true"
                modal="true"
                resizable="true"
                closable="true"
                closeOnEscape="true"
                header="Violation Photos"
                rendered="#{systemServicesBB.bbSessionUser.keyCard.hasEnfOfficialPermissions}"
                >

        <h:form id="violationPhotosUploadForm" enctype="multipart/form-data">
            <h2>Photos of this violation (3 max)</h2>
            <p>You must insert violation and re-enter this violation page, then select the violation and click "Update" mode to add photos.</p>
            <p:fileUpload
                mode="advanced"
                update="violation-photos-form:photoTable"
                multiple="true"
                fileLimit="3"
                sizeLimit="99999999999"
                allowTypes="/(\.|\/)(jpe?g|png)$/"
                rendered="#{ceCaseSearchProfileBB.activeUpdateMode}"/>
        </h:form>

        <h:form id="violation-photos-form">
            <p:spacer height="10px"/>

            <h2>Review and describe uploaded photos</h2>
            <p:dataTable
                id="photoTable"
                var="photo"
                value="#{ceCaseSearchProfileBB.currentViolation.blobList}"
                rowKey="#{photo.blobID}"
                tableStyleClass="primeDataTable"
                draggableRows="false" tabindex="6">
                <p:column width="70%">
                    <f:facet name="header">
                        <h:outputText value="Photo"/>
                    </f:facet>
                    <p:graphicImage width="100%" value="#{blobCoordinator.image}">
                        <f:param name="blobID" value="#{photo.blobID}"/>
                    </p:graphicImage>

                    <p:commandButton   id="photo-delete-button"
                                       rendered="true"
                                       value="Delete Photo"
                                       icon="fa fa-eraser"
                                       ajax="true"
                                       update="messages-global-form"
                                       actionListener="#{ceCaseSearchProfileBB.onPhotoRemoveButtonChange(photo.blobID)}"
                                       />

                </p:column>
                <p:column>
                    <f:facet name="header">
                        <h:outputText value="Description"/>
                    </f:facet>
                    <p:inputTextarea id="desc" value="#{photo.description}"
                                     style="width: 100%;" tabindex="5" required="true" styleClass="inputText">
                        <p:ajax />
                    </p:inputTextarea>
                    <p:growl    id="photo-desc-growl"
                                for="photo-updatedescr-button" />

                    <p:commandButton   id="photo-updatedescr-button"
                                       rendered="true"
                                       value="Update Desc"
                                       icon="fa fa-edit"
                                       ajax="true"
                                       update="messages-global-form"
                                       actionListener="#{ceCaseSearchProfileBB.onPhotoUpdateDescription(photo)}"
                                       />

                </p:column>

            </p:dataTable>

            <p:spacer height="10px"/>


        </h:form>

    </p:dialog>



    <p:dialog   id="violation-notes-dialog"
                height="800" width="1600"
                widgetVar="violation-notes-dialog-var"
                responsive="true"
                resizable="true"
                closable="true"
                closeOnEscape="true"
                modal="true"
                header="Violation notes"
                rendered="#{systemServicesBB.bbSessionUser.keyCard.hasEnfOfficialPermissions}"
                >

        <h:form id="violation-notes-form">

            <h:outputText styleClass="ui-label" value="Note text: "/>
            <p:textEditor   id="violation-notes-editor"
                            value="#{ceCaseSearchProfileBB.formNoteText}"
                            required="false"
                            secure="false"
                            height="200"/>


            <p:spacer height="5px" />
            <p:commandButton    id="violation-note-button-cancel"
                                ajax="true"  tabindex="27"
                                value="Cancel"
                                process="@none"
                                icon="fa fa-stop"
                                immediate="true"
                                onclick="PF('violation-notes-dialog-var').hide()"
                                />

            <p:commandButton   id="violation-dialog-notes-button-addnote"
                               ajax="true"
                               actionListener="#{ceCaseSearchProfileBB.onViolationNoteCommitButtonChange}"
                               oncomplete="PF('violation-notes-dialog-var').hide()"
                               rendered="#{systemServicesBB.bbSessionUser.keyCard.hasMuniStaffPermissions}"
                               value="Attach Note"
                               styleClass="inline-button"
                               icon="fa fa-sticky-note-o"
                               update="violation-notes-form"/>

            <p:spacer height="5px" />
            <h2>
                <h:outputText  value="Notes on violatio ID #{ceCaseSearchProfileBB.currentViolation.violationID}" />
            </h2>
            <h:outputText id="violation-note-ot"
                          value="#{ceCaseSearchProfileBB.currentViolation.notes}"
                          escape="false" />

        </h:form>

    </p:dialog>


    <p:dialog   id="violation-selectelement-dialog"
                height="1000" width="1200"
                widgetVar="violation-selectelement-dialog-var"
                responsive="true"
                modal="true"
                resizable="true"
                closable="true"
                closeOnEscape="true"
                header="Choose Ordinance"
                rendered="#{systemServicesBB.bbSessionUser.keyCard.hasEnfOfficialPermissions}"
                >

        <h:form id="violation-selectelement-form">
            <p:commandButton    id="viol-selectelement-done-cb"
                                ajax="true"  
                                tabindex="27"
                                value="Add selected violations"
                                icon="fa fa-check"
                                actionListener="#{ceCaseSearchProfileBB.onOrdinanceSelectionCompleteButtonChange}"
                                oncomplete="PF('violation-add-dialog-var').show()"
                                update="violation-add-form"/>

            <p:spacer height="5px" />

            <p:dataTable
                id="enforcableCodeSetElementTable"
                var="cse"
                value="#{ceCaseSearchProfileBB.currentCodeSet.enfCodeElementList}"
                rowKey="#{cse.codeSetElementID}"
                tableStyleClass="primeDataTable"
                scrollable="true"
                resizableColumns="true"
                draggableColumns="true"
                rowExpandMode="single"
                selection="#{ceCaseSearchProfileBB.selectedElementList}"
                filteredValue="#{ceCaseSearchProfileBB.filteredElementList}"
                expandedRow="false"
                widgetVar="codeSetElementListTable">

                <p:column   selectionMode="multiple" 
                            style="width:16px;text-align:center"/>

                <p:column width="3%">
                    <f:facet name="header">
                        <h:outputText value="Exp"/>
                    </f:facet>
                    <p:rowToggler/>
                </p:column>



                <p:column width="10%" sortBy="#{cse.source.sourceName}"
                          filterBy="#{cse.source.sourceName}">
                    <f:facet name="header">
                        <h:outputText value="Source" />
                    </f:facet>
                    <h:outputText value="#{cse.source.sourceName}(#{cse.source.sourceYear})"/>
                </p:column>

                <p:column width="5%"
                          sortBy="#{cse.ordchapterNo}">
                    <f:facet name="header">
                        <h:outputText value="Chap#"/>
                    </f:facet>
                    <h:outputText value="#{cse.ordchapterNo}"/>
                </p:column>

                <p:column width="15%" sortBy="#{cse.ordchapterTitle}"
                          filterBy="#{cse.ordchapterTitle}">
                    <f:facet name="header">
                        <h:outputText value="Chapter"/>
                    </f:facet>
                    <h:outputText value="#{cse.ordchapterTitle}"/>
                </p:column>

                <p:column width="5%" sortBy="#{cse.ordSecNum}">
                    <f:facet name="header">
                        <h:outputText value="Sec#" />
                    </f:facet>
                    <h:outputText value="#{cse.ordSecNum}"/>
                </p:column>

                <p:column width="15%" sortBy="#{cse.ordSecTitle}"
                          filterBy="#{cse.ordSecTitle}">
                    <f:facet name="header">
                        <h:outputText value="Section" />
                    </f:facet>
                    <h:outputText value="#{cse.ordSecTitle}"/>
                </p:column>

                <p:column width="5%" sortBy="#{cse.ordSubSecNum}">
                    <f:facet name="header">
                        <h:outputText value="Sub#" />
                    </f:facet>
                    <h:outputText value="#{cse.ordSubSecNum}"/>
                </p:column>

                <p:column sortBy="#{cse.ordSubSecTitle}"
                          filterBy="#{cse.ordSubSecTitle}"
                          width="15%">
                    <f:facet name="header">
                        <h:outputText value="SubSec. Title" />
                    </f:facet>
                    <h:outputText value="#{cse.ordSubSecTitle}"/>
                </p:column>

                <p:column width="10%" sortBy="#{cse.guideEntry.category}"
                          filterBy="#{cse.guideEntry.category}">
                    <f:facet name="header">
                        <h:outputText value="Category" />
                    </f:facet>
                    <h:outputText value="#{cse.guideEntry.category}"/>
                </p:column>

                <p:rowExpansion>
                    <div class="outlinedBox">


                        <h2>Details</h2>
                        <h:outputText escape="false" value="Code element ID: #{cse.elementID}"/>

                        <h2>Enforceability Info</h2>
                        <h:outputLabel styleClass="bold" value="Munimum Penalty"/>
                        <p:spacer height="15px"/>
                        <div class="rowExpansion">
                            <h:outputText escape="false" value="$#{cse.minPenalty}"/>
                        </div>

                        <h:outputLabel styleClass="bold" value="Norm Penalty"/>
                        <p:spacer height="15px"/>
                        <div class="rowExpansion">
                            <h:outputText escape="false" value="$#{cse.normPenalty}"/>
                        </div>

                        <h:outputLabel styleClass="bold" value="Maximum Penalty"/>
                        <p:spacer height="15px"/>
                        <div class="rowExpansion">
                            <h:outputText escape="false" value="$#{cse.maxPenalty}"/>
                        </div>

                        <h:outputLabel styleClass="bold" value="Penalty Notes"/>
                        <p:spacer height="15px"/>
                        <div class="rowExpansion">
                            <h:outputText escape="false" value="#{cse.penaltyNotes}"/>
                        </div>

                        <h:outputLabel styleClass="bold" value="Default days to comply"/>
                        <p:spacer height="15px"/>
                        <div class="rowExpansion">
                            <h:outputText escape="false" value="#{cse.normDaysToComply}"/>
                        </div>

                        <h:outputLabel styleClass="bold" value="Compliance timeframe Notes"/>
                        <p:spacer height="15px"/>
                        <div class="rowExpansion">
                            <h:outputText escape="false" value="#{cse.daysToComplyNotes}"/>
                        </div>

                        <h:outputLabel styleClass="bold" value="Municipality specific implementation notes"/>
                        <p:spacer height="15px"/>
                        <div class="rowExpansion">
                            <h:outputText escape="false" value="#{cse.muniSpecificNotes}"/>
                        </div>
                    </div>

                    <div class="outlinedBox">
                        <h2>Code Element Content</h2>

                        <h:outputLabel styleClass="bold" value="Technical Text"/>
                        <p:spacer height="15px"/>
                        <div class="rowExpansion">
                            <h:outputText escape="false" value="#{cse.ordTechnicalText}"/>
                        </div>

                        <p:spacer height="15px"/>

                        <h:outputLabel styleClass="bold" value="Human friendly text"/>
                        <div class="rowExpansion">
                            <h:outputText escape="false" value="#{cse.ordHumanFriendlyText}"/>
                        </div>
                        <p:spacer height="15px"/>
                        <h:outputLabel styleClass="bold" value="Code Guide: Enforcement Tips"/>
                        <div class="rowExpansion">
                            <h:outputText escape="false" value="#{cse.guideEntry.enforcementGuidelines}"/>
                        </div>

                        <p:spacer height="15px"/>

                        <h:outputLabel styleClass="bold" value="Code guide: Inspection Tips"/>
                        <div class="rowExpansion">
                            <h:outputText escape="false" value="#{cse.guideEntry.inspectionGuidelines}"/>
                        </div>
                    </div>
                </p:rowExpansion>
            </p:dataTable>
        </h:form>

    </p:dialog>



    <p:confirmDialog message="Photos attached to violation #{ceCaseSearchProfileBB.currentViolation.violationID}"
                     severity="alert" widgetVar="photo-dialog"
                     closable="true"
                     rendered="#{systemServicesBB.bbSessionUser.keyCard.hasMuniReaderPermissions}">

        <h:form id="photo-form">
            <p:scrollPanel style="width:1000px; height:400px" mode="native">
                <p:dataTable
                    id="photoTable"
                    var="photoid"
                    value="#{ceCaseSearchProfileBB.currentViolation.blobList}"
                    rowKey="#{photoid}"
                    tableStyleClass="primeDataTable"
                    draggableRows="false" tabindex="6">
                    <p:column width="10%">
                        <f:facet name="header">
                            <h:outputText value="Manage"/>
                        </f:facet>
                        <p:commandButton ajax="true"
                                         actionListener="#{ceCaseSearchProfileBB.onPhotoRemoveButtonChange(photoid)}"
                                         value="Delete"
                                         icon="fa fa-bomb"
                                         rendered="#{systemServicesBB.bbSessionUser.keyCard.hasSysAdminPermissions}"
                                         update=":photo-form:photoTable"/>
                    </p:column>
                    <p:column>
                        <f:facet name="header">
                            <h:outputText value="Photo"/>
                        </f:facet>
                        <p:graphicImage width="100%" value="#{imageServices.image}">
                            <f:param name="photoID" value="#{photoid}"/>
                        </p:graphicImage>
                    </p:column>
                    <p:column width="20%">
                        <f:facet name="header">
                            <h:outputText value="Description"/>
                        </f:facet>
                        <h:outputText escape="false" value="#{imageServices.getPhotograph(photoid).description}"/>

                    </p:column>
                </p:dataTable>
            </p:scrollPanel>
            <p:spacer height="15px"/>
            <p:commandButton ajax="true"
                             value="Continue"
                             update="violation-photos-form"
                             onclick="PF('photo-dialog').hide()"/>
        </h:form>
    </p:confirmDialog>


</ui:composition>