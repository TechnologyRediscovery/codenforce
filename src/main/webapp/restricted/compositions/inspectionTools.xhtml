<ui:composition xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
                xmlns:h="http://xmlns.jcp.org/jsf/html"
                xmlns:f="http://xmlns.jcp.org/jsf/core"
                xmlns:p="http://primefaces.org/ui"
                xmlns="http://www.w3.org/1999/xhtml">

    <h:form id="inspectiontools-growl-form">
        <p:growl id="inspectiontools-growl" />
    </h:form>

    <p:dialog id="inspection-profile-dialog"
              widgetVar="inspection-profile-dialog-var"
              width="1400"
              height="800"
              header="Inspection Profile (ID:#{fieldInspectionBB.currentInspection.inspectionID})"
              modal="true"
              dynamic="true"
              resizable="true"
              closable="true"
              closeOnEscape="true"
              >
        <div class="p-grid nested-grid">

            <!-- Inspection metadata-->
            <div class="p-col-6">
                <h:form id="inspection-profile-form">
                    
                    <h:outputText id="dispatch-notice-ot"
                                  style="color: darkgreen; font-weight: bold;"
                                value="This inspection has been dispatched to handheld computer field application"
                                rendered="#{!empty inspection.dispatch and (empty inspection.dispatch.synchronizationTS and (empty inspection.dispatch.deactivatedTS))}" />

                    <p:commandButton id="inspections-inspectiondetails-editbutton"
                                     value="#{fieldInspectionBB.editModeInspectionMetadata ? 'Save Changes' : 'Edit'}"
                                     disabled="#{!fieldInspectionBB.currentInspection.browserUserEditingAllowed}"
                                     rendered="#{systemServicesBB.bbSessionUser.keyCard.hasMuniStaffPermissions}"
                                     icon="fa #{fieldInspectionBB.editModeInspectionMetadata ? 'fa-check' : 'fa-pencil'}"
                                     actionListener="#{fieldInspectionBB.onToggleEditModeInspectionMetadata}"
                                     oncomplete="PF('inspection-profile-dialog-var').show();"
                                     update="@form
                                     inspection-actions-form
                                     inspection-advancedtools-form
                                     inspection-actions-form
                                     inspection-inspectedspaces-form
                                     @form:@parent:inspectiontools-growl-form
                                     #{fieldInspectionBB.inspectionListComponentForUpdate}"/>

                    <div class="gray_button">

                        <p:commandButton id="inspections-inspectiondetails-abort"
                                         value="Cancel"
                                         styleClass="gray-button"
                                         rendered="#{fieldInspectionBB.editModeInspectionMetadata}"
                                         icon="fa fa-stop"
                                         actionListener="#{fieldInspectionBB.abortEditsOccInspectionMetadata}"
                                         oncomplete="PF('inspection-profile-dialog-var').show()"
                                         update="   @form
                                         @form:@parent:inspectiontools-growl-form
                                         inspection-actions-form
                                         inspection-advancedtools-form
                                         inspection-actions-form
                                         inspection-inspectedspaces-form"/>
                    </div>



                    <p:spacer height="5px"/>

                    <p:panel id="inspections-inspectiondetails-generalpanel"
                             toggleable="true"
                             collapsed="false"
                             header="General">

                        <div class="p-grid">
                            <div class="p-col-6">ID</div>
                            <div class="p-col-6">
                                <h:outputText value="#{fieldInspectionBB.currentInspection.inspectionID}" />
                            </div>
                            <div class="p-col-6">
                                Re-inspection?
                            </div>
                            <div class="p-col-6">

                                <h:outputText rendered="#{fieldInspectionBB.currentInspection.followUpToInspectionID eq 0 and !fieldInspectionBB.editModeInspectionMetadata}" 
                                              value="No; first inspection"/>

                                <h:outputText rendered="#{fieldInspectionBB.currentInspection.followUpToInspectionID ne 0 and !fieldInspectionBB.editModeInspectionMetadata}" 
                                              value="Yes: To inspection ID: #{fieldInspectionBB.currentInspection.followUpToInspectionID}"/>



                            </div>
                            <div class="p-col-6">
                                Inspector
                            </div>
                            <div class="p-col-6">
                                <h:outputText rendered="#{!fieldInspectionBB.editModeInspectionMetadata}" 
                                              value="#{fieldInspectionBB.currentInspection.inspector.human.name}" />
                                <h:outputText rendered="#{!fieldInspectionBB.editModeInspectionMetadata}" 
                                              value=" (#{fieldInspectionBB.currentInspection.inspector.username})" />

                                <p:selectOneMenu rendered="#{fieldInspectionBB.editModeInspectionMetadata}"
                                                 value="#{fieldInspectionBB.currentInspection.inspector}"
                                                 filter="true"
                                                 filterMatchMode="contains"
                                                 required="false"
                                                 converter="userConverter">
                                    <f:selectItems value="#{systemServicesBB.bbSessionMuni.swornOfficerList}" 
                                                   var="user"
                                                   itemLabel="#{user.human.name} (#{user.username})"
                                                   itemValue="#{user}"/>
                                </p:selectOneMenu>
                            </div>

                            <p:divider/>

                            <div class="p-col-6">
                                Created
                            </div>

                            <div class="p-col-6">
                                <h:outputText value="#{fieldInspectionBB.currentInspection.createdBy.human.name} 
                                              (#{fieldInspectionBB.currentInspection.createdBy.username})" 
                                              rendered="#{!empty fieldInspectionBB.currentInspection.createdBy}"/>
                                <p:spacer height="3px" />

                                <h:outputText value="at "
                                              rendered="#{!empty fieldInspectionBB.currentInspection.creationTS}" />

                                <h:outputText value="#{fieldInspectionBB.getPrettyDate(fieldInspectionBB.currentInspection.creationTS)}" 
                                              rendered="#{!empty fieldInspectionBB.currentInspection.creationTS}"/>
                            </div>

                            <div class="p-col-6">
                                Last updated
                            </div>

                            <div class="p-col-6">
                                <h:outputText value="#{fieldInspectionBB.currentInspection.lastUpdatedBy.human.name} 
                                              (#{fieldInspectionBB.currentInspection.lastUpdatedBy.username})" 
                                              rendered="#{!empty fieldInspectionBB.currentInspection.lastUpdatedBy}"/>

                                <p:spacer height="3px" />
                                <h:outputText value="at "
                                              rendered="#{!empty fieldInspectionBB.currentInspection.lastUpdatedTS}" />

                                <h:outputText value="#{fieldInspectionBB.getPrettyDate(fieldInspectionBB.currentInspection.lastUpdatedTS)}" 
                                              rendered="#{!empty fieldInspectionBB.currentInspection.lastUpdatedTS}"/>
                            </div>
                            <div class="p-col-6">
                                Deactivated
                            </div>
                            <div class="p-col-6">

                                <h:outputText value="Active Record" 
                                              rendered="#{empty fieldInspectionBB.currentInspection.deactivatedBy}"/>

                                <h:outputText value="#{fieldInspectionBB.currentInspection.deactivatedBy.human.name} 
                                              (#{fieldInspectionBB.currentInspection.deactivatedBy.username})" 
                                              rendered="#{!empty fieldInspectionBB.currentInspection.deactivatedBy}"/>
                                <p:spacer height="3px" />

                                <h:outputText value="at "
                                              rendered="#{!empty fieldInspectionBB.currentInspection.deactivatedTS}" />

                                <h:outputText value="#{fieldInspectionBB.getPrettyDate(fieldInspectionBB.currentInspection.deactivatedTS)}" 
                                              rendered="#{!empty fieldInspectionBB.currentInspection.deactivatedBy}"/>
                            </div>
                        </div>
                    </p:panel>

                    <p:panel id="inspections-inspectiondetails-inspectionpanel"
                             toggleable="true"
                             collapsed="false"
                             header="Inspection">
                        <div class="p-grid">
                            <div class="p-col-4">
                                Effective Date
                            </div>

                            <div class="p-col-8">
                                <h:outputText rendered="#{!fieldInspectionBB.editModeInspectionMetadata}" 
                                              value="#{fieldInspectionBB.getPrettyDate(fieldInspectionBB.currentInspection.effectiveDateOfRecord)}"/>

                                <p:datePicker 	 id="inspection-dor-datepicker"
                                                rendered="#{fieldInspectionBB.editModeInspectionMetadata}"
                                                value="#{fieldInspectionBB.currentInspection.effectiveDateOfRecord}" 
                                                style="width: 100%;"
                                                pattern="MM/dd/yyyy HH:mm"
                                                disabled="false"
                                                showButtonBar="true"
                                                hideOnDateTimeSelect="true"
                                                showOnFocus="false"
                                                showIcon="true"
                                                mask="true"
                                                timeInput="true" 
                                                required="false" />
                            </div>

                            <div class="p-col-4">
                                Cause
                            </div>
                            <div class="p-col-8">
                                <h:outputText rendered="#{!fieldInspectionBB.editModeInspectionMetadata}" 
                                              value="#{fieldInspectionBB.currentInspection.cause.title}"
                                              title="#{fieldInspectionBB.currentInspection.cause.description}"
                                              />

                                <p:selectOneMenu rendered="#{fieldInspectionBB.editModeInspectionMetadata}"
                                                 value="#{fieldInspectionBB.currentInspection.cause}"
                                                 converter="occInspectionCauseConverter"
                                                 required="false">
                                    <f:selectItems value="#{fieldInspectionBB.causeList}" 
                                                   var="cause"
                                                   itemLabel="#{cause.title}"
                                                   itemValue="#{cause}"/>
                                </p:selectOneMenu>

                            </div>

                            <div class="p-col-4">
                                Checklist
                            </div>
                            <div class="p-col-8">

                                <h:outputText rendered="#{!fieldInspectionBB.editModeInspectionMetadata}" 
                                              value="#{fieldInspectionBB.currentInspection.checklistTemplate.title}"/>

                                <p:selectOneMenu rendered="#{fieldInspectionBB.editModeInspectionMetadata}"
                                                 value="#{fieldInspectionBB.currentInspection.checklistTemplate}"
                                                 converter="checklistTitleConverter"
                                                 required="false">
                                    <f:selectItems value="#{fieldInspectionBB.checklistTemplateList}" 
                                                   var="temp"
                                                   itemLabel="#{temp.title}"
                                                   itemValue="#{temp}"/>
                                </p:selectOneMenu>
                                <h:outputText rendered="#{fieldInspectionBB.editModeInspectionMetadata}" 
                                              value="Warning: changing templates after an inspection has begun is a recipe for disaster!"/>
                            </div>

                            <div class="p-col-4">
                                Start time
                            </div>

                            <div class="p-col-8">
                                <h:outputText rendered="#{!fieldInspectionBB.editModeInspectionMetadata}" 
                                              value="#{fieldInspectionBB.getPrettyDate(fieldInspectionBB.currentInspection.timeStart)}"/>

                                <p:datePicker 	 id="inspection-time-start-datepicker"
                                                rendered="#{fieldInspectionBB.editModeInspectionMetadata}"
                                                value="#{fieldInspectionBB.currentInspection.timeStart}" 
                                                style="width: 100%;"
                                                pattern="MM/dd/yyyy HH:mm"
                                                disabled="false"
                                                showButtonBar="true"
                                                hideOnDateTimeSelect="true"
                                                showOnFocus="false"
                                                showIcon="true"
                                                mask="true"
                                                timeInput="true" 
                                                required="false" />
                            </div>

                            <div class="p-col-4">
                                End time
                            </div>

                            <div class="p-col-8">
                                <h:outputText   rendered="#{!fieldInspectionBB.editModeInspectionMetadata}" 
                                                value="#{fieldInspectionBB.getPrettyDate(fieldInspectionBB.currentInspection.timeEnd)}"/>
                                <p:datePicker 	 id="inspection-time-end-datepicker"
                                                rendered="#{fieldInspectionBB.editModeInspectionMetadata}"
                                                value="#{fieldInspectionBB.currentInspection.timeEnd}" 
                                                style="width: 100%;"
                                                pattern="MM/dd/yyyy HH:mm"
                                                disabled="false"
                                                showButtonBar="true"
                                                hideOnDateTimeSelect="true"
                                                showOnFocus="false"
                                                showIcon="true"
                                                mask="true"
                                                timeInput="true" 
                                                required="false" />
                            </div>

                            <div class="p-col-4">
                                Determination
                                <p:spacer height="3px" />

                            </div>

                            <div class="p-col-8">
                                <h:outputText value="#{!empty fieldInspectionBB.currentInspection.determination 
                                                       ? fieldInspectionBB.currentInspection.determination.title 
                                                       : ''}" />
                            </div>


                            <p:divider/>

                            <div class="p-col-4">
                                Max occupants allowed
                            </div>
                            <div class="p-col-8">
                                <h:outputText rendered="#{!fieldInspectionBB.editModeInspectionMetadata}" 
                                              value="#{fieldInspectionBB.currentInspection.maxOccupantsAllowed}"/>

                                <p:inputText rendered="#{fieldInspectionBB.editModeInspectionMetadata}"  
                                             value="#{fieldInspectionBB.currentInspection.maxOccupantsAllowed}"
                                             required="false"/>
                            </div>
                            <div class="p-col-4">
                                Number of bedrooms
                            </div>
                            <div class="p-col-8">
                                <h:outputText rendered="#{!fieldInspectionBB.editModeInspectionMetadata}" 
                                              value="#{fieldInspectionBB.currentInspection.numBedrooms}"/>
                                <p:inputText rendered="#{fieldInspectionBB.editModeInspectionMetadata}"  
                                             value="#{fieldInspectionBB.currentInspection.numBedrooms}"
                                             required="false"/>
                            </div>

                            <div class="p-col-4">
                                Number of bathrooms
                            </div>
                            <div class="p-col-8">
                                <h:outputText rendered="#{!fieldInspectionBB.editModeInspectionMetadata}" 
                                              value="#{fieldInspectionBB.currentInspection.numBathrooms}"/>
                                <p:inputText rendered="#{fieldInspectionBB.editModeInspectionMetadata}"  
                                             value="#{fieldInspectionBB.currentInspection.numBathrooms}"
                                             required="false"/>
                            </div>
                        </div>
                    </p:panel>

                    <p:panel id="inspections-inspectiondetails-notespanel"
                             toggleable="true"
                             collapsed="false"
                             header="Notes">
                        <div class="p-grid">
                            <div class="p-col-4">
                                Pre-inspection notes
                            </div>
                            <div class="p-col-8">
                                <h:outputText   rendered="#{!fieldInspectionBB.editModeInspectionMetadata}" 
                                                value="#{fieldInspectionBB.currentInspection.notesPreInspection}"/>

                                <p:inputTextarea    rendered="#{fieldInspectionBB.editModeInspectionMetadata}" 
                                                    value="#{fieldInspectionBB.currentInspection.notesPreInspection}"
                                                    rows="8"
                                                    cols="30"
                                                    required="false"/>
                            </div>

                            <div class="p-col-4">
                                Remarks
                            </div>

                            <div class="p-col-8">
                                <h:outputText   rendered="#{!fieldInspectionBB.editModeInspectionMetadata}" 
                                                value="#{fieldInspectionBB.currentInspection.remarks}"/>

                                <p:inputTextarea    rendered="#{fieldInspectionBB.editModeInspectionMetadata}" 
                                                    value="#{fieldInspectionBB.currentInspection.remarks}"
                                                    rows="8"
                                                    cols="30"
                                                    required="false"/>
                            </div>

                            <div class="p-col-4">
                                General Comments
                            </div>
                            <div class="p-col-8">
                                <h:outputText   rendered="#{!fieldInspectionBB.editModeInspectionMetadata}" 
                                                value="#{fieldInspectionBB.currentInspection.generalComments}"/>

                                <p:inputTextarea    rendered="#{fieldInspectionBB.editModeInspectionMetadata}" 
                                                    value="#{fieldInspectionBB.currentInspection.generalComments}"
                                                    rows="8"
                                                    cols="30"
                                                    required="false"/>
                            </div>
                        </div>
                    </p:panel>
                </h:form>

                <p:panel id="inspection-advancedtools-panel"
                         toggleable="true"
                         collapsed="true"
                         header="Transfer and Deactivation">
                    <h:form id="inspection-advancedtools-form">
                        <h3>Transfer inspection to new period</h3>

                        <h:outputText     value="Current permit file ID: #{fieldInspectionBB.currentInspection.occPeriodID}"/>

                        <p:spacer height="4px" />

                        <h:outputText  value="Enter the ID of the permit file to which this inspection should be transferred. On successful transfer, you'll be sent to the dashboard." />

                        <p:inputNumber value="#{fieldInspectionBB.occPeriodIDFortransferFormField}"
                                       required="true" />

                        <p:commandButton id="inspection-occperiodxfer-button"
                                         action="#{fieldInspectionBB.onOccPeriodXferButtonClick}"
                                         disabled="#{!fieldInspectionBB.currentInspection.browserUserEditingAllowed}"
                                         ajax="false"
                                         value="Transfer this inspection!" />

                        <h3>Deactivate inspection</h3>

                        <p:commandButton  id="inspection-deacinspection-button"
                                          actionListener="#{fieldInspectionBB.onDeactivateInspectionButtonClick}"
                                          ajax="true"
                                          value="Deactivate inspection ID #{fieldInspectionBB.currentInspection.inspectionID}"
                                          disabled="#{!fieldInspectionBB.currentInspection.browserUserEditingAllowed}"
                                          update="#{fieldInspectionBB.inspectionListComponentForUpdate}
                                          inspectiontools-growl-form"
                                          oncomplete="PF('inspection-profile-dialog-var').hide();"
                                          >
                        </p:commandButton>


                    </h:form>  
                </p:panel>
            </div>
            <div class="p-col-6">

                <p:panel id="inspection-tools-panel"
                         toggleable="true"
                         collapsed="false"
                         header="Inspection Toolbox">

                    <h:form id="inspection-actions-form">

                        <div class="p-grid">
                            <div class="p-col-4">

                                <p:commandButton  id="inspection-uploadphotos-cl"
                                                  value="Add Photos"
                                                  actionListener="#{fieldInspectionBB.onUploadImagesToInspectionInitButtonClick}"
                                                  ajax="true"
                                                  icon="fa fa-upload"
                                                  oncomplete="PF('blob-upload-dialog-var').show()"
                                                  rendered="true"
                                                  disabled="#{fieldInspectionBB.editModeInspectionMetadata or !fieldInspectionBB.currentInspection.browserUserEditingAllowed}"
                                                  update="@form:@parent:@parent:blob-upload-dialog
                                                  inspectiontools-growl-form"
                                                  />

                            </div>
                            <div class="p-col-4">

                                <p:commandButton  id="inspection-viewphotos-cl"
                                                  value="View photo pool"
                                                  actionListener="#{fieldInspectionBB.onViewPhotoPoolLinkClick}" 
                                                  ajax="true"
                                                  icon="fa fa-file-image-o"
                                                  oncomplete="PF('blobs-gallery-dialog-var').show()"
                                                  disabled="#{fieldInspectionBB.editModeInspectionMetadata or !fieldInspectionBB.currentInspection.browserUserEditingAllowed}"
                                                  rendered="true"
                                                  update="@form:@parent:@parent:blobs-gallery-dialog
                                                  inspectiontools-growl-form"
                                                  />

                            </div>
                            <div class="p-col-4">

                                <p:commandButton  id="inspection-generatereport-cl"
                                                  value="Build Inspection report"
                                                  actionListener="#{fieldInspectionBB.onFieldInspectionReportInitLinkClick}"
                                                  ajax="true"
                                                  disabled="#{fieldInspectionBB.editModeInspectionMetadata or !fieldInspectionBB.currentInspection.browserUserEditingAllowed}"
                                                  rendered="true"
                                                  icon="fa fa-print"
                                                  oncomplete="PF('inspection-reportconfig-dialog-var').show()"
                                                  update="inspection-reportconfig-dialog
                                                  inspection-reportconfig-form"
                                                  />

                            </div>
                            <div class="p-col-4">
                                <p:commandButton    id="insp-followup-button"
                                                    value="Setup Re-inspection (coming soon)"
                                                    ajax="true"
                                                    disabled="true"
                                                    actionListener="#{fieldInspectionBB.onSetupReinspectionButtonClick}"
                                                    oncomplete="PF('inspection-followup-dialog-var').show()"
                                                    rendered="#{systemServicesBB.bbSessionUser.keyCard.hasMuniStaffPermissions}"
                                                    icon="fa fa-repeat"
                                                    update="inspection-followup-form"
                                                    />

                            </div>
                            <div class="p-col-4">
                                <p:commandButton    id="insp-extractviolations-button"
                                                    value="Transfer Violated Elements #{empty fieldInspectionBB.currentInspection.determination ? '[Finalize inspection to enable migration]' : ''}"
                                                    ajax="true"
                                                    disabled="#{(empty fieldInspectionBB.currentInspection.determination) or !fieldInspectionBB.currentInspection.browserUserEditingAllowed}"
                                                    actionListener="#{migrationBB.onMigrationInitButtonChange}"
                                                    oncomplete="PF('faileditems-migrate-choosepath-dialog-var').show()"
                                                    rendered="#{systemServicesBB.bbSessionUser.keyCard.hasMuniStaffPermissions}"
                                                    icon="fa fa-gavel"
                                                    update="faileditems-migrate-choosepath-dialog
                                                    faileditems-migrate-choosepath-form"
                                                    />

                            </div>

                            <div class="p-col-4">
                                <p:commandButton id="determination-init-button"
                                                 actionListener="#{fieldInspectionBB.onCertifyInspectionInitButtonChange}"
                                                 ajax="true"
                                                 icon="fa fa-check"
                                                 oncomplete="PF('inspection-finalize-dialog-var').show()"
                                                 disabled="#{fieldInspectionBB.editModeInspectionMetadata or !fieldInspectionBB.currentInspection.browserUserEditingAllowed}"
                                                 rendered="#{systemServicesBB.bbSessionUser.keyCard.hasEnfOfficialPermissions}"
                                                 update="  inspection-finalize-form
                                                 inspection-finalize-dialog"
                                                 value="#{!empty fieldInspectionBB.currentInspection.determination ? 'edit determination':'finalize inspection'}">
                                </p:commandButton>
                            </div>

                        </div>
                    </h:form>
                </p:panel>

                <p:panel id="inspection-dispatch-panel"
                         toggleable="true"
                         collapsed="false"
                         header="Dispatch">
                    <h:form id="inspection-dispatch-form">

                        <p:commandButton    id="dispatch-toggle-button"
                                            actionListener="#{fieldInspectionBB.onToggleDispatchEditMode}"
                                            ajax="true"
                                            disabled="#{!fieldInspectionBB.currentInspection.browserUserEditingAllowed}"
                                            rendered="#{!fieldInspectionBB.editModeDispatch}"
                                            update="inspection-dispatch-form
                                            inspectiontools-growl-form"
                                            value="#{!empty fieldInspectionBB.currentDispatch ? 'Edit dispatch notes':'Dispatch inspection to handheld computer field application'}">
                        </p:commandButton>

                        <p:commandButton    id="dispatch-save-button"
                                            actionListener="#{fieldInspectionBB.onToggleDispatchEditMode}"
                                            ajax="true"
                                            disabled="false"
                                            rendered="#{fieldInspectionBB.editModeDispatch}"
                                            update="inspection-dispatch-form
                                                inspection-profile-form
                                                inspectiontools-growl-form
                                                inspection-actions-form
                                                inspection-advancedtools-form
                                                inspection-actions-form
                                                inspection-inspectedspaces-form"
                                            value="Save dispatch">
                        </p:commandButton>

                        <div class="gray_button">
                            <p:commandButton    id="dispatch-abort-button"
                                                actionListener="#{fieldInspectionBB.onDispatchEditModeAbort}"
                                                ajax="true"
                                                disabled="false"
                                                rendered="#{fieldInspectionBB.editModeDispatch}"
                                                update="inspection-dispatch-form
                                                inspectiontools-growl-form"
                                                value="Abort dispatch edits">
                            </p:commandButton>
                        </div>

                        <p:spacer height="3px" />
                        <div class="p-grid">
                            <div class="p-col-4 restrict-data-field-label-inline">
                                Dispatch status
                            </div>

                            <div class="p-col-8 restrict-data-field-value-inline">
                                <h:outputText rendered="#{empty fieldInspectionBB.currentDispatch and !fieldInspectionBB.editModeDispatch}" 
                                              value="Inspection not dispatched to mobile application"/>
                                <h:outputText   id="dispatch-status-otwid"
                                                rendered="#{!empty fieldInspectionBB.currentDispatch and !fieldInspectionBB.editModeDispatch}" 
                                                value="Dispatched to mobile application (ID:#{fieldInspectionBB.currentDispatch.dispatchID})"/>
                            </div>

                            <f:subview  id="dispatchfields"
                                        rendered="#{!empty fieldInspectionBB.currentDispatch}">
                                <div class="p-col-4 restrict-data-field-label-inline">
                                    Dispatch notes
                                </div>

                                <div class="p-col-8 restrict-data-field-value-inline">
                                    <h:outputText value="#{fieldInspectionBB.currentDispatch.dispatchNotes}"
                                                  rendered="#{!fieldInspectionBB.editModeDispatch}" />
                                    <p:inputTextarea value="#{fieldInspectionBB.currentDispatch.dispatchNotes}"
                                                     rendered="#{fieldInspectionBB.editModeDispatch}"
                                                     rows="5"
                                                     cols="35" />
                                </div>
                                <div class="p-col-4 restrict-data-field-label-inline">
                                    Retrieval
                                      <p:commandButton id="retrieval-help-button"
                                                            icon="fa fa-question-circle-o"
                                                            styleClass="button-help"
                                                            type="button" />

                                           <p:overlayPanel for="retrieval-help-button"
                                                           style="width:350px;" 
                                                           dismissable="true"
                                                           showCloseIcon="true">
                                               <h3>Dispatch retrieval</h3>
                                               <p>After an inspection is dispatched to the handheld computer application, the field user must login on the handheld device
                                               and pull down any dispatched inspections. Once this transfer occurs, the date and time are reported in this field. The inspection
                                               remains locked to browser users until the inspection is synchronized from the handheld device back to the server OR the browser
                                               user decides to revoke the dispatch (used only in exceptional circumstances).</p>
                                               
                                               
                                           </p:overlayPanel>
                                </div>

                                <div class="p-col-8 restrict-data-field-value-inline">
                                    <h:outputText value="(pending mobile user retrieval)"
                                                  styleClass="italic"
                                                  rendered="#{empty fieldInspectionBB.currentDispatch.retrievalTS}" />
                                    <h:outputText value="Retrieved by user: #{fieldInspectionBB.currentDispatch.retrievedBy.human.name}"
                                                  rendered="#{!empty fieldInspectionBB.currentDispatch.retrievedBy}" />
                                    <p:spacer height="3px" />
                                    <h:outputText value="on #{fieldInspectionBB.getPrettyDate(fieldInspectionBB.currentDispatch.retrievalTS)}"
                                                  rendered="#{!empty fieldInspectionBB.currentDispatch.retrievalTS}" />

                                </div>
                                <div class="p-col-4 restrict-data-field-label-inline">
                                    Synchronization
                                    
                                        <p:commandButton id="sync-help-button"
                                                            icon="fa fa-question-circle-o"
                                                            styleClass="button-help"
                                                            type="button" />

                                           <p:overlayPanel for="sync-help-button"
                                                           style="width:350px;" 
                                                           dismissable="true"
                                                           showCloseIcon="true">
                                               <h3>Dispatch synchronization</h3>
                                               <p>Once an inspection is completed using the handheld computer application, the results are sent back to the codeNForce server
                                               and the inspection is then unlocked for further editing using the browser-based tools. This field will show the date this occurs.</p>
                                               
                                               
                                           </p:overlayPanel>

                                </div>

                                <div class="p-col-8 restrict-data-field-value-inline">
                                    <h:outputText value="(pending mobile user synchronization)"
                                                  styleClass="italic"
                                                  rendered="#{empty fieldInspectionBB.currentDispatch.synchronizationTS}" />
                                    <h:outputText value="On #{fieldInspectionBB.getPrettyDate(fieldInspectionBB.currentDispatch.synchronizationTS)}"
                                                  rendered="#{!empty fieldInspectionBB.currentDispatch.synchronizationTS}" />
                                    <p:spacer height="3px" />
                                    <h:outputText value="With notes: #{fieldInspectionBB.currentDispatch.synchronizationNotes}"
                                                  rendered="#{!empty fieldInspectionBB.currentDispatch.synchronizationTS}" />

                                </div>
                                <div class="p-col-4 restrict-data-field-label-inline">
                                    Revocation
                                </div>

                                <div class="p-col-8 restrict-data-field-value-inline">
                                    <p:commandLink     id="dispatch-deac-init-cl"
                                                       ajax="true"
                                                       style="color:blue; font-weight: bold;"
                                                       rendered="true"
                                                       disabled="#{(!empty fieldInspectionBB.currentDispatch.synchronizationTS) or (!empty fieldInspectionBB.currentDispatch.deactivatedTS)}"
                                                       oncomplete="PF('dispatch-deac-dialog-var').show();"
                                                       update="dispatch-deac-dialog
                                                       dispatch-deac-form"
                                                       value="#{!empty fieldInspectionBB.currentDispatch.synchronizationTS ? '(a synchronized dispatch cannot be revoked)':'revoke dispatch'}">
                                    </p:commandLink>

                                  

                                    <p:spacer height="3px" />
                                    <h:outputText value="Revoked on #{fieldInspectionBB.getPrettyDate(fieldInspectionBB.currentInspection.dispatch.deactivatedTS)}"
                                                  rendered="#{!empty fieldInspectionBB.currentInspection.dispatch.deactivatedTS}" />
                                    <p:spacer height="3px" />
                                    <h:outputText value="by user ID: #{fieldInspectionBB.currentInspection.dispatch.deactivatedBy.human.name}"
                                                  rendered="#{!empty fieldInspectionBB.currentInspection.dispatch.deactivatedBy}" />

                                </div>
                            </f:subview>
                        </div>
                    </h:form>
                </p:panel>

                <p:dialog id="dispatch-deac-dialog"
                          widgetVar="dispatch-deac-dialog-var"
                          header="Revoke dispatch ID:#{fieldInspectionBB.currentDispatch.dispatchID}"
                          closable="true"
                          closeOnEscape="true"
                          dynamic="true"
                          height="300"
                          width="400"
                          resizable="true"
                          responsive="true">

                    <h:form id="dispatch-deac-form">
                        <h:outputText style="color:darkred; font-weight: bold;"
                                      value="Official warming: Deactivating a dispatch that has been retrieved--but not synchronized--will wreak havoc in the mobile applicaiton" 
                                      rendered="#{!empty fieldInspectionBB.currentDispatch.retrievalTS}"/>

                        <p:spacer height="3px" />

                        <p:commandButton    id="dispatch-deac-button"
                                            actionListener="#{fieldInspectionBB.onDispatchRevoke}"
                                            ajax="true"
                                            disabled="false"
                                            rendered="true"
                                            update="inspection-dispatch-form
                                                    inspection-profile-form
                                                    inspectiontools-growl-form
                                                    inspectiontools-growl-form
                                                    inspection-actions-form
                                                    inspection-advancedtools-form
                                                    inspection-actions-form
                                                    inspection-inspectedspaces-form"
                                              oncomplete="PF('dispatch-deac-dialog-var').hide();"
                                            value="Revoke dispatch (ID:#{fieldInspectionBB.currentDispatch.dispatchID})">
                        </p:commandButton>


                    </h:form>
                </p:dialog>

                <p:panel id="inspection-spaces-panel"
                         toggleable="true"
                         collapsed="false"
                         header="Inspected Spaces">
                    <h:form id="inspection-inspectedspaces-form">


                        <p:commandButton    id="insp-addspace-comlink"
                                            value="#{!empty fieldInspectionBB.currentInspection.determinationTS ? 'New spaces cannot be added to finalized inspection!' : 'Inspect new space'}"
                                            ajax="true"
                                            actionListener="#{fieldInspectionBB.onAddSpaceInitLinkClick}"
                                            oncomplete="PF('inspections-selecttype-var').show()"
                                            rendered="#{systemServicesBB.bbSessionUser.keyCard.hasMuniStaffPermissions}"
                                            disabled="#{fieldInspectionBB.editModeInspectionMetadata or !empty fieldInspectionBB.currentInspection.determinationTS or !fieldInspectionBB.currentInspection.browserUserEditingAllowed}"
                                            icon="fa fa-plus"
                                            update="inspections-selecttype-form"
                                            />


                        <p:spacer height="5px" />

                        <p:dataTable    id="inspectedspaces-table"
                                        var="inspectedSpace"
                                        value="#{fieldInspectionBB.currentInspection.inspectedSpaceList}"
                                        rowKey="#{inspectedSpace.inspectedSpaceID}"
                                        reflow="true">

                            <p:column style="width:2rem">
                                <p:rowToggler/>
                            </p:column>
                            <p:column headerText="Type">
                                <h:outputText value="#{inspectedSpace.type.spaceTypeTitle} (ID:#{inspectedSpace.inspectedSpaceID})"/>
                                <h:panelGroup id="inspections-selectspace-dt-spacetypeinfoicon">
                                    <i class="p-ml-1 pi pi-info-circle"/>
                                </h:panelGroup>
                                <p:tooltip for="inspections-selectspace-dt-spacetypeinfoicon"
                                           value="#{inspectedSpace.type.spaceTypeDescription}" position="right"/>
                            </p:column>
                            <p:column headerText="Uninsp"
                                      style="width:10%;">
                                <h:outputText value="#{inspectedSpace.elementListNotIns.size()}" />
                            </p:column>
                            <p:column headerText="Pass"
                                      style="width:10%;">
                                <h:outputText value="#{inspectedSpace.elementListPass.size()}" />
                            </p:column>
                            <p:column headerText="Violation"
                                      style="width:10%;">
                                <h:outputText value="#{inspectedSpace.elementListFail.size()}" />
                            </p:column>

                            <p:column headerText="Actions">
                                <p:commandLink ajax="true"
                                               style="color:blue;"
                                               oncomplete="PF('inspections-entryscreen-var').show()"
                                               rendered="#{systemServicesBB.bbSessionUser.keyCard.hasMuniStaffPermissions}"
                                               update="inspections-entryscreen-form
                                               inspections-entryscreen"
                                               value="Edit">
                                    <f:actionListener binding="#{fieldInspectionBB.onViewInspectedSpaceLinkClick(inspectedSpace)}"/>
                                </p:commandLink>
                            </p:column>
                            <p:rowExpansion>

                                <h4>Violated</h4>
                                <ul>
                                    <ui:repeat id="spaceele-uir-fail"
                                               value="#{inspectedSpace.elementListFail}"
                                               var="ele_fail">
                                        <li>
                                            <h:outputText value="#{ele_fail.headerString}" 
                                                          escape="false"/>

                                            <h:outputText value=" [#{ele_fail.inspectionNotes}]" 
                                                          escape="true"
                                                          rendered="#{!empty ele_fail.inspectionNotes}"/>
                                        </li>
                                    </ui:repeat>
                                </ul>

                                <h4>Not Inspected</h4>
                                <ul>

                                    <ui:repeat id="spaceele-uir-notins"
                                               value="#{inspectedSpace.elementListNotIns}"
                                               var="ele_notins">
                                        <li>
                                            <h:outputText value="#{ele_notins.headerString}"
                                                          escape="false"/>
                                            <h:outputText value=" [#{ele_notins.inspectionNotes}]" 
                                                          escape="true"
                                                          rendered="#{!empty ele_notins.inspectionNotes}"/>
                                        </li>

                                    </ui:repeat>
                                </ul>

                                <h4>Pass</h4>
                                <ul>
                                    <ui:repeat id="spaceele-uir-pass"
                                               value="#{inspectedSpace.elementListPass}"
                                               var="ele_pass">
                                        <li>

                                            <h:outputText value="#{ele_pass.headerString}" 
                                                          escape="false"/>
                                            <h:outputText value=" [#{ele_pass.inspectionNotes}]" 
                                                          escape="true"
                                                          rendered="#{!empty ele_pass.inspectionNotes}"/>
                                        </li>

                                    </ui:repeat>
                                </ul>
                            </p:rowExpansion>
                        </p:dataTable>
                    </h:form>
                </p:panel>
            </div>
        </div>
    </p:dialog>



    <p:dialog   id="faileditems-migrate-choosepath-dialog"
                height="400" width="500"
                widgetVar="faileditems-migrate-choosepath-dialog-var"
                responsive="true"
                dynamic="true"
                modal="true"
                resizable="true"
                closable="true"
                closeOnEscape="true"
                rendered="true"
                header="Choose violated ordinances transfer pathway">

        <h:form id="faileditems-migrate-choosepath-form">

            <p:selectOneMenu id="faileditems-migrate-path-som"
                             value="#{migrationBB.selectedTransferPathway}" 
                             style="width: 100%;"
                             required="true"
                             tabindex="1"
                             requiredMessage="A transfer pathway is required"
                             >

                <f:selectItem itemLabel="select a pathway" 
                              noSelectionOption="true" 
                              itemDisabled="true"/>

                <f:selectItems id="faileditems-migrate-path-selitems"
                               value="#{migrationBB.transferOptionsListOccInspection}"
                               var="pathway" itemValue="#{pathway}" itemLabel="#{pathway.description}"/>
            </p:selectOneMenu>

            <p:spacer height="5px" />

            <p:commandButton    id="faileditems-migrate-init-button"
                                actionListener="#{migrationBB.onTransferPathwaySelectionCompleteButtonChange}" 
                                ajax="true" 
                                value="Configure migration"  
                                icon="fa fa-arrow-right" 
                                oncomplete="PF('faileditems-migrate-choosepath-dialog-var').hide(); PF('migration-configuration-dialog-var').show();"
                                update="migration-configuration-form
                                migration-configuration-dialog
                                migration-growl-form"/>
        </h:form>
    </p:dialog>


    <!-- Inspection Creation Flow -->

    <!-- Checklist selection dialog used in inspection creation flow -->
    <p:dialog id="inspections-selectchecklist"
              width="1000"
              widgetVar="inspections-selectchecklist-var"
              header="Choose Checklist"
              modal="true"
              dynamic="true"
              resizable="true">
        <h:form id="inspections-selectchecklist-form">
            <p:dataTable id="inspections-selectchecklist-dt"
                         scrollHeight="600"
                         var="checklist" value="#{fieldInspectionBB.checklistTemplateList}"
                         rowKey="#{checklist.inspectionChecklistID}"
                         selection="#{fieldInspectionBB.selectedChecklistTemplate}"
                         stripedRows="true">
                <p:ajax event="rowSelect"
                        update=":inspections-selectchecklist-form:inspections-selectchecklist-continuebutton"/>
                <p:column selectionMode="single" style="width:16px;text-align:center"/>
                <p:column headerText="Title">
                    <h:outputText value="#{checklist.title} (ID:#{checklist.inspectionChecklistID})"/>
                </p:column>

                <p:column headerText="Description">
                    <h:outputText value="#{checklist.description}"/>
                </p:column>

                <p:column headerText="Municipality">
                    <h:outputText value="#{checklist.muni.muniName}"/>
                </p:column>

                <p:column headerText="Code Source">
                    <h:outputText
                        value="#{checklist.governingCodeSource.sourceName} (#{checklist.governingCodeSource.sourceYear})"/>
                </p:column>
            </p:dataTable>


            <p:commandButton id="inspections-selectchecklist-continuebutton"
                             value="Create"
                             rendered="true"
                             disabled="false"
                             style="margin-right: 5px;"
                             icon="pi pi-arrow-right"
                             actionListener="#{fieldInspectionBB.onChecklistSelectionCompleteButtonClick}"
                             update="   inspectiontools-growl-form
                             inspection-profile-dialog
                             inspection-advancedtools-form
                             inspection-actions-form
                             inspection-inspectedspaces-form
                             #{fieldInspectionBB.inspectionListComponentForUpdate}"
                             oncomplete="PF('inspections-selectchecklist-var').hide(); PF('inspection-profile-dialog-var').show();"/>

            <p:commandButton value="Cancel"
                             icon="pi pi-times"
                             style="background-color: darkgrey; border: solid darkgray; color:white;"
                             class="ui-button-outlined p-mr-1"
                             oncomplete="PF('inspections-selectchecklist-var').hide()"/>

        </h:form>
    </p:dialog>



    <!-- Space add flow -->
    <!-- (Currently a bit defunct) -->

    <!-- Type selection used in space add flow -->
    <p:dialog id="inspections-selecttype"
              width="800" height="600"
              closeOnEscape="true"
              widgetVar="inspections-selecttype-var"
              header="Select Space Type"
              modal="true"
              dynamic="true"
              resizable="true">
        <h:form id="inspections-selecttype-form">
            <p:scrollPanel id="selectspacetype-scrollpanel"
                           style="height: 500px;" 
                           mode="native" >

                <p:dataTable id="inspections-selecttype-dt"
                             scrollHeight="600"
                             var="ost" 
                             value="#{fieldInspectionBB.currentInspection.checklistTemplate.occSpaceTypeList}"
                             rowKey="#{ost.checklistSpaceTypeID}"
                             selection="#{fieldInspectionBB.currentSpaceType}"
                             stripedRows="true"
                             rowExpandMode="multiple">
                    <p:ajax event="rowSelect"
                            update=":inspections-selecttype-form:inspections-selecttype-continuebutton"/>
                    <p:column selectionMode="single" style="width:16px;text-align:center"/>
                    <p:column style="width:2rem">
                        <p:rowToggler/>
                    </p:column>
                    <p:column headerText="CSTID">
                        <h:outputText value="#{ost.checklistSpaceTypeID}"/>
                    </p:column>
                    <p:column headerText="Type ID">
                        <h:outputText value="#{ost.spaceTypeID}"/>
                    </p:column>
                    <p:column headerText="Chklst ID">
                        <h:outputText value="#{ost.checklistParentID}"/>
                    </p:column>
                    <p:column headerText="Name">
                        <h:outputText value="#{ost.spaceTypeTitle}"/>
                    </p:column>
                    <p:column headerText="Description">
                        <h:outputText value="#{ost.spaceTypeDescription}"/>
                    </p:column>
                    <p:column headerText="Required">
                        <i class="#{ost.required ? 'pi pi-star' : ''}"/>
                    </p:column>
                    <p:rowExpansion>
                        <p:dataTable id="ordbytype-table"
                                     var="ord"
                                     value="#{ost.codeElementList}"
                                     rowKey="#{ord.elementID}"
                                     stripedRows="true">

                            <p:column headerText="EleID">
                                <h:outputText value="#{ord.elementID}"/>
                            </p:column>
                            <p:column headerText="subsec">
                                <h:outputText value="#{ord.ordSubSecTitle}"/>
                            </p:column>

                        </p:dataTable>

                    </p:rowExpansion>


                </p:dataTable>
            </p:scrollPanel>
            <p:spacer height="3px" />

            <p:commandButton value="Cancel"
                             icon="pi pi-times"
                             process="@none"
                             immediate="true"
                             class="ui-button-outlined p-mr-1"
                             oncomplete="PF('inspections-selecttype-var').hide()"/>
            <p:commandButton id="inspections-selecttype-continuebutton"
                             actionListener="#{fieldInspectionBB.onAddSpaceTypeSelectedButtonChange}"
                             ajax="true"
                             value="Continue"
                             disabled="false"
                             icon="pi pi-arrow-right"
                             update="inspections-selectspace-form"
                             oncomplete="PF('inspections-selecttype-var').hide(); 
                             PF('inspections-selectspace-var').show()"/>
        </h:form>
    </p:dialog>

    <!-- Actual space(?) selection used in space add flow -->
    <p:dialog id="inspections-selectspace"
              width="800"
              widgetVar="inspections-selectspace-var"
              header="Identify location of space type: #{fieldInspectionBB.currentSpaceType.spaceTypeTitle}"
              dynamic="true"
              modal="true"
              resizable="true">
        <h:form id="inspections-selectspace-form">
            <p:spacer height="5px"/>
            <div class="p-col-12 p-md-6">
                <p:commandButton value="New location descriptor"
                                 actionListener="#{fieldInspectionBB.initSkeletonLocDescriptor}"
                                 update="inspections-addlocdesc-form"
                                 oncomplete="PF('inspections-addlocdesc-var').show()"
                                 icon="pi pi-plus"/>
            </div>
            <p:outputLabel styleClass="p-d-block">OR Choose a Location descriptor:</p:outputLabel>
            <div class="p-grid">
                <div class="p-col-12 p-md-6">
                    <p:selectOneMenu value="#{fieldInspectionBB.currentLocationDescriptor}"
                                     converter="occLocationDescriptorConverter"
                                     var="ld" filter="true" filterMatchMode="contains">
                        <p:ajax update="inspections-selectspace-continuebutton
                                @form"/>
                        <f:selectItems value="#{fieldInspectionBB.currentInspection.allUniqueLocationDescriptors}" var="locdep"
                                       itemLabel="#{locdep.locationDescription}" itemValue="#{locdep}"/>
                        <p:column>
                            <h:outputText value="#{ld.locationDescription}"/>
                        </p:column>
                    </p:selectOneMenu>
                </div>

            </div>

            <h3>Selected location</h3>

            <h:outputText value="#{fieldInspectionBB.currentLocationDescriptor.locationDescription}"/>
            <p:spacer height="3px" />
            <h:outputText value="Floor: #{fieldInspectionBB.currentLocationDescriptor.buildingFloorNo}"/>
            <p:spacer height="3px" />
            <h:outputText value="#{fieldInspectionBB.currentLocationDescriptor.locationID}"/>
            <p:spacer height="5px" />
            <p:commandButton value="Back"
                             icon="pi pi-arrow-left"
                             class="ui-button-outlined p-mr-1"
                             oncomplete="PF('inspections-selectspace-var').hide(); PF('inspections-selecttype-var').show()"
                             style="margin-right: 5px;"/>

            <p:commandButton id="inspections-selectspace-continuebutton"
                             value="Add to inspection and close"
                             icon="pi pi-plus"
                             actionListener="#{fieldInspectionBB.onAddSpaceToInspectionCommitButtonChange}"
                             update="inspection-inspectedspaces-form
                             inspectiontools-growl-form"
                             oncomplete="PF('inspections-selectspace-var').hide()"
                             style="margin-right: 5px;"/>

            <p:commandButton id="inspections-selectspace-inspectnow"
                             value="Inspect space now!"
                             icon="pi pi-check-square "
                             actionListener="#{fieldInspectionBB.onAddSpaceToInspectionCommitButtonChange}"
                             update="inspection-inspectedspaces-form
                             inspectiontools-growl-form
                             inspections-entryscreen
                             inspections-entryscreen-controls-form"
                             oncomplete="PF('inspections-selectspace-var').hide();
                             PF('inspections-entryscreen-var').show();"/>
        </h:form>
    </p:dialog>

    <!-- Independent dialogs that are not necessarily used in a flow -->


    <!-- Currently not working and not realized dialog for editing of an OccInspectedSpace's basic info -->
    <p:dialog id="inspections-editspace"
              widgetVar="inspections-editspace-var"
              header="Edit Space"
              dynamic="true"
              modal="true"
              closable="false"
              resizable="true">
        <h:form id="inspections-editspace-form">
            <p:outputLabel styleClass="p-d-block">Space name:</p:outputLabel>
            <!--            <p:inputText styleClass="p-d-block" value="!{fieldInspectionBB.selectedSpace.name}"/>-->

            <p:outputLabel styleClass="p-d-block">Space description:</p:outputLabel>
            <!--            <p:inputTextarea rows="6" cols="33" value="!{fieldInspectionBB.selectedSpace.description}"/>-->

            <!--                                 update="inspections-selectspace-form:inspections-selectspace-dt
                                         inspections-selectspace-form:inspections-selectspace-continuebutton" -->
            <f:facet name="footer">
                <p:commandButton id="inspections-editspace-continuebutton"
                                 value="Ok"
                                 icon="pi pi-check"
                                 oncomplete="PF('inspections-editspace-var').hide()"/>
            </f:facet>
        </h:form>
    </p:dialog>

    <!-- Dialog used for adding new location descriptors. Yep, it's pretty defunct. -->
    <p:dialog id="inspections-addlocdesc"
              widgetVar="inspections-addlocdesc-var"
              header="Add Location Descriptor"
              dynamic="true"
              modal="true"
              closable="true"
              closeOnEscape="true"
              resizable="true">
        <h:form id="inspections-addlocdesc-form">

            <p:outputLabel for="inspections-locdesc-input" styleClass="p-d-block">Location description:</p:outputLabel>
            <p:inputTextarea id="inspections-locdesc-input"
                             rows="6" 
                             cols="33" 
                             value="#{fieldInspectionBB.skeletonLocationDescriptor.locationDescription}"
                             required="true">
                <p:ajax update="inspections-addlocdesc-continuebutton"/>
            </p:inputTextarea>

            <p:outputLabel for="inspections-floornumber-input" styleClass="p-d-block">Building floor number:</p:outputLabel>
            <p:inputNumber id="inspections-floornumber-input"
                           value="#{fieldInspectionBB.skeletonLocationDescriptor.buildingFloorNo}"/>

            <p:spacer height="3px" />
            <p:commandButton value="Cancel"
                             icon="pi pi-times"
                             oncomplete="PF('inspections-addlocdesc-var').hide()"/>
            <p:commandButton id="inspections-addlocdesc-continuebutton"
                             value="Add"
                             disabled="false"
                             icon="pi pi-plus"
                             update="@form:@parent:inspections-selectspace-form"
                             actionListener="#{fieldInspectionBB.createLocDescriptor}"
                             oncomplete="PF('inspections-addlocdesc-var').hide()"/>
        </h:form>
    </p:dialog>

    <!-- Barely realized form that should show stats for one OccInspectedSpace(?) and all of its ordinances -->

    <p:dialog id="inspections-entryscreen"
              height="800" width="1300"
              widgetVar="inspections-entryscreen-var"
              header="Inspect ordiances in #{fieldInspectionBB.currentInspectedSpace.type.spaceTypeTitle} (ID: #{fieldInspectionBB.currentInspectedSpace.inspectedSpaceID})"
              dynamic="true"
              modal="true"
              resizable="true"
              closable="false"
              closeOnEscape="false">

        <div class="p-d-flex p-jc-between">

            <div>
                <h:form id="inspections-entryscreen-controls-form">
                    <p:selectOneMenu    id="inspections-entryscreen-statussel" 
                                        value="#{fieldInspectionBB.selectedElementStatusForBatch}" 
                                        >
                        <!-- Strangely this element needs to update itself to call the setter -->
                        <f:selectItem noSelectionOption="true"
                                      itemDisabled="true"
                                      itemLabel="choose a batch status" />
                        <f:selectItems value="#{fieldInspectionBB.statuses}" 
                                       var="status" 
                                       itemLabel="#{status.label}"/>
                    </p:selectOneMenu>
                    <p:spacer height="3px" />

                    <p:commandLink     id="applybatch-cl"
                                       ajax="true"
                                       style="color:blue;"
                                       update="@form:@parent:inspections-entryscreen-form:element-accordion
                                       @form:@parent:inspectiontools-growl-form"
                                       value="Batch apply to all ords"
                                       actionListener="#{fieldInspectionBB.onBatchProcessElementLinkClick}" />
                </h:form>
            </div>
            <div>
                <h:form id="stinspection-tools-form">
                    <p>use default findings on violation: </p>

                    <p:selectBooleanCheckbox id="stinspection-usedefaultfindings-cb"
                                             value="#{fieldInspectionBB.useDefaultFindingsOnCurrentOISE}"
                                             label="use default findings"
                                             title="when an element is violated, populate findings with default findings on the ordinance">
                        <p:ajax />
                    </p:selectBooleanCheckbox>

                    <h:outputText value=" | " />

                    <p:commandLink     id="stinspection-editspace"
                                       ajax="true"
                                       style="color:blue;"
                                       update=""
                                       value="edit space"
                                       actionListener="#{fieldInspectionBB.onSpaceTypeEditLinkClick}" />

                    <h:outputText value=" | " />

                    <p:commandLink     id="stinspection-removespace"
                                       ajax="true"
                                       style="color:blue;"
                                       update=""
                                       value="remove space from inspection"
                                       actionListener="#{fieldInspectionBB.onSpaceTypeRemoveLinkClick}" >
                        <p:confirm header="Confirm remove space from inspection?"
                                   message="Are you sure?"
                                   icon="ui-icon-alert" />
                    </p:commandLink>

                    <p>Filter elements (See mobile specs) </p>
                    <p:inputText id="ordsearch" />
                </h:form>


            </div>
        </div>


        <p:separator />

        <h:form id="inspections-entryscreen-form">

            <p:commandButton id="inspections-saveandclose"
                             value="Save and confirm"
                             disabled="false"
                             rendered="true"
                             icon="fa fa-save"
                             style="margin-right:10px;"
                             actionListener="#{fieldInspectionBB.onSavCurrentSpaceChanges}"
                             oncomplete="PF('ois-violation-confirm-dialog-var').show();
                             PF('inspections-entryscreen-var').hide();"
                             update="@form:@parent:ois-violation-confirm-dialog
                             @form:@parent:ois-violation-confirm-form
                             @form:@parent:inspectiontools-growl-form"/>

            <div class="gray_button">

                <p:commandButton id="inspections-cancel"
                                 value="Cancel and discard changes"
                                 disabled="false"
                                 rendered="true"
                                 icon="fa fa-stop"
                                 actionListener="#{fieldInspectionBB.onAbortSpaceInspectionEntry}"
                                 oncomplete="PF('inspections-entryscreen-var').hide();"
                                 update="@form:@parent:inspectiontools-growl-form"/>
            </div>

            <p:spacer height="5px" />

            <p:accordionPanel id="element-accordion"
                              value="#{fieldInspectionBB.currentInspectedSpace.inspectedElementGroupList}" 
                              var="elegrp" multiple="true"
                              >
                <p:ajax/>
                <p:tab title="#{elegrp.groupTitle}" >
                    <p:repeat   id="elements-repeat"
                                value="#{elegrp.elementList}" 
                                var="spaceElement"
                                varStatus="eleStatus">
                        <div class="p-grid nested-grid">
                            <div class="p-col-8">
                                <div class="p-grid">
                                    <div class="p-col-12">
                                        <h2>
                                            <h:outputText value="#{spaceElement.headerString}"
                                                          escape="false" />
                                        </h2>
                                    </div>

                                    <div class="p-col-4">
                                        <p:commandLink     id="spaceelement-vieword-cl"
                                                           ajax="true"
                                                           type="button"
                                                           style="color:blue;"
                                                           actionListener="#{fieldInspectionBB.onSpaceElementViewLinkClick(spaceElement)}"
                                                           update="codeelement-fulltext-dialog"
                                                           oncomplete="PF('codeelement-fulltext-dialog-var').show();"
                                                           value="ordinance text"/>

                                        <h:outputText value=" | " />

                                        <p:commandLink     id="spaceelement-viewmeta"
                                                           ajax="true"
                                                           type="button"
                                                           style="color:blue;"
                                                           actionListener="#{fieldInspectionBB.onSpaceElementViewLinkClick(spaceElement)}"
                                                           update="codeelement-metadata-dialog"
                                                           oncomplete="PF('codeelement-metadata-dialog-var').show();"
                                                           value="element info"/>

                                    </div>
                                    <div class="p-col-8">
                                        <div class="p-grid">
                                            <div class="p-col-12>">

                                                <p:selectOneButton id="inspections-entryscreen-statussel" 
                                                                   value="#{spaceElement.statusEnum}" 
                                                                   unselectable="false" >
                                                    <f:selectItems value="#{fieldInspectionBB.statuses}" 
                                                                   var="status" 
                                                                   itemLabel="#{status.label}"/>
                                                </p:selectOneButton>
                                            </div>
                                            <div class="p-col-12>">

                                                <p:spacer height="5px" />
                                                <p>
                                                    <h:outputText id="inspectedby-user"
                                                                  value="Inspected by: #{spaceElement.lastInspectedBy.human.name}" 
                                                                  rendered="#{!empty spaceElement.lastInspectedBy}"/>
                                                    <p:spacer height="2px" />
                                                    <h:outputText id="inspectedby-ts"
                                                                  value="on #{fieldInspectionBB.getPrettyDate(spaceElement.lastInspectedTS)}" 
                                                                  rendered="#{!empty spaceElement.lastInspectedTS}"/>
                                                    <p:spacer height="2px" />
                                                    <h:outputText id="inspectedby-failed"
                                                                  value="Violated" 
                                                                  rendered="#{!empty spaceElement.lastInspectedTS and empty spaceElement.complianceGrantedTS}"/>
                                                    <p:spacer height="2px" />
                                                    <h:outputText id="inspectedby-comp-user"
                                                                  value="Compliance granted by: #{spaceElement.complianceGrantedBy.human.name}" 
                                                                  rendered="#{!empty spaceElement.complianceGrantedBy}"/>
                                                    <p:spacer height="2px" />
                                                    <h:outputText id="inspectedby-comp-ts"
                                                                  value="on #{fieldInspectionBB.getPrettyDate(spaceElement.complianceGrantedTS)}" 
                                                                  rendered="#{!empty spaceElement.complianceGrantedTS}"/>
                                                </p>

                                            </div>

                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="p-col-4">
                                <div class="p-grid">
                                    <div class="p-col-12">
                                        <p class="p-mb-0">Findings:</p>
                                        <p:inputTextarea    id="element-findings"
                                                            value="#{spaceElement.inspectionNotes}"
                                                            rows="6" cols="33"/>

                                    </div>
                                    <div class="p-col-12">

                                        <p:commandLink  id="oise-uploadphotos-cl"
                                                        ajax="true"
                                                        style="color:blue;"
                                                        oncomplete="PF('blob-upload-dialog-var').show()"
                                                        rendered="true"
                                                        update="@form:@parent:@parent:blob-upload-dialog
                                                        "
                                                        value="Add Photos"
                                                        actionListener="#{fieldInspectionBB.onManageBlobsOnInspectedElement(spaceElement)}">
                                            <f:param name="blob-list-component-to-update"
                                                     value="inspections-entryscreen-form" />
                                        </p:commandLink>

                                        <h:outputText value=" | " />

                                        <p:commandLink  id="oise-viewphotos-cl"
                                                        ajax="true"
                                                        style="color:blue;"
                                                        oncomplete="PF('blobs-gallery-dialog-var').show()"
                                                        rendered="true"
                                                        update="@form:@parent:@parent:blobs-gallery-dialog
                                                        "
                                                        value="View photos"
                                                        actionListener="#{fieldInspectionBB.onManageBlobsOnInspectedElement(spaceElement)}">

                                        </p:commandLink>

                                    </div>
                                    <div class="p-col-12">
                                        <ui:repeat id="oise-blobs-uir"
                                                   value="#{spaceElement.blobList}"
                                                   var="oiseblob">
                                            <h:outputText value="#{oiseblob.photoDocID}: #{oiseblob.filename}" />
                                            <p:spacer height="2px" />

                                        </ui:repeat>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <p:separator />
                    </p:repeat>
                </p:tab>
            </p:accordionPanel>
        </h:form>
    </p:dialog>

    <p:dialog id="ois-violation-confirm-dialog"
              widgetVar="ois-violation-confirm-dialog-var"
              header="Confirm violated ordinance details"
              closable="false"
              closeOnEscape="false"
              dynamic="true"
              modal="true"
              height="600"
              width="1000"
              resizable="true"
              responsive="true">

        <h:form id="ois-violation-confirm-form">

            <p:commandButton id="oise-bacl"
                             value="Return to space manager" 
                             icon="fa fa-backward"
                             actionListener="#{fieldInspectionBB.onReturnToSpaceInspectionEntry}"
                             oncomplete="PF('inspections-entryscreen-var').show();
                             PF('ois-violation-confirm-dialog-var').hide();">

            </p:commandButton>

            <p:commandButton id="oise-confirm"
                             value="Save violation details" 
                             icon="fa fa-save"
                             oncomplete="PF('ois-violation-confirm-dialog-var').hide();"
                             actionListener="#{fieldInspectionBB.onSaveViolatedOrdinanceConfirmationSettings}"
                             update="@form:@parent:inspectiontools-growl-form
                             @form:@parent:inspection-inspectedspaces-form">

            </p:commandButton>

            <p:spacer height="3px" />

            <h3>
                <h:outputText value="Confirm (#{fieldInspectionBB.currentInspectedSpace.elementListFail.size()}) Ordinances marked with violation in #{fieldInspectionBB.currentInspectedSpace.type.spaceTypeTitle}" />
            </h3>
            <p:spacer height="3px" />
            <p:dataTable id="ois-violations-table"
                         value="#{fieldInspectionBB.currentInspectedSpace.elementListFail}" 
                         var="oise"
                         rowKey="#{oise.inspectedSpaceElementID}"
                         expandedRow="false"
                         rowExpandMode="true">

                <p:column headerText="Exp"
                          width="10%">
                    <p:rowToggler />

                </p:column>
                <p:column headerText="Ordinance"
                          width="35%">
                    <h:outputText value="#{oise.headerString}"
                                  escape="false" />
                </p:column>

                <p:column headerText="Severity"
                          width="45%">

                    <h:selectOneMenu id="fail-severity-som-table"
                                     value="#{oise.faillureSeverity}" 
                                     >
                        <f:converter converterId="intensityClassConverter"/>

                        <f:selectItem itemLabel="select a severity" 
                                      noSelectionOption="true" />

                        <f:selectItems id="fail-severity-selitems-table"
                                       value="#{fieldInspectionBB.failSeverityList}"
                                       var="ic" itemValue="#{ic}" 
                                       itemLabel="#{ic.numericRating}: #{ic.title}"/>
                    </h:selectOneMenu>
                </p:column>
                <p:column headerText="Migrate to Case"
                          width="10%">
                    <p:selectBooleanCheckbox     value="#{oise.migrateToCaseOnFail}"/>
                </p:column>
                <p:rowExpansion>
                    <div class="p-grid nested-grid" >
                        <div class="p-col-4 restrict-data-field-label-inline">
                            Findings
                        </div>
                        <div class="p-col-8 restrict-data-field-value-inline">
                            <h:outputText value="#{oise.inspectionNotes}" />
                        </div>
                        <div class="p-col-4 restrict-data-field-label-inline">
                            Photos
                        </div>
                        <div class="p-col-8 restrict-data-field-value-inline nested-grid">
                            <div class="p-grid">
                                <ui:repeat id="oise-confirm-blobs-uir"
                                           value="#{oise.blobList}"
                                           var="oiseblob">
                                    <div class="p-col-4">
                                        <h:outputText value="#{oiseblob.photoDocID}" />
                                        <p:spacer height="2px" />
                                        <p:graphicImage value="#{blobsterBB.image}"
                                                        alt="no preview available" 
                                                        style="width: 100%" 
                                                        cache="false"
                                                        rendered="#{oiseblob.type.browserViewable}">
                                            <f:param name="blobid" value="#{oiseblob.photoDocID}"/>
                                        </p:graphicImage>
                                    </div>
                                </ui:repeat>
                            </div>
                        </div>
                    </div>
                </p:rowExpansion>
            </p:dataTable>


        </h:form>
    </p:dialog>

    <p:confirmDialog    id="confirmdialog-global"
                        global="true">
        <h:form id="confirm-global-form">

            <p:commandButton value="Yes"
                             type="button"
                             styleClass="ui-confirmdialog-yes"
                             icon="ui-icon-check" />
            <p:commandButton value="No"
                             type="button"
                             styleClass="ui-confirmdialog-no"
                             icon="ui-icon-check" />
        </h:form>
    </p:confirmDialog>

    <p:dialog id="codeelement-fulltext-dialog"
              widgetVar="codeelement-fulltext-dialog-var"
              header="Full ordinance text"
              closable="true"
              closeOnEscape="true"
              dynamic="true"
              modal="true"
              height="400"
              width="500"
              resizable="true"
              responsive="true">

        <h:form id="codeelement-fulltext-form">

            <h2>
                <h:outputText value="ch. #{fieldInspectionBB.currentInspectedSpaceElement.ordchapterNo}: #{fieldInspectionBB.currentInspectedSpaceElement.ordchapterTitle}" />
            </h2>
            <h3>
                <h:outputText value="#{fieldInspectionBB.currentInspectedSpaceElement.ordSecNum}:#{fieldInspectionBB.currentInspectedSpaceElement.ordSecTitle}" />
            </h3>
            <h3>
                <h:outputText value="#{fieldInspectionBB.currentInspectedSpaceElement.ordSubSecNum} #{fieldInspectionBB.currentInspectedSpaceElement.ordSubSecTitle}" 
                              rendered="#{!empty fieldInspectionBB.currentInspectedSpaceElement.ordSubSecNum}"/>

                <h:outputText value=" | " />
                <h:outputText value="#{fieldInspectionBB.currentInspectedSpaceElement.ordSubSubSecNum} #{fieldInspectionBB.currentInspectedSpaceElement.ordSubSubSecNum}" 
                              rendered="#{!empty fieldInspectionBB.currentInspectedSpaceElement.ordSubSubSecNum}"/>
            </h3> 

            <h:outputText id="codeelement-fulltext-ot"
                          value="#{fieldInspectionBB.currentInspectedSpaceElement.ordTechnicalText}" 
                          escape="false"/>

            <h3>Inspection tips</h3>
            <h:outputText id="codeelement-inspectiontips-ot"
                          value="#{fieldInspectionBB.currentInspectedSpaceElement.guideEntry.inspectionGuidelines}" 
                          escape="false"/>

        </h:form>




    </p:dialog>

    <p:dialog id="codeelement-metadata-dialog"
              header="Occ Inspected Space Element Metadata"
              widgetVar="codeelement-metadata-dialog-var"
              closable="true"
              closeOnEscape="true"
              dynamic="true"
              modal="true"
              height="400"
              width="500"
              resizable="true"
              responsive="true">

        <h2>
            <h:outputText value="ch. #{fieldInspectionBB.currentInspectedSpaceElement.ordchapterNo}: #{fieldInspectionBB.currentInspectedSpaceElement.ordchapterTitle}" />
        </h2>
        <h3>
            <h:outputText value="#{fieldInspectionBB.currentInspectedSpaceElement.ordSecNum}:#{fieldInspectionBB.currentInspectedSpaceElement.ordSecTitle}" />
        </h3>
        <h3>
            <h:outputText value="#{fieldInspectionBB.currentInspectedSpaceElement.ordSubSecNum} #{fieldInspectionBB.currentInspectedSpaceElement.ordSubSecTitle}" 
                          rendered="#{!empty fieldInspectionBB.currentInspectedSpaceElement.ordSubSecNum}"/>

            <h:outputText value=" | " />
            <h:outputText value="#{fieldInspectionBB.currentInspectedSpaceElement.ordSubSubSecNum} #{fieldInspectionBB.currentInspectedSpaceElement.ordSubSubSecNum}" 
                          rendered="#{!empty fieldInspectionBB.currentInspectedSpaceElement.ordSubSubSecNum}"/>
        </h3> 


        <h:outputText value="Inspected space element ID: #{fieldInspectionBB.currentInspectedSpaceElement.inspectedSpaceElementID}" />
        <p:spacer height="3px" />

        <h:outputText value="Inspected space ID: #{fieldInspectionBB.currentInspectedSpaceElement.inspectedSpaceID}" />
        <p:spacer height="3px" />

        <h:outputText value="occChecklist Space Type Element ID: #{fieldInspectionBB.currentInspectedSpaceElement.occChecklistSpaceTypeElementID}" />
        <p:spacer height="3px" />

        <h:outputText value="Code set element ID: #{fieldInspectionBB.currentInspectedSpaceElement.codeSetElementID}" />
        <p:spacer height="3px" />

        <h:outputText value="Code Element ID: #{fieldInspectionBB.currentInspectedSpaceElement.elementID}" />
        <p:spacer height="3px" />



    </p:dialog>


    <p:dialog id="inspection-finalize-dialog"
              widgetVar="inspection-finalize-dialog-var"
              header="Finalize inspection ID: #{fieldInspectionBB.currentInspection.inspectionID}"
              closable="true"
              closeOnEscape="true"
              dynamic="true"
              modal="true"
              height="400"
              width="900"
              resizable="true"
              responsive="true">


        <h:form id="inspection-finalize-form">
            <p:panel id="inspection-determination-panel"
                     toggleable="true"
                     collapsed="false"
                     header="Determination">
                <div class="p-grid">

                    <div class="p-col-4">
                        <h:outputText value="Determination" />
                    </div>
                    <div class="p-col-8" >


                        <p:selectOneMenu rendered="true"
                                         value="#{fieldInspectionBB.selectedDetermination}"
                                         converter="occInspectionDeterminationConverter">
                            <f:selectItem noSelectionOption="true"
                                          itemDisabled="true"
                                          itemLabel="choose a determination" />
                            <f:selectItems value="#{fieldInspectionBB.determinationList}" 
                                           var="det"
                                           itemLabel="#{det.title} (#{det.qualifiesAsPassed ? 'PASS' : 'FAIL'})"
                                           itemValue="#{det}"/>
                            <p:ajax update="inspection-finalize-commit-cb" />
                        </p:selectOneMenu>


                    </div>


                    <div class="p-col-12">
                        <p:commandButton   id="inspection-finalize-commit-cb"
                                           value="Finalzie and lock inspection ID:#{fieldInspectionBB.currentInspection.inspectionID} with selected determination"
                                           rendered="true"
                                           icon="fa fa-check-square "
                                           disabled="#{!empty fieldInspectionBB.currentInspection.determinationTS}"
                                           actionListener="#{fieldInspectionBB.onCertifyInspectionCommitButtonChange}"
                                           update=" @form:@parent:inspection-profile-form
                                           @form:@parent:inspection-actions-form
                                           @form:@parent:inspectiontools-growl-form
                                           @form:@parent:inspection-inspectedspaces-form:insp-addspace-comlink
                                           #{fieldInspectionBB.inspectionListComponentForUpdate}" 
                                           oncomplete="PF('inspection-finalize-dialog-var').hide();"
                                           style="margin-right: 5px;">

                        </p:commandButton>
                    </div>
                    <div class="p-col-12">
                        <div class="gray_button">
                            <p:commandButton  id="inspection-removefinalization-button"
                                              actionListener="#{fieldInspectionBB.onRemoveFinalizationOfInspection}"
                                              disabled="#{empty fieldInspectionBB.currentInspection.determinationTS}"
                                              ajax="true"
                                              oncomplete="PF('inspection-finalize-dialog-var').hide();"
                                              rendered="true"
                                              value="Remove finalization of inspection ID #{fieldInspectionBB.currentInspection.inspectionID}" 
                                              update="  @form:@parent:inspectiontools-growl-form
                                              @form:@parent:inspection-actions-form
                                              @form:@parent:inspection-profile-form
                                              @form:@parent:inspection-inspectedspaces-form:insp-addspace-comlink
                                              #{fieldInspectionBB.inspectionListComponentForUpdate}"
                                              >
                            </p:commandButton>
                        </div>
                    </div>
                </div>
            </p:panel>
        </h:form>
    </p:dialog>


    <p:dialog id="inspection-followup-dialog"
              widgetVar="inspection-followup-dialog-var"
              header="Setup re-inspection of inspection ID: #{fieldInspectionBB.formFollowUpInspectionTo.inspectionID}"
              closable="true"
              closeOnEscape="true"
              dynamic="true"
              modal="true"
              height="600"
              width="600"
              resizable="true"
              responsive="true">

        <h:form id="inspection-followup-form">

            <div class="p-grid">

                <div class="p-col-4">
                    <h:outputText value="Follow-up to" />
                </div>
                <div class="p-col-8">
                    <h:outputText value="Inspection ID: #{fieldInspectionBB.formFollowUpInspectionTo.inspectionID}" />
                    <h:outputText value="Start Time: #{!empty fieldInspectionBB.formFollowUpInspectionTo.timeStart 
                                                       ? fieldInspectionBB.getPrettyDate(fieldInspectionBB.formFollowupInspectionTo.timeStart) 
                                                       : ''}" />

                </div>
                <div class="p-col-4">
                    <h:outputText value="Reinspection Options:" />
                </div>
                <div class="p-col-8">
                </div>
            </div>
        </h:form>
    </p:dialog>

    <p:dialog id="inspection-reportconfig-dialog"
              widgetVar="inspection-reportconfig-dialog-var"
              header="Configure report of field inspection ID: #{fieldInspectionBB.currentInspection.inspectionID}"
              closable="true"
              closeOnEscape="true"
              dynamic="true"
              modal="true"
              height="600"
              width="1000"
              resizable="true"
              responsive="true">

        <h:form id="inspection-reportconfig-form">
            <div class="ui-g-12 ui-md-12 ui-lg-12 restrict-data-field">
                <div class="restrict-main-contents-io-link"
                     style="font-size: 3em;">

                    <p:commandLink  ajax="false" 
                                    action="#{fieldInspectionBB.onFieldInspectionReportCommitLinkClick}"
                                    value="Click to generate inspection report in new tab" 
                                    target="_blank"
                                    rendered="#{systemServicesBB.bbSessionUser.keyCard.hasMuniReaderPermissions}"
                                    />
                </div>
            </div>

            <div class="p-grid">

                <div class="p-col-12">
                    <h2>Inspection details options</h2>
                </div>
                <div class="p-col-4">
                    Include containing Object info <br />(Permit File or CECase):
                </div>
                <div class="p-col-2">
                    <p:selectBooleanCheckbox value="#{fieldInspectionBB.reportConfigFIN.includeParentObjectInfoHeader}"
                                             rendered="false"/>
                </div>

                <div class="p-col-4">
                    Include bed/bath count <br />and occupant limits:
                </div>
                <div class="p-col-2">
                    <p:selectBooleanCheckbox value="#{fieldInspectionBB.reportConfigFIN.includeBedBathOccCounts}" />
                </div>



                <div class="p-col-12">
                    <h2>Ordinance display options</h2>
                </div>
                <div class="p-col-4">
                    Ordinances to display:
                </div>
                <div class="p-col-8">


                    <p:selectOneMenu rendered="true"
                                     value="#{fieldInspectionBB.reportConfigFIN.viewSetting}"
                                     filter="false"
                                     required="true">
                        <f:selectItems value="#{fieldInspectionBB.ordinanceViewOptionsList}" 
                                       var="viewOpt"
                                       itemLabel="#{viewOpt.label}"
                                       itemValue="#{viewOpt}"/>
                    </p:selectOneMenu>

                </div>
                <div class="p-col-4">
                    Include ordinance text:
                </div>
                <div class="p-col-2">
                    <p:selectBooleanCheckbox value="#{fieldInspectionBB.reportConfigFIN.includeFullOrdText}" />
                </div>

                <div class="p-col-4">
                    Include inspection findings:
                </div>
                <div class="p-col-2">
                    <p:selectBooleanCheckbox value="#{fieldInspectionBB.reportConfigFIN.includeOrdinanceFindings}" />
                </div>

                <div class="p-col-4">
                    Include ordinance timestamps:
                </div>
                <div class="p-col-2">
                    <p:selectBooleanCheckbox value="#{fieldInspectionBB.reportConfigFIN.includeOrdinanceInspectionTimestamps}" />
                </div>





                <div class="p-col-12">
                    <h2>Photo options: Include...</h2>
                </div>

                <div class="p-col-4">
                    Photos on violated Ords:
                </div>
                <div class="p-col-2">
                    <p:selectBooleanCheckbox value="#{fieldInspectionBB.reportConfigFIN.includePhotos_fail}" />
                </div>

                <div class="p-col-4">
                    Photos on passed Ords:
                </div>
                <div class="p-col-2">
                    <p:selectBooleanCheckbox value="#{fieldInspectionBB.reportConfigFIN.includePhotos_pass}" />
                </div>

                <div class="p-col-4">
                    Overall photos:
                </div>
                <div class="p-col-2">
                    <p:selectBooleanCheckbox value="#{fieldInspectionBB.reportConfigFIN.includeOverallInspectionPhotos}" />
                </div>
                <div class="p-col-4">
                    Photo IDs:
                </div>
                <div class="p-col-2">
                    <p:selectBooleanCheckbox value="#{fieldInspectionBB.reportConfigFIN.includePhotoIDs}" />
                </div>

                <div class="p-col-4">
                    Photo Titles:
                </div>
                <div class="p-col-2">
                    <p:selectBooleanCheckbox value="#{fieldInspectionBB.reportConfigFIN.includePhotoTitles}" />
                </div>

                <div class="p-col-4">
                    Photo original filenames:
                </div>
                <div class="p-col-2">
                    <p:selectBooleanCheckbox value="#{fieldInspectionBB.reportConfigFIN.includePhotoOriginalFileNames}" />
                </div>

                <div class="p-col-4">
                    Photo descriptions:
                </div>
                <div class="p-col-2">
                    <p:selectBooleanCheckbox value="#{fieldInspectionBB.reportConfigFIN.includePhotoDescriptions}" />
                </div>



                <div class="p-col-3">
                    Default photo width:
                </div>
                <div class="p-col-3">
                    <p:inputNumber value="#{fieldInspectionBB.reportConfigFIN.unifiedPhotoWidth}" />
                </div>






                <div class="p-col-4">
                    Inspector signature:
                </div>
                <div class="p-col-2">
                    <p:selectBooleanCheckbox value="#{fieldInspectionBB.reportConfigFIN.includeSignature}" 
                                             disabled="true"
                                             rendered="false"/>

                </div>
            </div>

            <p:spacer height="5px" />
        </h:form>
    </p:dialog>
</ui:composition>