<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:f="http://xmlns.jcp.org/jsf/core"
      xmlns:p="http://primefaces.org/ui">
    <h:head>
        <link rel="stylesheet" type="text/css" href="css/style.css"></link>
        <title>Manage uploaded photographs and documents</title>
    </h:head>
    <h:body>
        <ui:composition template="/restricted/navContainer_restricted.xhtml">
            <ui:define name="content">
                <f:view id="blob-info-view">
                    <p:outputPanel id="body-panel">

                        <!-- GLOBAL MESSAGES -->
                        <h:form id="form-messages-global">
                            <p:growl id="messages-global" showDetail="false"/>
                        </h:form>

                        <div class="mainContainer">

                            <!-- DATA CONTAINER -->
                            <div class="ui-g data-container">

                                <!-- LIST DATA CONTAINER --> 
                                <div class="ui-g-12 ui-md-4 ui-lg-4 list-data-container">

                                    <!-- MODE SELECTION --> 
                                    <h:form id="mode-form">
                                        <div class="restrict-main-list-mode-button">
                                            <p:selectOneButton  value="#{manageBlobBB.currentMode}"
                                                                unselectable="false"
                                                                tabindex="1"
                                                                style="width: 100%"
                                                                >
                                                <f:selectItems value="#{manageBlobBB.pageModes}"
                                                               var="pmo"
                                                               itemLabel="#{pmo.title}"
                                                               itemDisabled="#{!manageBlobBB.currentBlobSelected and pmo.objectSelectRequiredToEnable}"/>
                                                <f:ajax render="@all"/>
                                            </p:selectOneButton>
                                        </div>
                                    </h:form>

                                    <!-- PANEL CONTAINER -->
                                    <p:panel id="blob-search-query-panel"
                                             toggleable="true"
                                             widgetVar="blob-search-query-panel-var"
                                             collapsed="false"
                                             style="width:100%;"
                                             header="File Search"
                                             rendered="#{manageBlobBB.activeLookupMode}">

                                        <!--MESSAGES -->
                                        <h:form id="blob-search-messages-form">
                                            <p:growl id="blob-search-messages" showDetail="false"/>
                                        </h:form>

                                        <h:form id="blob-search-query-form">

                                            <!-- NESTED DATA CONTAINER -->
                                            <div class="ui-g data_container_nested_restrict">

                                                <!-- NESTED DATA FIELD GRID:12-->
                                                <div class="ui-g-12 ui-md-12 ui-lg-12 restrict-data-field">

                                                    <!-- NESTED DATA TITLE -->
                                                    <div class="restrict-main-contents-io-title">
                                                        <h:outputLabel value="Enter Search Criteria"/>
                                                    </div>
                                                </div>

                                                <!-- NESTED DATA CONTENT -->
                                                <div class="restrict-main-contents-io-content">
                                                    <h:outputLabel value="Filename contains..."/>
                                                    <p:inputText id="blob-search-filter-filename"
                                                                 value="#{manageBlobBB.searchFilename}"
                                                                 style="width: 100%;"
                                                                 tabindex="2"
                                                                 styleClass="data_field_value"
                                                                 />

                                                    <p:message for="blob-search-filter-filename" showDetail="false" showSummary="true"/>
                                                </div>

                                                <div class="restrict-main-contents-io-content">
                                                    <h:outputLabel value="Description contains..."/>
                                                    <p:inputText id="blob-search-filter-desc"
                                                                 value="#{manageBlobBB.searchDescription}"
                                                                 style="width: 100%;"
                                                                 tabindex="2"
                                                                 styleClass="data_field_value"
                                                                 />

                                                    <p:message for="blob-search-filter-desc" showDetail="false" showSummary="true"/>
                                                </div>

                                                <div class="restrict-main-contents-io-content">
                                                    <h:outputLabel value="Uploaded before..."/>
                                                    <p:calendar value="#{manageBlobBB.searchBeforeUtil}" 
                                                                mode="popup" 
                                                                tabindex="3"
                                                                id="blob-search-filter-upload-before"
                                                                showOn="button"
                                                                pattern="EEE, dd MMM, yyyy HH:mm"
                                                                navigator="true"
                                                                showButtonPanel="true"
                                                                showTodayButton="true"
                                                                />

                                                    <p:message for="blob-search-filter-upload-before" showDetail="false" showSummary="true"/>
                                                </div>

                                                <div class="restrict-main-contents-io-content">
                                                    <h:outputLabel value="Uploaded after..."/>
                                                    <p:calendar value="#{manageBlobBB.searchAfterUtil}" 
                                                                mode="popup" 
                                                                tabindex="3"
                                                                id="blob-search-filter-upload-after"
                                                                showOn="button"
                                                                pattern="EEE, dd MMM, yyyy HH:mm"
                                                                navigator="true"
                                                                showButtonPanel="true"
                                                                showTodayButton="true"
                                                                />

                                                    <p:message for="blob-search-filter-upload-after" showDetail="false" showSummary="true"/>
                                                </div>

                                            </div>

                                            <!-- NESTED DATA CONTAINER -->
                                            <div class="ui-g data_container_nested_restrict">

                                                <!--NESTED DATA FIELD GRID:12-->
                                                <div class="ui-g-12 ui-md-12 ui-lg-12 restrict-data-field">

                                                    <!-- NESTED DATA BUTTON -->
                                                    <div class="restrict-main-contents-io-button">
                                                        <p:commandButton id="blob-search-exec-cb-0"
                                                                         ajax="true"
                                                                         actionListener="#{manageBlobBB.executeQuery}"
                                                                         icon="fa fa-search"
                                                                         value="Search"
                                                                         style="width: 100%"
                                                                         update=" 
                                                                         @form
                                                                         blob-search-messages-form
                                                                         blob-search-log-form
                                                                         blob-search-results-panel
                                                                         blob-search-clear-cb-0"/>

                                                    </div>

                                                </div>
                                            </div>
                                        </h:form>
                                    </p:panel>

                                    <!-- PANEL CONTAINER -->
                                    <p:panel id="blob-search-results-panel"
                                             toggleable="true"
                                             widgetVar="prop-search-query-panel-var"
                                             collapsed="false"
                                             style="width:100%;"
                                             header="Search Results"
                                             rendered="#{manageBlobBB.activeLookupMode}">


                                        <h:form id="blob-search-results-form">

                                            <p:dataTable id="blob-search-results-table"
                                                         var="blob"
                                                         value="#{manageBlobBB.blobList}"
                                                         rowKey="#{blob.blobID}"
                                                         tableStyleClass="primeDataTable"
                                                         draggableRows="false" draggableColumns="true"
                                                         tabindex="6"
                                                         >

                                                <p:column headerText="File Type">
                                                    <h:outputText value="#{blob.type.typeID}"/>
                                                    <i class="material-icons status-display-icon-i"><h:outputText value="#{blob.type.typeIcon}"/></i>
                                                </p:column>

                                                <p:column headerText="Filename">
                                                    <h:outputText value="#{blob.filename}"/>
                                                </p:column>

                                                <p:column headerText="Description">
                                                    <h:outputText id="desc" value="#{blob.description}"/>
                                                </p:column>

                                                <p:column width="20%" style="text-align: center" headerText="View">
                                                    <div class="gray_button">
                                                        <p:commandButton id="prop-search-loadprop-button"
                                                                         icon="fa fa-folder-open-o"
                                                                         value="Load"
                                                                         action="#{manageBlobBB.selectBlob(blob)}"
                                                                         ajax="true"
                                                                         update="
                                                                         form-messages-global
                                                                         blobinfo-panel-info
                                                                         blobinfo-panel-addupdate
                                                                         blob-remove-panel"
                                                                         />
                                                    </div>
                                                </p:column>
                                            </p:dataTable>
                                        </h:form>
                                    </p:panel>

                                </div>

                                <!-- OBJECT DATA CONTAINER --> 
                                <div class="ui-g-12 ui-md-8 ui-lg-8 object-data-container">

                                    <!-- OBJECT DATA TITLE --> 
                                    <div class="restrict-main-object-title">

                                        <h:form id="prop-info-header-form">
                                            <h:outputText id="header-ot" styleClass="dataText" value="#{propertyProfileBB.currentProperty.address}" />
                                            <h:outputText value=" (" />
                                            <h:outputText value="#{propertyProfileBB.currentProperty.muni.muniName}" />
                                            <h:outputText value=") " />
                                        </h:form>

                                    </div>

                                    <p:outputPanel id = "prop-lists-outpanel" >

                                        <!-- OBJECT DATA PANEL--> 
                                        <p:panel id="propinfo-panel-info"
                                                 toggleable="true"
                                                 collapsed="false"
                                                 header="Property Record ID:#{propertyProfileBB.currentProperty.propertyID} (Created: #{propertyProfileBB.getPrettyDate(propertyProfileBB.currentProperty.creationTS)} | Last udpated:#{propertyProfileBB.getPrettyDate(propertyProfileBB.currentProperty.lastUpdatedTS)})"
                                                 rendered="#{propertyProfileBB.getActiveViewMode() }"
                                                 >

                                            <p:spacer height="10px"/>

                                            <h:form id="evruleconfig-panel-info-form">

                                                <!-- NESTED DATA CONTAINER -->
                                                <div class="ui-g data_container_nested_restrict">

                                                    <!--NESTED DATA FIELD -->
                                                    <div class="ui-g-12 ui-md-12 ui-lg-12 restrict-data-field">

                                                        <!--NESTED DATA LABEL INLINE -->
                                                        <div class="restrict-data-field-label-inline" >
                                                            <h:outputLabel value="Address"/>
                                                        </div>
                                                        <!--NESTED DATA VALUE INLINE -->
                                                        <div class="restrict-data-field-value-inline" >

                                                            <h:outputText value="#{propertyProfileBB.currentProperty.address}" />
                                                            <br/>
                                                            <h:outputText value="#{propertyProfileBB.currentProperty.address_city}" />
                                                            <h:outputText value=", " />
                                                            <h:outputText value="#{propertyProfileBB.currentProperty.address_state}" />
                                                            <h:outputText value=" " />
                                                            <h:outputText value="#{propertyProfileBB.currentProperty.address_zip}" />
                                                        </div>
                                                    </div>

                                                    <!--NESTED DATA FIELD -->
                                                    <div class="ui-g-12 ui-md-6 ui-lg-4 restrict-data-field" >
                                                        <!--NESTED DATA LABEL INLINE -->
                                                        <div class="restrict-data-field-label-inline" >
                                                            <h:outputLabel value="County"/>
                                                        </div>
                                                        <!--NESTED DATA VALUE INLINE -->
                                                        <div class="restrict-data-field-value-inline" >
                                                            <h:outputText value="#{propertyProfileBB.currentProperty.countyCode}" />

                                                        </div>
                                                    </div>

                                                    <!--NESTED DATA FIELD -->
                                                    <div class="ui-g-12 ui-md-6 ui-lg-4 restrict-data-field">
                                                        <!--NESTED DATA LABEL INLINE -->
                                                        <div class="restrict-data-field-label-inline" >
                                                            <h:outputLabel value="User Group"/>
                                                        </div>
                                                        <!--NESTED DATA VALUE INLINE -->
                                                        <div class="restrict-data-field-value-inline" >
                                                            <h:outputText value="#{propertyProfileBB.currentProperty.useGroup}" />

                                                        </div>
                                                    </div>

                                                    <!--NESTED DATA FIELD -->
                                                    <div class="ui-g-12 ui-md-6 ui-lg-4 restrict-data-field">
                                                        <!--NESTED DATA LABEL INLINE -->
                                                        <div class="restrict-data-field-label-inline" >
                                                            <h:outputLabel value="Land Bank Prospect"/>
                                                        </div>
                                                        <!--NESTED DATA VALUE INLINE -->
                                                        <div class="restrict-data-field-value-inline" >
                                                            <h:outputText value="#{!(empty propertyProfileBB.currentProperty.landBankProspect)
                                                                                   ? propertyProfileBB.currentProperty.landBankProspect.title : ' '}" />

                                                        </div>
                                                    </div>

                                                    <!--NESTED DATA FIELD -->
                                                    <div class="ui-g-12 ui-md-6 ui-lg-4 restrict-data-field" >
                                                        <!--NESTED DATA LABEL INLINE -->
                                                        <div class="restrict-data-field-label-inline" >
                                                            <h:outputLabel value="Municipality"/>
                                                        </div>
                                                        <!--NESTED DATA VALUE INLINE -->
                                                        <div class="restrict-data-field-value-inline" >
                                                            <h:outputText value="#{propertyProfileBB.currentProperty.muni.muniName}
                                                                          (ID:#{propertyProfileBB.currentProperty.muni.muniCode})" />

                                                        </div>
                                                    </div>

                                                    <!--NESTED DATA FIELD -->
                                                    <div class="ui-g-12 ui-md-6 ui-lg-4 restrict-data-field">
                                                        <!--NESTED DATA LABEL INLINE -->
                                                        <div class="restrict-data-field-label-inline" >
                                                            <h:outputLabel value="Construction Type"/>
                                                        </div>
                                                        <!--NESTED DATA VALUE INLINE -->
                                                        <div class="restrict-data-field-value-inline" >
                                                            <h:outputText value="#{propertyProfileBB.currentProperty.constructionType}" />

                                                        </div>
                                                    </div>

                                                    <!--NESTED DATA FIELD -->
                                                    <div class="ui-g-12 ui-md-6 ui-lg-4 restrict-data-field">
                                                        <!--NESTED DATA LABEL INLINE -->
                                                        <div class="restrict-data-field-label-inline" >
                                                            <h:outputLabel value="Land Bank Held"/>
                                                        </div>
                                                        <!--NESTED DATA VALUE INLINE -->
                                                        <div class="restrict-data-field-value-inline" >
                                                            <h:outputText value="#{propertyProfileBB.currentProperty.landBankHeld}" />

                                                        </div>
                                                    </div>

                                                    <!--NESTED DATA FIELD -->
                                                    <div class="ui-g-12 ui-md-6 ui-lg-4 restrict-data-field">
                                                        <!--NESTED DATA LABEL INLINE -->
                                                        <div class="restrict-data-field-label-inline" >
                                                            <h:outputLabel value="Parcel ID"/>
                                                        </div>
                                                        <!--NESTED DATA VALUE INLINE -->
                                                        <div class="restrict-data-field-value-inline" >
                                                            <h:outputText value="#{propertyProfileBB.currentProperty.parID}" />

                                                        </div>
                                                    </div>
                                                    <!--NESTED DATA FIELD -->
                                                    <div class="ui-g-12 ui-md-6 ui-lg-4 restrict-data-field">
                                                        <!--NESTED DATA LABEL INLINE -->
                                                        <div class="restrict-data-field-label-inline" >
                                                            <h:outputLabel value="Condition Class"/>
                                                        </div>
                                                        <!--NESTED DATA VALUE INLINE -->
                                                        <div class="restrict-data-field-value-inline" >
                                                            <h:outputText value="#{!(empty propertyProfileBB.currentProperty.condition)
                                                                                   ? propertyProfileBB.currentProperty.condition.title
                                                                                   : ''}" />

                                                        </div>
                                                    </div>
                                                    <!--NESTED DATA FIELD -->
                                                    <div class="ui-g-12 ui-md-6 ui-lg-4 restrict-data-field">
                                                        <!--NESTED DATA LABEL INLINE -->
                                                        <div class="restrict-data-field-label-inline" >
                                                            <h:outputLabel value="Nonaddressable"/>
                                                        </div>
                                                        <!--NESTED DATA VALUE INLINE -->
                                                        <div class="restrict-data-field-value-inline" >
                                                            <h:outputText value="#{propertyProfileBB.currentProperty.nonAddressable}" />

                                                        </div>
                                                    </div>
                                                    <!--NESTED DATA FIELD -->
                                                    <div class="ui-g-12 ui-md-6 ui-lg-4 restrict-data-field">
                                                        <!--NESTED DATA LABEL INLINE -->
                                                        <div class="restrict-data-field-label-inline" >
                                                            <h:outputLabel value="Lot-Block"/>
                                                        </div>
                                                        <!--NESTED DATA VALUE INLINE -->
                                                        <div class="restrict-data-field-value-inline" >
                                                            <h:outputText value="#{propertyProfileBB.currentProperty.lotAndBlock}"  />

                                                        </div>
                                                    </div>
                                                    <!--NESTED DATA FIELD -->
                                                    <div class="ui-g-12 ui-md-6 ui-lg-4 restrict-data-field">
                                                        <!--NESTED DATA LABEL INLINE -->
                                                        <div class="restrict-data-field-label-inline" >
                                                            <h:outputLabel value="Source"/>
                                                        </div>
                                                        <!--NESTED DATA VALUE INLINE -->
                                                        <div class="restrict-data-field-value-inline" >
                                                            <h:outputText value="#{!(empty propertyProfileBB.currentProperty.bobSource)
                                                                                   ? propertyProfileBB.currentProperty.bobSource.title : ''}"  />

                                                        </div>
                                                    </div>
                                                    <!--NESTED DATA FIELD -->
                                                    <div class="ui-g-12 ui-md-6 ui-lg-4 restrict-data-field">
                                                        <!--NESTED DATA LABEL INLINE -->
                                                        <div class="restrict-data-field-label-inline" >
                                                            <h:outputLabel value="Active"/>
                                                        </div>
                                                        <!--NESTED DATA VALUE INLINE -->
                                                        <div class="restrict-data-field-value-inline" >
                                                            <h:outputText value="#{propertyProfileBB.currentProperty.active}" />
                                                        </div>
                                                    </div>
                                                </div>
                                            </h:form>

                                        </p:panel>

                                        <!--Insert/update Table-->
                                        <p:panel id="propinfo-panel-addupdate"
                                                 toggleable="true"
                                                 collapsed="false"
                                                 header="#{propertyProfileBB.currentProperty.propertyID == 0 ? 'New property record':'Update property record'}"
                                                 rendered="#{propertyProfileBB.getActiveInsertUpdateMode() }"
                                                 >

                                            <h:form id="prop-add-form">


                                                <p:commandButton    id="prop-add-addnew-commit-button-1"
                                                                    icon="fa fa-thmubs-o-up"
                                                                    ajax="false"
                                                                    action="#{propertyProfileBB.onInsertButtonChange()}"
                                                                    value="Commit record"
                                                                    rendered="#{propertyProfileBB.currentProperty.propertyID == 0}"
                                                                    />

                                                <p:commandButton    id="prop-add-update-commit-button-1"
                                                                    icon="fa fa-edit"
                                                                    ajax="false"
                                                                    action="#{propertyProfileBB.onUpdateButtonChange()}"
                                                                    value="Commit updates"
                                                                    rendered="#{propertyProfileBB.currentProperty.propertyID != 0}"
                                                                    />

                                                <p:commandButton    id="prop-add-discard-button-1"
                                                                    icon="fa fa-trash-o"
                                                                    ajax="false"
                                                                    action="#{propertyProfileBB.onDiscardNewPropertyDataButtonChange}"
                                                                    value="Discard new record"
                                                                    rendered="#{propertyProfileBB.currentProperty.propertyID == 0}"
                                                                    />

                                                <div    id="prop-add-container-div"
                                                        class="ui-g data-container">

                                                    <div    id="prop-add-muni-div"
                                                            class="ui-g-12 ui-md-12 ui-lg-12 data_field">

                                                        <p:outputLabel  value="Municipality"
                                                                        for="prop-add-muni-som"/>

                                                        <h:selectOneMenu id="prop-add-muni-som"
                                                                         value="#{propertyProfileBB.currentProperty.muni}" style="width:175px;height:25px">
                                                            <f:converter converterId="muniConverter"/>
                                                            <f:selectItems id="propinfoedit-muninamelist"
                                                                           value="#{sessionBean.sessUser.authMuniList}"
                                                                           var="m" itemValue="#{m}" itemLabel="#{m.muniName}"/>

                                                        </h:selectOneMenu>
                                                    </div>
                                                    <div    id="prop-add-address-div"
                                                            class="ui-g-12 ui-md-12 ui-lg-12 data_field">
                                                        <p:outputLabel value="Street Address"/>
                                                        <p:spacer width="3px"/>
                                                        <p:inputText    id="prop-add-address-it"
                                                                        value="#{propertyProfileBB.currentProperty.address}"
                                                                        />
                                                    </div>

                                                    <div    id="prop-add-cit-div"
                                                            class="ui-g-12 ui-md-12 ui-lg-12 data_field">
                                                        <p:outputLabel      id="prop-add-cit-ol"
                                                                            value="City"
                                                                            for="prop-add-cit-it"
                                                                            styleClass="data_field_label"/>

                                                        <p:inputText    id="prop-add-cit-it"
                                                                        value="#{propertyProfileBB.currentProperty.address_city}"
                                                                        />

                                                    </div>

                                                    <div    id="prop-add-state-div"
                                                            class="ui-g-12 ui-md-12 ui-lg-12 data_field">

                                                        <p:outputLabel value="State"
                                                                       for="prop-add-state-it"
                                                                       />

                                                        <p:inputText    id="prop-add-state-it"
                                                                        value="#{propertyProfileBB.currentProperty.address_state}"
                                                                        />

                                                    </div>

                                                    <div    id="prop-add-zip-div"
                                                            class="ui-g-12 ui-md-12 ui-lg-12 data_field">

                                                        <p:outputLabel value="Zip Code"
                                                                       for="prop-add-zip-it"
                                                                       />

                                                        <p:inputText    id="prop-add-zip-it"
                                                                        value="#{propertyProfileBB.currentProperty.address_zip}"
                                                                        />
                                                    </div>


                                                    <div    id="prop-add-lab-div"
                                                            class="ui-g-12 ui-md-12 ui-lg-12 data_field">

                                                        <p:outputLabel  value="Lot and Block"
                                                                        for="prop-add-lab-it"/>

                                                        <p:inputText    id="prop-add-lab-it"
                                                                        value="#{propertyProfileBB.currentProperty.lotAndBlock}"
                                                                        />

                                                    </div>

                                                    <div    id="prop-add-parid-div"
                                                            class="ui-g-12 ui-md-12 ui-lg-12 data_field">

                                                        <p:outputLabel value="ParcelID"
                                                                       for="prop-add-parid-it"/>

                                                        <p:inputText    id="prop-add-parid-it"
                                                                        value="#{propertyProfileBB.currentProperty.parID}"/>
                                                    </div>

                                                    <div    id="prop-add-usegroup-div"
                                                            class="ui-g-12 ui-md-12 ui-lg-12 data_field">

                                                        <p:outputLabel value="Use Group"
                                                                       for="prop-add-usegroup-it"/>

                                                        <p:inputText    id="prop-add-usegroup-it"
                                                                        value="#{propertyProfileBB.currentProperty.useGroup}"/>
                                                    </div>


                                                    <div    id="prop-add-const-div"
                                                            class="ui-g-12 ui-md-12 ui-lg-12 data_field">

                                                        <p:outputLabel value="Construction type"
                                                                       for="prop-add-const-it"/>

                                                        <p:inputText    id="prop-add-const-it"
                                                                        value="#{propertyProfileBB.currentProperty.constructionType}"/>
                                                    </div>



                                                    <div    id="prop-add-cond-div"
                                                            class="ui-g-12 ui-md-12 ui-lg-12 data_field">

                                                        <p:outputLabel  value="Condition"
                                                                        for="prop-add-condition-som"/>

                                                        <h:selectOneMenu id="prop-add-condition-som"
                                                                         value="#{propertyProfileBB.currentProperty.condition}" style="width:175px;height:25px">
                                                            <f:converter converterId="intensityClassConverter"/>
                                                            <f:selectItem itemLabel="select a muni..." noSelectionOption="true" />
                                                            <f:selectItems id="propinfoedit-condition-selitems"
                                                                           value="#{propertyProfileBB.conditionIntensityList}"
                                                                           var="ic" itemValue="#{ic}" itemLabel="#{ic.numericRating}: #{ic.title}"/>

                                                        </h:selectOneMenu>
                                                    </div>

                                                    <div    id="prop-add-landprospect-div"
                                                            class="ui-g-12 ui-md-12 ui-lg-12 data_field">

                                                        <p:outputLabel  value="Land Bank Prospect"
                                                                        for="prop-add-landprospect-som"/>

                                                        <h:selectOneMenu id="prop-add-landprospect-som"
                                                                         value="#{propertyProfileBB.currentProperty.landBankProspect}" style="width:175px;height:25px">
                                                            <f:converter converterId="intensityClassConverter"/>
                                                            <f:selectItem itemLabel="select a muni..." noSelectionOption="true" />
                                                            <f:selectItems id="propinfoedit-landprospect-selitems"
                                                                           value="#{propertyProfileBB.landBankProspectIntensityList}"
                                                                           var="ic" itemValue="#{ic}" itemLabel="#{ic.numericRating}: #{ic.title}"/>

                                                        </h:selectOneMenu>
                                                    </div>

                                                    <div    id="prop-add-source-div"
                                                            class="ui-g-12 ui-md-12 ui-lg-12 data_field">

                                                        <p:outputLabel  value="Object Source"
                                                                        for="prop-add-source-som"/>

                                                        <h:selectOneMenu id="prop-add-source-som"
                                                                         value="#{propertyProfileBB.currentProperty.bobSource}" style="width:175px;height:25px">
                                                            <f:converter converterId="bobSourceConverter"/>
                                                            <f:selectItem itemLabel="select a source..." noSelectionOption="true" />
                                                            <f:selectItems id="propinfoedit-sourcess-elitems"
                                                                           value="#{propertyProfileBB.sourceList}"
                                                                           var="bs" itemValue="#{bs}" itemLabel="#{bs.title}"/>

                                                        </h:selectOneMenu>
                                                    </div>


                                                    <div    id="prop-add-unfit-div"
                                                            class="ui-g-12 ui-md-12 ui-lg-12 data_field">

                                                        <p:outputLabel value="Unfit Start Date"
                                                                       for="prop-add-unfit-start-cal"/>

                                                        <p:calendar id="prop-add-unfit-start-cal"
                                                                    value="#{propertyProfileBB.currentProperty.unfitDateUtilStart}"
                                                                    mode="popup"
                                                                    pattern="EEE, dd MMM, yyyy HH:mm:ss"
                                                                    navigator="true"
                                                                    tabindex="16"
                                                                    timeInput="true"
                                                                    showHour="true" showMinute="false" showSecond="false" showMillisec="false"
                                                                    showButtonPanel="true"
                                                                    showTodayButton="true"
                                                                    maxdate="#{propertyProfileBB.currentProperty.unfitDateUtilStop}">
                                                        </p:calendar>
                                                    </div>

                                                    <div    id="prop-add-unfit-div"
                                                            class="ui-g-12 ui-md-12 ui-lg-12 data_field">

                                                        <p:outputLabel value="Unfit End Date"
                                                                       for="prop-add-unfit-end-cal"/>
                                                        <p:spacer height="3px"/>
                                                        <p:calendar id="prop-add-unfit-end-cal"
                                                                    value="#{propertyProfileBB.currentProperty.unfitDateUtilStop}"
                                                                    mode="popup"
                                                                    pattern="EEE, dd MMM, yyyy HH:mm:ss"
                                                                    navigator="true"
                                                                    tabindex="16"
                                                                    timeInput="true"
                                                                    showHour="true" showMinute="false" showSecond="false" showMillisec="false"
                                                                    showButtonPanel="true"
                                                                    showTodayButton="true"
                                                                    mindate="#{propertyProfileBB.currentProperty.unfitDateUtilStart}">
                                                        </p:calendar>

                                                    </div>

                                                    <div    id="prop-add-vacant-div"
                                                            class="ui-g-12 ui-md-12 ui-lg-12 data_field">

                                                        <p:outputLabel  value="Vacant Start Date"
                                                                        for="prop-add-vacant-start-cal"/>

                                                        <p:calendar id="prop-add-vacant-start-cal"
                                                                    value="#{propertyProfileBB.currentProperty.vacantDateUtilStart}"
                                                                    mode="popup"
                                                                    pattern="EEE, dd MMM, yyyy HH:mm:ss"
                                                                    navigator="true"
                                                                    tabindex="16"
                                                                    timeInput="true"
                                                                    showHour="true" showMinute="false" showSecond="false" showMillisec="false"
                                                                    showButtonPanel="true"
                                                                    showTodayButton="true"
                                                                    maxdate="#{propertyProfileBB.currentProperty.vacantDateUtilStop}">
                                                        </p:calendar>
                                                    </div>

                                                    <div    id="prop-add-vacant-stop-div"
                                                            class="ui-g-12 ui-md-12 ui-lg-12 data_field">

                                                        <p:outputLabel value="Vacant Stop Date"
                                                                       for="prop-add-vacant-stop-cal"/>

                                                        <p:calendar id="prop-add-vacant-stop-cal"
                                                                    value="#{propertyProfileBB.currentProperty.vacantDateUtilStop}"
                                                                    mode="popup"
                                                                    pattern="EEE, dd MMM, yyyy HH:mm:ss"
                                                                    navigator="true"
                                                                    tabindex="16"
                                                                    timeInput="true"
                                                                    showHour="true" showMinute="false" showSecond="false" showMillisec="false"
                                                                    showButtonPanel="true"
                                                                    showTodayButton="true"
                                                                    mindate="#{propertyProfileBB.currentProperty.vacantDateUtilStart}">
                                                        </p:calendar>
                                                    </div>

                                                    <div    id="prop-add-abandoned-div"
                                                            class="ui-g-12 ui-md-12 ui-lg-12 data_field">

                                                        <p:outputLabel value="Abandoned Start Date"
                                                                       for="prop-add-abandoned-start-cal"/>

                                                        <p:calendar id="prop-add-abandoned-start-cal"
                                                                    value="#{propertyProfileBB.currentProperty.abandonedDateUtilStart}"
                                                                    mode="popup"
                                                                    pattern="EEE, dd MMM, yyyy HH:mm:ss"
                                                                    navigator="true"
                                                                    tabindex="16"
                                                                    timeInput="true"
                                                                    showHour="true" showMinute="false" showSecond="false" showMillisec="false"
                                                                    showButtonPanel="true"
                                                                    showTodayButton="true"
                                                                    maxdate="#{propertyProfileBB.currentProperty.abandonedDateUtilStop}">
                                                        </p:calendar>
                                                    </div>

                                                    <div    id="prop-add-abandoned-stop-div"
                                                            class="ui-g-12 ui-md-12 ui-lg-12 data_field">

                                                        <p:outputLabel value="Abandoned Stop Date"
                                                                       for="prop-add-abandoned-stop-cal"/>

                                                        <p:calendar id="prop-add-abandoned-stop-cal"
                                                                    value="#{propertyProfileBB.currentProperty.abandonedDateUtilStop}"
                                                                    mode="popup"
                                                                    pattern="EEE, dd MMM, yyyy HH:mm:ss"
                                                                    navigator="true"
                                                                    tabindex="16"
                                                                    timeInput="true"
                                                                    showHour="true" showMinute="false" showSecond="false" showMillisec="false"
                                                                    showButtonPanel="true"
                                                                    showTodayButton="true"
                                                                    mindate="#{propertyProfileBB.currentProperty.abandonedDateUtilStart}">
                                                        </p:calendar>
                                                    </div>




                                                    <p:commandButton    id="prop-add-addnew-commit-button-2"
                                                                        icon="fa fa-thmubs-o-up"
                                                                        ajax="false"
                                                                        action="#{propertyProfileBB.onInsertButtonChange()}"
                                                                        value="Commit record"
                                                                        rendered="#{propertyProfileBB.currentProperty.propertyID == 0}"
                                                                        />

                                                    <p:commandButton    id="prop-add-update-commit-button-2"
                                                                        icon="fa fa-edit"
                                                                        ajax="false"
                                                                        action="#{propertyProfileBB.onUpdateButtonChange()}"
                                                                        value="Commit updates"
                                                                        rendered="#{propertyProfileBB.currentProperty.propertyID != 0}"
                                                                        />

                                                    <p:commandButton    id="prop-add-discard-button-2"
                                                                        icon="fa fa-trash-o"
                                                                        ajax="true"
                                                                        action="#{propertyProfileBB.onDiscardNewPropertyDataButtonChange}"
                                                                        value="Discard new record"
                                                                        rendered="#{propertyProfileBB.currentProperty.propertyID == 0}"
                                                                        />
                                                </div>
                                            </h:form>
                                        </p:panel>

                                        <!--remove panel-->
                                        <p:panel id="prop-remove-panel"
                                                 toggleable="true"
                                                 collapsed="false"
                                                 header="Remove property"
                                                 rendered="#{propertyProfileBB.getActiveRemoveMode() }"
                                                 >


                                            <h:form id="propinfo-remove-form">

                                                <p>Caution: This action is like 'delete'; we have to dig the record back out by
                                                    hand if you goof.</p>
                                                <p:commandButton icon="fa fa-stop"
                                                                 ajax="false"
                                                                 action="#{propertyProfileBB.onRemoveButtonChange()}"
                                                                 value="Permanently remove property ID:#{propertyProfileBB.currentProperty.propertyID}"
                                                                 />

                                            </h:form>

                                        </p:panel>

                                    </p:outputPanel>


                                </div>

                            </div>

                    </p:outputPanel>


                    <p:dialog   id="propinfo-notes-dialog"
                                height="300" width="750"
                                widgetVar="propinfo-notes-dialog-var"
                                closable="true"
                                header="Note Builder"
                                rendered="#{systemServicesBB.bbSessionUser.keyCard.hasMuniReaderPermissions}"
                                >

                        <h:form id="propinfo-note-create-form">

                            <h:messages id="propinfo-dialog-note-messages"
                                        globalOnly="true" showDetail="true" showSummary="true"
                                        warnClass="msgWarn" infoClass="msgInfo" fatalClass="msgFatal" errorClass="msgError">
                            </h:messages>

                            <h:panelGrid columns="1"
                                         columnClasses="gridTd, gridTd">

                                <h:panelGroup>
                                    <h:outputText styleClass="ui-label" value="Note text: "/>
                                    <p:editor   id="propinfo-notes-editor"
                                                value="#{propertyProfileBB.formNoteText}"
                                                controls="bold italic underline strikethrough font size style color
                                                bullets numbering center undo redo rule link removeformat"
                                                width="400" required="false"
                                                height="200"/>


                                    <p:spacer height="5px" />
                                    <p:commandButton    id="propinfo-updatemetadata-button-cancel"
                                                        ajax="true"  tabindex="27"
                                                        value="Cancel"
                                                        icon="fa fa-stop"
                                                        immediate="true"
                                                        onclick="PF('propinfo-notes-dialog-var').hide()"
                                                        />

                                    <p:commandButton   id="propinfo-dialog-notes-button-addnote"
                                                       ajax="true" 
                                                       actionListener="#{propertyProfileBB.onNoteCommitButtonChange}"
                                                       oncomplete="PF('propinfo-notes-dialog-var').hide()"
                                                       rendered="#{systemServicesBB.bbSessionUser.keyCard.hasMuniStaffPermissions}"                                                                               
                                                       value="Attach Note"  
                                                       styleClass="inline-button"
                                                       icon="fa fa-sticky-note-o"
                                                       update="propinfo-notes-form"/>
                                </h:panelGroup>
                            </h:panelGrid>
                        </h:form>
                    </p:dialog>

                </f:view>

                <script type="text/javascript">
                    $(function () {
                        $.extend(PF("datatable"), {
                            onKeyDown: function (e) {
                                var key = e.which,
                                        keyCode = $.ui.keyCode;
                                if ((key === keyCode.ENTER || key === keyCode.NUMPAD_ENTER)) {
                                    e.preventDefault();
                                }
                            },
                            onKeyUp: function (e, rowIndex) {
                                var key = e.which,
                                        keyCode = $.ui.keyCode;
                                //.ui-row-editor-check .ui-icon-check .ui-c
                                if ((key === keyCode.ENTER || key === keyCode.NUMPAD_ENTER)) {
                                    this.tbody
                                            .find('.ui-row-editor .ui-icon-check')
                                            .eq(rowIndex)
                                            .click();
                                }
                                if (key === keyCode.ESCAPE) {
                                    this.tbody
                                            .find('.ui-row-editor .ui-icon-close')
                                            .eq(rowIndex)
                                            .click();
                                }
                            }
                        });
                    });
                </script>
            </ui:define>
        </ui:composition>
    </h:body>
</html>

