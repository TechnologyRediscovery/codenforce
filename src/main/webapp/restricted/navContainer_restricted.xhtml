<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:f="http://xmlns.jcp.org/jsf/core"
      xmlns:p="http://primefaces.org/ui">

    <h:head>
        <link rel="shortcut icon" type="image/x-icon" href="#{request.contextPath}/resources/favicon.ico"/>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
        <h:outputStylesheet name="css/style.css"/>
        <h:outputStylesheet name="css/primeflex.min.css"/>
        <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet"/>
        <link href="https://fonts.googleapis.com/css?family=Montserrat" rel="stylesheet"/>
        <link href="https://fonts.googleapis.com/css?family=Heebo" rel="stylesheet"/>
        <title>codeNforce</title>
    </h:head>
    <h:body>
        <h:outputScript name="/js/navcontainer.js" target="body"/>

        <div class="flex-box-container">
            <ui:insert name="top">
                <div class="flexing-box-topbar">
                    <div class="logo-image-wrapper">
                        <h:graphicImage value="/images/Logo-N.png" height="100px"/>
                    </div>
                </div>
            </ui:insert>
        </div>

        <div class="flex-box-container">
            <div class="flexing-box-interior">
                <div class="flex-box-container-interior">
                    <f:view id="sessionInfoView">
                        <div id="maincontent">

                            <!-- SIDE NAVIGATION BAR -->
                            <h:form id="sidebar-form">
                                <div class="toolsidebarcontainer">
                                    <div id="toolSidebar" class="sidebar">
                                        <div class="toolSidebarCollapse" id="toolSidebarCollapseId">
                                            <i id="toolSidebarExpansionButtonIcon" class="fa fa-list"></i>
                                        </div>

                                        <div class="toolSidebarExpansion" id="toolSidebarExpansionId">
                                            <div class="toolSidebarTitle">
                                                Configuration Tool 
                                            </div>
                                            <i id="toolSidebarCollapseButtonIcon" class="fa fa-arrow-circle-left"></i>
                                        </div>

                                        <ui:repeat value="#{navigationBB.getSideBarNavList()}"
                                                   var="sidebarnavitem">
                                            <div class="sidebar_menu">
                                                <div class="sidebar_item">
                                                    <div class="sidebar_firstmenu_item">
                                                        <div class="sidebar_firstmenu_item_containner">
                                                            <i class="#{sidebarnavitem.icon}"/>
                                                            <div class="sidebar_firstmenu_font">
                                                                #{sidebarnavitem.value}
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <div class="sidebar_secondmenu">
                                                        <ui:repeat value="#{sidebarnavitem.subNavitem}" 
                                                                   var="sidebarnavsubnavitem">
                                                            <div class="sidebar_secondmenu_item">
                                                                <div class="sidebar_secondmenu_item_containner">
                                                                    <i class="#{sidebarnavsubnavitem.getIcon()}"/>
                                                                    <div class="sidebar_secondmenu_font">
                                                                        <p:commandLink
                                                                            style="color: inherit; text-decoration: none"
                                                                            action="#{sidebarnavsubnavitem.getPagePath()}"
                                                                            value="#{sidebarnavsubnavitem.value}" 
                                                                            ajax="false"/>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </ui:repeat>
                                                    </div>
                                                </div>
                                            </div>                                
                                        </ui:repeat>
                                        <p:commandButton id="navcontres-button-logout"
                                                         action="#{systemServicesBB.logout}"
                                                         value=""
                                                         title="Logout"
                                                         style="width:10px"
                                                         icon="fa fa-sign-out"
                                                         ajax="false"/>
                                    </div>
                                </div>
                            </h:form>

                            <!-- TOP NAVIGATION BAR -->
                            <div class="ui-g data_container_nested_restrict" style="background-color: gray; margin-bottom: 0px;">

                                <div class="activebob-container p-col"
                                     id="activbob-muni">

                                    <div class="ui-g data_container_nested_restrict">

                                        <!--NESTED DATA FIELD VERTICAL-->
                                        <div class="ui-g-12 ui-md-12 ui-lg-12 restrict-data-field-vertical">

                                            <div class="aob-container aob-container-iconifiedheader">

                                                <div class="inline-icon">

                                                    <i class="material-icons">
                                                        <h:outputText value="location_city"/>
                                                    </i>
                                                </div>

                                                <h:outputText value="Municipality"/>
                                            </div>
                                            <div class="aob-container aob-container-objectstring">

                                                <h:outputText value="#{sessionBean.sessMuni.muniName}"/>
                                                <h:outputText value=" (#{sessionBean.sessMuni.muniCode})"/>

                                            </div>
                                            <div class="aob-container aob-container-actions">
                                                <h:form id="topnav-muni-form">

                                                    <div class="restrict-main-contents-io-link link-button">

                                                        <p:commandLink    id="aob-muni-dash-cl" 
                                                                          value="dashboard"
                                                                          action="missionControl"
                                                                          ajax="false"/>
                                                    </div>

                                                    <div class="restrict-main-contents-io-link link-button">

                                                        <p:commandLink    id="aob-muni-change-cl" 
                                                                          value="change muni"
                                                                          action="#{missionControlBB.reauthenticate}" 
                                                                          ajax="false"/>
                                                    </div>
                                                    <p:spacer height="3px" />
                                                    <div class="restrict-main-contents-io-link link-button">

                                                        <p:commandLink    id="aob-muni-property-cl" 
                                                                          value="Muni Prop: #{sessionBean.sessMuni.muniPropertyDH.countyParcelID}"
                                                                          action="#{navigationBB.navigateToMuniPropertyDH}" 
                                                                          ajax="false"/>
                                                    </div>
                                                    
                                                    
                                                </h:form>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <div class="activebob-container p-col"
                                     id="activbob-code">

                                    <div class="ui-g data_container_nested_restrict">
                                        <!--NESTED DATA FIELD VERTICAL-->
                                        <div class="ui-g-10 ui-md-10 ui-lg-10">


                                            <div class="aob-container aob-container-iconifiedheader">

                                                <div class="inline-icon">

                                                    <i class="material-icons">
                                                        <h:outputText value="gavel"/>
                                                    </i>
                                                </div>

                                                <h:outputText value="Code Book"/>
                                            </div>
                                        </div>    


                                        <div class="ui-g-12 ui-md-12 ui-lg-12 restrict-data-field-vertical">
                                            <div class="aob-container aob-container-objectstring">
                                                <h:outputText value="#{sessionBean.sessMuni.codeSet.codeSetName}"/>

                                            </div>

                                            <div class="aob-container aob-container-actions">
                                                <h:form id="topnav-codebook-form">
                                                    <div class="restrict-main-contents-io-link link-button">

                                                        <p:commandLink    id="navcontres-button-ordinances" 
                                                                          value="ordinances"
                                                                          action="#{navigationBB.onOrdinancesLinkClick}"
                                                                          ajax="false"/>
                                                        
                                                        <h:outputText value=" | " />

                                                        <p:commandLink      id="navcontres-button-categories" 
                                                                            value="categories"
                                                                            oncomplete="PF('codeguide-list-dialog-var').show()"
                                                                            update="  codeguide-list-dialog
                                                                                        codeguide-list-form"
                                                                            actionListener="#{codeElementGuideBB.onViewCodeGuideNavLinkClick}"
                                                                            ajax="true"/>
                                                        <br/>

                                                        <p:commandLink    id="navcontres-button-codebook" 
                                                                          value="code book"
                                                                          action="#{navigationBB.onCodebookLinkClick}"
                                                                          ajax="false"/>
                                                        
                                                        <h:outputText value=" | " />
                                                        
                                                        <p:commandLink    id="navcontres-button-checklists" 
                                                                          value="checklists"
                                                                          action="#{navigationBB.onChecklistsLinkClick()}"
                                                                          ajax="false"/>
                                                        <br/>


                                                        <a href="https://technologyrediscovery.github.io/codenforce/code/code"
                                                           target="_blank">
                                                            help
                                                        </a>
                                                    </div>
                                                </h:form>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <ui:include src="/restricted/cogstaff/code/compositions/codeGuideTools.xhtml" />

                                <div class="activebob-container p-col"
                                     id="aob-property">

                                    <div class="ui-g data_container_nested_restrict">

                                        <!--NESTED DATA FIELD VERTICAL-->
                                        <div class="ui-g-12 ui-md-12 ui-lg-12 restrict-data-field-vertical">

                                            <div class="aob-container aob-container-iconifiedheader">

                                                <div class="inline-icon">

                                                    <i class="material-icons">
                                                        <h:outputText value="home"/>
                                                    </i>
                                                </div>

                                                <h:outputText value="Property"/>
                                            </div>
                                            <div class="aob-container aob-container-objectstring">


                                                <h:outputText value="#{sessionBean.sessProperty.address.addressPretty1Line}"/>
                                                

                                            </div>
                                            <h:form id="topnav-prop-form">

                                                <div class="aob-container aob-container-actions">

                                                    <div class="restrict-main-contents-io-link link-button">
                                                        <p:commandLink id="activebob-proplist-prop-explore-cl"
                                                                       action="#{navigationBB.onPropertyViewButtonChange()}"
                                                                       value="view"
                                                                       ajax="false"/>
                                                    </div>

                                                    <div class="restrict-main-contents-io-link link-button">

                                                        <p:commandLink id="activebob-proplist-cb"
                                                                       value="property search"
                                                                       oncomplete="PF('prop-search-dialog-var').show();"/>
                                                    </div>
                                                    
                                                    <p:spacer height="5px" />
                                                    
                                             
                                                    <div class="restrict-main-contents-io-link link-button">

                                                        <p:commandLink id="activebob-searchaddresses-cb"
                                                                       value="address search"
                                                                       ajax="true"
                                                                       actionListener="#{navigationBB.onAddressManagerViewLinkClick}"
                                                                       oncomplete="PF('address-search-dialog-var').show();"/>
                                                    </div>
                                                    <p:spacer height="2px" />

                                                    <p:overlayPanel id="activebob-proplist-overlay"
                                                                    widgetVar="activebob-proplist-overlay-var"
                                                                    appendTo="activebob-property"
                                                                    dismissable="true">
                                                        <b><h:outputText value="#{sessionBean.sessPropertyList.size()} properties:"/></b><br/>

                                                        <ui:repeat id="activebob-proplist-repeat"
                                                                   value="#{sessionBean.sessPropertyList}"
                                                                   var="sprop">

                                                            <h:outputText value="#{sprop.addressString}"/>

                                                            <div class="restrict-main-contents-io-link link-button">
                                                                <p:commandLink id="activebob-proplist-prop-explore-cl"
                                                                               action="#{navigationBB.onPropertyListItemSelect(sprop)}"
                                                                               value="view"
                                                                               ajax="false">
                                                                </p:commandLink>
                                                            </div>
                                                        </ui:repeat>

                                                        <p:commandLink id="activebob-property-view-cl"
                                                                       ajax="false"
                                                                       action="#{sessionBean.navigateToPageCorrespondingToObject(sessionBean.sessProperty)}"/>
                                                    </p:overlayPanel>
                                                </div>
                                            </h:form>
                                            
                                            <ui:include src="/restricted/cogstaff/prop/compositions/addresses.xhtml"/>
                                            <ui:include src="/restricted/cogstaff/prop/compositions/propertySearch.xhtml"/>
                                        </div>
                                    </div>
                                </div>

                                <div class="activebob-container p-col"
                                     id="aob-person">

                                    <div class="ui-g data_container_nested_restrict">

                                        <!--NESTED DATA FIELD VERTICAL-->
                                        <div class="ui-g-12 ui-md-12 ui-lg-12 restrict-data-field-vertical">

                                            <div class="aob-container aob-container-iconifiedheader">
                                                <div class="inline-icon">
                                                    <i class="material-icons">
                                                        <h:outputText value="person"/>
                                                    </i>
                                                </div>

                                                <h:outputText value="Person"/>
                                            </div>
                                                
                                            <ui:include src="cogstaff/person/compositions/personTools.xhtml"/>
                                            <h:form id="topnav-pers-form">
                                                <div class="aob-container aob-container-objectstring">
                                                    <h:outputText value="#{sessionBean.sessPerson.name} (ID:#{sessionBean.sessPerson.personID})"/>
                                                </div>

                                                <div class="aob-container aob-container-actions">

                                                    <div class="restrict-main-contents-io-link link-button">

                                                        <p:commandLink  id="activebob-persontools-cb"
                                                                        value="view/edit"
                                                                        ajax="true"
                                                                        actionListener="#{personBB.onViewCurrentPersonLinkClick}"
                                                                        update="person-info-form
                                                                                person-profile-addresses-form
                                                                                person-profile-phones-form
                                                                                person-profile-emails-form
                                                                                person-links-form
                                                                                person-profile-dialog"
                                                                        oncomplete="PF('person-profile-dialog-var').show();"/>
                                                    </div>

                                                    <div class="restrict-main-contents-io-link link-button">

                                                        <p:commandLink  id="activebob-perslist-cb"
                                                                        value="search/create"
                                                                        ajax="true"
                                                                        actionListener="#{personBB.onPersonSearchInitLinkClick}"
                                                                        oncomplete="PF('human-search-dialog-var').show();"
                                                                        update="human-search-dialog
                                                                        search-query-form
                                                                        log-form
                                                                        pers-search-results-form
                                                                        pers-selected-form
                                                                        hlh-humlist-form"/>
                                                    </div>
                                                </div>
                                            </h:form>
                                        </div>
                                        <p:overlayPanel id="activebob-perslist-overlay"
                                                        widgetVar="activebob-perslist-overlay-var"
                                                        appendTo="activebob-person"
                                                        dismissable="true">
                                            <h:form id="topnav-perslist-form">
                                                <b><h:outputText value="#{sessionBean.sessPersonList.size()} persons:"/></b><br/>
                                                <ui:repeat id="activebob-perslist-repeat"
                                                           value="#{sessionBean.sessPersonList}"
                                                           var="spers">
                                                    <p:commandLink id="activebob-proplist-prop-explore-cl"
                                                                   action="#{navigationBB.onViewPersonListItemSelect(spers)}"
                                                                   ajax="false">
                                                        <h:outputText value="#{spers.name} (ID:#{spers.humanID})"/>
                                                        <p:spacer height="3px"/>
                                                    </p:commandLink>
                                                </ui:repeat>
                                            </h:form>
                                        </p:overlayPanel>
                                    </div>
                                </div>

                                <div class="activebob-container p-col"
                                     id="aob-cecase">

                                    <div class="ui-g data_container_nested_restrict">

                                        <!--NESTED DATA FIELD VERTICAL-->
                                        <div class="ui-g-12 ui-md-12 ui-lg-12 restrict-data-field-vertical">

                                            <div class="aob-container aob-container-iconifiedheader">

                                                <div class="inline-icon">

                                                    <i class="material-icons">
                                                        <h:outputText value="gavel"/>
                                                    </i>
                                                </div>

                                                <h:outputText value="CE Case"/>
                                            </div>
                                            <div class="aob-container aob-container-objectstring">

                                                <h:outputText value="#{sessionBean.sessCECase.caseName} (ID:#{sessionBean.sessCECase.caseID})"/>

                                            </div>
                                            <h:form id="topnav-cecase-form">

                                                <div class="aob-container aob-container-actions">

                                                    <div class="restrict-main-contents-io-link link-button">
                                                        <p:commandLink id="activebob-cecase-view-cl"
                                                                       value="view"
                                                                       ajax="false"
                                                                       action="#{sessionBean.navigateToPageCorrespondingToObject(sessionBean.sessCECase)}"/>
                                                    </div>

                                                    <div class="restrict-main-contents-io-link link-button">

                                                        <p:commandLink  id="activebob-cecaselist-cb"
                                                                        value="change"
                                                                        oncomplete="PF('activebob-cecaselist-overlay-var').show();"/>
                                                    </div>
                                                    <p:spacer height="3px" />
                                                    <div class="restrict-main-contents-io-link link-button">
                                                        <p:commandLink   id="print-case-list-cl" 
                                                                        ajax="true" 
                                                                        actionListener="#{ceCaseSearchAndReportBB.prepareReportCECaseList}"
                                                                        styleClass="button"
                                                                        oncomplete="PF('cecase-list-report-dialog-var').show()"
                                                                        value="prepare Case List Report" 
                                                                        update="cecase-list-report-form"/>

                                                    </div>
                                                </div>
                                            </h:form>

                                        </div>
                                        
                                        <p:overlayPanel id="activebob-cecaselist-overlay"
                                                        widgetVar="activebob-cecaselist-overlay-var"
                                                        appendTo="activebob-cecase"
                                                        dismissable="true">
                                            <h:form id="topnav-caselist-form">

                                                <b><h:outputText value="#{sessionBean.sessCECaseList.size()} cases:"/></b><br/>

                                                <ui:repeat id="activebob-cecaselist-repeat"
                                                           value="#{sessionBean.sessCECaseList}"
                                                           var="cse">
                                                    <p:commandLink id="activebob-proplist-prop-explore-cl"
                                                                   ajax="false"
                                                                   action="#{navigationBB.onCECaseListItemSelect(cse)}">
                                                        <h:outputText value="#{cse.caseName} at #{cse.property.addressString} (ID:#{cse.caseID})"/>
                                                    </p:commandLink>



                                                    <p:spacer height="2px"/>
                                                </ui:repeat>
                                            </h:form>
                                        </p:overlayPanel>
                                    </div>
                                </div>

                                <div class="activebob-container p-col"
                                     id="aob-occperiod">

                                    <div class="ui-g data_container_nested_restrict">
                                        <div class="ui-g-12 ui-md-12 ui-lg-12 restrict-data-field-vertical">
                                            <div class="aob-container aob-container-iconifiedheader">
                                                <div class="inline-icon">
                                                    <i class="material-icons">
                                                        <h:outputText value="date_range"/>
                                                    </i>
                                                </div>
                                                <h:outputText value="Permit File"/>
                                            </div>

                                            <div class="aob-container aob-container-objectstring">
                                                <h:outputText value="Unit #{sessionBean.sessOccPeriod.propUnitProp.unitNumber} (ID:#{sessionBean.sessOccPeriod.periodID})"/>
                                                <h:outputText value="| Unit #{!empty sessionBean.sessOccPeriod ? sessionBean.sessOccPeriod.propUnitProp.unitNumber : ''}"/>
                                                <h:outputText value="(ID:#{!empty sessionBean.sessOccPeriod ? sessionBean.sessOccPeriod.periodID : ''})"/>
                                            </div>
                                            <h:form id="topnav-occ-form">
                                                <div class="aob-container aob-container-actions">
                                                    <div class="restrict-main-contents-io-link link-button">
                                                        <p:commandLink id="activebob-occperiod-view-cl"
                                                                       value="view"
                                                                       ajax="false"
                                                                       disabled="#{empty sessionBean.sessOccPeriod}"
                                                                       action="#{sessionBean.navigateToPageCorrespondingToObject(sessionBean.sessOccPeriod)}"/>
                                                    </div>

                                                    <div class="restrict-main-contents-io-link link-button">
                                                        <p:commandLink  id="activebob-occperiodlist-cb"
                                                                        value="search"
                                                                        disabled="true"
                                                                        oncomplete="PF('activebob-occperiodlist-overlay-var').show();"/>
                                                    </div>
                                                </div>
                                            </h:form>
                                        </div>
                                        <p:overlayPanel id="activebob-occperiodlist-overlay"
                                                        widgetVar="activebob-occperiodlist-overlay-var"
                                                        appendTo="activebob-occperiod"
                                                        dismissable="true">
                                            <h:form id="topnav-occperiodlist-form">

                                                <b><h:outputText value="#{sessionBean.sessOccPeriodList.size()} periods:"/></b><br/>

                                                <ui:repeat id="activebob-occperiodlist-repeat"
                                                           value="#{sessionBean.sessOccPeriodList}"
                                                           var="ose">
                                                    <p:commandLink id="activebob-proplist-prop-explore-cl"
                                                                   ajax="false"
                                                                   action="#{navigationBB.onOccPeriodListItemSelect(ose)}">
                                                        <h:outputText value="#{ose.propUnitProp.property.addressString} #{ose.propUnitProp.unitNumber} (ID:#{ose.periodID})"/>
                                                    </p:commandLink>


                                                    <p:spacer height="2px"/>
                                                </ui:repeat>
                                            </h:form>
                                        </p:overlayPanel>
                                    </div>
                                </div>
                            </div>
                            

                            <div style="float:right;">
                                <h:form id="userform">

                                    <h:outputText value="#{systemServicesBB.bbSessionUser.human.firstName} #{systemServicesBB.bbSessionUser.human.lastName} ( #{systemServicesBB.bbSessionUser.username})"/>

                                    <div class="restrict-main-contents-io-link link-button">
                                        <p:commandLink id="navbar-button-usersettings2"
                                                       ajax="true"
                                                       actionListener="#{userBB.initiateUserUpdates}"
                                                       rendered="true"
                                                       disabled="false"
                                                       oncomplete="PF('navcontainer-dialog-usersettings').show()"
                                                       value="user settings"
                                                       update="usersettings-form"/>
                                    </div>


                                    <div class="restrict-main-contents-io-link link-button">

                                        <p:commandLink id="navcontres-button-logout2"
                                                       action="#{systemServicesBB.logout}"
                                                       value="logout"
                                                       ajax="false"/>
                                    </div>
                                </h:form>
                            </div>
                            <ui:include src="/restricted/cogstaff/ce/compositions/caseListReport.xhtml" />


                            <p:dialog header="User settings" 
                                      widgetVar="navcontainer-dialog-usersettings" 
                                      responsive="true" 
                                      width="1000"
                                      modal="false"
                                      height="500">


                                <h2>
                                    <h:outputText value="User settings:"/>

                                    <h:outputText value="#{userBB.currentUser.username}"/>
                                    <h:outputText value="(ID: "/>
                                    <h:outputText value="#{userBB.currentUser.userID}"/>
                                    <h:outputText value=")"/>
                                    <h:outputText value=" "/>
                                    <h:outputText value="#{userBB.currentUser.human.name}"/>
                                    <h:outputText value=" "/>
                                    <h:outputText value="(HID: "/>
                                    <h:outputText value="#{userBB.currentUser.human.humanID}"/>
                                    <h:outputText value=")"/>
                                </h2>

                                <div class="ui-g data-container">

                                    <div class="ui-g-12 ui-md-12 ui-lg-12 data_field">


                                        <h:outputText value="#{userBB.currentUser.role.label}"/>
                                        <h:outputText value=":"/>
                                        <h:outputText value="rnk" 
                                                      class="dtype-label"/>
                                        <h:outputText value=":"/>
                                        <h:outputText value="#{userBB.currentUser.role.rank}"/>

                                        <h:outputText value="Auth Period ID:: #{userBB.currentUser.keyCard.governingAuthPeriod.muni.muniName}"/>
                                        <h:outputText value="Auth Period ID:: #{userBB.currentUser.keyCard.governingAuthPeriod.muni.muniName}"/>
                                        <h:outputText value="Auth Period ID:: #{userBB.currentUser.keyCard.governingAuthPeriod.userMuniAuthPeriodID}"/>
                                        <h:outputText value=" | "/>
                                        <h:outputText value="Period created TS:: #{userBB.getPrettyDate(userBB.currentUser.keyCard.governingAuthPeriod.createdTS)}"/>
                                        <h:outputText value=" | "/>
                                        <h:outputText value="Assignment priority:: #{userBB.currentUser.keyCard.governingAuthPeriod.assignmentRelativeOrder} "/>

                                        <h:form id="usersettings-messages-form-username">
                                            <h:messages id="usersettings-messages-username"
                                                        globalOnly="true" showDetail="true" showSummary="true"
                                                        warnClass="msgWarn" infoClass="msgInfo" fatalClass="msgFatal" errorClass="msgError">
                                            </h:messages>
                                        </h:form>

                                        <h:form id="usersettings-form"
                                                rendered="false">

                                            <p:outputLabel for="usersettings-it-username">
                                                <h:outputText value="User name"/>
                                            </p:outputLabel>
                                            <p:inputText id="usersettings-it-username" value="#{userBB.currentUser.username}" 
                                                         size="12"
                                                         maxlength="20"
                                                         tabindex="3" 
                                                         required="true" 
                                                         disabled="true"
                                                         validatorMessage="Length must be between 5 and 20 characters"
                                                         styleClass="inputText">
                                                <f:validateLength minimum="4" maximum="50"/>
                                            </p:inputText>
                                            <h:message for="usersettings-it-username" showDetail="false" showSummary="true" 
                                                       warnClass="msgWarn" infoClass="msgInfo" fatalClass="msgFatal" errorClass="msgError"/>

                                            <p:commandButton id="usersettings-button-updateusername"
                                                             ajax="true"
                                                             actionListener="#{userBB.commitUsernameUpdates}"
                                                             icon="fa fa-thumbs-o-up"
                                                             update="    usersettings-it-username
                                                             usersettings-messages-form-username
                                                             usersettings-notes-form"
                                                             value="Update username"
                                                             rendered="false"
                                                             tabindex="3"/>
                                        </h:form>

                                        <h:form id="usersettings-messages-form-personlink">
                                            <h:messages id="usersettings-messages-personlink"
                                                        globalOnly="true" showDetail="true" showSummary="true"
                                                        warnClass="msgWarn" infoClass="msgInfo" fatalClass="msgFatal" errorClass="msgError">
                                            </h:messages>
                                        </h:form>
                                    </div>
                                    <div class="ui-g-12 ui-md-12 ui-lg-12 data_field">


                                        <h:form id="usersettings-form-userpersonlink">

                                            <h:outputText value="Your user is currently mapped to: "/>
                                            <p:spacer height="5px"/>
                                            <h:outputText value="#{userBB.currentUser.human.name}"/>
                                            <h:outputText value=" (ID: #{userBB.currentUser.human.humanID})"/>
                                            <h:outputText value=" "/>


                                            <p:spacer height="5px"/>

                                            <p:outputLabel for="usersettings-som-userpersons"
                                                           value="Available User-type persons:"/>
                                            <p:selectOneMenu id="usersettings-som-userpersons"
                                                             required="true"
                                                             value="#{userBB.formSelectedUserPerson}">
                                                <f:selectItem itemLabel="select a person..." noSelectionOption="true"/>
                                                <f:selectItems value="#{userBB.userPersonList}"  var="p" itemValue="#{p}" 
                                                               itemLabel="#{p.name} (id:#{p.humanID})"/>
                                                <f:converter converterId="humanConverter"/>
                                            </p:selectOneMenu>
                                            <h:message for="usersettings-som-userpersons" showDetail="false" showSummary="true" 
                                                       warnClass="msgWarn" infoClass="msgInfo" fatalClass="msgFatal" errorClass="msgError"/>


                                            <p:commandButton id="usersettings-button-genuserpersonlist"
                                                             ajax="true"
                                                             actionListener="#{userBB.generateUserPersonList}"
                                                             update="usersettings-som-userpersons"
                                                             icon="fa fa-thumbs-0-up"
                                                             value="Gemerate person list"
                                                             tabindex="3"/>

                                            <p:commandButton id="usersettings-button-updatepersonlink"
                                                             ajax="true"
                                                             actionListener="#{userBB.commitUserPersonUpdates}"
                                                             update="usersettings-messages-form-personlink
                                                             usersettings-form-userpersonlink
                                                             usersettings-notes-form"
                                                             icon="fa fa-thumbs-0-up"
                                                             value="Update person link"
                                                             tabindex="4"/>
                                        </h:form>

                                        <h:form id="usersettings-messages-form-updatepassword">
                                            <h:messages id="usersettings-messages-updategepassword"
                                                        globalOnly="true" showDetail="true" showSummary="true"
                                                        warnClass="msgWarn" infoClass="msgInfo" fatalClass="msgFatal" errorClass="msgError">
                                            </h:messages>
                                        </h:form>

                                    </div>
                                    <div class="ui-g-12 ui-md-12 ui-lg-12 data_field">



                                        <h:form id="usersettings-form-updatepassword">
                                            <p:outputLabel for="usersettings-it-password">
                                                <h:outputText value="New password (use letters and numbers; at least 8 chars please! "/>
                                            </p:outputLabel>
                                            <p:password id="usersettings-it-password" value="#{userBB.formPassword}" 
                                                        style="width: 150px;"
                                                        maxlength="80"
                                                        tabindex="3" 
                                                        required="true" 
                                                        validatorMessage="Length must be between 8 and 50 characters"
                                                        feedback="true"
                                                        styleClass="inputText">
                                                <f:validateLength minimum="8" maximum="50"/>
                                            </p:password>

                                            <p:spacer height="5px"/>

                                            <p:outputLabel for="usersettings-it-password">
                                                <h:outputText value="Re-enter password"/>
                                            </p:outputLabel>

                                            <p:password id="usersettings-it-password-reentry" value="#{userBB.formPasswordReentry}" 
                                                        style="width: 150px;"
                                                        maxlength="80"
                                                        tabindex="3" 
                                                        required="true" 
                                                        validatorMessage="Length must be between 8 and 50 characters"
                                                        feedback="true"
                                                        styleClass="inputText">
                                                <f:validateLength minimum="8" maximum="50"/>
                                            </p:password>

                                            <h:message for="usersettings-it-password" showDetail="false" showSummary="true" 
                                                       warnClass="msgWarn" infoClass="msgInfo" fatalClass="msgFatal" errorClass="msgError"/>
                                            <p:commandButton id="usersettings-button-updatepassword"
                                                             ajax="true"
                                                             actionListener="#{userBB.commitPasswordUpdates}"
                                                             update="usersettings-messages-form-updatepassword
                                                             usersettings-form-updatepassword
                                                             usersettings-notes-form"
                                                             icon="fa fa-lock"
                                                             value="Update password"
                                                             tabindex="3"/>
                                        </h:form>



                                        <h:form id="usersettings-notes-form">

                                            <h:outputText value="Notes: " styleClass="bold"/>
                                            <p:spacer height="3px"/>
                                            <h:outputText   id="usersettings-notes-ot"
                                                            value="#{userBB.currentUser.notes}" 
                                                            escape="false"/>
                                        </h:form>


                                    </div>

                                    <h:form id="usersettings-umaps-messages-form">
                                        <h:messages id="usersettings-umaps-messages"
                                                    globalOnly="true" showDetail="true" showSummary="true"
                                                    warnClass="msgWarn" infoClass="msgInfo" fatalClass="msgFatal" errorClass="msgError">
                                        </h:messages>
                                    </h:form>

                                    <h:form id="usersettings-umaps-table-form">
                                        <div class="ui-g-12 ui-md-12 ui-lg-12 data_field">

                                            <p:dataTable
                                                id="usersettings-umaps-table"
                                                var="period"
                                                value="#{systemServicesBB.bbSessionUser.muniAuthPeriodListForCredMuni}"
                                                rowKey="#{period.userMuniAuthPeriodID}"
                                                tableStyleClass="primeDataTable">

                                                <p:column width="3%" exportable="false">
                                                    <f:facet name="header">
                                                        <h:outputText value="Expand row"/>
                                                    </f:facet>
                                                    <p:rowToggler/>
                                                </p:column>

                                                <p:column>
                                                    <f:facet name="header">
                                                        <h:outputText value="Period ID"/>
                                                    </f:facet>
                                                    <h:outputText value="#{period.userMuniAuthPeriodID}"/>
                                                </p:column>

                                                <p:column>
                                                    <f:facet name="header">
                                                        <h:outputText value="Muni"/>
                                                    </f:facet>
                                                    <h:outputText value="#{period.muni.muniName}"/>
                                                </p:column>


                                                <p:column>
                                                    <f:facet name="header">
                                                        <h:outputText value="Access start"/>
                                                    </f:facet>
                                                    <h:outputText value="#{systemServicesBB.getPrettyDate(period.startDate)}"/>
                                                </p:column>

                                                <p:column>
                                                    <f:facet name="header">
                                                        <h:outputText value="Access stop"/>
                                                    </f:facet>
                                                    <h:outputText value="#{systemServicesBB.getPrettyDate(period.stopDate)}"/>
                                                </p:column>

                                                <p:column>
                                                    <f:facet name="header">
                                                        <h:outputText value="Role"/>
                                                    </f:facet>
                                                    <h:outputText value="#{period.role.label}"/>
                                                    <h:outputText value=" (rank: #{period.role.rank})"/>
                                                </p:column>

                                                <p:column>
                                                    <f:facet name="header">
                                                        <h:outputText value="Deactivated TS"/>
                                                    </f:facet>
                                                    <h:outputText value="#{systemServicesBB.getPrettyDate(period.recorddeactivatedTS)}"/>
                                                </p:column>
                                                <p:column>
                                                    <f:facet name="header">
                                                        <h:outputText value="Assignment rank"/>
                                                    </f:facet>
                                                    <h:outputText value="#{period.assignmentRelativeOrder}"/>
                                                </p:column>


                                                <p:column>
                                                    <f:facet name="header">
                                                        <h:outputText value="Actions"/>
                                                    </f:facet>
                                                    <p:commandButton ajax="true"
                                                                     id="usersettings-umaps-button-credentialize" 
                                                                     value="credentialize" 
                                                                     icon="fa fa-credit-card"
                                                                     styleClass="multiButtonLineButton" 
                                                                     actionListener="#{userBB.credentializeUserMuniAuthPeriod(period)}"
                                                                     update="usersettings-umaps-messages-form"/>
                                                </p:column>
                                                <p:rowExpansion>
                                                    <div class="outlinedBox">



                                                        <h:outputLabel value="Created by: "/>
                                                        <p:spacer height="0px"/>
                                                        <h:outputLabel value="user id: "/>
                                                        <h:outputText value="#{period.createdByUserID}"/>


                                                        <h:outputLabel value="Created TS:"/>
                                                        <h:outputText value="#{systemServicesBB.getPrettyDate(period.createdTS)}"/>

                                                        <h:outputLabel value="Notes"/>
                                                        <h:outputText value="#{period.notes}" escape="false"/>

                                                        <h4>Log entries associated with this authorization period</h4>


                                                        <p:scrollPanel id="usersettings-umaps-log-scrollpanel"
                                                                       style="height: 200px;">

                                                            <p:dataTable
                                                                id="usersettings-umaps-log-table"
                                                                var="entry"
                                                                value="#{period.periodActivityLogBook}"
                                                                rowKey="#{entry.logBookEntryID}"
                                                                tableStyleClass="primeDataTable">

                                                                <p:column>
                                                                    <f:facet name="header">
                                                                        <h:outputText value="Log entry ID"/>
                                                                    </f:facet>
                                                                    <h:outputText value="#{entry.logBookEntryID}"/>
                                                                </p:column>
                                                                <p:column>
                                                                    <f:facet name="header">
                                                                        <h:outputText value="AuthPerID"/>
                                                                    </f:facet>
                                                                    <h:outputText value="#{entry.userMuniAuthPeriodID}"/>
                                                                </p:column>
                                                                <p:column>
                                                                    <f:facet name="header">
                                                                        <h:outputText value="Cat"/>
                                                                    </f:facet>
                                                                    <h:outputText value="#{entry.category}"/>
                                                                </p:column>
                                                                <p:column>
                                                                    <f:facet name="header">
                                                                        <h:outputText value="TS"/>
                                                                    </f:facet>
                                                                    <h:outputText value="#{entry.entryTS}"/>
                                                                </p:column>
                                                                <p:column>
                                                                    <f:facet name="header">
                                                                        <h:outputText value="Client address"/>
                                                                    </f:facet>
                                                                    <h:outputText value="#{entry.header_remoteaddr}"/>
                                                                </p:column>
                                                            </p:dataTable>
                                                        </p:scrollPanel>

                                                    </div>
                                                </p:rowExpansion>
                                            </p:dataTable>
                                        </div>

                                    </h:form>

                                    <h:form id="usersettings-form-close">                             

                                        <p:commandButton ajax="true" 
                                                         value="Cancel" icon="fa fa-stop" 
                                                         onclick="PF('navcontainer-dialog-usersettings').hide()"
                                                         tabindex="4"/>


                                        <p:commandButton ajax="true" 
                                                         value="Done!" icon="fa thumbs-up" 
                                                         onclick="PF('navcontainer-dialog-usersettings').hide()"
                                                         tabindex="4"/>
                                    </h:form>
                                </div>

                            </p:dialog>
                            <p:spacer height="0px;"/>

                            <div class="flexing-box-pagecontent">
                                <ui:insert name="content">
                                    <p>I am the not content in the template content placeholder. I am not aware of any way for this particular element to ever be displayed to anybody.</p>
                                </ui:insert>
                            </div>
                        </div>
                    </f:view>
                </div>
            </div>
        </div>
    </h:body>
</html>
